(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},6:function(t,e){},yLV6:function(t,e,n){var r;!function(i,a,o,s){"use strict";var l,u=["","webkit","Moz","MS","ms","o"],c=a.createElement("div"),h=Math.round,p=Math.abs,d=Date.now;function f(t,e,n){return setTimeout(x(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(g(t,n[e],n),!0)}function g(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=i.console&&(i.console.warn||i.console.log);return a&&a.call(i.console,r,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var v=y((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&l(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function C(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function _(t,e){return void 0===t?e:t}function k(t,e,n){g(M(e),(function(e){t.addEventListener(e,n,!1)}))}function S(t,e,n){g(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function O(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function E(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function N(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function P(t){return Array.prototype.slice.call(t,0)}function T(t,e,n){for(var r=[],i=[],a=0;a<t.length;){var o=e?t[a][e]:t[a];N(i,o)<0&&r.push(t[a]),i[a]=o,a++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function I(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),a=0;a<u.length;){if((r=(n=u[a])?n+i:e)in t)return r;a++}}var A=1;function R(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var D="ontouchstart"in i,F=void 0!==I(i,"PointerEvent"),z=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),L=["x","y"],B=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){C(t.options.enable,[t])&&n.handler(e)},this.init()}function U(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,a=1&e&&r-i==0,o=12&e&&r-i==0;n.isFirst=!!a,n.isFinal=!!o,a&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=W(e)),i>1&&!n.firstMultiple?n.firstMultiple=W(e):1===i&&(n.firstMultiple=!1);var a=n.firstInput,o=n.firstMultiple,s=o?o.center:a.center,l=e.center=j(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=$(s,l),e.distance=G(s,l),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},a=t.prevInput||{};1!==e.eventType&&4!==a.eventType||(i=t.prevDelta={x:a.deltaX||0,y:a.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=H(e.deltaX,e.deltaY);var u,c,h=q(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=h.x,e.overallVelocityY=h.y,e.overallVelocity=p(h.x)>p(h.y)?h.x:h.y,e.scale=o?(u=o.pointers,G((c=r)[0],c[1],B)/G(u[0],u[1],B)):1,e.rotation=o?function(t,e){return $(e[1],e[0],B)+$(t[1],t[0],B)}(o.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,a,o=t.lastInterval||e,s=e.timeStamp-o.timeStamp;if(8!=e.eventType&&(s>25||void 0===o.velocity)){var l=e.deltaX-o.deltaX,u=e.deltaY-o.deltaY,c=q(s,l,u);r=c.x,i=c.y,n=p(c.x)>p(c.y)?c.x:c.y,a=H(l,u),t.lastInterval=e}else n=o.velocity,r=o.velocityX,i=o.velocityY,a=o.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=a}(n,e);var f=t.element;O(e.srcEvent.target,f)&&(f=e.srcEvent.target),e.target=f}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function W(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:j(e),deltaX:t.deltaX,deltaY:t.deltaY}}function j(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function q(t,e,n){return{x:e/t||0,y:n/t||0}}function H(t,e){return t===e?1:p(t)>=p(e)?t<0?2:4:e<0?8:16}function G(t,e,n){n||(n=L);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function $(t,e,n){return n||(n=L),180*Math.atan2(e[n[1]]-t[n[1]],e[n[0]]-t[n[0]])/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(R(this.element),this.evWin,this.domHandler)}};var K={mousedown:1,mousemove:2,mouseup:4};function X(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,V.apply(this,arguments)}w(X,V,{handler:function(t){var e=K[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var Y={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Q={2:"touch",3:"pen",4:"mouse",5:"kinect"},Z="pointerdown",J="pointermove pointerup pointercancel";function tt(){this.evEl=Z,this.evWin=J,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(Z="MSPointerDown",J="MSPointerMove MSPointerUp MSPointerCancel"),w(tt,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Y[r],a=Q[t.pointerType]||t.pointerType,o="touch"==a,s=N(e,t.pointerId,"pointerId");1&i&&(0===t.button||o)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:a,srcEvent:t}),n&&e.splice(s,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function nt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,V.apply(this,arguments)}function rt(t,e){var n=P(t.touches),r=P(t.changedTouches);return 12&e&&(n=T(n.concat(r),"identifier",!0)),[n,r]}w(nt,V,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=rt.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function at(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},V.apply(this,arguments)}function ot(t,e){var n=P(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,a,o=P(t.changedTouches),s=[],l=this.target;if(a=n.filter((function(t){return O(t.target,l)})),1===e)for(i=0;i<a.length;)r[a[i].identifier]=!0,i++;for(i=0;i<o.length;)r[o[i].identifier]&&s.push(o[i]),12&e&&delete r[o[i].identifier],i++;return s.length?[T(a.concat(s),"identifier",!0),s]:void 0}function st(){V.apply(this,arguments);var t=x(this.handler,this);this.touch=new at(this.manager,t),this.mouse=new X(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function lt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ut.call(this,e)):12&t&&ut.call(this,e)}function ut(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function ct(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],a=Math.abs(e-i.x),o=Math.abs(n-i.y);if(a<=25&&o<=25)return!0}return!1}w(at,V,{handler:function(t){var e=it[t.type],n=ot.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}),w(st,V,{handler:function(t,e,n){var r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if("touch"==n.pointerType)lt.call(this,e,n);else if(r&&ct.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ht=I(c.style,"touchAction"),pt=void 0!==ht,dt=function(){if(!pt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function ft(t,e){this.manager=t,this.set(e)}function mt(t){this.options=l({},this.defaults,t||{}),this.id=A++,this.manager=null,this.options.enable=_(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function gt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function yt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function vt(t,e){var n=e.manager;return n?n.get(t):t}function bt(){mt.apply(this,arguments)}function wt(){bt.apply(this,arguments),this.pX=null,this.pY=null}function xt(){bt.apply(this,arguments)}function Ct(){mt.apply(this,arguments),this._timer=null,this._input=null}function _t(){bt.apply(this,arguments)}function kt(){bt.apply(this,arguments)}function St(){mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ot(t,e){return(e=e||{}).recognizers=_(e.recognizers,Ot.defaults.preset),new Et(t,e)}function Et(t,e){var n;this.options=l({},Ot.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(F?tt:z?at:D?st:X))(n,U),this.touchAction=new ft(this,this.options.touchAction),Mt(this,!0),g(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Mt(t,e){var n,r=t.element;r.style&&(g(t.options.cssProps,(function(i,a){n=I(r.style,a),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}ft.prototype={set:function(t){"compute"==t&&(t=this.compute()),pt&&this.manager.element.style&&dt[t]&&(this.manager.element.style[ht]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return g(this.manager.recognizers,(function(e){C(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(E(t,"none"))return"none";var e=E(t,"pan-x"),n=E(t,"pan-y");return e&&n?"none":e||n?e?"pan-x":"pan-y":E(t,"manipulation")?"manipulation":"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=E(r,"none")&&!dt.none,a=E(r,"pan-y")&&!dt["pan-y"],o=E(r,"pan-x")&&!dt["pan-x"];if(i&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!o||!a)return i||a&&6&n||o&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}},mt.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=vt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)?this:(t=vt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===N(e,t=vt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=vt(t,this);var e=N(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+gt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+gt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!C(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(bt,mt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),w(wt,bt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,a=t.deltaX,o=t.deltaY;return i&e.direction||(6&e.direction?(i=0===a?1:a<0?2:4,n=a!=this.pX,r=Math.abs(t.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return bt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=yt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(xt,bt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){1!==t.scale&&(t.additionalEvent=this.options.event+(t.scale<1?"in":"out")),this._super.emit.call(this,t)}}),w(Ct,mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=f((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),w(_t,bt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),w(kt,bt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return wt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&p(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=yt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w(St,mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,o=!this.pCenter||G(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,o&&a?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=f((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=f((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ot.VERSION="2.0.7",Ot.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[_t,{enable:!1}],[xt,{enable:!1},["rotate"]],[kt,{direction:6}],[wt,{direction:6},["swipe"]],[St],[St,{event:"doubletap",taps:2},["tap"]],[Ct]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Et.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var a=0;a<r.length;)n=r[a],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),a++}},get:function(t){if(t instanceof mt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=N(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return g(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return g(M(t),(function(t){e?n[t]&&n[t].splice(N(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=a.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Mt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Ot,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Et,Input:V,TouchAction:ft,TouchInput:at,MouseInput:X,PointerEventInput:tt,TouchMouseInput:st,SingleTouchInput:nt,Recognizer:mt,AttrRecognizer:bt,Tap:St,Pan:wt,Swipe:kt,Pinch:xt,Rotate:_t,Press:Ct,on:k,off:S,each:g,merge:b,extend:v,assign:l,inherit:w,bindFn:x,prefixed:I}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Ot,void 0===(r=(function(){return Ot}).call(e,n,e,t))||(t.exports=r)}(window,document)},zUnb:function(t,e,n){"use strict";function r(t){return"function"==typeof t}n.r(e),n("yLV6");let i=!1;const a={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=t},get useDeprecatedSynchronousErrorHandling(){return i}};function o(t){setTimeout(()=>{throw t})}const s={closed:!0,next(t){},error(t){if(a.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete(){}},l=Array.isArray||(t=>t&&"number"==typeof t.length);function u(t){return null!==t&&"object"==typeof t}function c(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}c.prototype=Object.create(Error.prototype);const h=c;let p=(()=>{class t{constructor(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let t,e=!1;if(this.closed)return;let{_parent:n,_parents:i,_unsubscribe:a,_subscriptions:o}=this;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;let s=-1,c=i?i.length:0;for(;n;)n.remove(this),n=++s<c&&i[s]||null;if(r(a))try{a.call(this)}catch(bC){e=!0,t=bC instanceof h?d(bC.errors):[bC]}if(l(o))for(s=-1,c=o.length;++s<c;){const n=o[s];if(u(n))try{n.unsubscribe()}catch(bC){e=!0,t=t||[],bC instanceof h?t=t.concat(d(bC.errors)):t.push(bC)}}if(e)throw new h(t)}add(e){let n=e;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:if(!e)return t.EMPTY;throw new Error("unrecognized teardown "+e+" added to Subscription.")}if(n._addParent(this)){const t=this._subscriptions;t?t.push(n):this._subscriptions=[n]}return n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}_addParent(t){let{_parent:e,_parents:n}=this;return e!==t&&(e?n?-1===n.indexOf(t)&&(n.push(t),!0):(this._parents=[t],!0):(this._parent=t,!0))}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function d(t){return t.reduce((t,e)=>t.concat(e instanceof h?e.errors:e),[])}const f="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class m extends p{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s;break;case 1:if(!t){this.destination=s;break}if("object"==typeof t){t instanceof m?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new g(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new g(this,t,e,n)}}[f](){return this}static create(t,e,n){const r=new m(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parent:t,_parents:e}=this;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this}}class g extends m{constructor(t,e,n,i){let a;super(),this._parentSubscriber=t;let o=this;r(e)?a=e:e&&(a=e.next,n=e.error,i=e.complete,e!==s&&(o=Object.create(e),r(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=a,this._error=n,this._complete=i}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;a.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=a;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;o(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),a.useDeprecatedSynchronousErrorHandling)throw n;o(n)}}__tryOrSetError(t,e,n){if(!a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return a.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(o(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const y="function"==typeof Symbol&&Symbol.observable||"@@observable";function v(){}function b(...t){return w(t)}function w(t){return t?1===t.length?t[0]:function(e){return t.reduce((t,e)=>e(t),e)}:v}let x=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof m)return t;if(t[f])return t[f]()}return t||e||n?new m(t,e,n):new m(s)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||a.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),a.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){a.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof m?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=C(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[y](){return this}pipe(...t){return 0===t.length?this:w(t)(this)}toPromise(t){return new(t=C(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function C(t){if(t||(t=a.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function _(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}_.prototype=Object.create(Error.prototype);const k=_;class S extends p{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class O extends m{constructor(t){super(t),this.destination=t}}let E=(()=>{class t extends x{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[f](){return new O(this)}lift(t){const e=new M(this,this);return e.operator=t,e}next(t){if(this.closed)throw new k;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new k;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new k;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new k;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new k;return this.hasError?(t.error(this.thrownError),p.EMPTY):this.isStopped?(t.complete(),p.EMPTY):(this.observers.push(t),new S(this,t))}asObservable(){const t=new x;return t.source=this,t}}return t.create=(t,e)=>new M(t,e),t})();class M extends E{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):p.EMPTY}}function N(t){return t&&"function"==typeof t.schedule}class P extends m{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const T=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.closed||e.complete()},I=t=>e=>(t.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,o),e);function A(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const R=A(),D=t=>e=>{const n=t[R]();for(;;){const t=n.next();if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e},F=t=>e=>{const n=t[y]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)},z=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function L(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const B=t=>{if(t instanceof x)return e=>t._isScalar?(e.next(t.value),void e.complete()):t.subscribe(e);if(t&&"function"==typeof t[y])return F(t);if(z(t))return T(t);if(L(t))return I(t);if(t&&"function"==typeof t[R])return D(t);{const e=u(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}};function V(t,e,n,r,i=new P(t,n,r)){if(!i.closed)return B(e)(i)}class U extends m{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function W(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new j(t,e))}}class j{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new q(t,this.project,this.thisArg))}}class q extends m{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function H(t,e){return new x(e?n=>{const r=new p;let i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}:T(t))}function G(t,e){if(!e)return t instanceof x?t:new x(B(t));if(null!=t){if(function(t){return t&&"function"==typeof t[y]}(t))return function(t,e){return new x(e?n=>{const r=new p;return r.add(e.schedule(()=>{const i=t[y]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r}:F(t))}(t,e);if(L(t))return function(t,e){return new x(e?n=>{const r=new p;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r}:I(t))}(t,e);if(z(t))return H(t,e);if(function(t){return t&&"function"==typeof t[R]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new x(e?n=>{const r=new p;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[R](),r.add(e.schedule((function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())})))})),r}:D(t))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function $(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe($((n,r)=>G(t(n,r)).pipe(W((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new K(t,n)))}class K{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new X(t,this.project,this.concurrent))}}class X extends U{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new P(this,void 0,void 0);this.destination.add(r),V(this,t,e,n,r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function Y(t){return t}function Q(t=Number.POSITIVE_INFINITY){return $(Y,t)}function Z(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return N(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof x?t[0]:Q(e)(H(t,n))}function J(){return function(t){return t.lift(new tt(t))}}class tt{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new et(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class et extends m{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}const nt=class extends x{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new p,t.add(this.source.subscribe(new it(this.getSubject(),this))),t.closed?(this._connection=null,t=p.EMPTY):this._connection=t),t}refCount(){return J()(this)}}.prototype,rt={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:nt._subscribe},_isComplete:{value:nt._isComplete,writable:!0},getSubject:{value:nt.getSubject},connect:{value:nt.connect},refCount:{value:nt.refCount}};class it extends O{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function at(){return new E}function ot(t,e,n){const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i}const st=ot("Inject",t=>({token:t})),lt=ot("Optional"),ut=ot("Self"),ct=ot("SkipSelf");var ht=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function pt(t){for(let e in t)if(t[e]===pt)return e;throw Error("Could not find renamed property on target object.")}function dt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ft(t){const e=t[mt];return e&&e.token===t?e:null}const mt=pt({ngInjectableDef:pt});function gt(t){if("string"==typeof t)return t;if(t instanceof Array)return"["+t.map(gt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}const yt=pt({__forward_ref__:pt});function vt(t){return t.__forward_ref__=vt,t.toString=function(){return gt(this())},t}function bt(t){const e=t;return"function"==typeof e&&e.hasOwnProperty(yt)&&e.__forward_ref__===vt?e():t}const wt="undefined"!=typeof globalThis&&globalThis,xt="undefined"!=typeof window&&window,Ct="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,_t="undefined"!=typeof global&&global,kt=wt||_t||xt||Ct;class St{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.ngInjectableDef=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.ngInjectableDef=dt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Ot=new St("INJECTOR",-1),Et=new Object,Mt=/\n/gm,Nt=pt({provide:String,useValue:pt});let Pt=void 0;function Tt(t){const e=Pt;return Pt=t,e}function It(t,e=ht.Default){return function(t,e=ht.Default){if(void 0===Pt)throw new Error("inject() must be called from an injection context");return null===Pt?function(t,e,n){const r=ft(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ht.Optional)return null;throw new Error(`Injector: NOT_FOUND [${gt(t)}]`)}(t,0,e):Pt.get(t,e&ht.Optional?null:void 0,e)}(t,e)}const At=It;class Rt{get(t,e=Et){if(e===Et){const e=new Error(`NullInjectorError: No provider for ${gt(t)}!`);throw e.name="NullInjectorError",e}return e}}function Dt(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=gt(e);if(e instanceof Array)i=e.map(gt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):gt(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Mt,"\n  ")}`}class Ft{}class zt{}function Lt(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Bt(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const Vt=function(){var t={Emulated:0,Native:1,None:2,ShadowDom:3};return t[t.Emulated]="Emulated",t[t.Native]="Native",t[t.None]="None",t[t.ShadowDom]="ShadowDom",t}(),Ut=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(kt))();function Wt(t){return t.ngDebugContext}function jt(t){return t.ngOriginalError}function qt(t,...e){t.error(...e)}class Ht{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||qt}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?Wt(t)?Wt(t):this._findContext(jt(t)):null}_findOriginalError(t){let e=jt(t);for(;e&&jt(e);)e=jt(e);return e}}let Gt=!0,$t=!1;function Kt(){return $t=!0,Gt}class Xt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),this.inertBodyElement=this.inertDocument.body,null==this.inertBodyElement){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t),this.inertBodyElement=this.inertDocument.createElement("body"),t.appendChild(this.inertBodyElement)}this.inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!this.inertBodyElement.querySelector||this.inertBodyElement.querySelector("svg")?(this.inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=this.inertBodyElement.querySelector&&this.inertBodyElement.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(Ip){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}getInertBodyElement_XHR(t){t="<body><remove></remove>"+t+"</body>";try{t=encodeURI(t)}catch(Ip){return null}const e=new XMLHttpRequest;e.responseType="document",e.open("GET","data:text/html;charset=utf-8,"+t,!1),e.send(void 0);const n=e.response.body;return n.removeChild(n.firstChild),n}getInertBodyElement_DOMParser(t){t="<body><remove></remove>"+t+"</body>";try{const e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(Ip){return null}}getInertBodyElement_InertDocument(t){const e=this.inertDocument.createElement("template");return"content"in e?(e.innerHTML=t,e):(this.inertBodyElement.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(this.inertBodyElement),this.inertBodyElement)}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Yt=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Qt=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Zt(t){return(t=String(t)).match(Yt)||t.match(Qt)?t:(Kt()&&console.warn(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}function Jt(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function te(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const ee=Jt("area,br,col,hr,img,wbr"),ne=Jt("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),re=Jt("rp,rt"),ie=te(re,ne),ae=te(ee,te(ne,Jt("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),te(re,Jt("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ie),oe=Jt("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),se=Jt("srcset"),le=te(oe,se,Jt("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Jt("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ue=Jt("script,style,template");class ce{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!ae.hasOwnProperty(e))return this.sanitizedSomething=!0,!ue.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,a=e.toLowerCase();if(!le.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let o=t.value;oe[a]&&(o=Zt(o)),se[a]&&(r=o,o=(r=String(r)).split(",").map(t=>Zt(t.trim())).join(", ")),this.buf.push(" ",e,'="',de(o),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();ae.hasOwnProperty(e)&&!ee.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(de(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const he=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,pe=/([^\#-~ |!])/g;function de(t){return t.replace(/&/g,"&amp;").replace(he,(function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"})).replace(pe,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let fe;function me(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}const ge=function(){var t={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return t[t.NONE]="NONE",t[t.HTML]="HTML",t[t.STYLE]="STYLE",t[t.SCRIPT]="SCRIPT",t[t.URL]="URL",t[t.RESOURCE_URL]="RESOURCE_URL",t}();class ye{}const ve=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),be=/^url\(([^)]+)\)$/,we=/([A-Z])/g;function xe(t){try{return null!=t?t.toString().slice(0,30):t}catch(bC){return"[ERROR] Exception while trying to serialize the value"}}let Ce=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>_e(),t})();const _e=(...t)=>{},ke=new St("The presence of this token marks an injector as being the root injector."),Se=function(t,e,n){return new Te(t,e,n)};let Oe=(()=>{class t{static create(t,e){return Array.isArray(t)?Se(t,e,""):Se(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=Et,t.NULL=new Rt,t.ngInjectableDef=dt({token:t,providedIn:"any",factory:()=>It(Ot)}),t.__NG_ELEMENT_ID__=-1,t})();const Ee=function(t){return t},Me=[],Ne=Ee,Pe=function(){return Array.prototype.slice.call(arguments)};class Te{constructor(t,e=Oe.NULL,n=null){this.parent=e,this.source=n;const r=this._records=new Map;r.set(Oe,{token:Oe,fn:Ee,deps:Me,value:this,useNew:!1}),r.set(Ot,{token:Ot,fn:Ee,deps:Me,value:this,useNew:!1}),function t(e,n){if(n)if((n=bt(n))instanceof Array)for(let r=0;r<n.length;r++)t(e,n[r]);else{if("function"==typeof n)throw Ae("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw Ae("Unexpected provider",n);{let t=bt(n.provide);const r=function(t){const e=function(t){let e=Me;const n=t.deps;if(n&&n.length){e=[];for(let t=0;t<n.length;t++){let r=6,i=bt(n[t]);if(i instanceof Array)for(let t=0,e=i;t<e.length;t++){const n=e[t];n instanceof lt||n==lt?r|=1:n instanceof ct||n==ct?r&=-3:n instanceof ut||n==ut?r&=-5:i=n instanceof st?n.token:bt(n)}e.push({token:i,options:r})}}else if(t.useExisting)e=[{token:bt(t.useExisting),options:6}];else if(!(n||Nt in t))throw Ae("'deps' required",t);return e}(t);let n=Ee,r=Me,i=!1,a=bt(t.provide);if(Nt in t)r=t.useValue;else if(t.useFactory)n=t.useFactory;else if(t.useExisting);else if(t.useClass)i=!0,n=bt(t.useClass);else{if("function"!=typeof a)throw Ae("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",t);i=!0,n=a}return{deps:e,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){let r=e.get(t);if(r){if(r.fn!==Pe)throw Ie(t)}else e.set(t,r={token:n.provide,deps:[],useNew:!1,fn:Pe,value:Me});t=n,r.deps.push({token:t,options:6})}const i=e.get(t);if(i&&i.fn==Pe)throw Ie(t);e.set(t,r)}}}(r,t)}get(t,e,n=ht.Default){const r=this._records.get(t);try{return function t(e,n,r,i,a,o){try{return function(e,n,r,i,a,o){let s;if(!n||o&ht.SkipSelf)o&ht.Self||(s=i.get(e,a,ht.Default));else{if(s=n.value,s==Ne)throw Error("\u0275Circular dependency");if(s===Me){n.value=Ne;let e=void 0,a=n.useNew,o=n.fn,l=n.deps,u=Me;if(l.length){u=[];for(let e=0;e<l.length;e++){const n=l[e],a=n.options,o=2&a?r.get(n.token):void 0;u.push(t(n.token,o,r,o||4&a?i:Oe.NULL,1&a?null:Oe.THROW_IF_NOT_FOUND,ht.Default))}}n.value=s=a?new o(...u):o.apply(e,u)}}return s}(e,n,r,i,a,o)}catch(bC){throw bC instanceof Error||(bC=new Error(bC)),(bC.ngTempTokenPath=bC.ngTempTokenPath||[]).unshift(e),n&&n.value==Ne&&(n.value=Me),bC}}(t,r,this._records,this.parent,e,n)}catch(bC){return function(t,e,n,r){const i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=Dt("\n"+t.message,i,"StaticInjectorError",r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(bC,t,0,this.source)}}toString(){const t=[];return this._records.forEach((e,n)=>t.push(gt(n))),`StaticInjector[${t.join(", ")}]`}}function Ie(t){return Ae("Cannot mix multi providers and regular providers",t)}function Ae(t,e){return new Error(Dt(t,e,"StaticInjectorError"))}const Re=new St("AnalyzeForEntryComponents");let De=null;function Fe(){if(!De){const t=kt.Symbol;if(t&&t.iterator)De=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(De=n)}}}return De}function ze(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}function Le(t,e){const n=Ve(t),r=Ve(e);if(n&&r)return function(t,e,n){const r=t[Fe()](),i=e[Fe()]();for(;;){const t=r.next(),e=i.next();if(t.done&&e.done)return!0;if(t.done||e.done)return!1;if(!n(t.value,e.value))return!1}}(t,e,Le);{const i=t&&("object"==typeof t||"function"==typeof t),a=e&&("object"==typeof e||"function"==typeof e);return!(n||!i||r||!a)||ze(t,e)}}class Be{constructor(t){this.wrapped=t}static wrap(t){return new Be(t)}static unwrap(t){return Be.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Be}}function Ve(t){return!!Ue(t)&&(Array.isArray(t)||!(t instanceof Map)&&Fe()in t)}function Ue(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function We(t){return!!t&&"function"==typeof t.then}function je(t){return!!t&&"function"==typeof t.subscribe}class qe{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}class He{}function Ge(t){const e=Error(`No component factory found for ${gt(t)}. Did you add it to @NgModule.entryComponents?`);return e[$e]=t,e}const $e="ngComponent";class Ke{resolveComponentFactory(t){throw Ge(t)}}let Xe=(()=>{class t{}return t.NULL=new Ke,t})();class Ye{constructor(t,e,n){this._parent=e,this._ngModule=n,this._factories=new Map;for(let r=0;r<t.length;r++){const e=t[r];this._factories.set(e.componentType,e)}}resolveComponentFactory(t){let e=this._factories.get(t);if(!e&&this._parent&&(e=this._parent.resolveComponentFactory(t)),!e)throw Ge(t);return new Qe(e,this._ngModule)}}class Qe extends He{constructor(t,e){super(),this.factory=t,this.ngModule=e,this.selector=t.selector,this.componentType=t.componentType,this.ngContentSelectors=t.ngContentSelectors,this.inputs=t.inputs,this.outputs=t.outputs}create(t,e,n,r){return this.factory.create(t,e,n,r||this.ngModule)}}function Ze(...t){}let Je=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>tn(t),t})();const tn=Ze;class en{}class nn{}const rn=function(){var t={Important:1,DashCase:2};return t[t.Important]="Important",t[t.DashCase]="DashCase",t}();let an=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>on(),t})();const on=Ze;class sn{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const ln=new sn("8.2.14");class un{constructor(){}supports(t){return Ve(t)}create(t){return new hn(t)}}const cn=(t,e)=>e;class hn{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||cn}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const a=!n||e&&e.currentIndex<mn(n,r,i)?e:n,o=mn(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(e=e._next,null==a.previousIndex)r++;else{i||(i=[]);const t=o-r,e=s-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,a=r+n;e<=a&&a<t&&(i[n]=r+1)}i[a.previousIndex]=e-t}}o!==s&&t(a,o,s)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ve(t))throw new Error(`Error trying to diff '${gt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,a=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&ze(i.trackById,r)?(a&&(i=this._verifyReinsertion(i,n,r,e)),ze(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),a=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Fe()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&ze(i.trackById,r)?(a&&(i=this._verifyReinsertion(i,t,r,e)),ze(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),a=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(ze(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(ze(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new pn(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new fn),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e?t:(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t,t)}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new fn),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class pn{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class dn{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&ze(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class fn{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new dn,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function mn(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class gn{constructor(){}supports(t){return t instanceof Map||Ue(t)}create(){return new yn}}class yn{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ue(t)))throw new Error(`Error trying to diff '${gt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new vn(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){ze(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class vn{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let bn=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new ct,new lt]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.ngInjectableDef=dt({token:t,providedIn:"root",factory:()=>new t([new un])}),t})(),wn=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new ct,new lt]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.ngInjectableDef=dt({token:t,providedIn:"root",factory:()=>new t([new gn])}),t})();const xn=[new gn],Cn=new bn([new un]),_n=new wn(xn);let kn=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Sn(t,Je),t})();const Sn=Ze;let On=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>En(t,Je),t})();const En=Ze;function Mn(t,e,n,r){let i=`ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '${e}'. Current value: '${n}'.`;return r&&(i+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),function(t,e){const n=new Error(t);return Nn(n,e),n}(i,t)}function Nn(t,e){t.ngDebugContext=e,t.ngErrorLogger=e.logError.bind(e)}function Pn(t){return new Error(`ViewDestroyedError: Attempt to use a destroyed view: ${t}`)}function Tn(t,e,n){const r=t.state,i=1792&r;return i===e?(t.state=-1793&r|n,t.initIndex=-1,!0):i===n}function In(t,e,n){return(1792&t.state)===e&&t.initIndex<=n&&(t.initIndex=n+1,!0)}function An(t,e){return t.nodes[e]}function Rn(t,e){return t.nodes[e]}function Dn(t,e){return t.nodes[e]}function Fn(t,e){return t.nodes[e]}function zn(t,e){return t.nodes[e]}const Ln={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0},Bn=()=>{},Vn=new Map;function Un(t){let e=Vn.get(t);return e||(e=gt(t)+"_"+Vn.size,Vn.set(t,e)),e}function Wn(t){return{id:"$$undefined",styles:t.styles,encapsulation:t.encapsulation,data:t.data}}let jn=0;function qn(t,e,n,r){return!(!(2&t.state)&&ze(t.oldValues[e.bindingIndex+n],r))}function Hn(t,e,n,r){return!!qn(t,e,n,r)&&(t.oldValues[e.bindingIndex+n]=r,!0)}function Gn(t,e,n,r){const i=t.oldValues[e.bindingIndex+n];if(1&t.state||!Le(i,r)){const a=e.bindings[n].name;throw Mn(Ln.createDebugContext(t,e.nodeIndex),`${a}: ${i}`,`${a}: ${r}`,0!=(1&t.state))}}function $n(t){let e=t;for(;e;)2&e.def.flags&&(e.state|=8),e=e.viewContainerParent||e.parent}function Kn(t,e){let n=t;for(;n&&n!==e;)n.state|=64,n=n.viewContainerParent||n.parent}function Xn(t,e,n,r){try{return $n(33554432&t.def.nodes[e].flags?Rn(t,e).componentView:t),Ln.handleEvent(t,e,n,r)}catch(bC){t.root.errorHandler.handleError(bC)}}function Yn(t){return t.parent?Rn(t.parent,t.parentNodeDef.nodeIndex):null}function Qn(t){return t.parent?t.parentNodeDef.parent:null}function Zn(t,e){switch(201347067&e.flags){case 1:return Rn(t,e.nodeIndex).renderElement;case 2:return An(t,e.nodeIndex).renderText}}function Jn(t){return!!t.parent&&!!(32768&t.parentNodeDef.flags)}function tr(t){return!(!t.parent||32768&t.parentNodeDef.flags)}function er(t){const e={};let n=0;const r={};return t&&t.forEach(([t,i])=>{"number"==typeof t?(e[t]=i,n|=function(t){return 1<<t%32}(t)):r[t]=i}),{matchedQueries:e,references:r,matchedQueryIds:n}}function nr(t,e){return t.map(t=>{let n,r;return Array.isArray(t)?[r,n]=t:(r=0,n=t),n&&("function"==typeof n||"object"==typeof n)&&e&&Object.defineProperty(n,"__source",{value:e,configurable:!0}),{flags:r,token:n,tokenKey:Un(n)}})}function rr(t,e,n){let r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===Vt.Native?Rn(t,n.renderParent.nodeIndex).renderElement:void 0:e}const ir=new WeakMap;function ar(t){let e=ir.get(t);return e||(e=t(()=>Bn),e.factory=t,ir.set(t,e)),e}function or(t,e,n,r,i){3===e&&(n=t.renderer.parentNode(Zn(t,t.def.lastRenderRootNode))),sr(t,e,0,t.def.nodes.length-1,n,r,i)}function sr(t,e,n,r,i,a,o){for(let s=n;s<=r;s++){const n=t.def.nodes[s];11&n.flags&&ur(t,n,e,i,a,o),s+=n.childCount}}function lr(t,e,n,r,i,a){let o=t;for(;o&&!Jn(o);)o=o.parent;const s=o.parent,l=Qn(o),u=l.nodeIndex+l.childCount;for(let c=l.nodeIndex+1;c<=u;c++){const t=s.def.nodes[c];t.ngContentIndex===e&&ur(s,t,n,r,i,a),c+=t.childCount}if(!s.parent){const o=t.root.projectableNodes[e];if(o)for(let e=0;e<o.length;e++)cr(t,o[e],n,r,i,a)}}function ur(t,e,n,r,i,a){if(8&e.flags)lr(t,e.ngContent.index,n,r,i,a);else{const o=Zn(t,e);if(3===n&&33554432&e.flags&&48&e.bindingFlags?(16&e.bindingFlags&&cr(t,o,n,r,i,a),32&e.bindingFlags&&cr(Rn(t,e.nodeIndex).componentView,o,n,r,i,a)):cr(t,o,n,r,i,a),16777216&e.flags){const o=Rn(t,e.nodeIndex).viewContainer._embeddedViews;for(let t=0;t<o.length;t++)or(o[t],n,r,i,a)}1&e.flags&&!e.element.name&&sr(t,n,e.nodeIndex+1,e.nodeIndex+e.childCount,r,i,a)}}function cr(t,e,n,r,i,a){const o=t.renderer;switch(n){case 1:o.appendChild(r,e);break;case 2:o.insertBefore(r,e,i);break;case 3:o.removeChild(r,e);break;case 0:a.push(e)}}const hr=/^:([^:]+):(.+)$/;function pr(t){if(":"===t[0]){const e=t.match(hr);return[e[1],e[2]]}return["",t]}function dr(t){let e=0;for(let n=0;n<t.length;n++)e|=t[n].flags;return e}const fr=new Object,mr=Un(Oe),gr=Un(Ot),yr=Un(Ft);function vr(t,e,n,r){return n=bt(n),{index:-1,deps:nr(r,gt(e)),flags:t,token:e,value:n}}function br(t,e,n=Oe.THROW_IF_NOT_FOUND){const r=Tt(t);try{if(8&e.flags)return e.token;if(2&e.flags&&(n=null),1&e.flags)return t._parent.get(e.token,n);const o=e.tokenKey;switch(o){case mr:case gr:case yr:return t}const s=t._def.providersByKey[o];let l;if(s){let e=t._providers[s.index];return void 0===e&&(e=t._providers[s.index]=wr(t,s)),e===fr?void 0:e}if((l=ft(e.token))&&(i=t,null!=(a=l).providedIn&&(function(t,e){return t._def.modules.indexOf(e)>-1}(i,a.providedIn)||"root"===a.providedIn&&i._def.isRoot))){const n=t._providers.length;return t._def.providers[n]=t._def.providersByKey[e.tokenKey]={flags:5120,value:l.factory,deps:[],index:n,token:e.token},t._providers[n]=fr,t._providers[n]=wr(t,t._def.providersByKey[e.tokenKey])}return 4&e.flags?n:t._parent.get(e.token,n)}finally{Tt(r)}var i,a}function wr(t,e){let n;switch(201347067&e.flags){case 512:n=function(t,e,n){const r=n.length;switch(r){case 0:return new e;case 1:return new e(br(t,n[0]));case 2:return new e(br(t,n[0]),br(t,n[1]));case 3:return new e(br(t,n[0]),br(t,n[1]),br(t,n[2]));default:const i=new Array(r);for(let e=0;e<r;e++)i[e]=br(t,n[e]);return new e(...i)}}(t,e.value,e.deps);break;case 1024:n=function(t,e,n){const r=n.length;switch(r){case 0:return e();case 1:return e(br(t,n[0]));case 2:return e(br(t,n[0]),br(t,n[1]));case 3:return e(br(t,n[0]),br(t,n[1]),br(t,n[2]));default:const i=Array(r);for(let e=0;e<r;e++)i[e]=br(t,n[e]);return e(...i)}}(t,e.value,e.deps);break;case 2048:n=br(t,e.deps[0]);break;case 256:n=e.value}return n===fr||null===n||"object"!=typeof n||131072&e.flags||"function"!=typeof n.ngOnDestroy||(e.flags|=131072),void 0===n?fr:n}function xr(t,e){const n=t.viewContainer._embeddedViews;if((null==e||e>=n.length)&&(e=n.length-1),e<0)return null;const r=n[e];return r.viewContainerParent=null,Bt(n,e),Ln.dirtyParentQueries(r),_r(r),r}function Cr(t,e,n){const r=e?Zn(e,e.def.lastRenderRootNode):t.renderElement,i=n.renderer.parentNode(r),a=n.renderer.nextSibling(r);or(n,2,i,a,void 0)}function _r(t){or(t,3,null,null,void 0)}const kr=new Object;function Sr(t,e,n,r,i,a){return new Or(t,e,n,r,i,a)}class Or extends He{constructor(t,e,n,r,i,a){super(),this.selector=t,this.componentType=e,this._inputs=r,this._outputs=i,this.ngContentSelectors=a,this.viewDefFactory=n}get inputs(){const t=[],e=this._inputs;for(let n in e)t.push({propName:n,templateName:e[n]});return t}get outputs(){const t=[];for(let e in this._outputs)t.push({propName:e,templateName:this._outputs[e]});return t}create(t,e,n,r){if(!r)throw new Error("ngModule should be provided");const i=ar(this.viewDefFactory),a=i.nodes[0].element.componentProvider.nodeIndex,o=Ln.createRootView(t,e||[],n,i,r,kr),s=Dn(o,a).instance;return n&&o.renderer.setAttribute(Rn(o,0).renderElement,"ng-version",ln.full),new Er(o,new Tr(o),s)}}class Er extends class{}{constructor(t,e,n){super(),this._view=t,this._viewRef=e,this._component=n,this._elDef=this._view.def.nodes[0],this.hostView=e,this.changeDetectorRef=e,this.instance=n}get location(){return new Je(Rn(this._view,this._elDef.nodeIndex).renderElement)}get injector(){return new Dr(this._view,this._elDef)}get componentType(){return this._component.constructor}destroy(){this._viewRef.destroy()}onDestroy(t){this._viewRef.onDestroy(t)}}function Mr(t,e,n){return new Nr(t,e,n)}class Nr{constructor(t,e,n){this._view=t,this._elDef=e,this._data=n,this._embeddedViews=[]}get element(){return new Je(this._data.renderElement)}get injector(){return new Dr(this._view,this._elDef)}get parentInjector(){let t=this._view,e=this._elDef.parent;for(;!e&&t;)e=Qn(t),t=t.parent;return t?new Dr(t,e):new Dr(this._view,null)}clear(){for(let t=this._embeddedViews.length-1;t>=0;t--){const e=xr(this._data,t);Ln.destroyView(e)}}get(t){const e=this._embeddedViews[t];if(e){const t=new Tr(e);return t.attachToViewContainerRef(this),t}return null}get length(){return this._embeddedViews.length}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const a=n||this.parentInjector;i||t instanceof Qe||(i=a.get(Ft));const o=t.create(a,r,void 0,i);return this.insert(o.hostView,e),o}insert(t,e){if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");const n=t;return function(t,e,n,r){let i=e.viewContainer._embeddedViews;null==n&&(n=i.length),r.viewContainerParent=t,Lt(i,n,r),function(t,e){const n=Yn(e);if(!n||n===t||16&e.state)return;e.state|=16;let r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(e),function(t,e){if(4&e.flags)return;t.nodeFlags|=4,e.flags|=4;let n=e.parent;for(;n;)n.childFlags|=4,n=n.parent}(e.parent.def,e.parentNodeDef)}(e,r),Ln.dirtyParentQueries(r),Cr(e,n>0?i[n-1]:null,r)}(this._view,this._data,e,n._view),n.attachToViewContainerRef(this),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");const n=this._embeddedViews.indexOf(t._view);return function(t,e,n){const r=t.viewContainer._embeddedViews,i=r[e];Bt(r,e),null==n&&(n=r.length),Lt(r,n,i),Ln.dirtyParentQueries(i),_r(i),Cr(t,n>0?r[n-1]:null,i)}(this._data,n,e),t}indexOf(t){return this._embeddedViews.indexOf(t._view)}remove(t){const e=xr(this._data,t);e&&Ln.destroyView(e)}detach(t){const e=xr(this._data,t);return e?new Tr(e):null}}function Pr(t){return new Tr(t)}class Tr{constructor(t){this._view=t,this._viewContainerRef=null,this._appRef=null}get rootNodes(){return function(t){const e=[];return or(t,0,void 0,void 0,e),e}(this._view)}get context(){return this._view.context}get destroyed(){return 0!=(128&this._view.state)}markForCheck(){$n(this._view)}detach(){this._view.state&=-5}detectChanges(){const t=this._view.root.rendererFactory;t.begin&&t.begin();try{Ln.checkAndUpdateView(this._view)}finally{t.end&&t.end()}}checkNoChanges(){Ln.checkNoChangesView(this._view)}reattach(){this._view.state|=4}onDestroy(t){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(t)}destroy(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Ln.destroyView(this._view)}detachFromAppRef(){this._appRef=null,_r(this._view),Ln.dirtyParentQueries(this._view)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}}function Ir(t,e){return new Ar(t,e)}class Ar extends kn{constructor(t,e){super(),this._parentView=t,this._def=e}createEmbeddedView(t){return new Tr(Ln.createEmbeddedView(this._parentView,this._def,this._def.element.template,t))}get elementRef(){return new Je(Rn(this._parentView,this._def.nodeIndex).renderElement)}}function Rr(t,e){return new Dr(t,e)}class Dr{constructor(t,e){this.view=t,this.elDef=e}get(t,e=Oe.THROW_IF_NOT_FOUND){return Ln.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:t,tokenKey:Un(t)},e)}}function Fr(t,e){const n=t.def.nodes[e];if(1&n.flags){const e=Rn(t,n.nodeIndex);return n.element.template?e.template:e.renderElement}if(2&n.flags)return An(t,n.nodeIndex).renderText;if(20240&n.flags)return Dn(t,n.nodeIndex).instance;throw new Error(`Illegal state: read nodeValue for node index ${e}`)}function zr(t){return new Lr(t.renderer)}class Lr{constructor(t){this.delegate=t}selectRootElement(t){return this.delegate.selectRootElement(t)}createElement(t,e){const[n,r]=pr(e),i=this.delegate.createElement(r,n);return t&&this.delegate.appendChild(t,i),i}createViewRoot(t){return t}createTemplateAnchor(t){const e=this.delegate.createComment("");return t&&this.delegate.appendChild(t,e),e}createText(t,e){const n=this.delegate.createText(e);return t&&this.delegate.appendChild(t,n),n}projectNodes(t,e){for(let n=0;n<e.length;n++)this.delegate.appendChild(t,e[n])}attachViewAfter(t,e){const n=this.delegate.parentNode(t),r=this.delegate.nextSibling(t);for(let i=0;i<e.length;i++)this.delegate.insertBefore(n,e[i],r)}detachView(t){for(let e=0;e<t.length;e++){const n=t[e],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}}destroyView(t,e){for(let n=0;n<e.length;n++)this.delegate.destroyNode(e[n])}listen(t,e,n){return this.delegate.listen(t,e,n)}listenGlobal(t,e,n){return this.delegate.listen(t,e,n)}setElementProperty(t,e,n){this.delegate.setProperty(t,e,n)}setElementAttribute(t,e,n){const[r,i]=pr(e);null!=n?this.delegate.setAttribute(t,i,n,r):this.delegate.removeAttribute(t,i,r)}setBindingDebugInfo(t,e,n){}setElementClass(t,e,n){n?this.delegate.addClass(t,e):this.delegate.removeClass(t,e)}setElementStyle(t,e,n){null!=n?this.delegate.setStyle(t,e,n):this.delegate.removeStyle(t,e)}invokeElementMethod(t,e,n){t[e].apply(t,n)}setText(t,e){this.delegate.setValue(t,e)}animate(){throw new Error("Renderer.animate is no longer supported!")}}function Br(t,e,n,r){return new Vr(t,e,n,r)}class Vr{constructor(t,e,n,r){this._moduleType=t,this._parent=e,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,this.injector=this,function(t){const e=t._def,n=t._providers=new Array(e.providers.length);for(let r=0;r<e.providers.length;r++){const i=e.providers[r];4096&i.flags||void 0===n[r]&&(n[r]=wr(t,i))}}(this)}get(t,e=Oe.THROW_IF_NOT_FOUND,n=ht.Default){let r=0;return n&ht.SkipSelf?r|=1:n&ht.Self&&(r|=4),br(this,{token:t,tokenKey:Un(t),flags:r},e)}get instance(){return this.get(this._moduleType)}get componentFactoryResolver(){return this.get(Xe)}destroy(){if(this._destroyed)throw new Error(`The ng module ${gt(this.instance.constructor)} has already been destroyed.`);this._destroyed=!0,function(t,e){const n=t._def,r=new Set;for(let i=0;i<n.providers.length;i++)if(131072&n.providers[i].flags){const e=t._providers[i];if(e&&e!==fr){const t=e.ngOnDestroy;"function"!=typeof t||r.has(e)||(t.apply(e),r.add(e))}}}(this),this._destroyListeners.forEach(t=>t())}onDestroy(t){this._destroyListeners.push(t)}}const Ur=Un(en),Wr=Un(an),jr=Un(Je),qr=Un(On),Hr=Un(kn),Gr=Un(Ce),$r=Un(Oe),Kr=Un(Ot);function Xr(t,e,n,r,i,a,o,s){const l=[];if(o)for(let c in o){const[t,e]=o[c];l[t]={flags:8,name:c,nonMinifiedName:e,ns:null,securityContext:null,suffix:null}}const u=[];if(s)for(let c in s)u.push({type:1,propName:c,target:null,eventName:s[c]});return function(t,e,n,r,i,a,o,s,l){const{matchedQueries:u,references:c,matchedQueryIds:h}=er(n);l||(l=[]),s||(s=[]),a=bt(a);const p=nr(o,gt(i));return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:u,matchedQueryIds:h,references:c,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:dr(s),outputs:l,element:null,provider:{token:i,value:a,deps:p},text:null,query:null,ngContent:null}}(t,e|=16384,n,r,i,i,a,l,u)}function Yr(t,e){return ti(t,e)}function Qr(t,e){let n=t;for(;n.parent&&!Jn(n);)n=n.parent;return ei(n.parent,Qn(n),!0,e.provider.value,e.provider.deps)}function Zr(t,e){const n=ei(t,e.parent,(32768&e.flags)>0,e.provider.value,e.provider.deps);if(e.outputs.length)for(let r=0;r<e.outputs.length;r++){const i=e.outputs[r],a=n[i.propName];if(!je(a))throw new Error(`@Output ${i.propName} not initialized in '${n.constructor.name}'.`);{const n=a.subscribe(Jr(t,e.parent.nodeIndex,i.eventName));t.disposables[e.outputIndex+r]=n.unsubscribe.bind(n)}}return n}function Jr(t,e,n){return r=>Xn(t,e,n,r)}function ti(t,e){const n=(8192&e.flags)>0,r=e.provider;switch(201347067&e.flags){case 512:return ei(t,e.parent,n,r.value,r.deps);case 1024:return function(t,e,n,r,i){const a=i.length;switch(a){case 0:return r();case 1:return r(ri(t,e,n,i[0]));case 2:return r(ri(t,e,n,i[0]),ri(t,e,n,i[1]));case 3:return r(ri(t,e,n,i[0]),ri(t,e,n,i[1]),ri(t,e,n,i[2]));default:const o=Array(a);for(let r=0;r<a;r++)o[r]=ri(t,e,n,i[r]);return r(...o)}}(t,e.parent,n,r.value,r.deps);case 2048:return ri(t,e.parent,n,r.deps[0]);case 256:return r.value}}function ei(t,e,n,r,i){const a=i.length;switch(a){case 0:return new r;case 1:return new r(ri(t,e,n,i[0]));case 2:return new r(ri(t,e,n,i[0]),ri(t,e,n,i[1]));case 3:return new r(ri(t,e,n,i[0]),ri(t,e,n,i[1]),ri(t,e,n,i[2]));default:const o=new Array(a);for(let r=0;r<a;r++)o[r]=ri(t,e,n,i[r]);return new r(...o)}}const ni={};function ri(t,e,n,r,i=Oe.THROW_IF_NOT_FOUND){if(8&r.flags)return r.token;const a=t;2&r.flags&&(i=null);const o=r.tokenKey;o===Gr&&(n=!(!e||!e.element.componentView)),e&&1&r.flags&&(n=!1,e=e.parent);let s=t;for(;s;){if(e)switch(o){case Ur:return zr(ii(s,e,n));case Wr:return ii(s,e,n).renderer;case jr:return new Je(Rn(s,e.nodeIndex).renderElement);case qr:return Rn(s,e.nodeIndex).viewContainer;case Hr:if(e.element.template)return Rn(s,e.nodeIndex).template;break;case Gr:return Pr(ii(s,e,n));case $r:case Kr:return Rr(s,e);default:const t=(n?e.element.allProviders:e.element.publicProviders)[o];if(t){let e=Dn(s,t.nodeIndex);return e||(e={instance:ti(s,t)},s.nodes[t.nodeIndex]=e),e.instance}}n=Jn(s),e=Qn(s),s=s.parent,4&r.flags&&(s=null)}const l=a.root.injector.get(r.token,ni);return l!==ni||i===ni?l:a.root.ngModule.injector.get(r.token,i)}function ii(t,e,n){let r;if(n)r=Rn(t,e.nodeIndex).componentView;else for(r=t;r.parent&&!Jn(r);)r=r.parent;return r}function ai(t,e,n,r,i,a){if(32768&n.flags){const e=Rn(t,n.parent.nodeIndex).componentView;2&e.def.flags&&(e.state|=8)}if(e.instance[n.bindings[r].name]=i,524288&n.flags){a=a||{};const e=Be.unwrap(t.oldValues[n.bindingIndex+r]);a[n.bindings[r].nonMinifiedName]=new qe(e,i,0!=(2&t.state))}return t.oldValues[n.bindingIndex+r]=i,a}function oi(t,e){if(!(t.def.nodeFlags&e))return;const n=t.def.nodes;let r=0;for(let i=0;i<n.length;i++){const a=n[i];let o=a.parent;for(!o&&a.flags&e&&li(t,i,a.flags&e,r++),0==(a.childFlags&e)&&(i+=a.childCount);o&&1&o.flags&&i===o.nodeIndex+o.childCount;)o.directChildFlags&e&&(r=si(t,o,e,r)),o=o.parent}}function si(t,e,n,r){for(let i=e.nodeIndex+1;i<=e.nodeIndex+e.childCount;i++){const e=t.def.nodes[i];e.flags&n&&li(t,i,e.flags&n,r++),i+=e.childCount}return r}function li(t,e,n,r){const i=Dn(t,e);if(!i)return;const a=i.instance;a&&(Ln.setCurrentNode(t,e),1048576&n&&In(t,512,r)&&a.ngAfterContentInit(),2097152&n&&a.ngAfterContentChecked(),4194304&n&&In(t,768,r)&&a.ngAfterViewInit(),8388608&n&&a.ngAfterViewChecked(),131072&n&&a.ngOnDestroy())}const ui=new St("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Ut}),ci={},hi=function(){var t={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencySymbol:15,CurrencyName:16,Currencies:17,PluralCase:18,ExtraData:19};return t[t.LocaleId]="LocaleId",t[t.DayPeriodsFormat]="DayPeriodsFormat",t[t.DayPeriodsStandalone]="DayPeriodsStandalone",t[t.DaysFormat]="DaysFormat",t[t.DaysStandalone]="DaysStandalone",t[t.MonthsFormat]="MonthsFormat",t[t.MonthsStandalone]="MonthsStandalone",t[t.Eras]="Eras",t[t.FirstDayOfWeek]="FirstDayOfWeek",t[t.WeekendRange]="WeekendRange",t[t.DateFormat]="DateFormat",t[t.TimeFormat]="TimeFormat",t[t.DateTimeFormat]="DateTimeFormat",t[t.NumberSymbols]="NumberSymbols",t[t.NumberFormats]="NumberFormats",t[t.CurrencySymbol]="CurrencySymbol",t[t.CurrencyName]="CurrencyName",t[t.Currencies]="Currencies",t[t.PluralCase]="PluralCase",t[t.ExtraData]="ExtraData",t}();var pi=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",{},function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];class di extends E{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,a=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(a=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(a=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const o=super.subscribe(r,i,a);return t instanceof p&&t.add(o),o}}function fi(){return this._results[Fe()]()}class mi{constructor(){this.dirty=!0,this._results=[],this.changes=new di,this.length=0;const t=Fe(),e=mi.prototype;e[t]||(e[t]=fi)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}const gi=new St("Application Initializer");class yi{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();We(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}const vi=new St("AppId");function bi(){return`${wi()}${wi()}${wi()}`}function wi(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const xi=new St("Platform Initializer"),Ci=new St("Platform ID"),_i=new St("appBootstrapListener");class ki{log(t){console.log(t)}warn(t){console.warn(t)}}const Si=new St("LocaleId");function Oi(){throw new Error("Runtime compiler is not loaded")}const Ei=Oi,Mi=Oi,Ni=Oi,Pi=Oi;class Ti{constructor(){this.compileModuleSync=Ei,this.compileModuleAsync=Mi,this.compileModuleAndAllComponentsSync=Ni,this.compileModuleAndAllComponentsAsync=Pi}clearCache(){}clearCacheFor(t){}getModuleId(t){}}class Ii{}let Ai,Ri;function Di(){const t=kt.wtf;return!(!t||(Ai=t.trace,!Ai)||(Ri=Ai.events,0))}const Fi=Di();function zi(t,e){return null}const Li=Fi?function(t,e=null){return Ri.createScope(t,e)}:(t,e)=>zi,Bi=Fi?function(t,e){return Ai.leaveScope(t,e),e}:(t,e)=>e,Vi=(()=>Promise.resolve(0))();function Ui(t){"undefined"==typeof Zone?Vi.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Wi{constructor({enableLongStackTrace:t=!1}){if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new di(!1),this.onMicrotaskEmpty=new di(!1),this.onStable=new di(!1),this.onError=new di(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");var e;Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(e=this)._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,i,a,o)=>{try{return Gi(e),t.invokeTask(r,i,a,o)}finally{$i(e)}},onInvoke:(t,n,r,i,a,o,s)=>{try{return Gi(e),t.invoke(r,i,a,o,s)}finally{$i(e)}},onHasTask:(t,n,r,i)=>{t.hasTask(r,i),n===r&&("microTask"==i.change?(e.hasPendingMicrotasks=i.microTask,Hi(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,n,r,i)=>(t.handleError(r,i),e.runOutsideAngular(()=>e.onError.emit(i)),!1)})}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Wi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,t,qi,ji,ji);try{return i.runTask(a,e,n)}finally{i.cancelTask(a)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function ji(){}const qi={};function Hi(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Gi(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function $i(t){t._nesting--,Hi(t)}class Ki{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new di,this.onMicrotaskEmpty=new di,this.onStable=new di,this.onError=new di}run(t){return t()}runGuarded(t){return t()}runOutsideAngular(t){return t()}runTask(t){return t()}}class Xi{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wi.assertNotInAngularZone(),Ui(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ui(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}class Yi{constructor(){this._applications=new Map,Ji.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return Ji.findTestabilityInTree(this,t,e)}}class Qi{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let Zi,Ji=new Qi;const ta=new St("AllowMultipleToken");class ea{constructor(t,e){this.name=t,this.token=e}}function na(t,e,n=[]){const r=`Platform: ${e}`,i=new St(r);return(e=[])=>{let a=ra();if(!a||a.injector.get(ta,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0});!function(t){if(Zi&&!Zi.destroyed&&!Zi.injector.get(ta,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Zi=t.get(ia);const e=t.get(xi,null);e&&e.forEach(t=>t())}(Oe.create({providers:t,name:r}))}return function(t){const e=ra();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function ra(){return Zi&&!Zi.destroyed?Zi:null}class ia{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t){let e;return e="noop"===t?new Ki:("zone.js"===t?void 0:t)||new Wi({enableLongStackTrace:Kt()}),e}(e?e.ngZone:void 0),r=[{provide:Wi,useValue:n}];return n.run(()=>{const e=Oe.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),a=i.injector.get(Ht,null);if(!a)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.onDestroy(()=>sa(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{a.handleError(t)}})),function(t,e,n){try{const r=n();return We(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(bC){throw e.runOutsideAngular(()=>t.handleError(bC)),bC}}(a,n,()=>{const t=i.injector.get(yi);return t.runInitializers(),t.donePromise.then(()=>(this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=aa({},e);return function(t,e,n){return t.get(Ii).createCompiler([e]).compileModuleAsync(n)}(this.injector,n,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(oa);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${gt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. `+"Please define one of these.");t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}function aa(t,e){return Array.isArray(e)?e.reduce(aa,t):Object.assign({},t,e)}let oa=(()=>{class t{constructor(t,e,n,r,i,a){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Kt(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new x(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),s=new x(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Wi.assertNotInAngularZone(),Ui(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Wi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=Z(o,s.pipe(t=>{return J()((e=at,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,rt);return r.source=t,r.subjectFactory=n,r})(t));var e}))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof He?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=function(t){return t instanceof Qe}(n)?null:this._injector.get(Ft),i=n.create(Oe.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const a=i.injector.get(Xi,null);return a&&i.injector.get(Yi).registerApplication(i.location.nativeElement,a),this._loadComponent(i),Kt()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");const e=t._tickScope();try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(bC){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(bC))}finally{this._runningTick=!1,Bi(e)}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;sa(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(_i,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),sa(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t._tickScope=Li("ApplicationRef#tick()"),t})();function sa(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class la{}class ua{}const ca={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};class ha{constructor(t,e){this._compiler=t,this._config=e||ca}load(t){return this._compiler instanceof Ti?this.loadFactory(t):this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>pa(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>pa(t,e,r))}}function pa(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}class da{constructor(t,e){this.name=t,this.callback=e}}class fa{constructor(t,e,n){this.listeners=[],this.parent=null,this._debugContext=n,this.nativeNode=t,e&&e instanceof ma&&e.addChild(this)}get injector(){return this._debugContext.injector}get componentInstance(){return this._debugContext.component}get context(){return this._debugContext.context}get references(){return this._debugContext.references}get providerTokens(){return this._debugContext.providerTokens}}class ma extends fa{constructor(t,e,n){super(t,e,n),this.properties={},this.attributes={},this.classes={},this.styles={},this.childNodes=[],this.nativeElement=t}addChild(t){t&&(this.childNodes.push(t),t.parent=this)}removeChild(t){const e=this.childNodes.indexOf(t);-1!==e&&(t.parent=null,this.childNodes.splice(e,1))}insertChildrenAfter(t,e){const n=this.childNodes.indexOf(t);-1!==n&&(this.childNodes.splice(n+1,0,...e),e.forEach(e=>{e.parent&&e.parent.removeChild(e),t.parent=this}))}insertBefore(t,e){const n=this.childNodes.indexOf(t);-1===n?this.addChild(e):(e.parent&&e.parent.removeChild(e),e.parent=this,this.childNodes.splice(n,0,e))}query(t){return this.queryAll(t)[0]||null}queryAll(t){const e=[];return function t(e,n,r){e.childNodes.forEach(e=>{e instanceof ma&&(n(e)&&r.push(e),t(e,n,r))})}(this,t,e),e}queryAllNodes(t){const e=[];return function t(e,n,r){e instanceof ma&&e.childNodes.forEach(e=>{n(e)&&r.push(e),e instanceof ma&&t(e,n,r)})}(this,t,e),e}get children(){return this.childNodes.filter(t=>t instanceof ma)}triggerEventHandler(t,e){this.listeners.forEach(n=>{n.name==t&&n.callback(e)})}}const ga=new Map,ya=function(t){return ga.get(t)||null};function va(t){ga.set(t.nativeNode,t)}const ba=na(null,"core",[{provide:Ci,useValue:"unknown"},{provide:ia,deps:[Oe]},{provide:Yi,deps:[]},{provide:ki,deps:[]}]);function wa(){return Cn}function xa(){return _n}function Ca(t){return t||"en-US"}function _a(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}class ka{constructor(t){}}function Sa(t,e,n,r,i,a){t|=1;const{matchedQueries:o,references:s,matchedQueryIds:l}=er(e);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:t,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:o,matchedQueryIds:l,references:s,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:a?ar(a):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||Bn},provider:null,text:null,query:null,ngContent:null}}function Oa(t,e,n,r,i,a,o=[],s,l,u,c,h){u||(u=Bn);const{matchedQueries:p,references:d,matchedQueryIds:f}=er(n);let m=null,g=null;a&&([m,g]=pr(a)),s=s||[];const y=new Array(s.length);for(let w=0;w<s.length;w++){const[t,e,n]=s[w],[r,i]=pr(e);let a=void 0,o=void 0;switch(15&t){case 4:o=n;break;case 1:case 8:a=n}y[w]={flags:t,ns:r,name:i,nonMinifiedName:i,securityContext:a,suffix:o}}l=l||[];const v=new Array(l.length);for(let w=0;w<l.length;w++){const[t,e]=l[w];v[w]={type:0,target:t,eventName:e,propName:null}}const b=(o=o||[]).map(([t,e])=>{const[n,r]=pr(t);return[n,r,e]});return h=function(t){if(t&&"$$undefined"===t.id){const e=null!=t.encapsulation&&t.encapsulation!==Vt.None||t.styles.length||Object.keys(t.data).length;t.id=e?`c${jn++}`:"$$empty"}return t&&"$$empty"===t.id&&(t=null),t||null}(h),c&&(e|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:p,matchedQueryIds:f,references:d,ngContentIndex:r,childCount:i,bindings:y,bindingFlags:dr(y),outputs:v,element:{ns:m,name:g,attrs:b,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:u||Bn},provider:null,text:null,query:null,ngContent:null}}function Ea(t,e,n){const r=n.element,i=t.root.selectorOrNode,a=t.renderer;let o;if(t.parent||!i){o=r.name?a.createElement(r.name,r.ns):a.createComment("");const i=rr(t,e,n);i&&a.appendChild(i,o)}else o=a.selectRootElement(i,!!r.componentRendererType&&r.componentRendererType.encapsulation===Vt.ShadowDom);if(r.attrs)for(let s=0;s<r.attrs.length;s++){const[t,e,n]=r.attrs[s];a.setAttribute(o,e,n,t)}return o}function Ma(t,e,n,r){for(let o=0;o<n.outputs.length;o++){const s=n.outputs[o],l=Na(t,n.nodeIndex,(a=s.eventName,(i=s.target)?`${i}:${a}`:a));let u=s.target,c=t;"component"===s.target&&(u=null,c=e);const h=c.renderer.listen(u||r,s.eventName,l);t.disposables[n.outputIndex+o]=h}var i,a}function Na(t,e,n){return r=>Xn(t,e,n,r)}function Pa(t,e,n,r){if(!Hn(t,e,n,r))return!1;const i=e.bindings[n],a=Rn(t,e.nodeIndex),o=a.renderElement,s=i.name;switch(15&i.flags){case 1:!function(t,e,n,r,i,a){const o=e.securityContext;let s=o?t.root.sanitizer.sanitize(o,a):a;s=null!=s?s.toString():null;const l=t.renderer;null!=a?l.setAttribute(n,i,s,r):l.removeAttribute(n,i,r)}(t,i,o,i.ns,s,r);break;case 2:!function(t,e,n,r){const i=t.renderer;r?i.addClass(e,n):i.removeClass(e,n)}(t,o,s,r);break;case 4:!function(t,e,n,r,i){let a=t.root.sanitizer.sanitize(ge.STYLE,i);if(null!=a){a=a.toString();const t=e.suffix;null!=t&&(a+=t)}else a=null;const o=t.renderer;null!=a?o.setStyle(n,r,a):o.removeStyle(n,r)}(t,i,o,s,r);break;case 8:!function(t,e,n,r,i){const a=e.securityContext;let o=a?t.root.sanitizer.sanitize(a,i):i;t.renderer.setProperty(n,r,o)}(33554432&e.flags&&32&i.flags?a.componentView:t,i,o,s,r)}return!0}function Ta(t){const e=t.def.nodeMatchedQueries;for(;t.parent&&tr(t);){let n=t.parentNodeDef;t=t.parent;const r=n.nodeIndex+n.childCount;for(let i=0;i<=r;i++){const r=t.def.nodes[i];67108864&r.flags&&536870912&r.flags&&(r.query.filterId&e)===r.query.filterId&&zn(t,i).setDirty(),!(1&r.flags&&i+r.childCount<n.nodeIndex)&&67108864&r.childFlags&&536870912&r.childFlags||(i+=r.childCount)}}if(134217728&t.def.nodeFlags)for(let n=0;n<t.def.nodes.length;n++){const e=t.def.nodes[n];134217728&e.flags&&536870912&e.flags&&zn(t,n).setDirty(),n+=e.childCount}}function Ia(t,e){const n=zn(t,e.nodeIndex);if(!n.dirty)return;let r,i=void 0;if(67108864&e.flags){const n=e.parent.parent;i=Aa(t,n.nodeIndex,n.nodeIndex+n.childCount,e.query,[]),r=Dn(t,e.parent.nodeIndex).instance}else 134217728&e.flags&&(i=Aa(t,0,t.def.nodes.length-1,e.query,[]),r=t.component);n.reset(i);const a=e.query.bindings;let o=!1;for(let s=0;s<a.length;s++){const t=a[s];let e;switch(t.bindingType){case 0:e=n.first;break;case 1:e=n,o=!0}r[t.propName]=e}o&&n.notifyOnChanges()}function Aa(t,e,n,r,i){for(let a=e;a<=n;a++){const e=t.def.nodes[a],n=e.matchedQueries[r.id];if(null!=n&&i.push(Ra(t,e,n)),1&e.flags&&e.element.template&&(e.element.template.nodeMatchedQueries&r.filterId)===r.filterId){const n=Rn(t,a);if((e.childMatchedQueries&r.filterId)===r.filterId&&(Aa(t,a+1,a+e.childCount,r,i),a+=e.childCount),16777216&e.flags){const t=n.viewContainer._embeddedViews;for(let e=0;e<t.length;e++){const a=t[e],o=Yn(a);o&&o===n&&Aa(a,0,a.def.nodes.length-1,r,i)}}const o=n.template._projectedViews;if(o)for(let t=0;t<o.length;t++){const e=o[t];Aa(e,0,e.def.nodes.length-1,r,i)}}(e.childMatchedQueries&r.filterId)!==r.filterId&&(a+=e.childCount)}return i}function Ra(t,e,n){if(null!=n)switch(n){case 1:return Rn(t,e.nodeIndex).renderElement;case 0:return new Je(Rn(t,e.nodeIndex).renderElement);case 2:return Rn(t,e.nodeIndex).template;case 3:return Rn(t,e.nodeIndex).viewContainer;case 4:return Dn(t,e.nodeIndex).instance}}function Da(t,e){return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:8,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:null,ngContent:{index:e}}}function Fa(t,e,n){const r=rr(t,e,n);r&&lr(t,n.ngContent.index,1,r,null,void 0)}function za(t,e,n){const r=new Array(n.length-1);for(let i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:e,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function La(t,e,n){let r;const i=t.renderer;r=i.createText(n.text.prefix);const a=rr(t,e,n);return a&&i.appendChild(a,r),{renderText:r}}function Ba(t,e){return(null!=t?t.toString():"")+e.suffix}function Va(t,e,n,r){let i=0,a=0,o=0,s=0,l=0,u=null,c=null,h=!1,p=!1,d=null;for(let f=0;f<e.length;f++){const t=e[f];if(t.nodeIndex=f,t.parent=u,t.bindingIndex=i,t.outputIndex=a,t.renderParent=c,o|=t.flags,l|=t.matchedQueryIds,t.element){const e=t.element;e.publicProviders=u?u.element.publicProviders:Object.create(null),e.allProviders=e.publicProviders,h=!1,p=!1,t.element.template&&(l|=t.element.template.nodeMatchedQueries)}if(Wa(u,t,e.length),i+=t.bindings.length,a+=t.outputs.length,!c&&3&t.flags&&(d=t),20224&t.flags){h||(h=!0,u.element.publicProviders=Object.create(u.element.publicProviders),u.element.allProviders=u.element.publicProviders);const e=0!=(32768&t.flags);0==(8192&t.flags)||e?u.element.publicProviders[Un(t.provider.token)]=t:(p||(p=!0,u.element.allProviders=Object.create(u.element.publicProviders)),u.element.allProviders[Un(t.provider.token)]=t),e&&(u.element.componentProvider=t)}if(u?(u.childFlags|=t.flags,u.directChildFlags|=t.flags,u.childMatchedQueries|=t.matchedQueryIds,t.element&&t.element.template&&(u.childMatchedQueries|=t.element.template.nodeMatchedQueries)):s|=t.flags,t.childCount>0)u=t,Ua(t)||(c=t);else for(;u&&f===u.nodeIndex+u.childCount;){const t=u.parent;t&&(t.childFlags|=u.childFlags,t.childMatchedQueries|=u.childMatchedQueries),u=t,c=u&&Ua(u)?u.renderParent:u}}return{factory:null,nodeFlags:o,rootNodeFlags:s,nodeMatchedQueries:l,flags:t,nodes:e,updateDirectives:n||Bn,updateRenderer:r||Bn,handleEvent:(t,n,r,i)=>e[n].element.handleEvent(t,r,i),bindingCount:i,outputCount:a,lastRenderRootNode:d}}function Ua(t){return 0!=(1&t.flags)&&null===t.element.name}function Wa(t,e,n){const r=e.element&&e.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error(`Illegal State: Last root node of a template can't have embedded views, at index ${e.nodeIndex}!`)}if(20224&e.flags&&0==(1&(t?t.flags:0)))throw new Error(`Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index ${e.nodeIndex}!`);if(e.query){if(67108864&e.flags&&(!t||0==(16384&t.flags)))throw new Error(`Illegal State: Content Query nodes need to be children of directives, at index ${e.nodeIndex}!`);if(134217728&e.flags&&t)throw new Error(`Illegal State: View Query nodes have to be top level nodes, at index ${e.nodeIndex}!`)}if(e.childCount){const r=t?t.nodeIndex+t.childCount:n-1;if(e.nodeIndex<=r&&e.nodeIndex+e.childCount>r)throw new Error(`Illegal State: childCount of node leads outside of parent, at index ${e.nodeIndex}!`)}}function ja(t,e,n,r){const i=Ga(t.root,t.renderer,t,e,n);return $a(i,t.component,r),Ka(i),i}function qa(t,e,n){const r=Ga(t,t.renderer,null,null,e);return $a(r,n,n),Ka(r),r}function Ha(t,e,n,r){const i=e.element.componentRendererType;let a;return a=i?t.root.rendererFactory.createRenderer(r,i):t.root.renderer,Ga(t.root,a,t,e.element.componentProvider,n)}function Ga(t,e,n,r,i){const a=new Array(i.nodes.length),o=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:a,state:13,root:t,renderer:e,oldValues:new Array(i.bindingCount),disposables:o,initIndex:-1}}function $a(t,e,n){t.component=e,t.context=n}function Ka(t){let e;Jn(t)&&(e=Rn(t.parent,t.parentNodeDef.parent.nodeIndex).renderElement);const n=t.def,r=t.nodes;for(let i=0;i<n.nodes.length;i++){const a=n.nodes[i];let o;switch(Ln.setCurrentNode(t,i),201347067&a.flags){case 1:const n=Ea(t,e,a);let s=void 0;if(33554432&a.flags){const e=ar(a.element.componentView);s=Ln.createComponentView(t,a,e,n)}Ma(t,s,a,n),o={renderElement:n,componentView:s,viewContainer:null,template:a.element.template?Ir(t,a):void 0},16777216&a.flags&&(o.viewContainer=Mr(t,a,o));break;case 2:o=La(t,e,a);break;case 512:case 1024:case 2048:case 256:o=r[i],o||4096&a.flags||(o={instance:Yr(t,a)});break;case 16:o={instance:Qr(t,a)};break;case 16384:o=r[i],o||(o={instance:Zr(t,a)}),32768&a.flags&&$a(Rn(t,a.parent.nodeIndex).componentView,o.instance,o.instance);break;case 32:case 64:case 128:o={value:void 0};break;case 67108864:case 134217728:o=new mi;break;case 8:Fa(t,e,a),o=void 0}r[i]=o}ro(t,no.CreateViewNodes),so(t,201326592,268435456,0)}function Xa(t){Za(t),Ln.updateDirectives(t,1),io(t,no.CheckNoChanges),Ln.updateRenderer(t,1),ro(t,no.CheckNoChanges),t.state&=-97}function Ya(t){1&t.state?(t.state&=-2,t.state|=2):t.state&=-3,Tn(t,0,256),Za(t),Ln.updateDirectives(t,0),io(t,no.CheckAndUpdate),so(t,67108864,536870912,0);let e=Tn(t,256,512);oi(t,2097152|(e?1048576:0)),Ln.updateRenderer(t,0),ro(t,no.CheckAndUpdate),so(t,134217728,536870912,0),e=Tn(t,512,768),oi(t,8388608|(e?4194304:0)),2&t.def.flags&&(t.state&=-9),t.state&=-97,Tn(t,768,1024)}function Qa(t,e,n,r,i,a,o,s,l,u,c,h,p){return 0===n?function(t,e,n,r,i,a,o,s,l,u,c,h){switch(201347067&e.flags){case 1:return function(t,e,n,r,i,a,o,s,l,u,c,h){const p=e.bindings.length;let d=!1;return p>0&&Pa(t,e,0,n)&&(d=!0),p>1&&Pa(t,e,1,r)&&(d=!0),p>2&&Pa(t,e,2,i)&&(d=!0),p>3&&Pa(t,e,3,a)&&(d=!0),p>4&&Pa(t,e,4,o)&&(d=!0),p>5&&Pa(t,e,5,s)&&(d=!0),p>6&&Pa(t,e,6,l)&&(d=!0),p>7&&Pa(t,e,7,u)&&(d=!0),p>8&&Pa(t,e,8,c)&&(d=!0),p>9&&Pa(t,e,9,h)&&(d=!0),d}(t,e,n,r,i,a,o,s,l,u,c,h);case 2:return function(t,e,n,r,i,a,o,s,l,u,c,h){let p=!1;const d=e.bindings,f=d.length;if(f>0&&Hn(t,e,0,n)&&(p=!0),f>1&&Hn(t,e,1,r)&&(p=!0),f>2&&Hn(t,e,2,i)&&(p=!0),f>3&&Hn(t,e,3,a)&&(p=!0),f>4&&Hn(t,e,4,o)&&(p=!0),f>5&&Hn(t,e,5,s)&&(p=!0),f>6&&Hn(t,e,6,l)&&(p=!0),f>7&&Hn(t,e,7,u)&&(p=!0),f>8&&Hn(t,e,8,c)&&(p=!0),f>9&&Hn(t,e,9,h)&&(p=!0),p){let p=e.text.prefix;f>0&&(p+=Ba(n,d[0])),f>1&&(p+=Ba(r,d[1])),f>2&&(p+=Ba(i,d[2])),f>3&&(p+=Ba(a,d[3])),f>4&&(p+=Ba(o,d[4])),f>5&&(p+=Ba(s,d[5])),f>6&&(p+=Ba(l,d[6])),f>7&&(p+=Ba(u,d[7])),f>8&&(p+=Ba(c,d[8])),f>9&&(p+=Ba(h,d[9]));const m=An(t,e.nodeIndex).renderText;t.renderer.setValue(m,p)}return p}(t,e,n,r,i,a,o,s,l,u,c,h);case 16384:return function(t,e,n,r,i,a,o,s,l,u,c,h){const p=Dn(t,e.nodeIndex),d=p.instance;let f=!1,m=void 0;const g=e.bindings.length;return g>0&&qn(t,e,0,n)&&(f=!0,m=ai(t,p,e,0,n,m)),g>1&&qn(t,e,1,r)&&(f=!0,m=ai(t,p,e,1,r,m)),g>2&&qn(t,e,2,i)&&(f=!0,m=ai(t,p,e,2,i,m)),g>3&&qn(t,e,3,a)&&(f=!0,m=ai(t,p,e,3,a,m)),g>4&&qn(t,e,4,o)&&(f=!0,m=ai(t,p,e,4,o,m)),g>5&&qn(t,e,5,s)&&(f=!0,m=ai(t,p,e,5,s,m)),g>6&&qn(t,e,6,l)&&(f=!0,m=ai(t,p,e,6,l,m)),g>7&&qn(t,e,7,u)&&(f=!0,m=ai(t,p,e,7,u,m)),g>8&&qn(t,e,8,c)&&(f=!0,m=ai(t,p,e,8,c,m)),g>9&&qn(t,e,9,h)&&(f=!0,m=ai(t,p,e,9,h,m)),m&&d.ngOnChanges(m),65536&e.flags&&In(t,256,e.nodeIndex)&&d.ngOnInit(),262144&e.flags&&d.ngDoCheck(),f}(t,e,n,r,i,a,o,s,l,u,c,h);case 32:case 64:case 128:return function(t,e,n,r,i,a,o,s,l,u,c,h){const p=e.bindings;let d=!1;const f=p.length;if(f>0&&Hn(t,e,0,n)&&(d=!0),f>1&&Hn(t,e,1,r)&&(d=!0),f>2&&Hn(t,e,2,i)&&(d=!0),f>3&&Hn(t,e,3,a)&&(d=!0),f>4&&Hn(t,e,4,o)&&(d=!0),f>5&&Hn(t,e,5,s)&&(d=!0),f>6&&Hn(t,e,6,l)&&(d=!0),f>7&&Hn(t,e,7,u)&&(d=!0),f>8&&Hn(t,e,8,c)&&(d=!0),f>9&&Hn(t,e,9,h)&&(d=!0),d){const d=Fn(t,e.nodeIndex);let m;switch(201347067&e.flags){case 32:m=new Array(p.length),f>0&&(m[0]=n),f>1&&(m[1]=r),f>2&&(m[2]=i),f>3&&(m[3]=a),f>4&&(m[4]=o),f>5&&(m[5]=s),f>6&&(m[6]=l),f>7&&(m[7]=u),f>8&&(m[8]=c),f>9&&(m[9]=h);break;case 64:m={},f>0&&(m[p[0].name]=n),f>1&&(m[p[1].name]=r),f>2&&(m[p[2].name]=i),f>3&&(m[p[3].name]=a),f>4&&(m[p[4].name]=o),f>5&&(m[p[5].name]=s),f>6&&(m[p[6].name]=l),f>7&&(m[p[7].name]=u),f>8&&(m[p[8].name]=c),f>9&&(m[p[9].name]=h);break;case 128:const t=n;switch(f){case 1:m=t.transform(n);break;case 2:m=t.transform(r);break;case 3:m=t.transform(r,i);break;case 4:m=t.transform(r,i,a);break;case 5:m=t.transform(r,i,a,o);break;case 6:m=t.transform(r,i,a,o,s);break;case 7:m=t.transform(r,i,a,o,s,l);break;case 8:m=t.transform(r,i,a,o,s,l,u);break;case 9:m=t.transform(r,i,a,o,s,l,u,c);break;case 10:m=t.transform(r,i,a,o,s,l,u,c,h)}}d.value=m}return d}(t,e,n,r,i,a,o,s,l,u,c,h);default:throw"unreachable"}}(t,e,r,i,a,o,s,l,u,c,h,p):function(t,e,n){switch(201347067&e.flags){case 1:return function(t,e,n){let r=!1;for(let i=0;i<n.length;i++)Pa(t,e,i,n[i])&&(r=!0);return r}(t,e,n);case 2:return function(t,e,n){const r=e.bindings;let i=!1;for(let a=0;a<n.length;a++)Hn(t,e,a,n[a])&&(i=!0);if(i){let i="";for(let t=0;t<n.length;t++)i+=Ba(n[t],r[t]);i=e.text.prefix+i;const a=An(t,e.nodeIndex).renderText;t.renderer.setValue(a,i)}return i}(t,e,n);case 16384:return function(t,e,n){const r=Dn(t,e.nodeIndex),i=r.instance;let a=!1,o=void 0;for(let s=0;s<n.length;s++)qn(t,e,s,n[s])&&(a=!0,o=ai(t,r,e,s,n[s],o));return o&&i.ngOnChanges(o),65536&e.flags&&In(t,256,e.nodeIndex)&&i.ngOnInit(),262144&e.flags&&i.ngDoCheck(),a}(t,e,n);case 32:case 64:case 128:return function(t,e,n){const r=e.bindings;let i=!1;for(let a=0;a<n.length;a++)Hn(t,e,a,n[a])&&(i=!0);if(i){const i=Fn(t,e.nodeIndex);let a;switch(201347067&e.flags){case 32:a=n;break;case 64:a={};for(let i=0;i<n.length;i++)a[r[i].name]=n[i];break;case 128:const t=n[0],e=n.slice(1);a=t.transform(...e)}i.value=a}return i}(t,e,n);default:throw"unreachable"}}(t,e,r)}function Za(t){const e=t.def;if(4&e.nodeFlags)for(let n=0;n<e.nodes.length;n++){const r=e.nodes[n];if(4&r.flags){const e=Rn(t,n).template._projectedViews;if(e)for(let n=0;n<e.length;n++){const r=e[n];r.state|=32,Kn(r,t)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function Ja(t,e,n,r,i,a,o,s,l,u,c,h,p){return 0===n?function(t,e,n,r,i,a,o,s,l,u,c,h){const p=e.bindings.length;p>0&&Gn(t,e,0,n),p>1&&Gn(t,e,1,r),p>2&&Gn(t,e,2,i),p>3&&Gn(t,e,3,a),p>4&&Gn(t,e,4,o),p>5&&Gn(t,e,5,s),p>6&&Gn(t,e,6,l),p>7&&Gn(t,e,7,u),p>8&&Gn(t,e,8,c),p>9&&Gn(t,e,9,h)}(t,e,r,i,a,o,s,l,u,c,h,p):function(t,e,n){for(let r=0;r<n.length;r++)Gn(t,e,r,n[r])}(t,e,r),!1}function to(t,e){if(zn(t,e.nodeIndex).dirty)throw Mn(Ln.createDebugContext(t,e.nodeIndex),`Query ${e.query.id} not dirty`,`Query ${e.query.id} dirty`,0!=(1&t.state))}function eo(t){if(!(128&t.state)){if(io(t,no.Destroy),ro(t,no.Destroy),oi(t,131072),t.disposables)for(let e=0;e<t.disposables.length;e++)t.disposables[e]();!function(t){if(!(16&t.state))return;const e=Yn(t);if(e){const n=e.template._projectedViews;n&&(Bt(n,n.indexOf(t)),Ln.dirtyParentQueries(t))}}(t),t.renderer.destroyNode&&function(t){const e=t.def.nodes.length;for(let n=0;n<e;n++){const e=t.def.nodes[n];1&e.flags?t.renderer.destroyNode(Rn(t,n).renderElement):2&e.flags?t.renderer.destroyNode(An(t,n).renderText):(67108864&e.flags||134217728&e.flags)&&zn(t,n).destroy()}}(t),Jn(t)&&t.renderer.destroy(),t.state|=128}}const no=function(){var t={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return t[t.CreateViewNodes]="CreateViewNodes",t[t.CheckNoChanges]="CheckNoChanges",t[t.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",t[t.CheckAndUpdate]="CheckAndUpdate",t[t.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",t[t.Destroy]="Destroy",t}();function ro(t,e){const n=t.def;if(33554432&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];33554432&i.flags?ao(Rn(t,r).componentView,e):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function io(t,e){const n=t.def;if(16777216&n.nodeFlags)for(let r=0;r<n.nodes.length;r++){const i=n.nodes[r];if(16777216&i.flags){const n=Rn(t,r).viewContainer._embeddedViews;for(let t=0;t<n.length;t++)ao(n[t],e)}else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function ao(t,e){const n=t.state;switch(e){case no.CheckNoChanges:0==(128&n)&&(12==(12&n)?Xa(t):64&n&&oo(t,no.CheckNoChangesProjectedViews));break;case no.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?Xa(t):64&n&&oo(t,e));break;case no.CheckAndUpdate:0==(128&n)&&(12==(12&n)?Ya(t):64&n&&oo(t,no.CheckAndUpdateProjectedViews));break;case no.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?Ya(t):64&n&&oo(t,e));break;case no.Destroy:eo(t);break;case no.CreateViewNodes:Ka(t)}}function oo(t,e){io(t,e),ro(t,e)}function so(t,e,n,r){if(!(t.def.nodeFlags&e&&t.def.nodeFlags&n))return;const i=t.def.nodes.length;for(let a=0;a<i;a++){const i=t.def.nodes[a];if(i.flags&e&&i.flags&n)switch(Ln.setCurrentNode(t,i.nodeIndex),r){case 0:Ia(t,i);break;case 1:to(t,i)}i.childFlags&e&&i.childFlags&n||(a+=i.childCount)}}let lo=!1;function uo(t,e,n,r,i,a){const o=i.injector.get(nn);return qa(ho(t,i,o,e,n),r,a)}function co(t,e,n,r,i,a){const o=i.injector.get(nn),s=ho(t,i,new qo(o),e,n),l=Co(r);return Wo(Mo.create,qa,null,[s,l,a])}function ho(t,e,n,r,i){const a=e.injector.get(ye),o=e.injector.get(Ht),s=n.createRenderer(null,null);return{ngModule:e,injector:t,projectableNodes:r,selectorOrNode:i,sanitizer:a,rendererFactory:n,renderer:s,errorHandler:o}}function po(t,e,n,r){const i=Co(n);return Wo(Mo.create,ja,null,[t,e,i,r])}function fo(t,e,n,r){return n=vo.get(e.element.componentProvider.provider.token)||Co(n),Wo(Mo.create,Ha,null,[t,e,n,r])}function mo(t,e,n,r){return Br(t,e,n,function(t){const{hasOverrides:e,hasDeprecatedOverrides:n}=function(t){let e=!1,n=!1;return 0===go.size?{hasOverrides:e,hasDeprecatedOverrides:n}:(t.providers.forEach(t=>{const r=go.get(t.token);3840&t.flags&&r&&(e=!0,n=n||r.deprecatedBehavior)}),t.modules.forEach(t=>{yo.forEach((r,i)=>{ft(i).providedIn===t&&(e=!0,n=n||r.deprecatedBehavior)})}),{hasOverrides:e,hasDeprecatedOverrides:n})}(t);return e?(function(t){for(let e=0;e<t.providers.length;e++){const r=t.providers[e];n&&(r.flags|=4096);const i=go.get(r.token);i&&(r.flags=-3841&r.flags|i.flags,r.deps=nr(i.deps),r.value=i.value)}if(yo.size>0){let e=new Set(t.modules);yo.forEach((r,i)=>{if(e.has(ft(i).providedIn)){let e={token:i,flags:r.flags|(n?4096:0),deps:nr(r.deps),value:r.value,index:t.providers.length};t.providers.push(e),t.providersByKey[Un(i)]=e}})}}(t=t.factory(()=>Bn)),t):t}(r))}const go=new Map,yo=new Map,vo=new Map;function bo(t){let e;go.set(t.token,t),"function"==typeof t.token&&(e=ft(t.token))&&"function"==typeof e.providedIn&&yo.set(t.token,t)}function wo(t,e){const n=ar(e.viewDefFactory),r=ar(n.nodes[0].element.componentView);vo.set(t,r)}function xo(){go.clear(),yo.clear(),vo.clear()}function Co(t){if(0===go.size)return t;const e=function(t){const e=[];let n=null;for(let r=0;r<t.nodes.length;r++){const i=t.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&go.has(i.provider.token)&&(e.push(n.nodeIndex),n=null)}return e}(t);if(0===e.length)return t;t=t.factory(()=>Bn);for(let r=0;r<e.length;r++)n(t,e[r]);return t;function n(t,e){for(let n=e+1;n<t.nodes.length;n++){const e=t.nodes[n];if(1&e.flags)return;if(3840&e.flags){const t=e.provider,n=go.get(t.token);n&&(e.flags=-3841&e.flags|n.flags,t.deps=nr(n.deps),t.value=n.value)}}}}function _o(t,e,n,r,i,a,o,s,l,u,c,h,p){const d=t.def.nodes[e];return Qa(t,d,n,r,i,a,o,s,l,u,c,h,p),224&d.flags?Fn(t,e).value:void 0}function ko(t,e,n,r,i,a,o,s,l,u,c,h,p){const d=t.def.nodes[e];return Ja(t,d,n,r,i,a,o,s,l,u,c,h,p),224&d.flags?Fn(t,e).value:void 0}function So(t){return Wo(Mo.detectChanges,Ya,null,[t])}function Oo(t){return Wo(Mo.checkNoChanges,Xa,null,[t])}function Eo(t){return Wo(Mo.destroy,eo,null,[t])}const Mo=function(){var t={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return t[t.create]="create",t[t.detectChanges]="detectChanges",t[t.checkNoChanges]="checkNoChanges",t[t.destroy]="destroy",t[t.handleEvent]="handleEvent",t}();let No,Po,To;function Io(t,e){Po=t,To=e}function Ao(t,e,n,r){return Io(t,e),Wo(Mo.handleEvent,t.def.handleEvent,null,[t,e,n,r])}function Ro(t,e){if(128&t.state)throw Pn(Mo[No]);return Io(t,Lo(t,0)),t.def.updateDirectives((function(t,n,r,...i){const a=t.def.nodes[n];return 0===e?Fo(t,a,r,i):zo(t,a,r,i),16384&a.flags&&Io(t,Lo(t,n)),224&a.flags?Fn(t,a.nodeIndex).value:void 0}),t)}function Do(t,e){if(128&t.state)throw Pn(Mo[No]);return Io(t,Bo(t,0)),t.def.updateRenderer((function(t,n,r,...i){const a=t.def.nodes[n];return 0===e?Fo(t,a,r,i):zo(t,a,r,i),3&a.flags&&Io(t,Bo(t,n)),224&a.flags?Fn(t,a.nodeIndex).value:void 0}),t)}function Fo(t,e,n,r){if(Qa(t,e,n,...r)){const o=1===n?r[0]:r;if(16384&e.flags){const n={};for(let t=0;t<e.bindings.length;t++){const r=e.bindings[t],s=o[t];8&r.flags&&(n[(i=r.nonMinifiedName,a=void 0,a=i.replace(/[$@]/g,"_"),`ng-reflect-${i=a.replace(we,(...t)=>"-"+t[1].toLowerCase())}`)]=xe(s))}const r=e.parent,s=Rn(t,r.nodeIndex).renderElement;if(r.element.name)for(let e in n){const r=n[e];null!=r?t.renderer.setAttribute(s,e,r):t.renderer.removeAttribute(s,e)}else t.renderer.setValue(s,`bindings=${JSON.stringify(n,null,2)}`)}}var i,a}function zo(t,e,n,r){Ja(t,e,n,...r)}function Lo(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(16384&e.flags&&e.bindings&&e.bindings.length)return n}return null}function Bo(t,e){for(let n=e;n<t.def.nodes.length;n++){const e=t.def.nodes[n];if(3&e.flags&&e.bindings&&e.bindings.length)return n}return null}class Vo{constructor(t,e){this.view=t,this.nodeIndex=e,null==e&&(this.nodeIndex=e=0),this.nodeDef=t.def.nodes[e];let n=this.nodeDef,r=t;for(;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=Qn(r),r=r.parent;this.elDef=n,this.elView=r}get elOrCompView(){return Rn(this.elView,this.elDef.nodeIndex).componentView||this.view}get injector(){return Rr(this.elView,this.elDef)}get component(){return this.elOrCompView.component}get context(){return this.elOrCompView.context}get providerTokens(){const t=[];if(this.elDef)for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&t.push(n.provider.token),e+=n.childCount}return t}get references(){const t={};if(this.elDef){Uo(this.elView,this.elDef,t);for(let e=this.elDef.nodeIndex+1;e<=this.elDef.nodeIndex+this.elDef.childCount;e++){const n=this.elView.def.nodes[e];20224&n.flags&&Uo(this.elView,n,t),e+=n.childCount}}return t}get componentRenderElement(){const t=function(t){for(;t&&!Jn(t);)t=t.parent;return t.parent?Rn(t.parent,Qn(t).nodeIndex):null}(this.elOrCompView);return t?t.renderElement:void 0}get renderNode(){return 2&this.nodeDef.flags?Zn(this.view,this.nodeDef):Zn(this.elView,this.elDef)}logError(t,...e){let n,r;2&this.nodeDef.flags?(n=this.view.def,r=this.nodeDef.nodeIndex):(n=this.elView.def,r=this.elDef.nodeIndex);const i=function(t,e){let n=-1;for(let r=0;r<=e;r++)3&t.nodes[r].flags&&n++;return n}(n,r);let a=-1;n.factory(()=>(a++,a===i?t.error.bind(t,...e):Bn)),a<i&&(t.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),t.error(...e))}}function Uo(t,e,n){for(let r in e.references)n[r]=Ra(t,e,e.references[r])}function Wo(t,e,n,r){const i=No,a=Po,o=To;try{No=t;const s=e.apply(n,r);return Po=a,To=o,No=i,s}catch(bC){if(Wt(bC)||!Po)throw bC;throw function(t,e){return t instanceof Error||(t=new Error(t.toString())),Nn(t,e),t}(bC,jo())}}function jo(){return Po?new Vo(Po,To):null}class qo{constructor(t){this.delegate=t}createRenderer(t,e){return new Ho(this.delegate.createRenderer(t,e))}begin(){this.delegate.begin&&this.delegate.begin()}end(){this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)}}class Ho{constructor(t){this.delegate=t,this.debugContextFactory=jo,this.data=this.delegate.data}createDebugContext(t){return this.debugContextFactory(t)}destroyNode(t){const e=ya(t);!function(t){ga.delete(t.nativeNode)}(e),e instanceof fa&&(e.listeners.length=0),this.delegate.destroyNode&&this.delegate.destroyNode(t)}destroy(){this.delegate.destroy()}createElement(t,e){const n=this.delegate.createElement(t,e),r=this.createDebugContext(n);if(r){const e=new ma(n,null,r);e.name=t,va(e)}return n}createComment(t){const e=this.delegate.createComment(t),n=this.createDebugContext(e);return n&&va(new fa(e,null,n)),e}createText(t){const e=this.delegate.createText(t),n=this.createDebugContext(e);return n&&va(new fa(e,null,n)),e}appendChild(t,e){const n=ya(t),r=ya(e);n&&r&&n instanceof ma&&n.addChild(r),this.delegate.appendChild(t,e)}insertBefore(t,e,n){const r=ya(t),i=ya(e),a=ya(n);r&&i&&r instanceof ma&&r.insertBefore(a,i),this.delegate.insertBefore(t,e,n)}removeChild(t,e){const n=ya(t),r=ya(e);n&&r&&n instanceof ma&&n.removeChild(r),this.delegate.removeChild(t,e)}selectRootElement(t,e){const n=this.delegate.selectRootElement(t,e),r=jo();return r&&va(new ma(n,null,r)),n}setAttribute(t,e,n,r){const i=ya(t);i&&i instanceof ma&&(i.attributes[r?r+":"+e:e]=n),this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){const r=ya(t);r&&r instanceof ma&&(r.attributes[n?n+":"+e:e]=null),this.delegate.removeAttribute(t,e,n)}addClass(t,e){const n=ya(t);n&&n instanceof ma&&(n.classes[e]=!0),this.delegate.addClass(t,e)}removeClass(t,e){const n=ya(t);n&&n instanceof ma&&(n.classes[e]=!1),this.delegate.removeClass(t,e)}setStyle(t,e,n,r){const i=ya(t);i&&i instanceof ma&&(i.styles[e]=n),this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){const r=ya(t);r&&r instanceof ma&&(r.styles[e]=null),this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){const r=ya(t);r&&r instanceof ma&&(r.properties[e]=n),this.delegate.setProperty(t,e,n)}listen(t,e,n){if("string"!=typeof t){const r=ya(t);r&&r.listeners.push(new da(e,n))}return this.delegate.listen(t,e,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setValue(t,e){return this.delegate.setValue(t,e)}}function Go(t,e,n){return new $o(t,e,n)}class $o extends zt{constructor(t,e,n){super(),this.moduleType=t,this._bootstrapComponents=e,this._ngModuleDefFactory=n}create(t){!function(){if(lo)return;lo=!0;const t=Kt()?{setCurrentNode:Io,createRootView:co,createEmbeddedView:po,createComponentView:fo,createNgModuleRef:mo,overrideProvider:bo,overrideComponentView:wo,clearOverrides:xo,checkAndUpdateView:So,checkNoChangesView:Oo,destroyView:Eo,createDebugContext:(t,e)=>new Vo(t,e),handleEvent:Ao,updateDirectives:Ro,updateRenderer:Do}:{setCurrentNode:()=>{},createRootView:uo,createEmbeddedView:ja,createComponentView:Ha,createNgModuleRef:Br,overrideProvider:Bn,overrideComponentView:Bn,clearOverrides:Bn,checkAndUpdateView:Ya,checkNoChangesView:Xa,destroyView:eo,createDebugContext:(t,e)=>new Vo(t,e),handleEvent:(t,e,n,r)=>t.def.handleEvent(t,e,n,r),updateDirectives:(t,e)=>t.def.updateDirectives(0===e?_o:ko,t),updateRenderer:(t,e)=>t.def.updateRenderer(0===e?_o:ko,t)};Ln.setCurrentNode=t.setCurrentNode,Ln.createRootView=t.createRootView,Ln.createEmbeddedView=t.createEmbeddedView,Ln.createComponentView=t.createComponentView,Ln.createNgModuleRef=t.createNgModuleRef,Ln.overrideProvider=t.overrideProvider,Ln.overrideComponentView=t.overrideComponentView,Ln.clearOverrides=t.clearOverrides,Ln.checkAndUpdateView=t.checkAndUpdateView,Ln.checkNoChangesView=t.checkNoChangesView,Ln.destroyView=t.destroyView,Ln.resolveDep=ri,Ln.createDebugContext=t.createDebugContext,Ln.handleEvent=t.handleEvent,Ln.updateDirectives=t.updateDirectives,Ln.updateRenderer=t.updateRenderer,Ln.dirtyParentQueries=Ta}();const e=function(t){const e=Array.from(t.providers),n=Array.from(t.modules),r={};for(const i in t.providersByKey)r[i]=t.providersByKey[i];return{factory:t.factory,isRoot:t.isRoot,providers:e,modules:n,providersByKey:r}}(ar(this._ngModuleDefFactory));return Ln.createNgModuleRef(this.moduleType,t||Oe.NULL,this._bootstrapComponents,e)}}class Ko{}var Xo=function(t,e){return(Xo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Yo(t,e){function n(){this.constructor=t}Xo(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Qo(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}l((r=r.apply(t,e||[])).next())}))}function Zo(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var Jo=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n=(e={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return ts(e,n[0],n[1]),n.join("=")})),e);"tfjsflags"in n&&n.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])}))}},t}();function ts(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function es(){return ns}var ns=null,rs=new Map,is=new Map;function as(t,e){var n=cs(t,e);return rs.get(n)}function os(t){return is.get(t)}function ss(t){for(var e=rs.entries(),n=[];;){var r=e.next(),i=r.value;if(r.done)break;var a=i[1];i[0].split("_")[0]===t&&n.push(a)}return n}function ls(t){var e=t.kernelName,n=t.backendName,r=cs(e,n);if(rs.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");rs.set(r,t)}function us(t){var e=t.kernelName;is.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),is.set(e,t)}function cs(t,e){return e+"_"+t}function hs(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function ps(t,e,n){return Math.max(t,Math.min(e,n))}function ds(t){return t%2==0?t:t+1}function fs(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function ms(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function gs(t,e,n){void 0===n&&(n=""),ms(ws(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function ys(t){ms(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function vs(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||Rs(t)&&!n)for(var r=0;r<t.length;++r)vs(t[r],e,n);else e.push(t);return e}function bs(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function ws(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function xs(t){return t%1==0}function Cs(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function _s(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function ks(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Ss(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var a=0,o=function(){if(t())r();else{a++;var s=e(a);null!=n&&a>=n?i():setTimeout(o,s)}};o()}))}function Os(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var a=t.slice();return a[r]=e/n,a}function Es(t,e){var n=e.length;return ms((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),ms(t.every((function(t){return xs(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function Ms(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:Es(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=a){if(a[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==a[o]||a[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),a[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function Ns(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function Ps(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function Ts(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function Is(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function As(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function Rs(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function Ds(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function Fs(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function zs(t){return"string"==typeof t||t instanceof String}function Ls(t){return"boolean"==typeof t}function Bs(t){return"number"==typeof t}function Vs(t){return Array.isArray(t)?Vs(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":Bs(t)?"float32":zs(t)?"string":Ls(t)?"bool":"float32"}function Us(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Ws(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function js(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function qs(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=vs(t)),n&&Ts(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function Hs(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var a=n[0],o=0;o<a;o++)i[o]=r[e+o];else{a=n[0];var s=n.slice(1),l=s.reduce((function(t,e){return t*e}));for(o=0;o<a;o++)i[o]=t(e+o*l,s,r)}return i}(0,t,e)}function Gs(t,e){for(var n=$s(t,e),r=0;r<n.length;r++)n[r]=1;return n}function $s(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Ks(){return es().platform.now()}function Xs(t){t.forEach((function(e){ms(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function Ys(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",es().platform.encode(t,e)}function Qs(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",es().platform.decode(t,e)}function Zs(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function Js(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}var tl=Object.freeze({shuffle:hs,clamp:ps,nearestLargerEven:ds,sum:fs,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:ms,assertShapesMatch:gs,assertNonNull:ys,flatten:vs,sizeFromShape:bs,isScalarShape:function(t){return 0===t.length},arraysEqual:ws,isInt:xs,tanh:Cs,sizeToSquarishShape:_s,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return hs(e),e},rightPad:ks,repeatedTry:Ss,inferFromImplicitShape:Os,parseAxisParam:Es,squeezeShape:Ms,getTypedArrayFromDType:Ns,getArrayFromDType:Ps,checkConversionForErrors:Ts,isValidDtype:Is,hasEncodingLoss:As,isTypedArray:Rs,bytesPerElement:Ds,bytesFromStringArray:Fs,isString:zs,isBoolean:Ls,isNumber:Bs,inferDtype:Vs,isFunction:Us,nearestDivisor:Ws,computeStrides:js,toTypedArray:qs,toNestedArray:Hs,makeOnesTypedArray:Gs,makeZerosTypedArray:$s,now:Ks,assertNonNegativeIntegerDimensions:Xs,fetch:function(t,e){return es().platform.fetch(t,e)},encodeString:Ys,decodeString:Qs,locToIndex:Zs,indexToLoc:Js}),el=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new nl)}return t.prototype.profileKernel=function(t,e,n){var r,i=this,a=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),a.then((function(a){var o="";null!=a.getExtraProfileInfo&&(o=a.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,a.kernelMs,e,o)}))}))})),r},t}(),nl=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,a){var o="number"==typeof r?ks(r+"ms",9):r.error,s=ks(t,25),l=e.rank,u=e.size,c=ks(e.shape.toString(),14),h="";for(var p in i){var d=i[p].shape||e.shape,f=d.length;h+=p+": "+f+"D "+(f>0?d:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+l+"D "+c+"\t%c"+u+"\t%c"+h+"\t%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function rl(t,e,n){return ks(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":zs(t)?"'"+t+"'":"bool"===n?il(t):parseFloat(t.toFixed(7)).toString(),e)}function il(t){return 0===t?"false":"true"}function al(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var ol=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=bs(t),null!=n){var i=n.length;ms(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Ps(e,this.size),this.strides=js(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),ms(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var a=i[r];if(a<0||a>=this.shape[n]){var o="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=t[t.length-1],l=0;l<t.length-1;++l)s+=this.strides[l]*t[l];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return sl().makeTensor(this.values,this.shape,this.dtype)},t}(),sl=null,ll=null,ul=null,cl=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=bs(t),this.strides=js(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),ms(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),ll.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return Qo(this,void 0,void 0,(function(){var t;return Zo(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,ll.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return ll.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return Qo(this,void 0,void 0,(function(){var t;return Zo(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Hs(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return Hs(this.shape,this.dataSync())},t.prototype.data=function(){return Qo(this,void 0,void 0,(function(){var t,e;return Zo(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=sl().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return Qs(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=sl().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return Qs(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return Qo(this,void 0,void 0,(function(){var t;return Zo(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,sl().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(sl().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),ll.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),ll.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),ll.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),ll.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),ll.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),ll.clone(this)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=js(e),a=function(t,e,n,r){var i=bs(e),a=r[r.length-1],o=new Array(a).fill(0),s=e.length,l="complex64"===n?al(t):t;if(s>1)for(var u=0;u<i/a;u++)for(var c=u*a,h=0;h<a;h++)o[h]=Math.max(o[h],rl(l[c+h],0,n).length);return o}(t,e,n,i),o=e.length,s=function t(e,n,r,i,a,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,l=n[0],u=n.length;if(0===u)return"complex64"===r?[rl(al(e)[0],0,r)]:"bool"===r?[il(e[0])]:[e[0].toString()];if(1===u){if(l>20){var c=Array.from(e.slice(0,3*s)),h=Array.from(e.slice((l-3)*s,l*s));return"complex64"===r&&(c=al(c),h=al(h)),["["+c.map((function(t,e){return rl(t,a[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return rl(t,a[l-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?al(e):Array.from(e)).map((function(t,e){return rl(t,a[e],r)})).join(", ")+"]"]}var p=n.slice(1),d=i.slice(1),f=i[0]*s,m=[];if(l>20){for(var g=0;g<3;g++){var y=(v=g*f)+f;m.push.apply(m,t(e.slice(v,y),p,r,d,a,!1))}for(m.push("..."),g=l-3;g<l;g++)y=(v=g*f)+f,m.push.apply(m,t(e.slice(v,y),p,r,d,a,g===l-1))}else for(g=0;g<l;g++){var v;y=(v=g*f)+f,m.push.apply(m,t(e.slice(v,y),p,r,d,a,g===l-1))}var b=2===u?",":"";for(m[0]="["+m[0]+b,g=1;g<m.length-1;g++)m[g]=" "+m[g]+b;var w=",\n";for(g=2;g<u;g++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(o?"":w),m}(t,e,n,i,a),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+o),l.push("  shape: ["+e+"]"),l.push("  values:")),l.push(s.map((function(t){return"    "+t})).join("\n")),l.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),ll.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),ll.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),ll.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),ll.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),ll.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),ll.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),ll.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),ll.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),ll.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),ll.unstack(this,t)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),ul("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ll.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),ll.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),ll.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),ll.cast(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),ll.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),ll.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),ll.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),ll.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),ll.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),ll.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),ll.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),ll.mulStrict(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),ll.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),ll.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),ll.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ll.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),ll.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ll.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),ll.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),ll.modStrict(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ll.squaredDifferenceStrict(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),ll.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ll.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),ll.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),ll.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),ll.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),ll.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),ll.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ll.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),ll.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ll.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ll.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ll.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ll.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),ll.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),ll.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),ll.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),ll.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),ll.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),ll.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),ll.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),ll.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),ll.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),ll.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),ll.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),ll.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),ll.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),ll.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),ll.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),ll.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),ll.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),ll.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),ll.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),ll.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ll.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),ll.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),ll.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),ll.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),ll.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),ll.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),ll.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),ll.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),ll.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),ll.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),ll.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),ll.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),ll.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),ll.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),ll.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),ll.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),ll.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),ll.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),ll.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),ll.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),ll.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),ll.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),ll.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),ll.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),ll.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),ll.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),ll.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),ll.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),ll.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),ll.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),ll.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,a){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),ll.conv1d(this,t,e,n,r,i,a)},t.prototype.conv2d=function(t,e,n,r,i,a){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),ll.conv2d(this,t,e,n,r,i,a)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),ll.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,a){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),ll.depthwiseConv2d(this,t,e,n,r,i,a)},t.prototype.separableConv2d=function(t,e,n,r,i,a){return void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC"),this.throwIfDisposed(),ll.separableConv2d(this,t,e,n,r,i,a)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),ll.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),ll.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),ll.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),ll.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),sl().makeVariable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ll.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ll.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ll.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),ll.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,a,o,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),ll.stridedSlice(this,t,e,n,r,i,a,o,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ll.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),ll.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),ll.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),ll.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),ll.spectral.irfft(this)},t}();Object.defineProperty(cl,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var hl,pl,dl,fl,ml,gl,yl=function(t){function e(e,n,r,i){var a=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return a.trainable=n,a.name=r,a}return Yo(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!ws(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");sl().disposeTensor(this),this.dataId=t.dataId,sl().incRef(this,null)},e.prototype.dispose=function(){sl().disposeVariable(this),this.isDisposedInternal=!0},e}(cl);Object.defineProperty(yl,Symbol.hasInstance,{value:function(t){return t instanceof cl&&null!=t.assign&&t.assign instanceof Function}}),(gl=hl||(hl={})).R0="R0",gl.R1="R1",gl.R2="R2",gl.R3="R3",gl.R4="R4",gl.R5="R5",gl.R6="R6",function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(pl||(pl={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(dl||(dl={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(fl||(fl={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(ml||(ml={}));var vl={float32:fl,int32:pl,bool:dl,complex64:ml};function bl(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return vl[t][e]}function wl(t){return bl(t,"int32")}function xl(t,e){if(t.dtype===e.dtype)return[t,e];var n=bl(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Cl(t,e){ms(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function _l(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof cl)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,a=e;for(var o in a){var s=a[o];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}var kl,Sl=Object.freeze({makeTypesMatch:xl,assertTypesMatch:Cl,isTensorInList:function(t,e){return e.some((function(e){return e.id===t.id}))},getTensorsInContainer:_l}),Ol=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),El=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ol}return t.prototype.ready=function(){return Qo(this,void 0,void 0,(function(){var t,e,n;return Zo(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r;return Zo(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new el(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;ss(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;ss(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,a=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype);return this.addTapeNode(this.state.activeScope.name,{x:t},[e],(function(t){return{x:function(){return t.toFloat()}}}),[],{}),e},t.prototype.runKernel=function(t,e,n,r,i){return this.runKernelFunc(null,e,null,t,n,r,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var a=r-e-i-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+t+"'")},t.prototype.runKernelFunc=function(t,e,n,r,i,a,o){var s,l=this,u=[],c=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,p=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var f,m=as(r,this.backendName);if(null!=m)h=function(){var t=l.backend.numDataIds();f=m.kernelFunc({inputs:e,attrs:i,backend:l.backend});var n=Array.isArray(f)?f:[f];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(r,t,n);var s=n.map((function(t){return l.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}));if(c){var h=l.getTensorsForGradient(r,e,s);if(null==h){null==o&&(o=[]);var p=s.filter((function(t,e){return o[e]}));h=(a||[]).slice().concat(p)}u=l.saveTensorsForBackwardMode(h)}return s};else{var g=function(t){c&&(u=t.map((function(t){return l.keep(l.clone(t))})))};h=function(){var e=l.backend.numDataIds();f=l.tidy((function(){return t(l.backend,g)}));var n=Array.isArray(f)?f:[f];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(r,e,n),n}}return this.scopedRun((function(){return l.state.kernelDepth++}),(function(){return l.state.kernelDepth--}),(function(){s=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(r,e,(function(){return h()})):h()})),c&&this.addTapeNode(r,e,s,n,u,i),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(f)?s:s[0]},t.prototype.saveTensorsForBackwardMode=function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))},t.prototype.getTensorsForGradient=function(t,e,n){var r=os(t);if(null!=r){var i=r.inputsToSave||[],a=r.outputsToSave||[],o=void 0;r.saveAllInputs?(ms(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(e).map((function(t){return e[t]}))):o=i.map((function(t){return e[t]}));var s=n.filter((function(t,e){return a[e]}));return o.concat(s)}return null},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;var i=t;"string"===(n=n||"float32")&&zs(t[0])&&(i=t.map((function(t){return Ys(t)})));var a=r.write(i,e,n),o=new cl(e,n,a,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(a),l=Fs(i);this.state.numBytes+=l-s.bytes,s.bytes=l}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var i=new cl(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,r),i},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var i=new yl(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*Ds(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof yl||this.track(t)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return Qo(this,void 0,void 0,(function(){var e,n;return Zo(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,i,a){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},l=os(t);null!=l&&(r=l.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=$s(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i,a)}),this.state.activeTape.push(s)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=_l(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||r.has(a.id)||a.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),ms(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var a=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));ms(a instanceof cl,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},i={},a=0;a<e.length;a++)r[e[a].id]=!0;for(a=0;a<t.length;a++){var o=(f=t[a]).inputs;for(var s in o){for(var l=o[s],u=!1,c=0;c<e.length;c++)if(r[l.id]){f.outputs.forEach((function(t){return r[t.id]=!0})),u=!0,i[f.id]=!0;break}if(u)break}}var h={};h[n.id]=!0;var p={};for(a=t.length-1;a>=0;a--)for(o=(f=t[a]).inputs,c=0;c<f.outputs.length;c++)if(h[f.outputs[c].id]){for(var s in o)h[o[s].id]=!0,p[f.id]=!0;break}var d=[];for(a=0;a<t.length;a++){var f;if(i[(f=t[a]).id]&&p[f.id]){var m={};for(var s in f.inputs){var g=f.inputs[s];r[g.id]&&(m[s]=g)}var y=Object.assign({},f);y.inputs=m,y.outputs=f.outputs,d.push(y)}}return d}(this.state.activeTape,e,a);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[a.id]=null==n?(r=Gs(bs(t=a.shape),"float32"),Ml.makeTensor(r,t,"float32")):n,function(t,e,n){for(var r=function(r){var i=e[r],a=[];if(i.outputs.forEach((function(e){var n=t[e.id];a.push(null!=n?n:null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.kernelName+".");var o=i.gradient(a),s=function(e){if(!(e in o))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var a=i.inputs[e];if(!ws(r.shape,a.shape))throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+a.shape+"'");if(null==t[a.id])t[a.id]=r;else{var s=t[a.id];t[a.id]=s.add(r),s.dispose()}};for(var l in i.inputs)s(l)},i=e.length-1;i>=0;i--)r(i)}(s,o,(function(t){return i.tidy(t)}));var l=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e=0,n=t.saved;e<n.length;e++)n[e].dispose()})),i.state.activeTape=null),{value:a,grads:l}}))},t.prototype.customGrad=function(t){var e=this;return ms(Us(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];ms(r.every((function(t){return t instanceof cl})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var a={};return r.forEach((function(t,e){a[e]=t})),e.runKernelFunc((function(e,i){return ms((n=t.apply(void 0,r.concat([i]))).value instanceof cl,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),ms(Us(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),a,(function(t,e){var i=n.gradFunc(t,e),a=Array.isArray(i)?i:[i];ms(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),ms(a.every((function(t){return t instanceof cl})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(t,e){o[e]=function(){return t}})),o}))}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.time=function(t){return Qo(this,void 0,void 0,(function(){var e,n;return Zo(this,(function(r){switch(r.label){case 0:return e=Ks(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=Ks()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ol,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),Ml=function(){var t=function(){if(null==kl){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}kl=t}return kl}();if(null==t._tfengine){var e=new Jo(t);t._tfengine=new El(e)}return function(t){ns=t}(t._tfengine.ENV),sl=function(){return t._tfengine},t._tfengine}();function Nl(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Pl=es();Pl.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Pl.registerFlag("IS_BROWSER",(function(){return Nl()})),Pl.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Pl.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Pl.registerFlag("PROD",(function(){return!1})),Pl.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Pl.getBool("DEBUG")})),Pl.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Pl.registerFlag("IS_TEST",(function(){return!1}));var Tl,Il,Al,Rl={},Dl={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Fl(t,e){Rl[t]=e}function zl(t){t in Rl||(Rl[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete Rl[t]}),!1),1===t?e.getContext("webgl",Dl)||e.getContext("experimental-webgl",Dl):e.getContext("webgl2",Dl)}(t));var e=Rl[t];return e.isContextLost()?(delete Rl[t],zl(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Rl[t])}function Ll(t,e){return[e,t]}function Bl(t){var e=bs(t);return _s(Math.ceil(e/4))}function Vl(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Ul(t,e){var n,r,i,a,o,s,l,u,c,h=t;return 2===es().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,i=h.RGBA16F,a=h.RGBA32F,o=h.RED,s=4,l=1,u=h.HALF_FLOAT,c=h.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,a=h.RGBA,o=t.RGBA,s=4,l=4,u=null!=e?e.HALF_FLOAT_OES:null,c=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:l,textureTypeHalfFloat:u,textureTypeFloat:c}}function Wl(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+ql(t,e))}(t),r}function jl(t){return!!(es().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function ql(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function Hl(t,e,n){return fu(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function Gl(t,e,n){var r=fu(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Wl(t,e,(function(){return t.shaderSource(r,n)})),Wl(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function $l(t,e,n){var r=fu(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Wl(t,e,(function(){return t.shaderSource(r,n)})),Wl(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=Yl.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),a=i.length.toString().length+2,o=i.map((function(t,e){return ks((e+1).toString(),a)+t})),s=0,l=0;l<o.length;l++)s=Math.max(o[l].length,s);var u=o.slice(0,r-1),c=o.slice(r-1,r),h=o.slice(r);console.log(u.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+ks(c[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(Tl||(Tl={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(Il||(Il={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Al||(Al={}));var Kl,Xl,Yl=/ERROR: [0-9]+:([0-9]+):/g;function Ql(t,e){return fu(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function Zl(t,e,n){if(Wl(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Jl(t,e,n){if(Wl(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function tu(t,e,n){var r=fu(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Wl(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),Wl(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function eu(t,e,n){var r=fu(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Wl(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),Wl(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function nu(t,e){return fu(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function ru(t,e){var n=es().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function iu(t,e){return fu(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function au(t,e,n,r,i,a,o,s){var l=t.getAttribLocation(n,r);return-1!==l&&(Wl(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),Wl(t,e,(function(){return t.vertexAttribPointer(l,a,t.FLOAT,!1,o,s)})),Wl(t,e,(function(){return t.enableVertexAttribArray(l)})),!0)}function ou(t,e,n,r){mu(t,r),Wl(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function su(t,e,n,r){return fu(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function lu(t,e,n){return t.getUniformLocation(e,n)}function uu(t,e,n,r,i,a){Wl(t,e,(function(){return ou(t,e,r,a)})),Wl(t,e,(function(){return t.uniform1i(i,a)}))}function cu(t,e,n,r){Wl(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Wl(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function hu(t,e,n){Wl(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Wl(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function pu(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+du(t,e))}function du(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function fu(t,e,n,r){var i=Wl(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function mu(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function gu(t,e){return void 0===e&&(e=2),bs(t.slice(0,t.length-e))}function yu(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function vu(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[gu(t)].concat(yu(t))),e}function bu(t,e){var n;void 0===e&&(e=!1);var r=es().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?ds(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=Ms(t);t=i.newShape}var a=bs(t);if(t.length<=1&&a<=r)return[1,a];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var o=gu(t),s=2,l=2;return t.length&&(s=(n=yu(t))[0],l=n[1]),_s(a=o*(s/2)*(l/2)).map((function(t){return 2*t}))}return _s(a)}function wu(t){return t%2==0}function xu(t,e){if(ws(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(wu(n)&&wu(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&wu(t[0])&&wu(e[0])}function Cu(t){if(null==Kl){var e=zl(t);Kl=e.getParameter(e.MAX_TEXTURE_SIZE)}return Kl}function _u(t){if(null==Xl){var e=zl(t);Xl=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Xl)}function ku(t){if(0===t)return 0;var e=zl(t);return Su(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:Su(e,"EXT_disjoint_timer_query")?1:0}function Su(t,e){return null!=t.getExtension(e)}function Ou(t){try{if(null!=zl(t))return!0}catch(t){return!1}return!1}function Eu(t){if(0===t)return!1;var e=zl(t);if(1===t){if(!Su(e,"OES_texture_float"))return!1}else if(!Su(e,"EXT_color_buffer_float"))return!1;return Nu(e)}function Mu(t){if(0===t)return!1;var e=zl(t);if(1!==t){if(Su(e,"EXT_color_buffer_float"))return Nu(e);if(Su(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=Ul(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}(e,n)}return!1}return!!Su(e,"OES_texture_float")&&!!Su(e,"WEBGL_color_buffer_float")&&Nu(e)}function Nu(t){var e=Ul(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function Pu(t){return 2===t&&null!=zl(t).fenceSync}var Tu=Object.freeze({callAndCheck:Wl,canBeRepresented:jl,getWebGLErrorMessage:ql,getExtensionOrThrow:Hl,createVertexShader:Gl,createFragmentShader:$l,createProgram:Ql,linkProgram:Zl,validateProgram:Jl,createStaticVertexBuffer:tu,createStaticIndexBuffer:eu,getNumChannels:function(){return 2===es().getNumber("WEBGL_VERSION")?1:4},createTexture:nu,validateTextureSize:ru,createFramebuffer:iu,bindVertexBufferToProgramAttribute:au,bindTextureUnit:ou,unbindTextureUnit:function(t,e,n){mu(t,n),Wl(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:su,getProgramUniformLocation:lu,bindTextureToProgramUniformSampler:uu,bindCanvasToFramebuffer:function(t,e){Wl(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Wl(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),Wl(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:cu,unbindColorTextureFromFramebuffer:hu,validateFramebuffer:pu,getFramebufferErrorMessage:du,getBatchDim:gu,getRowsCols:yu,getShapeAs3D:vu,getTextureShapeFromLogicalShape:bu,isReshapeFree:xu,getWebGLMaxTextureSize:Cu,resetMaxTextureSize:function(){Kl=null},resetMaxTexturesInShader:function(){Xl=null},getMaxTexturesInShader:_u,getWebGLDisjointQueryTimerVersion:ku,hasExtension:Su,isWebGLVersionEnabled:Ou,isCapableOfRenderingToFloatTexture:Eu,isDownloadFloatTextureEnabled:Mu,isWebGLFenceEnabled:Pu}),Iu=es();function Au(t){es().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Ru(){return Ml.memory()}function Du(t,e){return Ml.tidy(t,e)}function Fu(t){_l(t).forEach((function(t){return t.dispose()}))}function zu(t){return Ml.keep(t)}function Lu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];es().getBool("IS_TEST")||console.warn.apply(console,t)}function Bu(t,e){var n=t;if(Rs(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||Rs(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&es().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||Rs(e)){ms(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),ms(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),a=0;a<e.length;++a)t(e[a],i,r.concat(a))}else ms(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function Vu(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function Uu(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof cl)return Vu(r,t.dtype,e,n),t;var i=Vs(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Vu(r,i,e,n),null==t||!Rs(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var a=Bu(t,i);Rs(t)||Array.isArray(t)||(t=[t]);var o="string"!==i?qs(t,i,es().getBool("DEBUG")):vs(t,[],!0);return Ml.makeTensor(o,a,i)}function Wu(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return Uu(t,e+"["+r+"]",n)}),r)}function ju(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function qu(t,e,n){for(var r=t.length+e.length,i=[],a=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[a++]):i.push(e[o++]);return i}function Hu(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function Gu(t,e){return qu(t,e.map((function(t){return 1})),e)}function $u(t,e,n){ms(ju(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function Ku(t,e){if(ju(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function Xu(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function Yu(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function Qu(t,e){var n=t[0].length;t.forEach((function(t,e){ms(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),ms(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var a=0;a<n;a++)ms(a===e||t[a]===r[a],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function Zu(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function Ju(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ml.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ml.endScope(i),i}catch(t){throw Ml.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Iu.registerFlag("HAS_WEBGL",(function(){return Iu.getNumber("WEBGL_VERSION")>0})),Iu.registerFlag("WEBGL_VERSION",(function(){return Ou(2)?2:Ou(1)?1:0})),Iu.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Iu.get("WEBGL_VERSION")})),Iu.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Iu.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Iu.registerFlag("WEBGL_PACK",(function(){return Iu.getBool("HAS_WEBGL")})),Iu.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_PACK_CLIP",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Iu.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_PACK_REDUCE",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_CONV_IM2COL",(function(){return Iu.getBool("WEBGL_PACK")})),Iu.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Cu(Iu.getNumber("WEBGL_VERSION"))})),Iu.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return _u(Iu.getNumber("WEBGL_VERSION"))})),Iu.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=Iu.getNumber("WEBGL_VERSION");return 0===t?0:ku(t)})),Iu.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Iu.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),Iu.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return Eu(Iu.getNumber("WEBGL_VERSION"))})),Iu.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Iu.getBool("WEBGL_FORCE_F16_TEXTURES")&&Iu.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Iu.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Mu(Iu.getNumber("WEBGL_VERSION"))})),Iu.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Pu(Iu.getNumber("WEBGL_VERSION"))})),Iu.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Iu.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),ul=Au;var tc=Ju({complex_:function(t,e){var n=Uu(t,"real","complex"),r=Uu(e,"imag","complex");return gs(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Ml.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),ec=Ju({real_:function(t){var e=Uu(t,"input","real");return Ml.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),nc=Ju({imag_:function(t){var e=Uu(t,"input","imag");return Ml.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function rc(t,e,n){return ic(t,e,Bu(t,n),n)}function ic(t,e,n,r){if(null==r&&(r=Vs(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Rs(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Xs(e);var i=bs(e),a=bs(n);ms(i===a,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+a}));for(var o=0;o<n.length;++o){var s=o!==n.length-1||n[o]!==bs(e.slice(o));ms(n[o]===e[o]||!s,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return Rs(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?qs(t,r,es().getBool("DEBUG")):vs(t,[],!0),Ml.makeTensor(t,e,r)}function ac(t,e){if((Rs(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Rs(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ic(t,[],[],e)}function oc(t,e){ys(t);var n=Bu(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ic(t,null,n,e)}function sc(t,e,n){if(ys(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Bu(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ic(t,e,r,n)}function lc(t,e,n){if(ys(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Bu(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ic(t,e,r,n)}function uc(t,e,n){if(ys(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Bu(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ic(t,e,r,n)}function cc(t,e,n,r){return void 0===e&&(e=!0),Ml.makeVariable(t,e,n,r)}function hc(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=hc(t,"float32"),r=pc(t,"float32");return tc(n,r)}var i=Gs(bs(t),e);return Ml.makeTensor(i,t,e)}function pc(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=pc(t,"float32"),r=pc(t,"float32");return tc(n,r)}var i=$s(bs(t),e);return Ml.makeTensor(i,t,e)}function dc(t,e,n){return Ml.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function fc(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return Ml.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function mc(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return pc([0],r);var i=$s(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var a=1;a<i.length;a++)i[a]=i[a-1]+n;return oc(i,r)}var gc=Ju({onesLike_:function(t){var e=Uu(t,"x","onesLike");if("complex64"===e.dtype){var n=gc(ec(e)),r=yc(nc(e));return tc(n,r)}return Ml.runKernelFunc((function(t){return t.onesLike(e)}),{x:e},(function(t,e){return{x:function(){return yc(t)}}}),"OnesLike")}}),yc=Ju({zerosLike_:function(t){var e=Uu(t,"x","zerosLike");return Ml.runKernelFunc((function(t){return t.zerosLike(e)}),{x:e},(function(t,e){return{x:function(){return yc(t)}}}),"ZerosLike")}}),vc=Ju({concat_:function(t,e){void 0===e&&(e=0),ms(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Wu(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=Es(e,n[0].shape)[0];var r=Zu(n.map((function(t){return t.shape})),e);if(0===bs(r))return rc([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));return Qu(i,e),Ml.runKernelFunc((function(t){return t.concat(n,e)}),n,(function(t){var n=i.map((function(t){return t[e]}));return _c(t,n,e).map((function(t){return function(){return t}}))}),"Concat",{axis:e})}}),bc=Ju({concat1d_:function(t){return vc(t,0)}}),wc=Ju({concat2d_:function(t,e){return vc(t,e)}}),xc=Ju({concat3d_:function(t,e){return vc(t,e)}}),Cc=Ju({concat4d_:function(t,e){return vc(t,e)}}),_c=Ju({split_:function(t,e,n){void 0===n&&(n=0);var r,i=Uu(t,"x","split");return n=Es(n,i.shape)[0],"number"==typeof e?(ms(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(ms(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Ml.runKernelFunc((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return vc(t,n)}}}))}});function kc(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",Xs(t),new ol(t,e,n)}var Sc=Ju({batchToSpaceND_:function(t,e,n){var r=Uu(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return ms(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),ms(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),ms(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),Ml.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),Oc=Ju({cast_:function(t,e){var n=Uu(t,"x","cast");if(!Is(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return Ml.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),"Cast",{dtype:e})}}),Ec=Ju({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Uu(t,"x","cumsum"),a=Ku([e|=0],i.rank),o=i;null!=a&&(o=i.transpose(a));var s=Yu(1,i.rank)[0],l=Ml.runKernelFunc((function(t){return t.cumsum(o,s,n,r)}),{permutedX:o},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=a&&(l=l.transpose(a)),l}}),Mc=Ju({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=Uu(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return ms(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),ms(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),ms(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+o+" for depthToSpace with input shape "+r.shape})),Ml.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),Nc=Ju({expandDims_:function(t,e){void 0===e&&(e=0);var n=Uu(t,"x","expandDims",null);ms(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(ms(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),Pc(n,r)}}),Pc=Ju({reshape_:function(t,e){var n=Uu(t,"x","reshape",null);return e=Os(e,n.size),ms(n.size===bs(e),(function(){return"new shape and old shape must have the same number of elements."})),Ml.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),"Reshape",{shape:e})}}),Tc=Ju({spaceToBatchND_:function(t,e,n){var r=Uu(t,"x","spaceToBatchND");return ms(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),ms(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),ms(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),Ml.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),Ic=Ju({squeeze_:function(t,e){var n=Uu(t,"x","squeeze");return Pc(n,Ms(n.shape,e).newShape)}}),Ac=Ju({stack_:function(t,e){void 0===e&&(e=0);var n=Wu(t,"tensors","stack");if(ms(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;ms(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){gs(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){ms(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var a=n.map((function(t){return t.expandDims(e)}));return vc(a,e)}}),Rc=Ju({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=Uu(t,"x","unstack");return ms(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),Ml.runKernelFunc((function(t){return t.unstack(n,e)}),{x:n},(function(t){return{x:function(){return Ac(t,e)}}}),"Unpack",{axis:e})}}),Dc=function(t,e){return Qo(this,void 0,void 0,(function(){var n,r,i,a,o,s,l,u,c,h;return Zo(this,(function(p){switch(p.label){case 0:return n=Uu(t,"x","setdiff1d"),r=Uu(e,"y","setdiff1d"),ms(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),ms(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),ms(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=p.sent(),[4,r.data()];case 2:for(a=p.sent(),o=new Set(a),s=0,c=0;c<i.length;c++)o.has(i[c])||s++;for(l=new ol([s],n.dtype),u=new ol([s],"int32"),c=0,h=0;c<i.length;c++)o.has(i[c])||(l.values[h]=i[c],u.values[h]=c,h++);return[2,[l.toTensor(),u.toTensor()]]}}))}))};function Fc(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var a=e.length,o=0;o<a;++o)i=i.concat([t[o+1]/e[o],e[o]]);i=i.concat(t.slice(a+1))}return i}function zc(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var a=[],o=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?o.push(i):a.push(i);r.push.apply(r,a),r.push(0),r.push.apply(r,o)}return r}function Lc(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var a=1;a<t.length;++a)i.push(a<=e.length?r?e[a-1]*t[a]:t[a]/e[a-1]:t[a]);return i}function Bc(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Vc(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}var Uc="Div",Wc="SquaredDifference",jc="BroadcastTo",qc="Identity",Hc=Ju({add_:function(t,e){var n,r=Uu(t,"a","add"),i=Uu(e,"b","add");return n=xl(r,i),Ml.runKernelFunc((function(t,e){var n=t.add(r,i);return e([r,i]),n}),{a:r=n[0],b:i=n[1]},null,"Add")}});function Gc(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var a=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[a]||1)&&r.unshift(a)}return r}function $c(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],a=e.length-r-1;(null==i||1===i&&e[a]>1)&&n.unshift(a)}return n}function Kc(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var a=t[t.length-i-1];null==a&&(a=1);var o=e[e.length-i-1];if(null==o&&(o=1),1===a)n.unshift(o);else if(1===o)n.unshift(a);else{if(a!==o)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(a)}}return n}var Xc=Ju({abs_:function(t){var e=Uu(t,"x","abs");return"complex64"===e.dtype?Ml.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Ml.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),"Abs")}}),Yc=Ju({acos_:function(t){var e=Uu(t,"x","acos");return Ml.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(ac(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),Qc=Ju({acosh_:function(t){var e=Uu(t,"x","acosh");return Ml.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Zc=Ju({asin_:function(t){var e=Uu(t,"x","asin");return Ml.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(ac(1).sub(n.toFloat().square()).sqrt())}}}))}}),Jc=Ju({asinh_:function(t){var e=Uu(t,"x","asinh");return Ml.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(ac(1).add(n.toFloat().square()).sqrt())}}}))}}),th=Ju({atan_:function(t){var e=Uu(t,"x","atan");return Ml.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),eh=Ju({atanh_:function(t){var e=Uu(t,"x","atanh");return Ml.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(ac(1).sub(n.toFloat().square()))}}}))}}),nh=Ju({ceil_:function(t){var e=Uu(t,"x","ceil");return Ml.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),rh=Ju({clipByValue_:function(t,e,n){var r=Uu(t,"x","clipByValue");return ms(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),Ml.runKernelFunc((function(t,i){var a=t.clip(r,e,n);return i([r]),a}),{x:r},(function(t,r){var i=r[0];return{x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),yc(t))}}}),"ClipByValue",{min:e,max:n},[r])}}),ih=Ju({cos_:function(t){var e=Uu(t,"x","cos");return Ml.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().sin().neg().mul(t)}}}),"Cos",{},[e])}}),ah=Ju({cosh_:function(t){var e=Uu(t,"x","cosh");return Ml.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),oh=Ju({erf_:function(t){var e=Uu(t,"x","erf");return ms("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),Ml.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),sh=Ju({exp_:function(t){var e=Uu(t,"x","exp");return Ml.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{x:e},(function(t,e){return{x:function(){return t.mulStrict(e[0])}}}),"Exp",{},[],[!0])}}),lh=Ju({expm1_:function(t){var e=Uu(t,"x","expm1");return Ml.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),uh=Ju({floor_:function(t){var e=Uu(t,"x","floor");return Ml.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),ch=Ju({log_:function(t){var e=Uu(t,"x","log");return Ml.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.toFloat())}}}),"Log",{},[e])}}),hh=Ju({log1p_:function(t){var e=Uu(t,"x","log1p");return Ml.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),ph=Ju({logSigmoid_:function(t){var e=Uu(t,"x","logSigmoid");return Ml.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),dh=Ju({neg_:function(t){var e=Uu(t,"x","neg");return Ml.runKernelFunc((function(t){return t.neg(e)}),{x:e},(function(t){return{x:function(){return t.neg()}}}),"Neg",{},[e])}}),fh=Ju({reciprocal_:function(t){var e=Uu(t,"x","reciprocal");return Ml.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),mh=Ju({round_:function(t){var e=Uu(t,"x","round");return Ml.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),gh=Ju({rsqrt_:function(t){var e=Uu(t,"x","rsqrt");return Ml.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},[e])}}),yh=Ju({sigmoid_:function(t){var e=Uu(t,"x","sigmoid");return Ml.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.mul(ac(1).sub(n)))}}}),"Sigmoid")}}),vh=Ju({sign_:function(t){var e=Uu(t,"x","sign");return Ml.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),bh=Ju({isNaN_:function(t){var e=Uu(t,"x","isNaN");return Ml.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),wh=Ju({isInf_:function(t){var e=Uu(t,"x","isInf");return Ml.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),xh=Ju({isFinite_:function(t){var e=Uu(t,"x","isFinite");return Ml.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return yc(t)}}}))}}),Ch=Ju({sin_:function(t){var e=Uu(t,"x","sin");return Ml.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().cos().mul(t)}}}),"Sin",{},[e])}}),_h=Ju({sinh_:function(t){var e=Uu(t,"x","sinh");return Ml.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),kh=Ju({softplus_:function(t){var e=Uu(t,"x","softplus");return Ml.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),Sh=Ju({sqrt_:function(t){var e=Uu(t,"x","sqrt");return Ml.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),Oh=Ju({step_:function(t,e){void 0===e&&(e=0);var n=Uu(t,"x","step");return Ml.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return yc(t)}}}))}}),Eh=Ju({tan_:function(t){var e=Uu(t,"x","tan");return Ml.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),Mh=Ju({tanh_:function(t){var e=Uu(t,"x","tanh");return Ml.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return ac(1).sub(n.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}}),Nh=Ju({addStrict_:function(t,e){var n=Uu(t,"a","addStrict"),r=Uu(e,"b","addStrict");return gs(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Ph=Ju({atan2_:function(t,e){var n,r=Uu(t,"a","atan2"),i=Uu(e,"b","atan2");n=xl(r,i);var a=Kc((r=n[0]).shape,(i=n[1]).shape);return Ml.runKernelFunc((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=Hc(n.square(),r.square()),i=t.mul(r.div(e)),o=$c(n.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(n.shape)},$b:function(){var e=Hc(n.square(),r.square()),i=dh(t.mul(n.div(e))),o=$c(r.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(r.shape)}}}))}}),Th=Ju({divStrict_:function(t,e){var n=Uu(t,"a","div"),r=Uu(e,"b","div");return gs(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Ih=Ju({floorDiv_:function(t,e){var n,r=Uu(t,"a","floorDiv"),i=Uu(e,"b","floorDiv");n=xl(r,i);var a=Kc((r=n[0]).shape,(i=n[1]).shape);return Ml.runKernelFunc((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),i=$c(n.shape,a);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=$c(r.shape,a);i.length>0&&(e=e.sum(i).reshape(r.shape));var o=r.square();return e.div(o.toFloat()).neg()}}}),"FloorDiv")}}),Ah=Ju({maximum_:function(t,e){var n,r=Uu(t,"a","maximum"),i=Uu(e,"b","maximum");return n=xl(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),Kc(r.shape,i.shape),Ml.runKernelFunc((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.greaterEqual(r).toFloat())},b:function(){return t.mul(n.less(r).toFloat())}}}),"Maximum")}}),Rh=Ju({maximumStrict_:function(t,e){var n=Uu(t,"a","maximumStrict"),r=Uu(e,"b","maximumStrict");return gs(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Dh=Ju({minimum_:function(t,e){var n,r=Uu(t,"a","minimum"),i=Uu(e,"b","minimum");return n=xl(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),Kc(r.shape,i.shape),Ml.runKernelFunc((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.lessEqual(r).toFloat())},b:function(){return t.mul(n.greater(r).toFloat())}}}),"Minimum")}}),Fh=Ju({minimumStrict_:function(t,e){var n=Uu(t,"a","minimumStrict"),r=Uu(e,"b","minimumStrict");return gs(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),zh=Ju({mod_:function(t,e){var n,r=Uu(t,"a","mod"),i=Uu(e,"b","mod");n=xl(r,i);var a=Kc((r=n[0]).shape,(i=n[1]).shape);return Ml.runKernelFunc((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=$c(n.shape,a);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=$c(r.shape,a);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),Lh=Ju({modStrict_:function(t,e){var n=Uu(t,"a","modStrict"),r=Uu(e,"b","modStrict");return gs(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Bh=Ju({mul_:function(t,e){var n,r=Uu(t,"a","mul"),i=Uu(e,"b","mul");n=xl(r,i);var a=Kc((r=n[0]).shape,(i=n[1]).shape);return Ml.runKernelFunc((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.mul(r.toFloat()),i=$c(n.shape,a);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=$c(r.shape,a);return i.length>0?e.sum(i).reshape(r.shape):e}}}),"Mul")}}),Vh=Ju({mulStrict_:function(t,e){var n=Uu(t,"a","mul"),r=Uu(e,"b","mul");return gs(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Uh=Ju({pow_:function(t,e){var n,r=Uu(t,"base","pow"),i=Uu(e,"exp","pow");n=xl(r,i);var a=Kc((r=n[0]).shape,(i=n[1]).shape);return Ml.runKernelFunc((function(t,e){var n=t.pow(r,i);return e([r,i,n]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1],i=e[2];return{a:function(){var e=r.toFloat(),i=t.mul(e.mul(n.pow(e.sub(ac(1))))),o=$c(n.shape,a);return o.length>0&&(i=i.sum(o)),i.reshape(n.shape)},b:function(){var e=n.greater(0),o=n.log().where(e,yc(n)),s=t.mul(i.mul(o)),l=$c(r.shape,a);return l.length>0&&(s=s.sum(l)),s.reshape(r.shape)}}}),"Pow",{},[r,i],[!0])}}),Wh=Ju({powStrict_:function(t,e){return gs(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),jh=Ju({squaredDifferenceStrict_:function(t,e){var n=Uu(t,"a","squaredDifferenceStrict"),r=Uu(e,"b","squaredDifferenceStrict");return gs(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),qh=Ju({sub_:function(t,e){var n,r=Uu(t,"a","sub"),i=Uu(e,"b","sub");n=xl(r,i);var a=Kc((r=n[0]).shape,(i=n[1]).shape);return Ml.runKernelFunc((function(t){return t.subtract(r,i)}),{a:r,b:i},(function(t){return{a:function(){var e=t,n=$c(r.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=$c(i.shape,a);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}),"Sub")}}),Hh=Ju({subStrict_:function(t,e){var n=Uu(t,"a","subStrict"),r=Uu(e,"b","subStrict");return gs(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Gh=Ju({div_:function(t,e){var n,r=Uu(t,"a","div"),i=Uu(e,"b","div");return n=xl(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype?Ih(r,i):Ml.runKernelFunc((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{a:r,b:i},null,Uc,{})}});function $h(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,a=0;a<n.length-1;++a)i*=n[a];var o=t.shape,s=n.slice();s.pop();var l=1;for(a=r;a<t.rank;++a)l*=o[a],s.push(o[a]);var u=js(t.shape).map((function(t){return t/l})).concat([1]).slice(0,r);return[s,i,l,u]}function Kh(t){return t<=30?t:Ws(t,Math.floor(Math.sqrt(t)))}function Xh(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(a+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(a+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != "+(i+t.length-r));for(var o=0;o<i;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+e.shape[o]+").");for(o=0;o<n.rank-i;++o)if(n.shape[o+i]!==t[o+r])throw new Error(a+" updates.shape["+(o+i)+"] ("+n.shape[o+i]+") != shape["+(o+i)+"] ("+t[o+i]+")")}function Yh(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}Xh(n,e,t)}function Qh(t,e,n){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length,o=1,s=i;s<a;++s)o*=n[s];var l=i<1?1:i;return{sliceRank:i,numUpdates:bs(e.shape)/l,sliceSize:o,strides:js(n.slice(0,i)).concat([1]),outputSize:bs(n)}}function Zh(t,e,n){ms(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),ms(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){ms(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}function Jh(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function tp(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function ep(t,e,n,r,i){var a=e[i];(t&1<<i||null==a)&&(a=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var o=r[i];return a<0&&(a+=o),ps(0,a,o-1)}function np(t,e,n,r,i){var a=e[i],o=n[i]||1;(t&1<<i||null==a)&&(a=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return a<0&&(a+=s),o>0?ps(0,a,s):ps(-1,a,s-1)}function rp(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function ip(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function ap(t){return Ml.customGrad(t)}Object.freeze({prepareAndValidate:$h}),Object.freeze({validateUpdateShape:Xh,validateInput:Yh,calculateShapes:Qh}),Object.freeze({assertParamsValid:Zh,maskToAxes:Jh,computeOutShape:tp,startForAxis:ep,stopForAxis:np,isSliceContinous:rp,computeFlatOffset:ip});var op=Ju({softmax_:function(t,e){void 0===e&&(e=-1);var n=Uu(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return Ml.runKernelFunc((function(t,r){var i=t.softmax(n,e);return r([i]),i}),{logits:n},(function(t,n){var r=n[0],i=t.mul(r);return{logits:function(){return i.sub(i.sum([e],!0).mul(r))}}}),"Softmax",{dim:e},[],[!0])}}),sp=Ju({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=Uu(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return ap((function(t,n){var r=t.max(e,!0),i=t.sub(r),a=i.toFloat().sub(i.exp().sum(e,!0).log());return n([a]),{value:a,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),lp=Ju({transpose_:function(t,e){var n=Uu(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),ms(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){ms(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():Ml.runKernelFunc((function(t){return t.transpose(n,e)}),{x:n},null,"Transpose",{perm:e})}}),up=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),cp=function(){function t(){}return t.prototype.time=function(t){return hp("time")},t.prototype.read=function(t){return hp("read")},t.prototype.readSync=function(t){return hp("readSync")},t.prototype.numDataIds=function(){return hp("numDataIds")},t.prototype.disposeData=function(t){return hp("disposeData")},t.prototype.write=function(t,e,n){return hp("write")},t.prototype.move=function(t,e,n,r){return hp("move")},t.prototype.memory=function(){return hp("memory")},t.prototype.floatPrecision=function(){return hp("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){return hp("batchMatMul")},t.prototype.fusedBatchMatMul=function(t){return hp("fusedBatchMatMul")},t.prototype.slice=function(t,e,n){return hp("slice")},t.prototype.stridedSlice=function(t,e,n,r){return hp("stridedSlice")},t.prototype.unstack=function(t,e){return hp("unstack")},t.prototype.reverse=function(t,e){return hp("reverse")},t.prototype.concat=function(t,e){return hp("concat")},t.prototype.neg=function(t){return hp("neg")},t.prototype.add=function(t,e){return hp("add")},t.prototype.addN=function(t){return hp("addN")},t.prototype.subtract=function(t,e){return hp("subtract")},t.prototype.multiply=function(t,e){return hp("multiply")},t.prototype.realDivide=function(t,e){return hp("realDivide")},t.prototype.floorDiv=function(t,e){return hp("floorDiv")},t.prototype.sum=function(t,e){return hp("sum")},t.prototype.prod=function(t,e){return hp("prod")},t.prototype.unsortedSegmentSum=function(t,e,n){return hp("unsortedSegmentSum")},t.prototype.argMin=function(t,e){return hp("argMin")},t.prototype.argMax=function(t,e){return hp("argMax")},t.prototype.equal=function(t,e){return hp("equal")},t.prototype.notEqual=function(t,e){return hp("notEqual")},t.prototype.less=function(t,e){return hp("less")},t.prototype.lessEqual=function(t,e){return hp("lessEqual")},t.prototype.greater=function(t,e){return hp("greater")},t.prototype.greaterEqual=function(t,e){return hp("greaterEqual")},t.prototype.logicalNot=function(t){return hp("logicalNot")},t.prototype.logicalAnd=function(t,e){return hp("logicalAnd")},t.prototype.logicalOr=function(t,e){return hp("logicalOr")},t.prototype.where=function(t){return hp("where")},t.prototype.select=function(t,e,n){return hp("select")},t.prototype.topk=function(t,e,n){return hp("topk")},t.prototype.min=function(t,e){return hp("min")},t.prototype.minimum=function(t,e){return hp("minimum")},t.prototype.mod=function(t,e){return hp("mod")},t.prototype.max=function(t,e){return hp("max")},t.prototype.maximum=function(t,e){return hp("maximum")},t.prototype.all=function(t,e){return hp("all")},t.prototype.any=function(t,e){return hp("any")},t.prototype.squaredDifference=function(t,e){return hp("squaredDifference")},t.prototype.ceil=function(t){return hp("ceil")},t.prototype.floor=function(t){return hp("floor")},t.prototype.round=function(t){return hp("round")},t.prototype.sign=function(t){return hp("sign")},t.prototype.isNaN=function(t){return hp("isNaN")},t.prototype.isInf=function(t){return hp("isInf")},t.prototype.isFinite=function(t){return hp("isFinite")},t.prototype.pow=function(t,e){return hp("pow")},t.prototype.exp=function(t){return hp("exp")},t.prototype.expm1=function(t){return hp("expm1")},t.prototype.softmax=function(t,e){return hp("softmax")},t.prototype.log=function(t){return hp("log")},t.prototype.log1p=function(t){return hp("log1p")},t.prototype.sqrt=function(t){return hp("sqrt")},t.prototype.rsqrt=function(t){return hp("rsqrt")},t.prototype.square=function(t){return hp("square")},t.prototype.reciprocal=function(t){return hp("reciprocal")},t.prototype.relu=function(t){return hp("relu")},t.prototype.relu6=function(t){return hp("relu6")},t.prototype.prelu=function(t,e){return hp("prelu")},t.prototype.elu=function(t){return hp("elu")},t.prototype.eluDer=function(t,e){return hp("eluDer")},t.prototype.selu=function(t){return hp("selu")},t.prototype.int=function(t){return hp("int")},t.prototype.clip=function(t,e,n){return hp("clip")},t.prototype.abs=function(t){return hp("abs")},t.prototype.complexAbs=function(t){return hp("complexAbs")},t.prototype.sigmoid=function(t){return hp("sigmoid")},t.prototype.softplus=function(t){return hp("softplus")},t.prototype.sin=function(t){return hp("sin")},t.prototype.cos=function(t){return hp("cos")},t.prototype.tan=function(t){return hp("tan")},t.prototype.asin=function(t){return hp("asin")},t.prototype.acos=function(t){return hp("acos")},t.prototype.atan=function(t){return hp("atan")},t.prototype.atan2=function(t,e){return hp("atan2")},t.prototype.sinh=function(t){return hp("sinh")},t.prototype.cosh=function(t){return hp("cosh")},t.prototype.tanh=function(t){return hp("tanh")},t.prototype.asinh=function(t){return hp("asinh")},t.prototype.acosh=function(t){return hp("acosh")},t.prototype.atanh=function(t){return hp("atanh")},t.prototype.erf=function(t){return hp("erf")},t.prototype.step=function(t,e){return hp("step")},t.prototype.fusedConv2d=function(t){return hp("fusedConv2d")},t.prototype.conv2d=function(t,e,n){return hp("conv2d")},t.prototype.conv2dDerInput=function(t,e,n){return hp("conv2dDerInput")},t.prototype.conv2dDerFilter=function(t,e,n){return hp("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(t){return hp("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(t,e,n){return hp("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){return hp("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){return hp("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(t,e,n){return hp("conv3d")},t.prototype.conv3dDerInput=function(t,e,n){return hp("conv3dDerInput")},t.prototype.conv3dDerFilter=function(t,e,n){return hp("conv3dDerFilter")},t.prototype.maxPool=function(t,e){return hp("maxPool")},t.prototype.maxPoolBackprop=function(t,e,n,r){return hp("maxPoolBackprop")},t.prototype.avgPool=function(t,e){return hp("avgPool")},t.prototype.avgPoolBackprop=function(t,e,n){return hp("avgPoolBackprop")},t.prototype.avgPool3d=function(t,e){return hp("avgPool3d")},t.prototype.avgPool3dBackprop=function(t,e,n){return hp("avgPool3dBackprop")},t.prototype.maxPool3d=function(t,e){return hp("maxPool3d")},t.prototype.maxPool3dBackprop=function(t,e,n,r){return hp("maxPool3dBackprop")},t.prototype.reshape=function(t,e){return hp("reshape")},t.prototype.cast=function(t,e){return hp("cast")},t.prototype.tile=function(t,e){return hp("tile")},t.prototype.pad=function(t,e,n){return hp("pad")},t.prototype.transpose=function(t,e){return hp("transpose")},t.prototype.gather=function(t,e,n){return hp("gather")},t.prototype.gatherND=function(t,e){return hp("gatherND")},t.prototype.scatterND=function(t,e,n){return hp("scatterND")},t.prototype.batchToSpaceND=function(t,e,n){return hp("batchToSpaceND")},t.prototype.spaceToBatchND=function(t,e,n){return hp("spaceToBatchND")},t.prototype.resizeBilinear=function(t,e,n,r){return hp("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(t,e,n){return hp("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){return hp("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){return hp("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(t,e,n,r,i,a){return hp("batchNormalization")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){return hp("localResponseNormalization4D")},t.prototype.LRNGrad=function(t,e,n,r,i,a,o){return hp("LRNGrad")},t.prototype.multinomial=function(t,e,n,r){return hp("multinomial")},t.prototype.oneHot=function(t,e,n,r){return hp("oneHot")},t.prototype.cumsum=function(t,e,n,r){return hp("cumsum")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return hp("nonMaxSuppression")},t.prototype.fft=function(t){return hp("fft")},t.prototype.ifft=function(t){return hp("ifft")},t.prototype.complex=function(t,e){return hp("complex")},t.prototype.real=function(t){return hp("real")},t.prototype.imag=function(t){return hp("imag")},t.prototype.cropAndResize=function(t,e,n,r,i,a){return hp("cropAndResize")},t.prototype.depthToSpace=function(t,e,n){return hp("depthToSpace")},t.prototype.split=function(t,e,n){return hp("split")},t.prototype.sparseToDense=function(t,e,n,r){return hp("sparseToDense")},t.prototype.diag=function(t){return hp("diag")},t.prototype.fill=function(t,e,n){return hp("fill")},t.prototype.onesLike=function(t){return hp("onesLike")},t.prototype.zerosLike=function(t){return hp("zerosLike")},t.prototype.linspace=function(t,e,n){return hp("linspace")},t.prototype.dispose=function(){return hp("dispose")},t}();function hp(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function pp(t,e,n,r,i,a,o){void 0===o&&(o="channelsLast");var s,l=yp(e),u=l[0],c=l[1];if("channelsLast"===o)s=[u,c,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[u,c,t[1],t[1]]}return fp(t,s,n,r,i,a,!1,o)}function dp(t,e,n,r,i,a,o){void 0===o&&(o="NDHWC");var s,l,u=vp(e),c=u[0],h=u[1],p=u[2];if("NDHWC"===o)l="channelsLast",s=[c,h,p,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);l="channelsFirst",s=[c,h,p,t[1],t[1]]}return mp(t,s,n,r,i,!1,l,a)}function fp(t,e,n,r,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var l=[-1,-1,-1,-1],u=l[0],c=l[1],h=l[2],p=l[3];if("channelsLast"===s)u=t[0],c=t[1],h=t[2],p=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);u=t[0],p=t[1],c=t[2],h=t[3]}var d,f=e[0],m=e[1],g=e[3],y=yp(n),v=y[0],b=y[1],w=yp(r),x=w[0],C=w[1],_=bp(f,x),k=bp(m,C),S=function(t,e,n,r,i,a,o,s){var l,u,c;if("number"==typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=gp(t,e,n));var a=t[1],o=wp((t[0]-e+2*r)/n+1,i);ms(xs(o),(function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"}));var s=wp((a-e+2*r)/n+1,i);return ms(xs(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[o,s]}([e,n],a,r,t,s);u=h[0],c=h[1]}else if("same"===t){u=Math.ceil(e/r),c=Math.ceil(n/i);var p=Math.max(0,(u-1)*r+a-e),d=Math.max(0,(c-1)*i+o-n),f=Math.floor(p/2),m=p-f,g=Math.floor(d/2);l={top:f,bottom:m,left:g,right:d-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-a+1)/r),c=Math.ceil((n-o+1)/i)}return{padInfo:l,outHeight:u,outWidth:c}}(i,c,h,v,b,_,k,a),O=S.outHeight,E=S.outWidth,M=o?g*p:g;return"channelsFirst"===s?d=[u,M,O,E]:"channelsLast"===s&&(d=[u,O,E,M]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:h,inChannels:p,outHeight:O,outWidth:E,outChannels:M,padInfo:S.padInfo,strideHeight:v,strideWidth:b,filterHeight:f,filterWidth:m,effectiveFilterHeight:_,effectiveFilterWidth:k,dilationHeight:x,dilationWidth:C,inShape:t,outShape:d,filterShape:e}}function mp(t,e,n,r,i,a,o,s){void 0===a&&(a=!1),void 0===o&&(o="channelsLast");var l=[-1,-1,-1,-1,-1],u=l[0],c=l[1],h=l[2],p=l[3],d=l[4];if("channelsLast"===o)u=t[0],c=t[1],h=t[2],p=t[3],d=t[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);u=t[0],d=t[1],c=t[2],h=t[3],p=t[4]}var f,m=e[0],g=e[1],y=e[2],v=e[4],b=vp(n),w=b[0],x=b[1],C=b[2],_=vp(r),k=_[0],S=_[1],O=_[2],E=bp(m,k),M=bp(g,S),N=bp(y,O),P=function(t,e,n,r,i,a,o,s,l,u,c){var h,p,d,f;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,i,a){null==i&&(i=gp(t,e,r));var o=t[1],s=t[2],l=wp((t[0]-e+2*i)/r+1,a);ms(xs(l),(function(){return"The output # of depths ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var u=wp((o-e+2*i)/r+1,a);ms(xs(u),(function(){return"The output # of rows ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=wp((s-e+2*i)/r+1,a);return ms(xs(c),(function(){return"The output # of columns ("+c+") must be an integer. Change the stride and/or zero pad parameters"})),[l,u,c,1]}([e,n,r,1],s,0,i,t,c);p=m[0],d=m[1],f=m[2]}else if("same"===t){var g=((p=Math.ceil(e/i))-1)*i+s-e,y=((d=Math.ceil(n/a))-1)*a+l-n,v=((f=Math.ceil(r/o))-1)*o+u-r,b=Math.floor(g/2),w=g-b,x=Math.floor(y/2),C=y-x,_=Math.floor(v/2);h={top:x,bottom:C,left:_,right:v-_,front:b,back:w,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-s+1)/i),d=Math.ceil((n-l+1)/a),f=Math.ceil((r-u+1)/o)}return{padInfo:h,outDepth:p,outHeight:d,outWidth:f}}(i,c,h,p,w,x,C,E,M,N,s),T=P.outDepth,I=P.outHeight,A=P.outWidth,R=a?v*d:v;return"channelsFirst"===o?f=[u,R,T,I,A]:"channelsLast"===o&&(f=[u,T,I,A,R]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:h,inWidth:p,inChannels:d,outDepth:T,outHeight:I,outWidth:A,outChannels:R,padInfo:P.padInfo,strideDepth:w,strideHeight:x,strideWidth:C,filterDepth:m,filterHeight:g,filterWidth:y,effectiveFilterDepth:E,effectiveFilterHeight:M,effectiveFilterWidth:N,dilationDepth:k,dilationHeight:S,dilationWidth:O,inShape:t,outShape:f,filterShape:e}}function gp(t,e,n,r){void 0===r&&(r=1);var i=bp(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function yp(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function vp(t){return"number"==typeof t?[t,t,t]:t}function bp(t,e){return e<=1?t:t+(t-1)*(e-1)}function wp(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function xp(t){var e=yp(t);return 1===e[0]&&1===e[1]&&1===e[2]}function Cp(t,e){return xp(t)||xp(e)}function _p(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function kp(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=pc(t.shape),i=t.toFloat(),a=n.complex(i,r);return r.dispose(),i.dispose(),a}if(!As(t.dtype,e))return Ml.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){var o=n.real(t);return a=o.cast(e),o.dispose(),a}if("int32"===e)return n.int(t);if("bool"===e){var s=ac(0,t.dtype);return a=n.notEqual(t,s),s.dispose(),a}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Sp(t,e){return Ml.makeTensorFromDataId(t.dataId,e,t.dtype)}function Op(t,e,n){var r=(e-t)/(n-1),i=$s(n,"float32");i[0]=t;for(var a=1;a<i.length;a++)i[a]=i[a-1]+r;return oc(i,"float32")}function Ep(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Mp(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Np(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Pp(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function Tp(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,i=t.length,a=0,o=!1;r<i;){var s=n(e,t[a=r+(i-r>>>1)]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}(t,e,n||Ip)}(t,e,n);t.splice(r<0?-(r+1):r,0,e)}function Ip(t,e){return t>e?1:t<e?-1:0}function Ap(t,e,n,r,i){return Dp(t,e,n,r,i,0).selectedIndices}function Rp(t,e,n,r,i,a){var o=Dp(t,e,n,r,i,a,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function Dp(t,e,n,r,i,a,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var l=Array.from(e).map((function(t,e){return{score:t,boxIndex:e,suppressBeginIndex:0}})).filter((function(t){return t.score>i})).sort(Lp),u=a>0?-.5/a:0,c=[],h=[];c.length<n&&l.length>0;){var p=l.pop(),d=p.score,f=p.boxIndex,m=p.suppressBeginIndex;if(d<i)break;for(var g=!1,y=c.length-1;y>=m;--y){var v=Fp(t,f,c[y]);if(v>=r){g=!0;break}if(p.score=p.score*zp(r,u,v),p.score<=i)break}p.suppressBeginIndex=c.length,g||(p.score===d?(c.push(f),h.push(p.score)):p.score>i&&Tp(l,p,Lp))}var b=c.length;return s&&(c.fill(0,b),h.fill(0,b)),{selectedIndices:oc(c,"int32"),selectedScores:oc(h,"float32"),numValidOutputs:ac(b,"int32")}}function Fp(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),d=(s-a)*(l-o),f=(h-u)*(p-c);if(d<=0||f<=0)return 0;var m=Math.max(a,u),g=Math.max(o,c),y=Math.min(s,h),v=Math.min(l,p),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(d+f-b)}function zp(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Lp(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function Bp(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var a=t.slice(r,i);return r[n]+=e,a}))}function Vp(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=kc(n,t.dtype);for(r=0;r<i.values.length;++r){for(var a=i.indexToLoc(r),o=new Array(t.rank),s=0;s<o.length;s++)o[s]=a[s]%t.shape[s];var l=t.locToIndex(o);i.values[r]=t.values[l]}return i.toTensor()}function Up(t,e,n,r,i){for(var a=e[e.length-1],o=[t.length/a,a],s=o[0],l=o[1],u=Ns(n,s*r),c=Ns("int32",s*r),h=0;h<s;h++){for(var p=h*l,d=t.subarray(p,p+l),f=[],m=0;m<d.length;m++)f.push({value:d[m],index:m});f.sort((function(t,e){return e.value-t.value}));var g=h*r,y=u.subarray(g,g+r),v=c.subarray(g,g+r);for(m=0;m<r;m++)y[m]=f[m].value,v[m]=f[m].index}var b=e.slice();return b[b.length-1]=r,[rc(u,b,n),rc(c,b,"int32")]}function Wp(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=kc(t,"int32"),a=kc([n.length,t.length],"int32");for(r=0;r<n.length;r++){var o=i.indexToLoc(n[r]);a.values.set(o,r*t.length)}return a.toTensor()}Object.freeze({castTensor:kp,reshapeTensor:Sp,linspaceImpl:Op,upcastType:bl,axesAreInnerMostDims:ju,combineLocations:qu,computeOutAndReduceShapes:Hu,expandShapeToKeepDim:Gu,assertAxesAreInnerMostDims:$u,getAxesPermutation:Ku,getUndoAxesPermutation:Xu,getInnerMostAxes:Yu,getBroadcastDims:Gc,getReductionAxes:$c,assertAndGetBroadcastShape:Kc,assertParamsConsistent:Qu,computeOutShape:Zu,computePool2DInfo:pp,computePool3DInfo:dp,computeConv2DInfo:fp,computeConv3DInfo:mp,computeDefaultPad:gp,tupleValuesAreOne:xp,eitherStridesOrDilationsAreOne:Cp,convertConv2DDataFormat:_p,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Kh});var jp=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},qp=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Hp=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,a=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Gp(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function $p(t,e){return 1===e?[t]:Gp(t,e)}function Kp(){var t,e,n,r,i,a,o,s,l,u;return 2===es().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",a="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",a="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:l,defineRound:u}}function Xp(t,e,n){void 0===n&&(n="index");var r=js(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function Yp(t){var e=js(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var Qp="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Zp(t){return"offset"+t}function Jp(t){var e=t.name,n=bs(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function td(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function ed(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function nd(t,e){return e.map((function(e){return t[e]})).join(", ")}var rd=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ms(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,o,s=this.outputShape,l=s.length,u=td(l),c=$p("coords",l);if(1===i){var h=td(o=l+1);a="\n        "+h+" sourceLocR = "+h+"("+c.join()+", 0);\n        ++"+c[l-1]+";\n        "+h+" sourceLocG = "+h+"("+c.join()+", 0);\n        ++"+c[l-2]+";\n        "+h+" sourceLocA = "+h+"("+c.join()+", 0);\n        --"+c[l-1]+";\n        "+h+" sourceLocB = "+h+"("+c.join()+", 0);\n        --"+c[l-2]+";"}else o=l,a="\n        "+u+" sourceLocR = coords;\n        ++"+c[l-1]+";\n        "+u+" sourceLocG = coords;\n        ++"+c[l-2]+";\n        "+u+" sourceLocA = coords;\n        --"+c[l-1]+";\n        "+u+" sourceLocB = coords;\n        --"+c[l-2]+";";var p=["x","y","z","w","u","v"].slice(0,o),d="."+p[o-1],f=p.map((function(t){return"int "+t})),m=$p("sourceLocR",o-1).concat("inIdx.r"),g=$p("sourceLocG",o-1).concat("inIdx.g"),y=$p("sourceLocB",o-1).concat("inIdx.b"),v=$p("sourceLocA",o-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+v.join()+")));",x="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+v.join()+") : 0.)",C=r?"":"\n      float getBestIndicesAChannel("+f.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+f.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+C+"\n      void main() {\n        "+u+" coords = getOutputCoords();\n        bool hasNextCol = "+c[l-1]+" < "+(s[l-1]-1)+";\n        bool hasNextRow = "+c[l-2]+" < "+(s[l-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+x+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+x+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+b+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},id=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ad=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterDepth*t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n            wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},od=function(t,e,n,r,i,a){this.outputShape=[],this.variableNames=["x","mean","variance"],Kc(t,e),Kc(t,n);var o="0.0";null!=r&&(Kc(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=i&&(Kc(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+a+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},sd=function(t,e,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Kc(t,e),Kc(t,n);var o="vec4(0.0)";null!=r&&(Kc(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(Kc(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+a+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},ld=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Kc(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},ud="return a + b;",cd="return a - b;",hd="return a * b;",pd="return (a < 0.) ? b * a : a;",dd=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Kc(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},fd="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",md=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Kc(e,n);var i=this.outputShape.length,a="";if(r)if(0===i||1===bs(this.outputShape))a="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(a="\n          "+td(i)+" coords = getOutputCoords();\n        ",1===i)a+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=$p("coords",i);a+="\n            bool nextRowOutOfBounds =\n              ("+o[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+o[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+a+"\n\n        setOutput(result);\n      }\n    "},gd=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),yd=function(){function t(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),vd=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},bd=function(t){this.outputShape=[],this.outputShape=Zu(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},wd=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Zu(t,e);var n=this.outputShape,r=n.length,i=td(r),a=$p("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var l=1;l<s.length;l++)s[l]=s[l-1]+t[l][e];var u=o[e],c=o.slice(-2),h=o.join(),p="if ("+u+" < "+s[0]+") {\n        return getChannel(\n            getT0("+h+"), vec2("+c.join()+"));\n        }";for(l=1;l<s.length;l++){var d=s[l-1];p+="\n        if ("+u+" < "+s[l]+"  && "+u+" >= "+s[l-1]+") {\n          return getChannel(\n            getT"+l+"("+xd(o,u,d)+"),\n            vec2("+xd(c,u,d)+"));\n        }"}var f=s[s.length-1];p+="\n        return getChannel(\n          getT"+s.length+"("+xd(o,u,f)+"),\n          vec2("+xd(c,u,f)+"));",this.userCode="\n      float getValue("+o.map((function(t){return"int "+t}))+") {\n        "+p+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+a+"), 0., 0., 0.);\n\n        "+a[r-1]+" = "+a[r-1]+" + 1;\n        if ("+a[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+a+");\n        }\n\n        "+a[r-2]+" = "+a[r-2]+" + 1;\n        if ("+a[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+a+");\n        }\n\n        "+a[r-1]+" = "+a[r-1]+" - 1;\n        if ("+a[r-2]+" < "+n[r-2]+" &&\n            "+a[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+a+");\n        }\n        setOutput(result);\n      }\n    "};function xd(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+" - "+n:t})).join()}var Cd=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===t.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},_d=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(r?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(r?1:2)+"], coords["+(r?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+r+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},kd=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Sd=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Od=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ed=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Md=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,a=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),d=t.inChannels%4,f="channelsLast"===t.dataFormat,m=f?1:2,g=f?2:3,y=f?3:1,v="",b="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+y+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+g+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+c+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+u+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+f+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===d)+") {\n\n              if ("+f+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+p+") *\n                    getW(wR, wC, "+p+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+p+", xR, xC) *\n                    getW(wR, wC, "+p+", d2);\n              }\n\n            } else if ("+(2===d)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2)\n              );\n\n              if ("+f+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===d)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+p+", d2),\n                getW(wR, wC, "+p+" + 1, d2),\n                getW(wR, wC, "+p+" + 2, d2)\n              );\n\n              if ("+f+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+p+"),\n                  getX(batch, xR, xC, "+p+" + 1),\n                  getX(batch, xR, xC, "+p+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+p+", xR, xC),\n                  getX(batch, "+p+" + 1, xR, xC),\n                  getX(batch, "+p+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+w+"\n        "+b+"\n        setOutput(result);\n      }\n    "},Nd=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,l=t.dilationHeight,u=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,p=t.filterWidth,d=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+a+", "+o+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+c+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+l+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+p+"; wC++) {\n              int xC = xCCorner + wC * "+u+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===f)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+d+") *\n                  getW(wF, wR, wC, "+d+", d2);\n              } else if ("+(2===f)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===f)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1),\n                  getX(batch, xF, xR, xC, "+d+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2),\n                  getW(wF, wR, wC, "+d+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Pd=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,a=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,d=t.filterWidth,f=t.outChannels/t.inChannels,m="",g="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",g="result = activation(result);");var y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+l+", "+u+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+f+";\n        int q = d2 - d1 * "+f+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+p+"; wR++) {\n          int xR = xRCorner + wR * "+c+";\n\n          if (xR < 0 || xR >= "+i+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+a+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+y+"\n        "+g+"\n        setOutput(result);\n      }\n    "},Td=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var i=t.inHeight,a=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,l=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,p=t.filterHeight,d=t.filterWidth,f=d,m="int xR; int xC; int xCOffset;",g=0;g<p;g++)for(var y=0;y<d;y++)m+="\n          vec4 xTexelR"+g+"C"+2*y+" = vec4(0.);\n          vec4 wR"+g+"C"+y+" = vec4(0.);\n          vec4 xR"+g+"C"+y+" = vec4(0.);";for(g=0;g<p;g++)for(var v=0;v<f;v++){if(m+="\n          xR = xRCorner + "+g*c+";\n          xC = xCCorner + "+(y=2*v)*h+";\n        ",1===u){if(y<d&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+a+") {\n                    xTexelR"+g+"C"+y+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+a+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+a+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+g+"C"+y+" = vec4(previous.zw, xTexelR"+g+"C"+y+".xy);\n                } else {\n                  xR"+g+"C"+y+" = vec4(0, 0, xTexelR"+g+"C"+y+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+i+" && xC >= 0 && xC < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                xR"+g+"C"+y+" = xTexelR"+g+"C"+y+";\n              ",y+1<d)){var b=s%2==0?ds(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+a+") {\n                    xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",h>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+i+" &&\n                      xCOffset >= 0 && xCOffset < "+a+") {\n                      xTexelR"+g+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+g+"C"+y+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+g+"C"+(y+1)+" = vec4(\n                    xTexelR"+g+"C"+y+".zw, xTexelR"+g+"C"+(y+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+a+") {\n                    xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+g+"C"+(y+1)+" = xTexelR"+g+"C"+(y+2)+";\n                "}}else y<d&&(m+="\n              if(xR >= 0 && xR < "+i+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+u+";\n                if(xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+a+") {\n                  xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+g+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+y+" = vec4(\n                  xTexelR"+g+"C"+y+".zw, xTexelR"+g+"C"+(y+2)+".zw);\n              ",y+1<d&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+u+";\n                  if(xCOffset >= 0 && xCOffset < "+a+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+g+"C"+(y+1)+" = vec4(xTexelR"+g+"C"+(y+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+a+") {\n                  xTexelR"+g+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+u+";\n                if(xCOffset >= 0 && xCOffset < "+a+") {\n                  xTexelR"+g+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+y+" = vec4(\n                  xTexelR"+g+"C"+y+".xy, xTexelR"+g+"C"+(y+2)+".xy);\n              ",y+1<d&&(m+="\n                  xR"+g+"C"+(y+1)+" = vec4(\n                    xTexelR"+g+"C"+y+".zw, xTexelR"+g+"C"+(y+2)+".zw);\n                ")),m+="}");y<d&&(m+="\n            vec4 wTexelR"+g+"C"+y+" = getW("+g+", "+y+", d1, q);\n            wR"+g+"C"+y+" = vec4(wTexelR"+g+"C"+y+".xz, wTexelR"+g+"C"+y+".xz);\n          ",y+1<d&&(m+="\n              vec4 wTexelR"+g+"C"+(y+1)+" = getW("+g+", "+(y+1)+", d1, q);\n              wR"+g+"C"+(y+1)+" =\n                vec4(wTexelR"+g+"C"+(y+1)+".xz, wTexelR"+g+"C"+(y+1)+".xz);"))}for(g=0;g<p;g++)for(y=0;y<d;y++)m+="dotProd += xR"+g+"C"+y+" * wR"+g+"C"+y+";";var w="",x="";n&&(w=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",x="result = activation(result);");var C=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+w+"\n\n      const ivec2 strides = ivec2("+l+", "+u+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+C+"\n        "+x+"\n        setOutput(result);\n      }\n    "},Id=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var a=t[0],o=t[1],s=t[2],l=n[0],u=n[1];this.outputShape=[e[0],l,u,t[3]];var c=[o-1+".0",s-1+".0"],h=c[0],p=c[1],d=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],f=u>1?[""+(s-1)/(u-1),"(x2-x1) * width_ratio","x1*"+p+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+p];this.userCode="\n      const float height_ratio = float("+d[0]+");\n      const float width_ratio = float("+f[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+a+") {\n          return;\n        }\n\n        float height_scale = "+d[1]+";\n        float width_scale = "+f[1]+";\n\n        float in_y = "+d[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+f[2]+";\n        if( in_x < 0.0 || in_x > "+p+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Ad=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],a=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+td(r)+" coords = getOutputCoords();\n        int end = "+Rd(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+a+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+Rd(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Rd(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var Dd=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Tl.DENSE;var e=Bl(t),n=Kp();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Xp(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},Fd=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Tl.DENSE;var e=Bl(t),n=Kp();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Xp(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},zd=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),Ld=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Bd=function(t){this.variableNames=["A"],this.outTexUsage=Il.DOWNLOAD;var e=Kp();this.outputShape=t,this.userCode="\n      "+Qp+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},Vd=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Il.DOWNLOAD;var e=Kp();this.outputShape=t,this.userCode="\n      "+Qp+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},Ud=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Kp(),i=e[0],a=e[1];this.outputShape=t;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+Yp(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+a+";\n        int c = imod(flatIndex, "+a+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+a+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},Wd=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Kp(),i=e[0],a=e[1];this.outputShape=t;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var u=0;u<=1;u++){var c=2*l+u;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+u+" < "+t[2]+") {\n            localCoords[2] += "+u+";\n            if(localCoords[1] + "+l+" < "+t[1]+") {\n              localCoords[1] += "+l+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+a+";\n              c = imod(flatIndex, "+a+");\n              uv = (vec2(c, r) + halfCR) / vec2("+a+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+c+"] = values[0];\n              } else if(offset == 1) {\n                result["+c+"] = values[1];\n              } else if(offset == 2) {\n                result["+c+"] = values[2];\n              } else {\n                result["+c+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Yp(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},jd=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},qd=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),Hd=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=td(this.rank),a=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],a=0;a<t.length;a++)i.push(a===e?"int(getIndices("+r[a]+"))":""+r[a]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "},Gd=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=td(e.length),i=td(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function $d(t,e){var n=Kp();return Gl(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Kd(t,e){return tu(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Xd(t,e){return eu(t,e,new Uint16Array([0,1,2,2,1,3]))}function Yd(t,e,n,r,i,a,o){ru(n,r);var s=nu(t,e),l=t.TEXTURE_2D;return Wl(t,e,(function(){return t.bindTexture(l,s)})),Wl(t,e,(function(){return t.texParameteri(l,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Wl(t,e,(function(){return t.texParameteri(l,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Wl(t,e,(function(){return t.texParameteri(l,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Wl(t,e,(function(){return t.texParameteri(l,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Wl(t,e,(function(){return t.texImage2D(l,0,i,n,r,0,a,o,null)})),Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function Qd(t,e,n,r,i){var a=Ll(n,r);return Yd(t,e,a[0],a[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function Zd(t,e,n,r,i){var a=Ll(n,r);return Yd(t,e,a[0],a[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function Jd(t,e,n,r,i){var a=Ll(n,r);return Yd(t,e,a[0],a[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function tf(t,e,n,r,i){var a=Vl(n,r);return Yd(t,e,a[0],a[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function ef(t,e,n,r,i){var a=Vl(n,r);return Yd(t,e,a[0],a[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function nf(t,e,n,r){return Wl(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),au(t,e,n,"clipSpacePos",r,3,20,0)&&au(t,e,n,"uv",r,2,20,12)}function rf(t,e,n,r,i,a,o){var s,l,u;Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),a instanceof Uint8Array?(s=new Uint8Array(r*i*4),l=t.UNSIGNED_BYTE,u=t.RGBA):(s=new Float32Array(r*i*4),l=t.FLOAT,u=o.internalFormatPackedFloat),s.set(a),Wl(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,u,r,i,0,t.RGBA,l,s)})),Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function af(t,e,n,r){Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Wl(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):Wl(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),Wl(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function of(t,e,n,r,i){var a=t.createBuffer();Wl(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,a)}));var o=16*n*r;return Wl(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),Wl(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),Wl(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),a}function sf(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function lf(t,e,n,r,i){var a=Ll(n,r),o=a[0],s=a[1],l=new Uint8Array(n*r*4);return Wl(t,e,(function(){return t.readPixels(0,0,o,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,l)})),new Float32Array(l.buffer)}function uf(t,e,n,r,i,a,o,s){var l=t,u=new Float32Array(function(t,e){var n=Vl(t,e);return n[0]*n[1]*4}(a,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function cf(t,e,n,r){var i=new Float32Array(n*r*4);return Wl(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}var hf=Object.freeze({createVertexShader:$d,createVertexBuffer:Kd,createIndexBuffer:Xd,createFloat32MatrixTexture:Qd,createFloat16MatrixTexture:Zd,createUnsignedBytesMatrixTexture:Jd,createPackedMatrixTexture:tf,createFloat16PackedMatrixTexture:ef,bindVertexProgramAttributeStreams:nf,uploadDenseMatrixToTexture:rf,uploadPixelDataToTexture:af,createBufferFromOutputTexture:of,downloadFloat32MatrixFromBuffer:sf,downloadByteEncodedFloatMatrixFromOutputTexture:lf,downloadPackedMatrixFromBuffer:uf,downloadMatrixFromPackedOutputTexture:cf}),pf=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=es().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,Fl(e,t)):this.gl=zl(e);var n="WEBGL_color_buffer_float";if(1===es().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=Hl(this.gl,this.debug,"OES_texture_float"),Su(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=Hl(this.gl,this.debug,"OES_texture_half_float");else if(es().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Su(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=Hl(this.gl,this.debug,"EXT_color_buffer_half_float");else if(es().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(Su(this.gl,n="EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Su(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Kd(this.gl,this.debug),this.indexBuffer=Xd(this.gl,this.debug),this.framebuffer=iu(this.gl,this.debug),this.textureConfig=Ul(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return es().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Wl(e,this.debug,(function(){return e.finish()})),Wl(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Wl(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Wl(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Wl(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Wl(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),Qd(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),Zd(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),Jd(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),af(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),rf(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ef(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),tf(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(hu(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Wl(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return lf(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,a){return uf(this.gl,t,0,0,0,i,a)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return sf(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=of(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(es().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(a,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=a}else es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return cf(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=$l(e,this.debug,t),r=$d(e,this.debug),i=Ql(e,this.debug);return Wl(e,this.debug,(function(){return e.attachShader(i,r)})),Wl(e,this.debug,(function(){return e.attachShader(i,n)})),Zl(e,this.debug,i),this.debug&&Jl(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=nf(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&Wl(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&Jl(this.gl,this.debug,this.program),Wl(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?su(this.gl,this.debug,t,e):lu(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Wl(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),uu(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=Vl(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&Jl(this.gl,this.debug,this.program),pu(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Wl(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Wl(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Hl(this.gl,this.debug,2===es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return Qo(this,void 0,void 0,(function(){var e=this;return Zo(this,(function(n){switch(n.label){case 0:return[4,Ss((function(){return e.disposed||e.isQueryAvailable(t,es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||Ss((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),cu(this.gl,this.debug,t,this.framebuffer),this.debug&&pu(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(cu(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&pu(this.gl)):hu(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;cu(r,this.debug,t,this.framebuffer),this.debug&&pu(r),this.outputTexture=t,Wl(r,this.debug,(function(){return r.viewport(0,0,e,n)})),Wl(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),Wl(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function df(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],a=i.shape;if(!ws(r,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+a+" must match");if(!t.isUniform||!i.isUniform){var o=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!ws(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var ff=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.inChannels,i=n.strideWidth,a=n.strideHeight,o=n.padInfo,s=n.outWidth,l=n.dilationWidth,u=n.dilationHeight,c=n.dataFormat,h=o.left,p=o.top,d=r*n.filterWidth,f=Kp(),m="channelsLast"===c,g=m?0:1,y=m?1:2,v="",b=0;b<=1;b++)for(var w=0;w<=1;w++)v+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+b+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+s+")) * "+a+" - "+p+";\n            d0 = offsetY + "+u+" * (pos / "+d+");\n\n            if(d0 < "+e[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+s+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+l+" * (int(mod(float(pos), "+d+".) / "+r+".));\n\n              if(d1 < "+e[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+r+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+v+"\n\n        "+f.output+" = result;\n      }\n    "},mf=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var a=e,o=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+o+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},gf=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},yf=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var a=e,o=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+o+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},vf=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},bf=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n           wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(e*n*r-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+n+" * "+r+" +\n                  wR * "+r+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},wf=function(t,e,n,r,i,a,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===a&&(a=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=Math.ceil((n?t[1]:t[2])/2),l=n?"i * 2, rc.y":"rc.y, i * 2",u=r?"rc.z, i * 2":"i * 2, rc.z",c=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",d="";a&&(p=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+a+"\n        }":"vec4 activation(vec4 x) {\n          "+a+"\n        }",d="result = activation(result);");var f=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+p+"\n\n      const float sharedDimension = "+s+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+s+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+l+");\n          vec4 b = getMatrixB(rc.x, "+u+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+c[0]+" * "+h[0]+");\n          result += ("+c[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+f+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},xf=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),Cf=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},_f=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=$p("rc",e),r=td(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),a=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var a=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),o=2;o<t;o++)a=e[e.length-1-o]+","+a;n.push(a)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+a+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},kf=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=td(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+a+");\n      "+i+" end = "+i+"("+o+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+a+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Sf=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=td(r),a=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=$p("rc",r),l=$p("source",r),u=s[r-1]+" < "+this.outputShape[r-1],c=1===r?"source":"vec2("+l.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+u+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+u+") {"],p=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",f=0,m=1===r?2:4;f<m;f++)d+="\n        "+h[f]+"\n        if ("+p+") {\n          result["+f+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+f+"] = getChannel(getX("+l.join()+"), "+c+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+a+");\n      const "+i+" end = "+i+"("+o+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(d+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},Of=function(t,e,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var a=t.filterWidth,o=t.strideHeight,s=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.top,d=t.padInfo.left;this.outputShape=t.outShape;var f="avg"===e,m="0.0";if(f||(m="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+s+");\n        const ivec2 pads = ivec2("+p+", "+d+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+c+";\n              wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+u+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = "+(r?i?"((batch  * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + d":"(xR * "+t.inWidth+" + xC) * "+t.inChannels+" + d":"wR * "+h+" + wC")+";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var g=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(g="avgValue / count");var y=4*Math.floor(a/4),v=a%4,b="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+p+", "+d+");\n      const float initializationValue = "+m+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+m+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+c+";\n            wR += "+l+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+y+"; wC += 4) {\n            int xC = xCCorner + wC * "+u+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+u+", d),\n              getValue(batch, xR, xC + 2 * "+u+", d),\n              getValue(batch, xR, xC + 3 * "+u+", d)\n            );\n\n            "+b+"\n          }\n\n          int xC = xCCorner + "+y+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+b+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+u+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+b+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+u+", d),\n              getValue(batch, xR, xC + 2 * "+u+", d),\n              initializationValue\n            );\n\n            "+b+"\n          }\n        }\n        setOutput("+g+");\n      }\n    "}},Ef=function(t,e,n,r,i){if(void 0===r&&(r=!1),void 0===i&&(i=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var a=t.filterWidth,o=t.strideDepth,s=t.strideHeight,l=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,p=t.effectiveFilterDepth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===e,b="0.0";if(v||(b="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+s+", "+l+");\n        const ivec3 pads = ivec3("+m+", "+g+", "+y+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+p+";\n              wD += "+u+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+d+";\n                wR += "+c+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+h+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = "+(r?i?"(((batch * "+t.inDepth+" + xD) * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + ch":"((xD * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + ch":"wD * "+d+" * "+f+" +\n                      wR * "+f+" + wC")+";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var w=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(w="avgValue / count");var x=4*Math.floor(a/4),C=a%4,_="\n      if ("+v+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+s+", "+l+");\n      const ivec3 pads = ivec3("+m+", "+g+", "+y+");\n      const float initializationValue = "+b+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+b+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+p+";\n            wD += "+u+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+";\n            wR += "+c+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+x+"; wC += 4) {\n              int xC = xCCorner + wC * "+h+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+h+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+h+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+h+", ch)\n              );\n\n              "+_+"\n            }\n\n            int xC = xCCorner + "+x+";\n            if ("+(1===C)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+_+"\n            } else if ("+(2===C)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+h+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+_+"\n            } else if ("+(3===C)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+h+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+h+", ch),\n                initializationValue\n              );\n\n              "+_+"\n            }\n          }\n          setOutput("+w+");\n        }\n      }\n    "}},Mf=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,a=Math.ceil(i/n);this.outputShape=[r,a];var o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");var l=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?l="sumValue":"prod"===e?l="prodValue":"all"===e?l="allValue":"any"===e&&(l="anyValue");var u=4*Math.floor(n/4),c=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",p="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var d="";i%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+u+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+u+";\n        if ("+(1===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===c)+") {\n          "+p+" values = "+p+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+l+");\n      }\n    "},Nf=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Xp(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Yp(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Pf=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],a=r[2],o=t.shape,s=o[1],l=o[2],u=[n&&s>1?i-1:i,n&&l>1?a-1:a],c=[n&&s>1?s-1:s,n&&l>1?l-1:l],h=u[0]/c[0],p=u[1]/c[1],d=1/h,f=1/p,m=2*Math.ceil(d)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+l+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(a-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Tf=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],a=t[2];this.outputShape=[t[0],e,n,t[3]];var o=[r&&e>1?i-1:i,r&&n>1?a-1:a],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+o[0]/s[0]+",\n          "+o[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},If=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=t[1],a=t[2],o=t[3];this.outputShape=[t[0],e,n,o];var s=[r&&e>1?i-1:i,r&&n>1?a-1:a],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+s[0]/l[0]+",\n          "+s[1]/l[1]+",\n          "+s[1]/l[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(o-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Af=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],a=r[2],o=t.shape,s=o[1],l=o[2],u=[n&&s>1?i-1:i,n&&l>1?a-1:a],c=[n&&s>1?s-1:s,n&&l>1?l-1:l],h=u[0]/c[0],p=u[1]/c[1],d=1/h,f=1/p,m=2*Math.ceil(d)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+p+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+l+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+u[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+u[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Rf=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],a=t[2];this.outputShape=[t[0],e,n,t[3]];var o=[r&&e>1?i-1:i,r&&n>1?a-1:a],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+o[0]/s[0]+",\n          "+o[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Df=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=td(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},Ff=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=$p("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],a=r[n-2]+" + 1 < "+this.outputShape[n-2],o=td(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+a+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},zf=function(t,e,n,r,i,a,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;var s=td(i.length),l=td(a.length),u="";1===n?u="i":2===n&&(u="i, j");var c="";1===r?c="i":2===r&&(c="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+l+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+u+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+c+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Lf=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,a=t.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),l=n%4,u="\n        sumValue += dot(values, segFilter);\n    ",c="";i%n>0&&(c="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+a+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+a+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+u+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+u+"\n        } else if ("+(2===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+u+"\n        } else if ("+(3===l)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+u+"\n        }\n        setOutput(sumValue);\n      }\n    "},Bf=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var a=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],l=0;l<e.length;l++)s.push(""+a[l]),l<t&&o.push(""+a[l]);r=o.join(),i=s.join()}var u=td(n);this.userCode="\n      void main() {\n        "+u+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},Vf=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=td(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return Uf.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+Uf[e]+" = start["+e+"] + coords."+Uf[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),Uf=["x","y","z","w","u","v"],Wf=function(){function t(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=td(this.rank),n=$p("coords",this.rank),r=$p("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",a="getChannel(getSource("+r.join()+"), "+i+")",o="\n      result.x = "+a+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+a+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+a+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+a+";\n        }\n      }\n    ",l=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+l+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),jf=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=td(n.length),a=td(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+t+");\n      "+i+" strides = "+i+"("+e+");\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},qf=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=Hf(e,n),a=Gf(t,i,n);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[a].shift();return this.usedTextures[a].push(o),o}return this.numUsedTextures++,this.log(),i===Al.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Al.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Al.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Al.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Al.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=Gf(e,Hf(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],o=a.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(o,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function Hf(t,e){if(t===Il.UPLOAD)return Al.PACKED_2X2_FLOAT32;if(t===Il.RENDER||null==t)return function(t){return es().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Al.PACKED_2X2_FLOAT32:Al.UNPACKED_FLOAT32:t?Al.PACKED_2X2_FLOAT16:Al.UNPACKED_FLOAT16}(e);if(t===Il.DOWNLOAD||t===Il.PIXELS)return Al.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function Gf(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var $f=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=td(this.rank),a=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+a+"));\n      }\n    "},Kf=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Xf="if (isnan(x)) return x;",Yf="return abs(x);",Qf=Xf+"\n  return (x < 0.0) ? 0.0 : x;\n",Zf=Xf+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Jf="return (x >= 0.0) ? x : (exp(x) - 1.0);",tm="return -x;",em="return ceil(x);",nm="return floor(x);",rm="return exp(x);",im="return exp(x) - 1.0;",am="return x;",om="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",sm="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",lm="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",um=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},cm=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=$p("rc",e),r=td(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),a=n.slice(-2),o=e<=1?"rc":"vec2("+a.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},hm={};function pm(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?om:Qf;if("elu"===t)return e?lm:Jf;if("relu6"===t)return e?sm:Zf;if("prelu"===t)return e?fd:pd;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var dm=function(t){function e(e){var n,r=t.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!es().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=zl(es().getNumber("WEBGL_VERSION"));r.binaryCache=(n=es().getNumber("WEBGL_VERSION"))in hm?hm[n]:(hm[n]={},hm[n]),r.gpgpu=new pf(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new qf(r.gpgpu),r.numMBBeforeWarning=null==es().global.screen?1024:es().global.screen.height*es().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new up(r,Ml),r}return Yo(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,e,n){if(es().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:Il.UPLOAD}),r},e.prototype.move=function(t,e,n,r){if(es().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:Il.UPLOAD})},e.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,a=e.shape;if(null!=e.slice){var o;o=e.isPacked?new um(a,am):new Kf(a,am);var s=this.runWebGLProgram(o,[{dataId:t,shape:a,dtype:r}],r),l=this.readSync(s.dataId);return this.disposeData(s.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var u,c,h=null!=this.activeTimers;return h&&(u=Ks()),c="complex64"===r?Ep(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=Ks()-u),this.convertAndCacheOnCPU(t,c)},e.prototype.read=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,b;return Zo(this,(function(w){switch(w.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,i=n.shape,a=n.dtype,o=n.complexTensors,s=n.isPacked,null!=n.slice)return l=s?new um(i,am):new Kf(i,am),u=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:a}],a),c=this.read(u.dataId),this.disposeData(u.dataId),[2,c];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!es().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===es().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==a&&es().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),d=this.texData.get(p.dataId),h=(b=this.gpgpu).createBufferFromTexture.apply(b,[d.texture].concat(Bl(i)))),this.pendingRead.set(t,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:w.sent(),w.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([o.real.data(),o.imag.data()])];case 3:return m=w.sent(),f=Ep(m[0],m[1]),[3,5];case 4:null==h?f=this.getValuesFromTexture(t):(g=bs(i),f=this.gpgpu.downloadFloat32MatrixFromBuffer(h,g)),w.label=5;case 5:return null!=p&&this.disposeData(p.dataId),y=this.convertAndCacheOnCPU(t,f),v=this.pendingRead.get(t),this.pendingRead.delete(t),v.forEach((function(t){return t(y)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,y]}}))}))},e.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!jl(n)){if(es().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},e.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,a=n.isPacked,o=bs(r);if(es().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(t),l=this.texData.get(s.dataId),u=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[l.texture].concat(Bl(r))).subarray(0,o);return this.disposeData(s.dataId),u}var c=es().getBool("WEBGL_PACK")&&!0===a,h=c?vu(r):r,p=c?new Vd(h):new Bd(h),d=this.runWebGLProgram(p,[{shape:h,dtype:i,dataId:t}],"float32"),f=this.texData.get(d.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(f.texture,f.texShape[0],f.texShape[1]).subarray(0,o);return this.disposeData(d.dataId),m},e.prototype.time=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r,i,a,o,s;return Zo(this,(function(l){switch(l.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=vs(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),a=vs(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(i)]:[3,2];case 1:return s=l.sent(),o.kernelMs=fs(s),o.getExtraProfileInfo=function(){return s.map((function(t,e){return{name:a[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},[3,3];case 2:o.kernelMs={error:"WebGL query timers are not supported in this environment."},l.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,o]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ks(),endMs:null}},e.prototype.endTimer=function(t){return es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Ks(),t)},e.prototype.getQueryTime=function(t){return Qo(this,void 0,void 0,(function(){var e;return Zo(this,(function(n){return es().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,a=e.usage,o=e.isPacked,s=e.slice,l=s&&s.origDataId||t,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,a,o)));var c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return es().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Ml.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&bs(t.shape)<e}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,e){var n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Ml.keep(t.clone()),imag:Ml.keep(e.clone())},n},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===bs(n))return rc([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=rp(t.shape,e,n);if(r||!i){var a=es().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wf(n):new Vf(n),o=a.getCustomSetupFunc(e);return this.compileAndRun(a,[t],null,o)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},e.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=this.makeOutput(n,t.dtype),a=this.texData.get(i.dataId);Object.assign(a,r),a.shape=n,a.dtype=t.dtype;var o=ip(e,t.strides);r.slice&&(o+=r.slice.flatOffset),a.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(a.slice.origDataId)||1;return this.dataRefCount.set(a.slice.origDataId,s+1),i},e.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=tp(e,n,r);if(i.some((function(t){return 0===t})))return rc([],i);var a=new jf(e,r,i);return this.compileAndRun(a,[t])},e.prototype.reverse=function(t,e){var n=es().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ff(t.shape,e):new Df(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return ec(t)})),r=t.map((function(t){return nc(t)}));return tc(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>es().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(t.length/2),a=this.concat(t.slice(0,i),e),o=this.concat(t.slice(i),e);return this.concat([a,o],e)}if(es().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new wd(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var l=Zu(t.map((function(t){return t.shape})),e),u=t.map((function(t){return t.as2D(-1,bs(t.shape.slice(e)))})),c=new bd(u.map((function(t){return t.shape})));return this.compileAndRun(c,u).reshape(l)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,tm,t.dtype);var e=new Kf(t.shape,tm);return this.compileAndRun(e,[t])},e.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],o=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===i||1===a)&&o>1e3){n&&(t=lp(t,[0,2,1])),r&&(e=lp(e,[0,2,1]));var l=1===a?t:t.as3D(s,o,1),u=1===a?2:1,c=1===a?e.as3D(s,1,o):e;return this.multiply(l,c).sum(u,!0)}var h=bl(t.dtype,e.dtype),p=new wf(t.shape,[s,i,a],n,r);return this.compileAndRun(p,[t,e],h)},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,a=t.bias,o=t.activation,s=t.preluActivationWeights,l=r?e.shape[2]:e.shape[1],u=i?n.shape[1]:n.shape[2],c=e.shape[0],h=bl(e.dtype,n.dtype),p=null!=a,d=null!=s,f=o?pm(o,!0):null,m=new wf(e.shape,[c,l,u],r,i,p,f,d),g=[e,n];return a&&g.push(a),s&&g.push(s),this.compileAndRun(m,g,h)},e.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new ld("return areal * breal - aimag * bimag;",t.shape,e.shape),a=new ld("return areal * bimag + aimag * breal;",t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],s=this.compileAndRun(i,o),l=this.compileAndRun(a,o),u=this.complex(s,l);return s.dispose(),l.dispose(),u}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,hd,t.dtype);var c=new dd(hd,t.shape,e.shape);return this.compileAndRun(c,[t,e],t.dtype)},e.prototype.batchNormalization=function(t,e,n,r,i,a){var o=[t,e,n],s=null;null!=a&&(s=a.shape,o.push(a));var l=null;if(null!=i&&(l=i.shape,o.push(i)),es().getBool("WEBGL_PACK_NORMALIZATION")){var u=new sd(t.shape,e.shape,n.shape,s,l,r);return this.compileAndRun(u,o)}var c=new od(t.shape,e.shape,n.shape,s,l,r);return this.compileAndRun(c,o)},e.prototype.localResponseNormalization4D=function(t,e,n,r,i){var a=es().getBool("WEBGL_PACK_NORMALIZATION")?new yf(t.shape,e,n,r,i):new mf(t.shape,e,n,r,i);return this.compileAndRun(a,[t])},e.prototype.LRNGrad=function(t,e,n,r,i,a,o){var s=new gf(e.shape,r,i,a,o);return this.compileAndRun(s,[e,n,t])},e.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return Qs(t)}));return Vp(kc(t.shape,t.dtype,n),e)}var r=new $f(t.shape,e);return this.compileAndRun(r,[t])},e.prototype.pad=function(t,e,n){var r=es().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sf(t.shape,e,n):new kf(t.shape,e,n);return this.compileAndRun(r,[t])},e.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new Hd(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},e.prototype.batchToSpaceND=function(t,e,n){ms(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=Fc(t.shape,e,r),a=zc(i.length,e.length),o=Lc(t.shape,e,r),s=Bc(n,e.length),l=Vc(o,n,e.length);return lp(t.reshape(i),a).reshape(o).slice(s,l)},e.prototype.spaceToBatchND=function(t,e,n){ms(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var a=1+e.length;a<t.shape.length;++a)i.push([0,0]);var o=t.pad(i),s=Fc(o.shape,e,r,!1),l=zc(s.length,e.length,!1),u=Lc(o.shape,e,r,!1);return lp(o.reshape(s),l).reshape(u)},e.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],a=Kh(i),o=new Mf({windowSize:a,inSize:i,batchSize:r},e),s=this.compileAndRun(o,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)},e.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var a=Kh(i),o=new Hp({windowSize:a,inSize:i,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var l=this.compileAndRun(o,s,"int32");return 1===l.shape[1]?l:this.argReduce(t,e,l)},e.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=Kh(r[r.length-1]),a=new rd(r,i,e,null==n),o=this.compileAndRun(a,null==n?[t]:[t,n],"int32");return o.rank===t.rank?this.argReducePacked(t,e,o):o},e.prototype.sum=function(t,e){$u("sum",e,t.rank);var n=Hu(t.shape,e),r=n[0],i=bs(n[1]),a=t.as2D(-1,i),o=wl(t.dtype);return this.reduce(a,"sum",o).reshape(r)},e.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=Hu(t.shape,e),r=n[0],i=bs(n[1]),a=t.as2D(-1,i),o=wl(t.dtype);return this.reduce(a,"prod",o).reshape(r)},e.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=Ku([r],t.rank),a=t;null!=i&&(a=lp(t,i),r=Yu(1,t.rank)[0]);var o=function(t,e,n){for(var r=[],i=t.length,a=0;a<i;a++)r.push(a!==e?t[a]:n);return r}(a.shape,r,n),s=bs([a.shape[r]]),l=a.as2D(-1,s),u=wl(t.dtype),c=this.segOpCompute(l,"unsortedSegmentSum",e,u,n).reshape(o);return null!=i&&(c=lp(c,Xu(i))),c},e.prototype.segOpCompute=function(t,e,n,r,i){var a=t.shape[0],o=t.shape[1],s=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=Ws(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Ws(t,n+1);return n}(o,i),l=new Lf({windowSize:s,inSize:o,batchSize:a,numSegments:i},e),u=this.compileAndRun(l,[t,n],r);return u.shape[1]===i?u:(n=mc(0,i).tile([o/s]),this.segOpCompute(u,e,n,r,i))},e.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if($u("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!es().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=Hu(t.shape,r),a=i[0],o=bs(i[1]),s=t.as2D(-1,o);return this.argReduce(s,n).reshape(a)}return this.argReducePacked(t,n)},e.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},e.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},e.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new Ad(t.shape,n,r);return this.compileAndRun(i,[t])},e.prototype.equal=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new dd("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.notEqual=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new dd("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new dd("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.lessEqual=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new dd("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new dd("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greaterEqual=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new dd("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalNot=function(t){var e=new Kf(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},e.prototype.logicalAnd=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new dd("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalOr=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new dd("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.select=function(t,e,n){var r=new Bf(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],bl(e.dtype,n.dtype))},e.prototype.where=function(t){Lu("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return Wp(t.shape,e)},e.prototype.topk=function(t,e,n){return Up(t.dataSync(),t.shape,t.dtype,e)},e.prototype.min=function(t,e){$u("min",e,t.rank);var n=Hu(t.shape,e),r=n[0],i=bs(n[1]),a=t.as2D(-1,i);return this.reduce(a,"min",a.dtype).reshape(r)},e.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dd("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.mod=function(t,e){var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dd("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);$u("max",e,t.rank);var n=Hu(t.shape,e),r=n[0],i=bs(n[1]),a=t.as2D(-1,i);return this.reduce(a,"max",a.dtype).reshape(r)},e.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dd("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.all=function(t,e){$u("all",e,t.rank);var n=Hu(t.shape,e),r=n[0],i=bs(n[1]),a=t.as2D(-1,i);return this.reduce(a,"all",a.dtype).reshape(r)},e.prototype.any=function(t,e){$u("any",e,t.rank);var n=Hu(t.shape,e),r=n[0],i=bs(n[1]),a=t.as2D(-1,i);return this.reduce(a,"any",a.dtype).reshape(r)},e.prototype.floorDiv=function(t,e){if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new dd("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")},e.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,ud);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=bl(t.dtype,e.dtype);if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,ud,n);var r=new dd(ud,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.packedUnaryOp=function(t,e,n){var r=new um(t.shape,e);return this.compileAndRun(r,[t],n)},e.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var a=new md(n,t.shape,e.shape,i);return this.compileAndRun(a,[t,e],r)},e.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),a=this.texData.get(e.dataId),o=[[i.complexTensors.real,a.complexTensors.real],[i.complexTensors.imag,a.complexTensors.imag]].map((function(i){var a=i[0],o=i[1],s=r.makeComplexComponentTensorInfo(t,a),l=r.makeComplexComponentTensorInfo(e,o),u=new dd(n,t.shape,e.shape);return r.compileAndRun(u,[s,l],bl(a.dtype,o.dtype))})),s=o[0],l=o[1],u=this.complex(s,l);return s.dispose(),l.dispose(),u},e.prototype.makeComplexComponentTensorInfo=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},e.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>es().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return bl(t,e)})),a=t.map((function(t){return t.shape})),o=es().getBool("WEBGL_PACK")?new qp(t[0].shape,a):new jp(t[0].shape,a);return this.compileAndRun(o,t,i)},e.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,cd);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=bl(t.dtype,e.dtype);if(es().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,cd,t.dtype);var r=new dd(cd,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.pow=function(t,e){var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dd("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=bl(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,em,t.dtype);var e=new Kf(t.shape,em);return this.compileAndRun(e,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,nm,t.dtype);var e=new Kf(t.shape,nm);return this.compileAndRun(e,[t])},e.prototype.sign=function(t){var e=new Kf(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},e.prototype.isNaN=function(t){var e=new Kf(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isInf=function(t){var e=new Kf(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isFinite=function(t){var e=new Kf(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.round=function(t){var e=new Kf(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,rm,t.dtype);var e=new Kf(t.shape,rm);return this.compileAndRun(e,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,im,t.dtype);var e=new Kf(t.shape,im);return this.compileAndRun(e,[t])},e.prototype.softmax=function(t,e){var n=Es([e],t.shape),r=this.max(t,n),i=Gu(r.shape,n),a=this.subtract(t,r.reshape(i)),o=this.exp(a),s=this.sum(o,n).reshape(i);return Gh(o,s)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new Kf(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},e.prototype.log1p=function(t){var e=new Kf(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},e.prototype.sqrt=function(t){var e=new Kf(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new Kf(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},e.prototype.reciprocal=function(t){var e=new Kf(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},e.prototype.relu=function(t){var e;return e=es().getBool("WEBGL_PACK")?new um(t.shape,om):new Kf(t.shape,Qf),this.compileAndRun(e,[t])},e.prototype.relu6=function(t){var e;return e=es().getBool("WEBGL_PACK")?new um(t.shape,sm):new Kf(t.shape,Zf),this.compileAndRun(e,[t])},e.prototype.prelu=function(t,e){var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md(fd,t.shape,e.shape):new dd(pd,t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.elu=function(t){if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,lm,t.dtype);var e=new Kf(t.shape,Jf);return this.compileAndRun(e,[t])},e.prototype.eluDer=function(t,e){var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new dd("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.selu=function(t){var e=new Kf(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},e.prototype.int=function(t){var e=new Kf(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")},e.prototype.clip=function(t,e,n){var r,i=(r=es().getBool("WEBGL_PACK_CLIP")?new yd(t.shape):new gd(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(es().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Yf,t.dtype);var e=new Kf(t.shape,Yf);return this.compileAndRun(e,[t])},e.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new vd(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(t){var e=new Kf(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},e.prototype.softplus=function(t){var e=new Kf(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},e.prototype.sin=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},e.prototype.cos=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},e.prototype.tan=function(t){var e=new Kf(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},e.prototype.asin=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])},e.prototype.acos=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])},e.prototype.atan=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},e.prototype.atan2=function(t,e){var n=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new dd("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.sinh=function(t){var e=new Kf(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.cosh=function(t){var e=new Kf(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.tanh=function(t){var e=new Kf(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},e.prototype.asinh=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},e.prototype.acosh=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},e.prototype.atanh=function(t){var e=new Kf(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},e.prototype.erf=function(t){var e=new Kf(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(e,[t])},e.prototype.step=function(t,e){var n=new Kf(t.shape,function(t){return void 0===t&&(t=0),Xf+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},e.prototype.conv2dByMatMul=function(t,e,n,r,i,a){var o=t.shape,s=this.texData.get(t.dataId),l="channelsLast"===n.dataFormat,u=o[2]%2!=0&&!!s.isPacked;if((1==o[0]*o[1]*o[2]||1===n.outChannels)&&n.inChannels>1e3||!es().getBool("WEBGL_LAZILY_UNPACK")||!es().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!u){var c=this.reshape(t,[1,l?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],n.inChannels]),h=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:c,b:h,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:a}),n.outShape)}var p={dataId:t.dataId,shape:[1,l?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),n.inChannels],dtype:t.dtype},d=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,ms(xu(s.shape,p.shape),(function(){return"packed reshape "+s.shape+" to "+p.shape+" isn't free"}));var f=this.reshape(e,[1,n.inChannels,n.outChannels]),m=this.fusedBatchMatMul({a:p,b:f,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:a}),g=this.texData.get(m.dataId);return ms(g.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=d,g.shape=n.outShape,Ml.makeTensorFromDataId(m.dataId,n.outShape,m.dtype)},e.prototype.conv2dWithIm2Row=function(t,e,n,r,i,a){var o=n.outWidth,s=n.outHeight,l="channelsLast"===n.dataFormat,u=n.filterWidth*n.filterHeight*n.inChannels,c=s*o,h=[u,c],p=t.squeeze([0]),d=e.reshape([1,u,-1]),f=new ff(h,p.shape,n),m=this.compileAndRun(f,[p]).reshape([1,h[0],h[1]]),g=null!=r,y=null!=a,v=i?pm(i,!0):null,b=new wf(m.shape,[1,c,n.outChannels],!0,!1,g,v,y),w=[m,d];return r&&w.push(r),y&&w.push(a),this.compileAndRun(b,w).reshape(l?[1,s,o,n.outChannels]:[1,n.outChannels,s,o])},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,a=t.activation,o=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,i,a,o);if(es().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,i,a,o);var s=null!=i,l=null!=o,u=a?pm(a,!1):null,c=new Md(r,s,u,l),h=[e,n];return i&&h.push(i),o&&h.push(o),this.compileAndRun(c,h)},e.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(es().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new Md(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerInput=function(t,e,n){var r=new _d(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerFilter=function(t,e,n){var r=new Cd(n);return this.compileAndRun(r,[t,e])},e.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,i=t.convInfo,a=t.bias,o=t.activation,s=t.preluActivationWeights,l=es().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,u=o?pm(o,l):null,c=[n,r],h=null!=a,p=null!=s;return h&&c.push(a),p&&c.push(s),l?(e=new Td(i,h,u,p),this.compileAndRun(e,c)):(e=new Pd(i,h,u,p),this.compileAndRun(e,c))},e.prototype.depthwiseConv2D=function(t,e,n){var r;return es().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Td(n),this.compileAndRun(r,[t,e])):(r=new Pd(n),this.compileAndRun(r,[t,e]))},e.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new Ed(n);return this.compileAndRun(r,[t,e])},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new Od(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3d=function(t,e,n){var r=new Nd(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerInput=function(t,e,n){var r=new Sd(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerFilter=function(t,e,n){var r=new kd(n);return this.compileAndRun(r,[t,e])},e.prototype.maxPool=function(t,e){var n=new Of(e,"max",!1);return this.compileAndRun(n,[t])},e.prototype.avgPool=function(t,e){var n=new Of(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPoolBackprop=function(t,e,n,r){var i=new Of(r,"max",!0),a=this.compileAndRun(i,[e]),o=new vf(r),s=this.compileAndRun(o,[t,a],e.dtype);return a.dispose(),s},e.prototype.avgPoolBackprop=function(t,e,n){var r=new id(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.cast=function(t,e){return kp(t,e,this)},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,a=0;a<t.rank;a++)a!==e&&(r[i++]=t.shape[a]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var l=new Array(n);for(a=0;a<l.length;a++)o[e]=a,l[a]=this.slice(t,o,s).reshape(r);return l},e.prototype.avgPool3d=function(t,e){var n=new Ef(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,e,n){var r=new ad(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.maxPool3d=function(t,e){var n=new Ef(e,"max",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,e,n,r){var i=new Ef(r,"max",!0),a=this.compileAndRun(i,[e]),o=new bf(r),s=this.compileAndRun(o,[t,a],e.dtype);return a.dispose(),s},e.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!xu(t.shape,e)&&(null===n.texture||!xu(n.shape,e))){var r=this.packedReshape(t,e);return Ml.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Sp(t,e)},e.prototype.resizeBilinear=function(t,e,n,r){var i=es().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new If(t.shape,e,n,r):new Tf(t.shape,e,n,r);return this.compileAndRun(i,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,e,n){var r=new Pf(t,e,n);return this.compileAndRun(r,[t])},e.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new Rf(t.shape,e,n,r);return this.compileAndRun(i,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new Af(t,e,n);return this.compileAndRun(r,[t])},e.prototype.multinomial=function(t,e,n,r){var i=e?t:op(t),a=new xf(i.shape[0],i.shape[1],n),o=a.getCustomSetupFunc(r);return this.compileAndRun(a,[i],"int32",o)},e.prototype.oneHot=function(t,e,n,r){var i=new Cf(t.size,e,n,r);return this.compileAndRun(i,[t])},e.prototype.diag=function(t){var e=new Ld(t.size);return this.compileAndRun(e,[t])},e.prototype.nonMaxSuppression=function(t,e,n,r,i){return Lu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Ap(t.dataSync(),e.dataSync(),n,r,i)},e.prototype.cropAndResize=function(t,e,n,r,i,a){var o=new Id(t.shape,e.shape,r,i,a);return this.compileAndRun(o,[t,e,n],"float32")},e.prototype.depthToSpace=function(t,e,n){ms(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,a=("NHWC"===n?t.shape[2]:t.shape[3])*e,o=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),s=new zd("NHWC"===n?[r,i,a,o]:[r,o,i,a],e,n);return this.compileAndRun(s,[t])},e.prototype.split=function(t,e,n){return Bp(t,e,n)},e.prototype.scatterND=function(t,e,n){var r=Qh(0,t,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,l=r.outputSize,u=[l/o,o],c=t.reshape([a,i]),h=e.reshape([a,o]);if(0===l)return Sp(rc([]),n);var p=ac(0),d=new zf(a,i,c.rank,h.rank,s,u);return this.compileAndRun(d,[h,c,p]).reshape(n)},e.prototype.sparseToDense=function(t,e,n,r){var i=Qh(0,t,n),a=new zf(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(a,[e,t,r]).reshape(n)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new jd("return real * expR - imag * expI;",t.shape,e),i=new jd("return real * expI + imag * expR;",t.shape,e),a=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],o=this.compileAndRun(r,a),s=this.compileAndRun(i,a),l=this.complex(o,s).as2D(t.shape[0],t.shape[1]);return o.dispose(),s.dispose(),l},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=$h(t,e),a=i[0],o=i[1],s=i[2],l=i[3],u=e.reshape([o,r]),c=t.reshape([t.size/s,s]),h=new Gd(r,l,[o,s]);return this.compileAndRun(h,[c,u]).reshape(a)},e.prototype.fill=function(t,e,n){if("string"===(n=n||Vs(e))){var r=Ps(n,bs(t));return r.fill(e),Ml.makeTensor(r,t,n,this)}var i=new qd(t,e),a=i.getCustomSetupFunc(e);return this.compileAndRun(i,[],n,a)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},e.prototype.linspace=function(t,e,n){return Op(t,e,n)},e.prototype.makeTensorInfo=function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}},e.prototype.makeOutput=function(t,e){var n=this.makeTensorInfo(t,e).dataId;return Ml.makeTensorFromDataId(n,t,e,this)},e.prototype.unpackTensor=function(t){var e=new cm(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},e.prototype.packTensor=function(t){var e=new _f(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,e){var n=[gu(t.shape)].concat(yu(t.shape)),r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[gu(e)].concat(yu(e)),a=new Nf(i,n),o=this.runWebGLProgram(a,[r],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}},e.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,a=n.dtype,o=vu(i);return e=r?new Fd(o):new Dd(o),{dtype:a,shape:i,dataId:this.runWebGLProgram(e,[{shape:o,dtype:a,dataId:t}],a,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,e,n,r,i){var a=this;void 0===i&&(i=!1);var o=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(o.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===Tl.DENSE){var l=Bl(t.outputShape);s.texShape=l.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===bs(o.shape))return s.values=Ns(o.dtype,0),o;var u=[],c=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&bs(e.shape)<=es().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?a.unpackTensor(e):a.packTensor(e),u.push(e),n=a.texData.get(e.dataId);else if(n.isPacked&&!xu(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=a.packedReshape(e,i),u.push(e),n=a.texData.get(e.dataId),r.shape=i}return a.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var h,p={shape:o.shape,texData:s,isUniform:!1},d=function(t,e,n){var r="";return e.concat(n).forEach((function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)})),t.constructor.name+"_"+r+"_"+t.userCode}(t,c,p),f=this.getAndSaveBinary(d,(function(){return function(t,e,n,r){var i=e.userCode,a=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=a.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},l=function(t,e,n,r){var i=[];t.forEach((function(t){var e=bs(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var a,o,s=i.join("\n"),l=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+Kp().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=Kp();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+a.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,a=i[0],o=i[1],s=Kp();if(null!=i&&ws(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+a+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+l[0]+", "+l[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===n[0]){var s=ed(e,n.slice(1));return"\n        "+t(s)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+nd(["b","row","col"],[1,2])+");\n        }\n      "}var l=o[0],u=o[1],c=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+l+", "+u+", "+c*Math.ceil(n[1]/2)+", "+c+", b, row, col);\n      return "+Kp().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],s=o[0],l=o[1],u=Math.ceil(e[n-1]/2),c=u*Math.ceil(e[n-2]/2),h="int b, int row, int col",p="b * "+c+" + (row / 2) * "+u+" + (col / 2)",d=2;d<n-1;d++)h="int b"+d+", "+h,p="b"+d+" * "+(c*=e[n-d-1])+" + "+p;return"\n    vec4 "+i+"("+h+") {\n      int index = "+p+";\n      int texR = index / "+l+";\n      int texC = index - texR * "+l+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+l+", "+s+");\n      return "+Kp().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+Zp(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Jp(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],a=r[1];if(1===a&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=Zp(e);return 1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+a+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+a+", index + "+o+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(null!=a&&ws(n,a))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+a[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var o=Ms(n),s=o.newShape,l=o.keptDims;if(s.length<n.length){var u=ed(e,s);return"\n      "+t(u)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+nd(["row","col"],l)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+Jp(e)+"\n      }\n    ";var c=a[0],h=a[1],p=Zp(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+p+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+c+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===c?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+p+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+p+";\n    vec2 uv = uvFromFlat("+c+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],o=n[2],s=Ms(n),l=s.newShape,u=s.keptDims;if(l.length<n.length){var c=ed(e,l);return"\n        "+t(c)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+nd(["row","col","depth"],u)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+o+", 1)));\n        "+Jp(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,p=h[0],d=h[1],f=e.shapeInfo.flatOffset;return d===a&&null==f?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+o+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+d+".0, "+p+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":d===o&&null==f?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+d+".0, "+p+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+o+" + depth + "+Zp(r)+";\n        vec2 uv = uvFromFlat("+p+", "+d+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],o=n[2]*a,s=n[1]*o,l=Ms(n),u=l.newShape,c=l.keptDims;if(u.length<n.length){var h=ed(e,u);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+nd(["row","col","depth","depth2"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+s+", "+o+", "+a+", 1)));\n        "+Jp(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],m=d[1];return m===s&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+o+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+f+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===a&&null==p?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+f+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+f+", "+m+", index + "+Zp(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n[4],o=n[3]*a,s=n[2]*o,l=n[1]*s,u=Ms(n),c=u.newShape,h=u.keptDims;if(c.length<n.length){var p=ed(e,c);return"\n      "+t(p)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+nd(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+l+", "+s+", "+o+", "+a+")) +\n          depth3;\n        "+Jp(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,m=f[0],g=f[1];return g===l&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+s+", "+o+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===a&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+l+" + col * "+s+" + depth * "+o+" +\n          depth2 * "+a+" + depth3 + "+Zp(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=Ms(n),o=a.newShape,s=a.keptDims;if(o.length<n.length){var l=ed(e,o);return"\n      "+t(l)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+nd(["row","col","depth","depth2","depth3","depth4"],s)+");\n      }\n    "}var u=n[5],c=n[4]*u,h=n[3]*c,p=n[2]*h,d=n[1]*p;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+d+", "+p+", "+h+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+u+", 1)));\n        "+Jp(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,g=m[0],y=m[1];return y===d&&null==f?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+p+", "+h+", "+c+", "+u+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+y+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":y===u&&null==f?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+y+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+d+" + col * "+p+" + depth * "+h+" +\n          depth2 * "+c+" + depth3 * "+u+" + depth4 + "+Zp(r)+";\n      vec2 uv = uvFromFlat("+g+", "+y+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,a=i.charAt(0).toUpperCase()+i.slice(1),o="get"+a+"AtOutCoords",s=t.shapeInfo.logicalShape.length,l=e.logicalShape.length,u=Gc(t.shapeInfo.logicalShape,e.logicalShape),c=td(l),h=l-s,p=["x","y","z","w","u","v"];n=0===s?"":l<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+p[t+h]+" = 0;"})).join("\n"),r=l<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+p[e+h]})).join(", ");var d="return outputValue;",f=1===bs(t.shapeInfo.logicalShape),m=1===bs(e.logicalShape);if(1!==s||f||m){if(f&&!m)d=1===l?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var g=s-2,y=s-1;u.indexOf(g)>-1&&u.indexOf(y)>-1?d="return vec4(outputValue.x);":u.indexOf(g)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(y)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+o+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+r+");\n      "+d+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",a=t.shapeInfo.logicalShape.length,o=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===o&&null==t.shapeInfo.flatOffset&&ws(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var s=td(o),l=Gc(t.shapeInfo.logicalShape,e.logicalShape),u=o-a,c=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+s+" coords = getOutputCoords();\n      "+(0===a?"":o<2&&l.length>=1?"coords = 0;":l.map((function(t){return"coords."+c[t+u]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(o<2&&a>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+c[e+u]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),u=e.texShape,c=Kp(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(c),p=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+t.defineSpecialNaN+"\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    \nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n    \nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  "}(c);return e.isPacked?(a=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(ws(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(a=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+a+");\n      int c = imod(index, "+a+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),a=i,o="",s="b, r, c",l=2;l<t.length-1;l++)o="\n      int b"+l+" = index / "+(a*=t[t.length-l-1])+";\n      index -= b"+l+" * "+a+";\n    "+o,s="b"+l+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,i,a,o}(e.logicalShape,u),o=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(c)):(a=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return ws(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=Xp(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=Xp(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=Xp(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=Xp(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,u),o=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(c)),r&&(p+="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n"),[p,h,o,s,a,l,n].join("\n")}(a,s,i,e.packedInputs),u=t.createProgram(l),c=null,h=t.getUniformLocation(u,"NAN",!1);1===es().getNumber("WEBGL_VERSION")&&(c=t.getUniformLocation(u,"INFINITY",!1));for(var p={},d=0;d<e.variableNames.length;d++){var f=e.variableNames[d];p[f]=t.getUniformLocation(u,f,!1),p["offset"+f]=t.getUniformLocation(u,"offset"+f,!1)}return{program:e,source:l,webGLProgram:u,uniformLocations:p,inShapeInfos:o,outShapeInfo:s,infLoc:c,nanLoc:h}}(a.gpgpu,t,c,p)})),m=null!=this.activeTimers;if(m&&(h=this.startTimer()),function(t,e,n,r,i){df(e.inShapeInfos,n),df([e.outShapeInfo],[r]);var a=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(a,o[0],o[1]):t.setOutputMatrixTexture(a,o[0],o[1]),t.setProgram(e.webGLProgram),1===es().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],a=e.uniformLocations[i],o=e.uniformLocations["offset"+i];if(null!=a)if(n.isUniform)if(bs(n.shape)<2)t.gl.uniform1f(a,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(a,s)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,a,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,f,c,p,r),u.forEach((function(t){return a.disposeData(t.dataId)})),m&&(h=this.endTimer(h),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(h)})),!es().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var g=this.unpackTensor(o);return this.disposeData(o.dataId),g}return o},e.prototype.compileAndRun=function(t,e,n,r,i){void 0===i&&(i=!1);var a=this.runWebGLProgram(t,e,n=n||e[0].dtype,r,i);return Ml.makeTensorFromDataId(a.dataId,a.shape,a.dtype)},e.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(es().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Du((function(){if(!es().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=es().getBool("DEBUG");es().set("DEBUG",!1);var n=t.abs(ac(1e-8)).dataSync()[0];if(es().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,a=n.values,o=n.usage,s=n.isPacked;if(null==n.texture){var l,u=null!=this.activeTimers;u&&(l=Ks());var c=n.texShape;if(null==c&&(c=bu(r,s),n.texShape=c),null!=a){var h=vu(r),p=void 0,d=c[1],f=c[0],m=a instanceof Uint8Array;s?(d=(e=Vl(c[0],c[1]))[0],p=new Wd(h,[f=e[1],d],m)):p=new Ud(h,[f,d],m);var g=this.makeTensorInfo([f,d],i);this.texData.get(g.dataId).usage=m?Il.PIXELS:Il.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,f,a);var y=this.runWebGLProgram(p,[g],i,null,!0),v=this.texData.get(y.dataId);n.texture=v.texture,n.texShape=v.texShape,n.isPacked=v.isPacked,n.usage=v.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,u&&(this.uploadWaitMs+=Ks()-l)}else{var b=this.acquireTexture(c,o,i,s);n.texture=b}}},e.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},e.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},e.prototype.computeBytes=function(t,e){return t[0]*t[1]*Ds(e)},e}(cp);function fm(t,e){return t(e={exports:{}},e.exports),e.exports}Nl()&&Ml.registerBackend("webgl",(function(){return new dm}),2),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var mm=fm((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var n=new r(t),a=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.alea=a}(0,t)})),gm=fm((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xor128=a}(0,t)})),ym=fm((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xorwow=a}(0,t)})),vm=fm((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&(a.x&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xorshift7=a}(0,t)})),bm=fm((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n=i[a]=(n^=n>>>15)^(t^=t>>>12),e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=0==(n=s[127&a]^=r+(o=o+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=o,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&(a.X&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.xor4096=a}(0,t)})),wm=fm((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:this.tychei=a}(0,t)})),xm=fm((function(t){!function(e,r){var i,a=this,o=256,s="random",l=r.pow(o,6),u=r.pow(2,52),c=2*u,h=255;function p(t,n,h){var p=[],y=m(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,g(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=a.navigator,r=n&&n.plugins;return[+new Date,a,r,a.screen,g(e)]}}():t,3),p),v=new d(p),b=function(){for(var t=v.g(6),e=l,n=0;t<u;)t=(t+n)*o,e*=o,n=v.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|v.g(4)},b.quick=function(){return v.g(4)/4294967296},b.double=b,m(g(v.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&f(i,v),t.state=function(){return f(v,{})}),n?(r[s]=t,e):t})(b,y,"global"in n?n.global:this==r,n.state)}function d(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=h&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*o+s[h&(s[i]=s[a=h&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(r["seed"+s]=p,m(r.random(),e),t.exports){t.exports=p;try{i=n(1)}catch(t){}}}([],Math)}));xm.alea=mm,xm.xor128=gm,xm.xorwow=ym,xm.xorshift7=vm,xm.xor4096=bm,xm.tychei=wm;var Cm=xm.alea,_m=Ju({addN_:function(t){ms(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),ms(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return Uu(t,"tensors"+e,"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!ws(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),Ml.runKernelFunc((function(t,n){return t.addN(e)}),e,null,"AddN")}});function km(){Au("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function Sm(t){return 0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function Om(t,e,n,r,i,a){null==a&&(a=.001);var o,s,l=Uu(t,"x","batchNorm"),u=Uu(e,"mean","batchNorm"),c=Uu(n,"variance","batchNorm");return null!=i&&(o=Uu(i,"scale","batchNorm")),null!=r&&(s=Uu(r,"offset","batchNorm")),ms(u.rank===c.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),ms(null==s||u.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),ms(null==o||u.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),Ml.runKernelFunc((function(t,e){var n=Sm(l),r=t.batchNormalization(n,Em(u),Em(c),a,Em(o),Em(s));return e([l,u,c,o]),r}),{x:l,scale:o,offset:s,mean:u,variance:c},null,"FusedBatchNorm",{varianceEpsilon:a}).reshape(l.shape)}function Em(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}var Mm=Ju({batchNormalization_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),km(),Om(t,e,n,a,i,r)}}),Nm=Ju({batchNorm_:Om});function Pm(t,e,n,r,i,a){var o,s,l=Uu(t,"x","batchNorm"),u=Uu(e,"mean","batchNorm"),c=Uu(n,"variance","batchNorm");return null!=i&&(o=Uu(i,"scale","batchNorm")),null!=r&&(s=Uu(r,"offset","batchNorm")),ms(2===l.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."})),ms(2===u.rank||1===u.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+u.rank+"."})),ms(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."})),null!=o&&ms(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&ms(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),Nm(l,u,c,s,o,a)}var Tm=Ju({batchNormalization2d_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),km(),Pm(t,e,n,a,i,r)}}),Im=Ju({batchNorm2d_:Pm});function Am(t,e,n,r,i,a){var o,s,l=Uu(t,"x","batchNorm"),u=Uu(e,"mean","batchNorm"),c=Uu(n,"variance","batchNorm");return null!=i&&(o=Uu(i,"scale","batchNorm")),null!=r&&(s=Uu(r,"offset","batchNorm")),ms(3===l.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+l.rank+"."})),ms(3===u.rank||1===u.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+u.rank+"."})),ms(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."})),null!=o&&ms(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&ms(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),Nm(l,u,c,s,o,a)}var Rm=Ju({batchNormalization3d_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),km(),Am(t,e,n,a,i,r)}}),Dm=Ju({batchNorm3d_:Am});function Fm(t,e,n,r,i,a){var o,s,l=Uu(t,"x","batchNorm"),u=Uu(e,"mean","batchNorm"),c=Uu(n,"variance","batchNorm");return null!=i&&(o=Uu(i,"scale","batchNorm")),null!=r&&(s=Uu(r,"offset","batchNorm")),ms(4===l.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+l.rank+"."})),ms(4===u.rank||1===u.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+u.rank+"."})),ms(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."})),null!=o&&ms(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&ms(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),Nm(l,u,c,s,o,a)}var zm=Ju({batchNormalization4d_:function(t,e,n,r,i,a){return void 0===r&&(r=.001),km(),Fm(t,e,n,a,i,r)}}),Lm=Ju({batchNorm4d_:Fm}),Bm=Ju({broadcastTo_:function(t,e){var n=Uu(t,"broadcastTo","x"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=n.reshape(i)}for(var a=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(a[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var l=o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0}));return 0===l.length?n.clone():Ml.runKernelFunc((function(t){return t.tile(n,o)}),{x:n},(function(t){return{x:function(){return t.sum(l,!0)}}}),jc,{shape:e,inputShape:a})}}),Vm=Ju({clone_:function(t){var e=Uu(t,"x","clone",null);return Ml.runKernelFunc((function(){return Ml.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{x:e},null,qc)}}),Um=Ju({logicalAnd_:function(t,e){var n=Uu(t,"a","logicalAnd","bool"),r=Uu(e,"b","logicalAnd","bool");return Kc(n.shape,r.shape),Ml.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),Wm=Ju({logicalNot_:function(t){var e=Uu(t,"x","logicalNot","bool");return Ml.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),jm=Ju({logicalOr_:function(t,e){var n=Uu(t,"a","logicalOr","bool"),r=Uu(e,"b","logicalOr","bool");return Kc(n.shape,r.shape),Ml.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),qm=Ju({logicalXor_:function(t,e){var n=Uu(t,"a","logicalXor","bool"),r=Uu(e,"b","logicalXor","bool");return Kc(n.shape,r.shape),jm(t,e).logicalAnd(Um(t,e).logicalNot())}}),Hm=Ju({where_:function(t,e,n){var r=Uu(e,"a","where"),i=Uu(n,"b","where"),a=Uu(t,"condition","where","bool");return gs(r.shape,i.shape,"Error in where: "),1===a.rank?ms(a.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):gs(a.shape,i.shape,"Error in where: "),Ml.runKernelFunc((function(t,e){var n=t.select(a,r,i);return e([a]),n}),{$condition:a,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return yc(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),Gm=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r;return Zo(this,(function(i){switch(i.label){case 0:return[4,(e=Uu(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=Wp(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},$m=Ju({divNoNan_:function(t,e){var n,r=Uu(t,"a","div"),i=Uu(e,"b","div");r=(n=xl(r,i))[0];var a=Gh(r,i=n[1]),o=yc(a),s=i.equal(o);return Hm(s,o,a)}}),Km=Ju({tile_:function(t,e){var n=Uu(t,"x","tile",null);return ms(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),Ml.runKernelFunc((function(t,r){var i=t.tile(n,e);return r([n]),i}),{x:n},null,"Tile",{reps:e},[n])}}),Xm=Ju({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=kc([t,e],r),a=t<=e?t:e,o=0;o<a;++o)i.set(1,o,o);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return Km(Nc(s,0),[n[0],1,1]);if(2===n.length)return Km(Nc(Nc(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Km(Nc(Nc(Nc(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Ym=Ju({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=Uu(t,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+a+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?i.as2D(1,-1):i,l=Ml.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===o?l.as1D():l}}),Qm=Ju({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=Uu(t,"indices","oneHot","int32"),a=i.shape.concat([e]),o={indices:i=i.flatten()};return Ml.runKernelFunc((function(t,a){return a([i]),t.oneHot(i,e,n,r)}),o,null,"OneHot",{depth:e,onValue:n,offValue:r}).reshape(a)}}),Zm=Ju({pad_:function(t,e,n){void 0===n&&(n=0);var r=Uu(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return Ml.runKernelFunc((function(t,i){return i([r]),t.pad(r,e,n)}),{x:r},null,"PadV2",{paddings:e,constantValue:n})}}),Jm=Ju({pad1d_:function(t,e,n){return void 0===n&&(n=0),ms(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Zm(t,[e],n)}}),tg=Ju({pad2d_:function(t,e,n){return void 0===n&&(n=0),ms(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Zm(t,e,n)}}),eg=Ju({pad3d_:function(t,e,n){return void 0===n&&(n=0),ms(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Zm(t,e,n)}}),ng=Ju({pad4d_:function(t,e,n){return void 0===n&&(n=0),ms(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Zm(t,e,n)}}),rg=Ju({rand_:function(t,e,n){var r=bs(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var a=0;a<r;a++)i[a]=e();return Ml.makeTensor(i,t,n)}});function ig(){return 32===Ml.backend.floatPrecision()?.001:.1}function ag(t,e,n){var r=!0;if((Rs(t)||Rs(e))&&(r=!1),Rs(t)&&Rs(e)&&(r=!0),r){var i=t.constructor.name,a=e.constructor.name;if(i!==a)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+a)}if(Array.isArray(t)&&Array.isArray(e)){var o=Bu(t),s=Bu(e);if(!ws(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var l=Rs(t)?t:vs(t),u=Rs(e)?e:vs(e);if(l.length!==u.length)throw new Error("Arrays have different lengths actual: "+l.length+" vs expected: "+u.length+".\nActual:   "+l+".\nExpected: "+u+".");for(var c=0;c<u.length;++c){var h=l[c],p=u[c];if(!n(h,p))throw new Error("Arrays differ: actual["+c+"] = "+h+", expected["+c+"] = "+p+".\nActual:   "+l+".\nExpected: "+u+".")}}function og(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=ig()),ag(t,e,(function(t,e){return og(t,e,n)}))},testEpsilon:ig,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return zs(t)||zs(t[0])||zs(e)||zs(e[0])?ag(t,n,(function(t,e){return t==e})):ag(t,e,(function(t,e){return og(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=ig()),!og(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}});var sg=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Cm(a.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,a=void 0,o=void 0;do{o=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),lg=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=Cm(i.toString()),this.randn=new sg(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,a;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-(a*=a*a)+Math.log(a)),(i=this.randu())<e||Math.log(i)<n)break}return a*=1/this.beta*this.d,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),ug=function(){function t(t,e,n,r){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Cm(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}(),cg=Ju({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var a=new lg(e,n,r,i),o=kc(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),hg=Ju({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var a=new sg(e,n,r,!1,i),o=kc(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),pg=Ju({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var a=kc(t,r),o=new ug(e,n,null,i),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),dg=Ju({square_:function(t){var e=Uu(t,"x","square");return Ml.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},null,"Square",{},[e],[])}}),fg=Ju({squaredDifference_:function(t,e){var n,r=Uu(t,"a","squaredDifference"),i=Uu(e,"b","squaredDifference");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1],i=ac(2);return{a:function(){return t.mul(n.sub(r).mul(i))},b:function(){return t.mul(r.sub(n).mul(i))}}}),Wc,{},[r,i],[])}}),mg=Ju({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var a=new sg(e,n,r,!0,i),o=kc(t,r),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),gg=Ju({equal_:function(t,e){var n,r=Uu(t,"a","equal"),i=Uu(e,"b","equal");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),yg=Ju({equalStrict_:function(t,e){var n=Uu(t,"a","equalStrict"),r=Uu(e,"b","equalStrict");return gs(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),vg=Ju({greater_:function(t,e){var n,r=Uu(t,"a","greater"),i=Uu(e,"b","greater");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t){return t.greater(r,i)}),{a:r,b:i},null,"Greater")}}),bg=Ju({greaterEqual_:function(t,e){var n,r=Uu(t,"a","greaterEqual"),i=Uu(e,"b","greaterEqual");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return yc(n)},b:function(){return yc(r)}}}),"GreaterEqual")}}),wg=Ju({greaterEqualStrict_:function(t,e){var n=Uu(t,"a","greaterEqualStrict"),r=Uu(e,"b","greaterEqualStrict");return gs(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),xg=Ju({greaterStrict_:function(t,e){var n=Uu(t,"a","greaterStrict"),r=Uu(e,"b","greaterStrict");return gs(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Cg=Ju({less_:function(t,e){var n,r=Uu(t,"a","less"),i=Uu(e,"b","less");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t){return t.less(r,i)}),{a:r,b:i},null,"Less")}}),_g=Ju({lessEqual_:function(t,e){var n,r=Uu(t,"a","lessEqual"),i=Uu(e,"b","lessEqual");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t,e){var n=t.lessEqual(r,i);return e([r,i]),n}),{a:r,b:i},null,"LessEqual")}}),kg=Ju({lessEqualStrict_:function(t,e){var n=Uu(t,"a","lessEqualStrict"),r=Uu(e,"b","lessEqualStrict");return gs(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Sg=Ju({lessStrict_:function(t,e){var n=Uu(t,"a","lessStrict"),r=Uu(e,"b","lessStrict");return gs(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),Og=Ju({notEqual_:function(t,e){var n,r=Uu(t,"a","notEqual"),i=Uu(e,"b","notEqual");return n=xl(r,i),Kc((r=n[0]).shape,(i=n[1]).shape),Ml.runKernelFunc((function(t){return t.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),Eg=Ju({notEqualStrict_:function(t,e){var n=Uu(t,"a","notEqualStrict"),r=Uu(e,"b","notEqualStrict");return gs(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Mg(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Ng(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var Pg=Ju({gather_:function(t,e,n){void 0===n&&(n=0);var r=Uu(t,"x","gather"),i=Uu(e,"indices","gather","int32");n=Es(n,r.shape)[0];var a=function(t,e,n){for(var r=t.shape[n],i=[],a=1,o=1,s=0;s<n;s++)i.push(t.shape[s]),a*=t.shape[s];for(s=0;s<e.rank;s++)i.push(e.shape[s]);for(s=n+1;s<t.rank;s++)i.push(t.shape[s]),o*=t.shape[s];return{batchSize:a,sliceSize:o,dimSize:r,outputShape:i}}(r,i,n);return Ml.runKernelFunc((function(t,e){var a=t.gather(r,i.flatten(),n);return e([i]),a}),{x:r,indices:i},(function(t,e){var i=e[0];return{x:function(){var e=r.shape,a=i.size,o=e.slice(0,n),s=o.length,l=e.slice(n,e.length).slice(1),u=l.length,c=Mg(0,s),h=Mg(s+1,s+1+u),p=Ng([o,[a],l]),d=t.reshape(p),f=i.reshape([a]),m=Ng([[s],c,h]),g=d.transpose(m),y=Tg(g,f,r.shape[n]),v=Xu(m);return y.transpose(v)},indices:function(){return i}}}),"Gather",{axis:n}).reshape(a.outputShape)}}),Tg=Ju({unsortedSegmentSum_:function(t,e,n){var r=Uu(t,"x","unsortedSegmentSum"),i=Uu(e,"segmentIds","unsortedSegmentSum","int32");return ms(xs(n),(function(){return"numSegments must be of dtype int"})),Ml.runKernelFunc((function(t,e){var a=t.unsortedSegmentSum(r,i,n);return e([i]),a}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=Ah(e,yc(e)),r=Pg(t,n),i=bg(e,ac(0,"int32")),a=r.rank-i.rank,o=0;o<a;++o)i=Nc(i,o+1);i=Um(i,hc(r.shape,"bool"));var s=yc(r);return Hm(i,r,s)}(t,n)}}}))}});function Ig(t,e,n,r,i,a,o){void 0===a&&(a="NHWC"),ms(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,l=e,u=!1;3===e.rank&&(u=!0,l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),ms(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),ms(4===l.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+l.rank})),ms(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var c="NHWC"===a?s[3]:s[1],h="NHWC"===a?l.shape[3]:l.shape[1];ms(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."})),ms(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&ms(xs(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var p=_p(a),d=fp(s,n.shape,r,1,i,o,!1,p),f=Ml.runKernelFunc((function(t,e){var r=t.conv2dDerInput(l,n,d);return e([n,l]),r}),{dy4D:l,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return Fg(t,n,r,i,a,1,o)},filter:function(){return Lg(t,s,n.shape,r,i,a,o)}}}));return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function Ag(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}function Rg(t,e,n,r,i){ms(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var a=t,o=e,s=!1;4===e.rank&&(s=!0,o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),a=[1,t[0],t[1],t[2],t[3]]);var l=a[4],u=o.shape[4];ms(5===a.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+a.length+"."})),ms(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),ms(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),ms(l===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[3]+"."})),ms(u===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+u+") must match output depth for filter "+n.shape[4]+"."}));var c=mp(a,n.shape,r,1,i),h=Ml.runKernelFunc((function(t){return t.conv3dDerInput(o,n,c)}),{dy5D:o});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var Dg=Ju({conv1d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NWC"),void 0===a&&(a=1);var s=Uu(t,"x","conv1d"),l=Uu(e,"filter","conv1d"),u=s,c=!1;2===s.rank&&(c=!0,u=s.as3D(1,s.shape[0],s.shape[1])),ms(3===u.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+u.rank+"."})),ms(3===l.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+l.rank+"."})),null!=o&&ms(xs(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),ms(u.shape[2]===l.shape[1],(function(){return"Error in conv1d: depth of input ("+u.shape[2]+") must match input depth for filter "+l.shape[1]+"."})),ms(Cp(n,a),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+a+"'"})),ms("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=l.as4D(1,l.shape[0],l.shape[1],l.shape[2]),p=u.as4D(u.shape[0],1,u.shape[1],u.shape[2]),d=Fg(p,h,[1,n],r,"NHWC",[1,a],o);return c?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),Fg=Ju({conv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=Uu(t,"x","conv2d"),l=Uu(e,"filter","conv2d"),u=s,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),ms(4===u.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+u.rank+"."})),ms(4===l.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+l.rank+"."})),null!=o&&ms(xs(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var h="NHWC"===i?u.shape[3]:u.shape[1];ms(h===l.shape[2],(function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+l.shape[2]+"."})),ms(Cp(n,a),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}));var p=_p(i),d=fp(u.shape,l.shape,n,a,r,o,!1,p),f=Ml.runKernelFunc((function(t,e){var n=t.conv2d(u,l,d);return e([l,u]),n}),{x:u,filter:l},(function(t,e){var o=e[0],s=e[1];return ms(xp(a),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"})),{x:function(){return Bg(s.shape,t,o,n,r,i)},filter:function(){return Lg(s,t,o.shape,n,r,i)}}}),"Conv2D",d,[l,u]);return c?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}}),zg=Ju({conv3d_:function(t,e,n,r,i,a){void 0===i&&(i="NDHWC"),void 0===a&&(a=[1,1,1]);var o=Uu(t,"x","conv3d"),s=Uu(e,"filter","conv3d"),l=o,u=!1;4===o.rank&&(u=!0,l=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),ms(5===l.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+l.rank+"."})),ms(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),ms(l.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+l.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),ms(function(t,e){return Ag(t)||Ag(e)}(n,a),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),ms("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var c=mp(l.shape,s.shape,n,a,r),h=Ml.runKernelFunc((function(t,e){var n=t.conv3d(l,s,c);return e([l,s]),n}),{x:l,$filter:s},(function(t,e){ms(Ag(a),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+a+"'"}));var i=e[0],o=e[1];return{x:function(){return Rg(i.shape,t,o,n,r)},$filter:function(){return function(t,e,n,r,i){var a=t;4===t.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var o=e;4===o.rank&&(o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),ms(5===a.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+a.shape+"."})),ms(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),ms(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),ms(a.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+a.shape[4]+") must match input depth in filter ("+n[3]+"."})),ms(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=mp(a.shape,n,r,1,i);return Ml.runKernelFunc((function(t){return t.conv3dDerFilter(a,o,s)}),{x5D:a,dy5D:o})}(i,t,o.shape,n,r)}}}));return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Lg=Ju({conv2dDerFilter_:function(t,e,n,r,i,a,o){void 0===a&&(a="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var l=e;3===l.rank&&(l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),ms(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),ms(4===l.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+l.shape+"."})),ms(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var u="NHWC"===a?s.shape[3]:s.shape[1],c="NHWC"===a?l.shape[3]:l.shape[1];ms(u===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+u+") must match input depth in filter ("+n[2]+"."})),ms(c===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."})),null!=o&&ms(xs(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=_p(a),p=fp(s.shape,n,r,1,i,o,!1,h);return Ml.runKernelFunc((function(t){return t.conv2dDerFilter(s,l,p)}),{x4D:s,dy4D:l})}}),Bg=Ju({conv2dDerInput_:Ig}),Vg=Ju({depthwiseConv2d_:function(t,e,n,r,i,a,o){void 0===i&&(i="NHWC"),void 0===a&&(a=[1,1]);var s=Uu(t,"x","depthwiseConv2d"),l=Uu(e,"filter","depthwiseConv2d"),u=s,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),ms(4===u.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+u.rank+"."})),ms(4===l.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+l.rank+"."})),ms(u.shape[3]===l.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+u.shape[3]+") must match the inChannels dimension in filter "+l.shape[2]+"."})),null==a&&(a=[1,1]),ms(Cp(n,a),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&ms(xs(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var h=fp(u.shape,l.shape,n,a,r,o,!0),p=Ml.runKernelFunc((function(t,e){var n=t.depthwiseConv2D(u,l,h);return e([u,l]),n}),{x:u,filter:l},(function(t,e){ms(xp(a),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+a+"'"}));var n=e[0],r=e[1];return{x:function(){return Ug(n.shape,t,r,h)},filter:function(){return Wg(n,t,r.shape,h)}}}),"DepthwiseConv2dNative",h,[u,l]);return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Ug=Ju({depthwiseConv2dDerInput_:function(t,e,n,r){var i=e,a=!1;3===e.rank&&(a=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=Ml.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return a?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),Wg=Ju({depthwiseConv2dDerFilter_:function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=e;return 3===a.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Ml.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(i,a,r)}),{x4D:i,dy4D:a})}}),jg=Ju({separableConv2d_:function(t,e,n,r,i,a,o){void 0===a&&(a=[1,1]),void 0===o&&(o="NHWC");var s=Uu(t,"x","separableConv2d"),l=Uu(e,"depthwiseFilter","separableConv2d"),u=Uu(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(3===s.rank&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ms(4===c.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."})),ms(4===l.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+l.rank+"."})),ms(4===u.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+l.rank+"."})),ms(1===u.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+u.shape[0]+"."})),ms(1===u.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+u.shape[1]+"."}));var p=l.shape[2],d=l.shape[3];ms(u.shape[2]===p*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+p*d+", but got "+u.shape[2]+"."}));var f=Vg(c,l,r,i,o,a),m=Fg(f,u,1,"valid",o);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),qg=Ju({conv2dTranspose_:function(t,e,n,r,i,a){return Ig(n,Uu(t,"x","conv2dTranspose"),Uu(e,"filter","conv2dTranspose"),r,i,"NHWC",a)}}),Hg=Ju({conv3dTranspose_:function(t,e,n,r,i){return Rg(n,Uu(t,"x","conv3dTranspose"),Uu(e,"filter","conv3dTranspose"),r,i)}}),Gg=Ju({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var a=Uu(t,"a","matMul"),o=Uu(e,"b","matMul");i=xl(a,o),a=i[0],o=i[1];var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],l=r?o.shape[o.rank-1]:o.shape[o.rank-2],u=n?a.shape[a.rank-1]:a.shape[a.rank-2],c=r?o.shape[o.rank-2]:o.shape[o.rank-1],h=a.shape.slice(0,-2),p=o.shape.slice(0,-2),d=bs(h),f=bs(p);ms(a.rank>=2&&o.rank>=2&&a.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+a.rank+" and "+o.rank+"."})),ms(ws(h,p),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+p+") of Tensors with shapes "+a.shape+" and "+o.shape+" must match."})),ms(s===l,(function(){return"Error in matMul: inner shapes ("+s+") and ("+l+") of Tensors with shapes "+a.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=a.shape.slice(0,-2).concat([u,c]),g=n?a.as3D(d,s,u):a.as3D(d,u,s),y=r?o.as3D(f,c,l):o.as3D(f,l,c);return Ml.runKernelFunc((function(t,e){var i=t.batchMatMul(g,y,n,r);return e([g,y]),i}),{a:g,b:y},(function(t,e){var i=e[0],a=e[1];return n||r?!n&&r?{a:function(){return t.matMul(a,!1,!1)},b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{a:function(){return a.matMul(t,!1,!0)},b:function(){return i.matMul(t,!1,!1)}}:{a:function(){return a.matMul(t,!0,!0)},b:function(){return t.matMul(i,!0,!0)}}:{a:function(){return t.matMul(a,!1,!0)},b:function(){return i.matMul(t,!0,!1)}}}),"BatchMatMul",{transposeA:n,transposeB:r}).reshape(m)}}),$g=Ju({dot_:function(t,e){var n=Uu(t,"t1","dot"),r=Uu(e,"t2","dot");ms(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];return ms(i===a,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+a+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),Kg=Ju({outerProduct_:function(t,e){var n=Uu(t,"v1","outerProduct"),r=Uu(e,"v2","outerProduct");return ms(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Xg=Ju({reverse_:function(t,e){var n=Uu(t,"x","reverse");if(0===n.rank)return n.clone();var r=Es(e,n.shape);return Ml.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),Yg=Ju({reverse1d_:function(t){var e=Uu(t,"x","reverse");return ms(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Xg(e,0)}}),Qg=Ju({reverse2d_:function(t,e){var n=Uu(t,"x","reverse");return ms(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),Xg(n,e)}}),Zg=Ju({reverse3d_:function(t,e){var n=Uu(t,"x","reverse");return ms(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),Xg(n,e)}}),Jg=Ju({reverse4d_:function(t,e){var n=Uu(t,"x","reverse");return ms(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),Xg(n,e)}});function ty(t,e,n,r,i,a){var o=Uu(t,"x","maxPool"),s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),ms(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),ms(Cp(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=a&&ms(xs(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var u=pp(s.shape,e,n,r,i,a);if(1===u.filterWidth&&1===u.filterHeight&&ws(u.inShape,u.outShape))return o.clone();var c=Ml.runKernelFunc((function(t,e){var n=t.maxPool(s,u);return e([s,n]),n}),{x:s},(function(t,a){var o=a[0],s=a[1];return{x:function(){return function(t,e,n,r,i,a,o,s){var l=Uu(t,"dy","maxPoolBackprop"),u=Uu(e,"input","maxPoolBackprop"),c=Uu(n,"output","maxPoolBackprop");ms(u.rank===l.rank,(function(){return"Rank of input ("+u.rank+") does not match rank of dy ("+l.rank+")"})),null==a&&(a=[1,1]),ms(Cp(i,a),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"})),ms(4===l.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."})),ms(4===u.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=pp(u.shape,r,i,a,o,void 0);return Ml.runKernelFunc((function(t){return t.maxPoolBackprop(l,u,c,h)}),{$dy:l,$input:u})}(t,o,s,e,n,r,i)}}}),"MaxPool",u,[s]);return l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function ey(t,e,n,r,i,a){var o=Uu(t,"x","avgPool","float32");null==r&&(r=[1,1]),ms(Cp(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),ms(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=a&&ms(xs(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var u=pp(s.shape,e,n,r,i,a);if(1===u.filterWidth&&1===u.filterHeight&&ws(u.inShape,u.outShape))return o.clone();var c=Ml.runKernelFunc((function(t){return t.avgPool(s,u)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,a){var o=Uu(t,"dy","avgPoolBackprop"),s=Uu(e,"input","avgPoolBackprop");ms(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==i&&(i=[1,1]),ms(Cp(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var l=s,u=o,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),u=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),ms(4===u.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),ms(4===l.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+l.rank+"."}));var h=pp(l.shape,n,r,i,a),p=Ml.runKernelFunc((function(t){return t.avgPoolBackprop(u,l,h)}),{dy4D:u,input4D:l});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}(t,s,e,n,r,i)}}}),"AvgPool",u);return c=c.cast(o.dtype),l?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var ny=Ju({maxPool_:function(t,e,n,r,i){return ty(t,e,n,1,r,i)}}),ry=Ju({avgPool_:function(t,e,n,r,i){return ey(t,e,n,1,r,i)}}),iy=Ju({pool_:function(t,e,n,r,i,a){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");var o=Uu(t,"x","maxPool"),s=o,l=!1;3===o.rank&&(l=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),ms(Cp(a,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"}));var u,c=pp(s.shape,e,a,i,r),h=[c.dilationHeight,c.dilationWidth];u="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var p=1===h[0]&&1===h[1],d=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),a=t.concat(r,i),o=e.map((function(t,e){return(t-a[e]%t)%t})),s=i.map((function(t,e){return t+o[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,o[e]]}))]}([c.inHeight,c.inWidth],h,u),f=d[1],m=p?r:"valid",g=p?s:Tc(s,h,d[0]),y=("avg"===n?function(){return ey(g,e,a,1,m)}:function(){return ty(g,e,a,1,m)})(),v=p?y:Sc(y,h,f);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),ay=Ju({maxPool3d_:function(t,e,n,r,i,a,o){void 0===a&&(a="NDHWC");var s=Uu(t,"x","maxPool3d"),l=s,u=!1;4===s.rank&&(u=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),ms(5===l.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+l.rank+"."})),ms("NDHWC"===a,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+a})),ms(Cp(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=i&&ms(xs(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var c=dp(l.shape,e,n,o,r,i,a),h=Ml.runKernelFunc((function(t,e){var n=t.maxPool3d(l,c);return e([l,n]),n}),{x:l},(function(t,a){var s=a[0],l=a[1];return{x:function(){return function(t,e,n,r,i,a,o,s){var l=Uu(t,"dy","maxPool3dBackprop"),u=Uu(e,"input","maxPool3dBackprop"),c=Uu(n,"output","maxPool3dBackprop"),h=l,p=u,d=c,f=!1;4===u.rank&&(f=!0,h=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),p=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),d=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),ms(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."})),ms(5===p.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+p.rank+"."})),ms(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+d.rank+"."})),null==a&&(a=[1,1,1]),ms(Cp(i,a),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"})),null!=s&&ms(xs(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var m=dp(p.shape,r,i,a,o,s),g=Ml.runKernelFunc((function(t){return t.maxPool3dBackprop(h,p,d,m)}),{dy5D:h,input5D:p});return f?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(t,s,l,e,n,o,r,i)}}}));return u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),oy=Ju({avgPool3d_:function(t,e,n,r,i,a,o){void 0===a&&(a="NDHWC");var s=Uu(t,"x","avgPool3d","float32"),l=s,u=!1;4===s.rank&&(u=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),ms(5===l.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+l.rank+"."})),ms("NDHWC"===a,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+a})),ms(Cp(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=i&&ms(xs(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var c=dp(l.shape,e,n,o,r,i,a),h=Ml.runKernelFunc((function(t){return t.avgPool3d(l,c)}),{x:l},(function(t){return{x:function(){return function(t,e,n,r,i,a,o){var s=Uu(t,"dy","avgPool3dBackprop"),l=Uu(e,"input","avgPool3dBackprop"),u=s,c=l,h=!1;4===l.rank&&(h=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),c=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),ms(5===u.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+u.rank+"."})),ms(5===c.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+c.rank+"."})),null==i&&(i=[1,1,1]),ms(Cp(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=o&&ms(xs(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var p=dp(c.shape,n,r,i,a,o),d=Ml.runKernelFunc((function(t){return t.avgPool3dBackprop(u,c,p)}),{dy5D:u,input5D:c});return h?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}(t,l,e,n,o,r,i)}}}));return h=h.cast(l.dtype),u?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),sy=Ju({maxPoolWithArgmax_:function(t,e,n,r,i){void 0===i&&(i=!1);var a=Uu(t,"x","maxPoolWithArgmax"),o=Ml.runKernel("MaxPoolWithArgmax",{x:a},{filterSize:e,strides:n,pad:r,includeBatchInIndex:i});return{result:o[0],indexes:o[1]}}}),ly=Ju({slice_:function(t,e,n){var r,i,a=Uu(t,"x","slice");if(0===a.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(a.rank-1).fill(0)):e.length<a.rank?e.concat(new Array(a.rank-e.length).fill(0)):e.slice()).forEach((function(t){ms(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(a.rank).fill(-1):"number"==typeof n?[n].concat(new Array(a.rank-1).fill(-1)):n.length<a.rank?n.concat(new Array(a.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(ms(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),a.shape[e]-r[e])})),Zh(a,r,i);var o=a.shape;return Ml.runKernelFunc((function(t){return t.slice(a,r,i)}),{x:a},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],o[n]-r[n]-i[n]]);return{x:function(){return Zm(t,e)}}}),"Slice",{begin:r,size:i})}}),uy=Ju({slice1d_:function(t,e,n){var r=Uu(t,"x","slice1d");return ms(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),ly(r,[e],[n])}}),cy=Ju({slice2d_:function(t,e,n){var r=Uu(t,"x","slice2d");return ms(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),ly(r,e,n)}}),hy=Ju({slice3d_:function(t,e,n){var r=Uu(t,"x","slice3d");return ms(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),ly(r,e,n)}}),py=Ju({slice4d_:function(t,e,n){var r=Uu(t,"x","slice4d");return ms(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),ly(r,e,n)}});function dy(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(Gu(e.shape,r))),t.rank<n.rank&&(t=t.reshape(Gu(t.shape,r))),{x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var fy=Ju({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","all","bool"),i=Es(e,r.shape),a=i,o=Ku(a,r.rank);null!=o&&(r=r.transpose(o),a=Yu(a.length,r.rank));var s=Ml.runKernelFunc((function(t){return t.all(r,a)}),{$x:r});if(n){var l=Gu(s.shape,i);return s.reshape(l)}return s}}),my=Ju({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","any","bool"),i=Es(e,r.shape),a=i,o=Ku(a,r.rank);null!=o&&(r=r.transpose(o),a=Yu(a.length,r.rank));var s=Ml.runKernelFunc((function(t){return t.any(r,a)}),{$x:r});if(n){var l=Gu(s.shape,i);return s.reshape(l)}return s}}),gy=Ju({argMax_:function(t,e){void 0===e&&(e=0);var n=Uu(t,"x","argMax");null==e&&(e=0);var r=Es(e,n.shape),i=Ku(r,n.rank);return null!=i&&(n=n.transpose(i),r=Yu(r.length,n.rank)),Ml.runKernelFunc((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{x:n},(function(t,e){var n=e[0];return{x:function(){return yc(n)}}}),"ArgMax",{axis:r[0]},[n])}}),yy=Ju({argMin_:function(t,e){void 0===e&&(e=0);var n=Uu(t,"x","argMin");null==e&&(e=0);var r=Es(e,n.shape),i=Ku(r,n.rank);return null!=i&&(n=n.transpose(i),r=Yu(r.length,n.rank)),Ml.runKernelFunc((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return yc(n)}}}))}}),vy=Ju({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","logSumExp"),i=Es(e,r.shape),a=r.max(i,!0),o=r.sub(a).exp().sum(i).log(),s=a.reshape(o.shape).add(o);if(n){var l=Gu(s.shape,i);return s.reshape(l)}return s}}),by=Ju({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","max"),i=r,a=Es(e,r.shape),o=a,s=Ku(o,r.rank);null!=s&&(r=r.transpose(s),o=Yu(o.length,r.rank));var l=Ml.runKernelFunc((function(t,e){var n=t.max(r,o);return e([i,n]),n}),{x:r},(function(t,e){return dy(t,e[1],e[0],a,s)}),"Max",{axes:o},[r],[!0]);if(n){var u=Gu(l.shape,a);l=l.reshape(u)}return l}}),wy=Ju({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","mean"),i=Es(e,r.shape),a=bs(Hu(r.shape,i)[1]);return ap((function(t){var r=ac(a);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(hc(t.shape,"float32")).div(a)}}}))(r)}}),xy=Ju({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","min"),i=r,a=Es(e,r.shape),o=a,s=Ku(o,r.rank);null!=s&&(r=r.transpose(s),o=Yu(o.length,r.rank));var l=Ml.runKernelFunc((function(t,e){var n=t.min(r,o);return e([i,n]),n}),{x:r},(function(t,e){return dy(t,e[1],e[0],a,s)}),"Min",{axes:o},[r],[!0]);if(n){var u=Gu(l.shape,a);l=l.reshape(u)}return l}}),Cy=Ju({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Es(e,(t=Uu(t,"x","moments")).shape),i=t.mean(r,n),a=i.shape;n||(a=Gu(i.shape,r));var o=t.toFloat().sub(i.reshape(a)).square();return{mean:i,variance:o.mean(r,n)}}}),_y=Ju({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=Es(e,r.shape);return ap((function(t){var e=Ku(i,t.rank),r=i,a=t;null!=e&&(a=t.transpose(e),r=Yu(r.length,t.rank));var o=function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(hc(t.shape,"float32"))},s=Ml.runKernelFunc((function(t){return t.sum(a,r)}),{x:a},(function(t){return{x:function(){return o(t)}}}),"Sum",{axes:r});if(n){var l=Gu(s.shape,i);s=s.reshape(l)}return{value:s,gradFunc:o}}))(r)}}),ky=Ju({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Uu(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=Es(e,r.shape),a=Ku(i,r.rank),o=i,s=r;null!=a&&(s=r.transpose(a),o=Yu(o.length,r.rank));var l=Ml.runKernelFunc((function(t){return t.prod(s,o)}),{permutedX:s});if(n){var u=Gu(l.shape,i);l=l.reshape(u)}return l}}),Sy=Ju({elu_:function(t){var e=Uu(t,"x","elu");return Ml.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Ml.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),Oy=Ju({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=Uu(t,"x","leakyRelu");return Ah(ac(e).mul(n),n)}}),Ey=Ju({prelu_:function(t,e){var n=Uu(t,"x","prelu"),r=Uu(e,"alpha","prelu");return Ml.runKernelFunc((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{x:n,alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{x:function(){return Hm(i,t,t.mul(r))},alpha:function(){var e=Hm(i,yc(t),t.mul(n)),a=$c(r.shape,t.shape);return a.length>0&&(e=e.sum(a)),e.reshape(r.shape)}}}),"Prelu")}}),My=Ju({relu_:function(t){var e=Uu(t,"x","relu");return"bool"===e.dtype?e.toInt():Ml.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mulStrict(n.step().toFloat())}}}),"Relu")}}),Ny=Ju({relu6_:function(t){var e=Uu(t,"x","relu6");return"bool"===e.dtype?e.toInt():Ml.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return t.mulStrict(r.toFloat())}}}),"Relu6")}}),Py=Ju({selu_:function(t){var e=Uu(t,"x","selu");return Ml.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(ac(0)),r=ac(1.7580993408473768),i=ac(1.0507009873554805),a=t.mul(i),o=t.mul(r).mul(n.toFloat().exp());return Hm(e,a,o)}}}))}}),Ty=Ju({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var a=Uu(t,"x","localResponseNormalization");ms(4===a.rank||3===a.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+a.rank+"."})),ms(xs(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var o=a,s=!1;3===a.rank&&(s=!0,o=a.as4D(1,a.shape[0],a.shape[1],a.shape[2]));var l=Ml.runKernelFunc((function(t,a){var s=t.localResponseNormalization4D(o,e,n,r,i);return a([o,s]),s}),{x4D:o},(function(t,a){var o=a[0],s=a[1];return{x4D:function(){return Ml.runKernelFunc((function(a){return a.LRNGrad(t,o,s,e,n,r,i)}),{})}}}));return s?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),Iy=Ju({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(ac(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=Uu(t,"x","norm"),e,n),a=i.shape;if(r){var o=Es(n,t.shape);a=Gu(i.shape,o)}return i.reshape(a)}}),Ay=Ju({basicLSTMCell_:function(t,e,n,r,i,a){var o=Uu(t,"forgetBias","basicLSTMCell"),s=Uu(e,"lstmKernel","basicLSTMCell"),l=Uu(n,"lstmBias","basicLSTMCell"),u=Uu(r,"data","basicLSTMCell"),c=Uu(i,"c","basicLSTMCell"),h=Uu(a,"h","basicLSTMCell"),p=u.concat(h,1).matMul(s).add(l),d=p.shape[1]/4,f=[p.shape[0],d],m=p.slice([0,0],f),g=p.slice([0,d],f),y=p.slice([0,2*d],f),v=p.slice([0,3*d],f),b=m.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(o.add(y).sigmoid())),w=b.tanh().mulStrict(v.sigmoid());return[b,w]}}),Ry=Ju({multiRNNCell_:function(t,e,n,r){for(var i=Uu(e,"data","multiRNNCell"),a=Wu(n,"c","multiRNNCell"),o=Wu(r,"h","multiRNNCell"),s=i,l=[],u=0;u<t.length;u++){var c=t[u](s,a[u],o[u]);l.push(c[0]),l.push(c[1]),s=c[1]}var h=[],p=[];for(u=0;u<l.length;u+=2)h.push(l[u]),p.push(l[u+1]);return[h,p]}}),Dy=Ju({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var a=Uu(t,"v","movingAverage"),o=Uu(e,"x","movingAverage"),s=Uu(n,"decay","movingAverage");Cl(a,o),ms(ws(a.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var l=ac(1),u=l.sub(s),c=o.sub(a).mul(u);if(i){ms(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=Uu(r,"step","movingAverage");c=c.div(l.sub(Uh(s,h)))}return a.add(c)}}),Fy=Ju({stridedSlice_:function(t,e,n,r,i,a,o,s,l){if(void 0===i&&(i=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=0),null==r&&(r=new Array(e.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var u=Uu(t,"x","stridedSlice"),c=Jh(s),h=u.shape.slice();c.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),u=u.reshape(h);for(var p=0;p<u.rank;p++)e[p]=ep(i,e,r,u.shape,p),n[p]=np(a,n,r,u.shape,p),r[p]=r[p]||1;var d=Jh(l);d.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var f=tp(e,n,r),m=f.filter((function(t,e){return-1===d.indexOf(e)}));return r.every((function(t){return 1===t}))?ly(u,e,f).reshape(m):Ml.runKernelFunc((function(t){return t.stridedSlice(u,e,n,r)}),{$x:u}).reshape(m)}}),zy=Ju({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=Uu(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var a=Ml.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r});return{values:a[0],indices:a[1]}}}),Ly=Ju({scatterND_:function(t,e,n){var r=Uu(t,"indices","scatterND","int32"),i=Uu(e,"updates","scatterND");return Yh(i,r,n),Ml.runKernelFunc((function(t){return t.scatterND(r,i,n)}),{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),By=Ju({fft_:function(t){ms("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return Ml.runKernelFunc((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),Vy=Ju({ifft_:function(t){ms("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return Ml.runKernelFunc((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),Uy=Ju({rfft_:function(t,e){ms("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var a=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=t.slice(a,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(pc(s),t.shape.length-1),r=e}else n=t;var l=n.zerosLike(),u=tc(n,l).as2D(i,r),c=By(u),h=Math.floor(r/2)+1,p=ec(c),d=nc(c),f=p.split([h,r-h],p.shape.length-1),m=d.split([h,r-h],d.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=h,tc(f[0],m[0]).reshape(g)}}),Wy=Ju({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=Vy(r);return ec(i)}var a=[n,2*(e-1)],o=ec(t).as2D(n,e),s=nc(t).as2D(n,e),l=o.slice([0,1],[n,e-2]).reverse(1),u=s.slice([0,1],[n,e-2]).reverse(1).mul(ac(-1)),c=o.concat(l,1),h=s.concat(u,1);return r=tc(c,h).as2D(a[0],a[1]),i=Vy(r),ec(i)}}),jy=Object.freeze({fft:By,ifft:Vy,rfft:Uy,irfft:Wy}),qy=Ju({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=Uu(t,"sparseIndices","sparseToDense","int32"),a=Uu(e,"sparseValues","sparseToDense"),o=Uu(r,"defaultValue","sparseToDense",a.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+a+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,o),Ml.runKernelFunc((function(t){return t.sparseToDense(i,a,n,o)}),{$sparseIndices:i,$sparseValues:a,$defaultValue:o})}}),Hy=Ju({gatherND_:function(t,e){var n=Uu(e,"indices","gatherND","int32"),r=Uu(t,"x","gatherND");return Ml.runKernelFunc((function(t){return t.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),Gy=Ju({diag_:function(t){var e=Uu(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return Ml.runKernelFunc((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),$y=Ju({dropout_:function(t,e,n,r){var i=Uu(t,"x","dropout");if(ms("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),ms(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof cl?i.clone():i;var a=function(t,e){if(null==e)return t.shape.slice();if(ws(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(i,n),o=1-e,s=pg(a,0,1,"float32",r).add(o).floor().div(o);return i.mul(s)}});function Ky(t,e,n){for(var r=1-t%2,i=new Float32Array(t),a=0;a<t;++a){var o=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(o)}return oc(i,"float32")}var Xy,Yy=Ju({hannWindow_:function(t){return Ky(t,.5,.5)}}),Qy=Ju({hammingWindow_:function(t){return Ky(t,.54,.46)}}),Zy=Ju({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var a=0,o=[];a+e<=t.size;)o.push(ly(t,a,e)),a+=n;if(r)for(;a<t.size;){var s=a+e-t.size,l=vc([ly(t,a,e-s),dc([s],i)]);o.push(l),a+=n}return 0===o.length?sc([],[0,e]):vc(o).as2D(o.length,e)}}),Jy=Ju({stft_:function(t,e,n,r,i){void 0===i&&(i=Yy),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));for(var a=Zy(t,e,n),o=Bh(a,i(e)),s=[],l=0;l<a.shape[0];l++)s.push(Uy(o.slice([l,0],[1,e]),r));return vc(s)}}),tv=Object.freeze({hannWindow:Yy,hammingWindow:Qy,frame:Zy,stft:Jy});!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Xy||(Xy={}));var ev=Ju({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=Xy.SUM_BY_NONZERO_WEIGHTS);var i=Uu(t,"labels","absoluteDifference"),a=Uu(e,"predictions","absoluteDifference"),o=null;null!=n&&(o=Uu(n,"weights","absoluteDifference")),gs(i.shape,a.shape,"Error in absoluteDifference: ");var s=i.sub(a).abs();return nv(s,o,r)}}),nv=Ju({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=Xy.SUM_BY_NONZERO_WEIGHTS);var r=Uu(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=Uu(e,"weights","computeWeightedLoss"));var a=null==i?r:r.mul(i);if(n===Xy.NONE)return a;if(n===Xy.SUM)return a.sum();if(n===Xy.MEAN){if(null==i)return a.mean();var o=r.size/i.size,s=a.sum().div(i.sum());return o>1?s.div(ac(o)):s}if(n===Xy.SUM_BY_NONZERO_WEIGHTS){if(null==i)return a.sum().div(ac(r.size));var l=i.mul(hc(r.shape)).notEqual(ac(0)).sum().toFloat();return a.sum().div(l)}throw Error("Unknown reduction: "+n)}}),rv=Ju({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=Xy.SUM_BY_NONZERO_WEIGHTS);var a=Uu(t,"labels","cosineDistance"),o=Uu(e,"predictions","cosineDistance"),s=null;null!=r&&(s=Uu(r,"weights","cosineDistance")),gs(a.shape,o.shape,"Error in cosineDistance: ");var l=ac(1).sub(a.mul(o).sum(n,!0));return nv(l,s,i)}}),iv=Ju({hingeLoss_:function(t,e,n,r){void 0===r&&(r=Xy.SUM_BY_NONZERO_WEIGHTS);var i=Uu(t,"labels","hingeLoss"),a=Uu(e,"predictions","hingeLoss"),o=null;null!=n&&(o=Uu(n,"weights","hingeLoss")),gs(i.shape,a.shape,"Error in hingeLoss: ");var s=ac(1);i=ac(2).mul(i).sub(s);var l=s.sub(i.mul(a)).relu();return nv(l,o,r)}}),av=Ju({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=Xy.SUM_BY_NONZERO_WEIGHTS);var a=Uu(t,"labels","huberLoss"),o=Uu(e,"predictions","huberLoss"),s=null;null!=n&&(s=Uu(n,"weights","huberLoss")),gs(a.shape,o.shape,"Error in huberLoss: ");var l=ac(r),u=o.sub(a).abs(),c=Dh(u,l),h=u.sub(c),p=ac(.5).mul(c.square()).add(l.mul(h));return nv(p,s,i)}}),ov=Ju({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=Xy.SUM_BY_NONZERO_WEIGHTS);var a=Uu(t,"labels","logLoss"),o=Uu(e,"predictions","logLoss"),s=null;null!=n&&(s=Uu(n,"weights","logLoss")),gs(a.shape,o.shape,"Error in logLoss: ");var l=ac(1),u=ac(r),c=a.mul(o.add(u).log()).neg().sub(l.sub(a).mul(l.sub(o).add(u).log()));return nv(c,s,i)}}),sv=Ju({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=Xy.SUM_BY_NONZERO_WEIGHTS);var i=Uu(t,"labels","meanSquaredError"),a=Uu(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=Uu(n,"weights","meanSquaredError")),gs(i.shape,a.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(a);return nv(s,o,r)}}),lv=Ju({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=Xy.SUM_BY_NONZERO_WEIGHTS);var a=Uu(t,"multiClassLabels","sigmoidCrossEntropy"),o=Uu(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Uu(n,"weights","sigmoidCrossEntropy")),gs(a.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var l=ac(r),u=ac(1),c=ac(.5);a=a.mul(u.sub(l)).add(c.mul(l))}var h=function(t,e){var n=Uu(t,"labels","sigmoidCrossEntropyWithLogits"),r=Uu(e,"logits","sigmoidCrossEntropyWithLogits");gs(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),a=r.mul(n),o=r.abs().neg().exp().log1p();return i.sub(a).add(o)}(a,o);return nv(h,s,i)}}),uv=Ju({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=Xy.SUM_BY_NONZERO_WEIGHTS);var a=Uu(t,"onehotLabels","softmaxCrossEntropy"),o=Uu(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Uu(n,"weights","softmaxCrossEntropy")),gs(a.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var l=ac(r),u=ac(1),c=ac(a.shape[1]);a=a.mul(u.sub(l)).add(l.div(c))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return ap((function(t,e,r){var i=e.logSumExp([n],!0),a=e.toFloat().sub(i);return r([t,a]),{value:a.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],a=Gu(t.shape,[n]);return[t.reshape(a).mul(r.toFloat().sub(i.exp())),t.reshape(a).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(a,o);return nv(h,s,i)}}),cv=Object.freeze({get Reduction(){return Xy},absoluteDifference:ev,computeWeightedLoss:nv,cosineDistance:rv,hingeLoss:iv,huberLoss:av,logLoss:ov,meanSquaredError:sv,sigmoidCrossEntropy:lv,softmaxCrossEntropy:uv});function hv(t,e){return void 0===e&&(e=!1),Ml.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=Xm(n),a=t.clone(),o=sc([[1]],[1,1]),s=o.clone(),l=n>=r?r:n,u=function(t){var e,l=a,u=s,c=i;e=Ml.tidy((function(){var e=a.slice([t,t],[n-t,1]),l=e.norm(),u=a.slice([t,t],[1,1]),c=sc([[-1]]).where(u.greater(0),sc([[1]])),h=u.sub(c.mul(l)),p=e.div(h);s=1===p.shape[0]?o.clone():o.concat(p.slice([1,0],[p.shape[0]-1,p.shape[1]]),0);var d=c.matMul(h).div(l).neg(),f=a.slice([t,0],[n-t,r]),m=d.mul(s),g=s.transpose();if(0===t)a=f.sub(m.matMul(g.matMul(f)));else{var y=f.sub(m.matMul(g.matMul(f)));a=a.slice([0,0],[t,r]).concat(y,0)}var v=m.transpose(),b=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=b.sub(b.matMul(s).matMul(v));else{var w=b.sub(b.matMul(s).matMul(v));i=i.slice([0,0],[n,t]).concat(w,1)}return[s,a,i]})),s=e[0],a=e[1],i=e[2],Fu([l,u,c])},c=0;c<l;++c)u(c);return!e&&n>r&&(i=i.slice([0,0],[n,r]),a=a.slice([0,0],[r,r])),[i,a]}))}var pv=Ju({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Uu(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,a=r.shape.slice(-2),o=a[0],s=a[1];if(!(e<=o))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=o),n<0&&(n=s);var l=mc(0,o,1,"int32").reshape([-1,1]),u=mc(0,s,1,"int32"),c=qh(l,u),h=Um(c.lessEqual(ac(+e,"int32")),c.greaterEqual(ac(-n,"int32"))),p=pc([o,s],r.dtype);return Ac(Rc(r.reshape([-1,o,s])).map((function(t){return Hm(h,t,p)}))).reshape(i)}}),dv=Ju({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,ms(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){ms(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=_c(t,t.shape[0],0).map((function(t){return Ic(t,[0])}));ms(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var a=[],o=t,s=function(t){a.push(Ml.tidy((function(){var e=o[t];if(t>0)for(var n=0;n<t;++n){var r=_y(a[n].mulStrict(e)).mul(a[n]);e=e.sub(r)}return e.div(Iy(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?Ac(a,0):a}}),fv=Ju({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return hv(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Rc(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach((function(t){var n=hv(t,e),r=n[1];i.push(n[0]),a.push(r)})),[Ac(i,0).reshape(t.shape),Ac(a,0).reshape(t.shape)]}}),mv=Object.freeze({bandPart:pv,gramSchmidt:dv,qr:fv});function gv(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);var o=t.shape[0];return n=Math.min(n,o),ms(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),ms(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),ms(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),ms(1===e.rank,(function(){return"scores must be a 1D tensor"})),ms(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),ms(0<=a&&a<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+a+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}var yv=Ju({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=Uu(t,"images","resizeBilinear");ms(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),ms(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],l=Ml.runKernelFunc((function(t,e){return e([i]),t.resizeBilinear(i,o,s,n)}),{x:i},(function(t,e){return{x:function(){return Ml.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),vv=Ju({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=Uu(t,"images","resizeNearestNeighbor");ms(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),ms(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),ms("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,a=!1;3===r.rank&&(a=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],l=Ml.runKernelFunc((function(t,e){return e([i]),t.resizeNearestNeighbor(i,o,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return Ml.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return a?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}}),bv=Ju({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var a=Uu(t,"boxes","nonMaxSuppression"),o=Uu(e,"scores","nonMaxSuppression"),s=gv(a,o,n,r,i);return Ml.runKernelFunc((function(t){return t.nonMaxSuppression(a,o,n,r,i)}),{boxes:a,scores:o},null,"NonMaxSuppressionV3",{maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:i=s.scoreThreshold})}}),wv=Ju({nonMaxSuppressionWithScore_:function(t,e,n,r,i,a){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0);var o=Uu(t,"boxes","nonMaxSuppression"),s=Uu(e,"scores","nonMaxSuppression"),l=gv(o,s,n,r,i,a),u={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:i=l.scoreThreshold,softNmsSigma:a=l.softNmsSigma},c=Ml.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},u);return{selectedIndices:c[0],selectedScores:c[1]}}}),xv=Ju({cropAndResize_:function(t,e,n,r,i,a){var o=Uu(t,"image","cropAndResize"),s=Uu(e,"boxes","cropAndResize","float32"),l=Uu(n,"boxInd","cropAndResize","int32");i=i||"bilinear",a=a||0;var u=s.shape[0];return ms(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),ms(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+u+",4] but had shape "+s.shape+"."})),ms(1===l.rank&&l.shape[0]===u,(function(){return"Error in cropAndResize: boxInd must be have size ["+u+"] but had shape "+s.shape+"."})),ms(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),ms(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),ms("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),Ml.runKernelFunc((function(t,e){return t.cropAndResize(o,s,l,r,i,a)}),{images:o,boxes:s,boxInd:l},null,"CropAndResize",{method:i,extrapolationValue:a,cropSize:r})}}),Cv=Object.freeze({resizeBilinear:yv,resizeNearestNeighbor:vv,nonMaxSuppression:bv,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),Qo(this,void 0,void 0,(function(){var a,o,s,l,u;return Zo(this,(function(c){switch(c.label){case 0:return a=Uu(t,"boxes","nonMaxSuppressionAsync"),o=Uu(e,"scores","nonMaxSuppressionAsync"),s=gv(a,o,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([a.data(),o.data()])];case 1:return l=c.sent(),u=Ap(l[0],l[1],n,r,i),a!==t&&a.dispose(),o!==e&&o.dispose(),[2,u]}}))}))},nonMaxSuppressionWithScore:wv,nonMaxSuppressionWithScoreAsync:function(t,e,n,r,i,a){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===a&&(a=0),Qo(this,void 0,void 0,(function(){var o,s,l,u,c;return Zo(this,(function(h){switch(h.label){case 0:return o=Uu(t,"boxes","nonMaxSuppressionAsync"),s=Uu(e,"scores","nonMaxSuppressionAsync"),l=gv(o,s,n,r,i,a),n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return u=h.sent(),c=Rp(u[0],u[1],n,r,i,a),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,c]}}))}))},cropAndResize:xv}),_v=function(t,e){return!(t>0)||"linear"===e},kv=function(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},Sv=function(t,e){var n=e,r=$c(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},Ov=function(t,e,n){if("linear"===e)return t;if("relu"===e)return My(t);if("elu"===e)return Sy(t);if("relu6"===e)return Ny(t);if("prelu"===e)return Ey(t,n);throw new Error("Unknown fused activation "+e+".")},Ev=Ju({fusedMatMul_:function(t){var e,n=t.a,r=t.b,i=t.transposeA,a=void 0!==i&&i,o=t.transposeB,s=void 0!==o&&o,l=t.bias,u=t.activation,c=void 0===u?"linear":u,h=t.preluActivationWeights;if(!1===_v(Ml.state.gradientDepth,c)){var p=Gg(n,r,a,s);return null!=l&&(p=Hc(p,l)),Ov(p,c,h)}var d=Uu(n,"a","fused matMul"),f=Uu(r,"b","fused matMul");e=xl(d,f),d=e[0],f=e[1];var m=a?d.shape[d.rank-2]:d.shape[d.rank-1],g=s?f.shape[f.rank-1]:f.shape[f.rank-2],y=a?d.shape[d.rank-1]:d.shape[d.rank-2],v=s?f.shape[f.rank-2]:f.shape[f.rank-1],b=d.shape.slice(0,-2),w=f.shape.slice(0,-2),x=bs(b),C=bs(w);ms(d.rank>=2&&f.rank>=2&&d.rank===f.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+d.rank+" and "+f.rank+"."})),ms(ws(b,w),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+d.shape+" and "+f.shape+" must match."})),ms(m===g,(function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+d.shape+" and "+f.shape+" and transposeA="+a+" and transposeB="+s+" must match."}));var _,k,S=d.shape.slice(0,-2).concat([y,v]),O=a?d.as3D(x,m,y):d.as3D(x,y,m),E=s?f.as3D(C,v,g):f.as3D(C,g,v);null!=l&&Kc(S,(_=xl(_=Uu(l,"bias","fused matMul"),d)[0]).shape),null!=h&&(k=Uu(h,"prelu weights","fused matMul"));var M={a:O,b:E};return null!=l&&(M.bias=_),null!=h&&(M.preluActivationWeights=k),Ml.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:O,b:E,transposeA:a,transposeB:s,bias:_,activation:c,preluActivationWeights:k});return e([O,E,n]),n}),M,(function(t,e){var n=e[0],r=e[1],i=kv(t,e[2],c),o={};return null!=l&&(o={bias:function(){return Sv(_,i)}}),Object.assign(a||s?!a&&s?{a:function(){return i.matMul(r,!1,!1)},b:function(){return i.matMul(n,!0,!1)}}:a&&!s?{a:function(){return r.matMul(i,!1,!0)},b:function(){return n.matMul(i,!1,!1)}}:{a:function(){return r.matMul(i,!0,!0)},b:function(){return i.matMul(n,!0,!0)}}:{a:function(){return i.matMul(r,!1,!0)},b:function(){return n.matMul(i,!0,!1)}},o)}),"_FusedMatMul",{transposeA:a,transposeB:s,activation:c},[O,E],[!0]).reshape(S)}}),Mv=Ju({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,i=t.pad,a=t.dataFormat,o=void 0===a?"NHWC":a,s=t.dilations,l=void 0===s?[1,1]:s,u=t.dimRoundingMode,c=t.bias,h=t.activation,p=void 0===h?"linear":h,d=t.preluActivationWeights;if(!1===_v(Ml.state.gradientDepth,p=p||"linear")){var f=Fg(e,n,r,i,o,l,u);return null!=c&&(f=Hc(f,c)),Ov(f,p,d)}var m=Uu(e,"x","conv2d"),g=Uu(n,"filter","conv2d"),y=m,v=!1;3===m.rank&&(v=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),ms(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+y.rank+"."})),ms(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."})),null!=u&&ms(xs(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+i+"."})),ms(y.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input ("+y.shape[3]+") must match input depth for filter "+g.shape[2]+"."})),ms(Cp(r,l),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"})),ms("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var b,w,x=fp(y.shape,g.shape,r,l,i,u);null!=c&&(b=xl(b=Uu(c,"bias","fused conv2d"),m)[0],Kc(x.outShape,b.shape)),null!=d&&(w=Uu(d,"prelu weights","fused conv2d"));var C={x:y,filter:g};null!=c&&(C.bias=b),null!=d&&(C.preluActivationWeights=w);var _=Ml.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:y,filter:g,convInfo:x,bias:b,activation:p,preluActivationWeights:w});return e([g,y,n]),n}),C,(function(t,e){var n=e[0],a=e[1],o=kv(t,e[2],p);ms(xp(l),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+l+"'"}));var s={};return null!=c&&(s={bias:function(){return Sv(b,o)}}),Object.assign({x:function(){return Bg(a.shape,o,n,r,i)},filter:function(){return Lg(a,o,n.shape,r,i)}},s)}),"FusedConv2D",{convInfo:x,activation:p},[g,y],[!0]);return v?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Nv=Ju({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,i=t.pad,a=t.dataFormat,o=void 0===a?"NHWC":a,s=t.dilations,l=void 0===s?[1,1]:s,u=t.dimRoundingMode,c=t.bias,h=t.activation,p=void 0===h?"linear":h,d=t.preluActivationWeights;if(!1===_v(Ml.state.gradientDepth,p)){var f=Vg(e,n,r,i,o,l,u);return null!=c&&(f=Hc(f,c)),Ov(f,p,d)}var m=Uu(e,"x","depthwiseConv2d"),g=Uu(n,"filter","depthwiseConv2d"),y=m,v=!1;3===m.rank&&(v=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),ms(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+y.rank+"."})),ms(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."})),ms(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+y.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."})),null==l&&(l=[1,1]),ms(Cp(r,l),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+l+"'"})),null!=u&&ms(xs(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+u+" but got pad "+i+"."}));var b,w,x=fp(y.shape,g.shape,r,l,i,u,!0);null!=c&&(b=xl(b=Uu(c,"bias","fused conv2d"),m)[0],Kc(x.outShape,b.shape)),null!=d&&(w=Uu(d,"prelu weights","fused depthwiseConv2d"));var C={x:y,filter:g};null!=c&&(C.bias=b),null!=d&&(C.preluActivationWeights=w);var _=Ml.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:y,filter:g,convInfo:x,bias:b,activation:p,preluActivationWeights:w});return e([g,y,n]),n}),C,(function(t,e){ms(xp(l),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+l+"'"}));var n=e[0],r=e[1],i=kv(t,e[2],p),a={};return null!=c&&(a={bias:function(){return Sv(b,i)}}),Object.assign({x:function(){return Ug(r.shape,i,n,x)},filter:function(){return Wg(r,i,n.shape,x)}},a)}),"FusedDepthwiseConv2D",{convInfo:x,activation:p},[g,y],[!0]);return v?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),Pv=Object.freeze({matMul:Ev,conv2d:Mv,depthwiseConv2d:Nv}),Tv=Object.freeze({image:Cv,linalg:mv,losses:cv,spectral:jy,fused:Pv,signal:tv,add:Hc,addN:_m,batchNorm:Nm,batchNormalization:Mm,batchNorm2d:Im,batchNormalization2d:Tm,batchNorm3d:Dm,batchNormalization3d:Rm,batchNorm4d:Lm,batchNormalization4d:zm,broadcastTo:Bm,clone:Vm,div:Gh,divNoNan:$m,eye:Xm,multinomial:Ym,oneHot:Qm,pad:Zm,pad1d:Jm,pad2d:tg,pad3d:eg,pad4d:ng,rand:rg,randomGamma:cg,randomNormal:hg,randomUniform:pg,square:dg,squaredDifference:fg,tile:Km,truncatedNormal:mg,conv1d:Dg,conv2d:Fg,conv3d:zg,depthwiseConv2d:Vg,separableConv2d:jg,conv2dTranspose:qg,conv3dTranspose:Hg,op:Ju,booleanMaskAsync:function(t,e,n){return Qo(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h,p,d,f,m;return Zo(this,(function(g){switch(g.label){case 0:for(r=Uu(t,"tensor","boolMask"),i=Uu(e,"mask","boolMask","bool"),a=null==n?0:n,s=r.shape,ms((o=i.rank)>0,(function(){return"mask cannot be scalar"})),gs(s.slice(a,a+o),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,u=a;u<a+o;u++)l*=s[u];return c=s.slice(0,a).concat([l],s.slice(a+o)),h=r.reshape(c),p=i.reshape([-1]),[4,Gm(p)];case 1:return d=g.sent(),f=d.squeeze([1]),m=Pg(h,f,a),t!==r&&r.dispose(),e!==i&&i.dispose(),f.dispose(),h.dispose(),p.dispose(),d.dispose(),[2,m]}}))}))},complex:tc,real:ec,imag:nc,concat:vc,concat1d:bc,concat2d:wc,concat3d:xc,concat4d:Cc,split:_c,matMul:Gg,dot:$g,outerProduct:Kg,reverse:Xg,reverse1d:Yg,reverse2d:Qg,reverse3d:Zg,reverse4d:Jg,maxPool:ny,avgPool:ry,pool:iy,maxPool3d:ay,avgPool3d:oy,maxPoolWithArgmax:sy,slice:ly,slice1d:uy,slice2d:cy,slice3d:hy,slice4d:py,abs:Xc,acos:Yc,acosh:Qc,asin:Zc,asinh:Jc,atan:th,atanh:eh,ceil:nh,clipByValue:rh,cos:ih,cosh:ah,erf:oh,exp:sh,expm1:lh,floor:uh,log:ch,log1p:hh,logSigmoid:ph,neg:dh,reciprocal:fh,round:mh,rsqrt:gh,sigmoid:yh,sign:vh,isNaN:bh,isInf:wh,isFinite:xh,sin:Ch,sinh:_h,softplus:kh,sqrt:Sh,step:Oh,tan:Eh,tanh:Mh,all:fy,any:my,argMax:gy,argMin:yy,logSumExp:vy,max:by,mean:wy,min:xy,moments:Cy,sum:_y,prod:ky,equal:gg,equalStrict:yg,greater:vg,greaterEqual:bg,greaterEqualStrict:wg,greaterStrict:xg,less:Cg,lessEqual:_g,lessEqualStrict:kg,lessStrict:Sg,notEqual:Og,notEqualStrict:Eg,addStrict:Nh,atan2:Ph,divStrict:Th,floorDiv:Ih,maximum:Ah,maximumStrict:Rh,minimum:Dh,minimumStrict:Fh,mod:zh,modStrict:Lh,mul:Bh,mulStrict:Vh,pow:Uh,powStrict:Wh,squaredDifferenceStrict:jh,sub:qh,subStrict:Hh,elu:Sy,leakyRelu:Oy,prelu:Ey,relu:My,relu6:Ny,selu:Py,logicalAnd:Um,logicalNot:Wm,logicalOr:jm,logicalXor:qm,where:Hm,whereAsync:Gm,buffer:kc,print:function(t,e){void 0===e&&(e=!1),console.log(t.toString(e))},batchToSpaceND:Sc,cast:Oc,cumsum:Ec,depthToSpace:Mc,expandDims:Nc,reshape:Pc,spaceToBatchND:Tc,squeeze:Ic,stack:Ac,unstack:Rc,setdiff1dAsync:Dc,fill:dc,linspace:fc,ones:hc,range:mc,scalar:ac,tensor:rc,tensor1d:oc,tensor2d:sc,tensor3d:lc,tensor4d:uc,tensor5d:function(t,e,n){if(ys(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Bu(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ic(t,e,r,n)},tensor6d:function(t,e,n){if(ys(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Bu(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ic(t,e=e||r,r,n)},variable:cc,zeros:pc,onesLike:gc,zerosLike:yc,transpose:lp,softmax:op,logSoftmax:sp,localResponseNormalization:Ty,norm:Iy,gather:Pg,unsortedSegmentSum:Tg,basicLSTMCell:Ay,multiRNNCell:Ry,movingAverage:Dy,stridedSlice:Fy,topk:zy,scatterND:Ly,fft:By,ifft:Vy,rfft:Uy,irfft:Wy,sparseToDense:qy,gatherND:Hy,diag:Gy,dropout:$y,hannWindow:Yy,hammingWindow:Qy,frame:Zy,stft:Jy,inTopKAsync:function(t,e,n){return void 0===n&&(n=1),Qo(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h,p,d,f,m,g;return Zo(this,(function(y){switch(y.label){case 0:return r=Uu(t,"predictions","inTopK"),i=Uu(e,"targets","inTopK"),ms(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),ms(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),gs(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),a=r.shape[r.shape.length-1],ms(n>0&&n<=a,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+a+"), but got "+n})),[4,r.data()];case 1:return o=y.sent(),[4,i.data()];case 2:for(s=y.sent(),c=(l=[o.length/a,a])[1],h=Ns("bool",u=l[0]),p=0;p<u;p++){for(f=o.subarray(d=p*c,d+c),m=[],g=0;g<f.length;g++)m.push({value:f[g],index:g});for(m.sort((function(t,e){return e.value-t.value})),h[p]=0,g=0;g<n;g++)if(m[g].index===s[p]){h[p]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,rc(h,i.shape,"bool")]}}))}))}});function Iv(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&ms("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))}function Av(t,e,n,r,i,a){for(var o=i.strideHeight,s=i.strideWidth,l=i.dilationHeight,u=i.dilationWidth,c=i.effectiveFilterHeight,h=i.effectiveFilterWidth,p=i.padInfo.top,d=i.padInfo.left,f="max"===a?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=kc(i.outShape,n),g=m.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],v=i.outShape[2]*i.outShape[3],b=i.outShape[3],w=0;w<i.batchSize;++w)for(var x=w*y,C=w*r[0],_=0;_<i.inChannels;++_)for(var k=0;k<i.outHeight;++k)for(var S=k*o-p,O=Math.max(0,S),E=Math.min(i.inHeight,c+S),M=x+k*v,N=0;N<i.outWidth;++N){for(var P=N*s-d,T=Math.max(0,P),I=Math.min(i.inWidth,h+P),A=f,R=0,D=0,F=O;F<E;F+=l){for(var z=C+F*r[1],L=T;L<I;L+=u){var B=t[z+L*r[2]+_];"max"===a&&B>A?A=B:"avg"===a&&(R+=B,D++)}if(isNaN(A))break}g[M+N*b+_]="avg"===a?R/D:A}return m}function Rv(t,e,n,r,i,a){void 0===i&&(i=!1),void 0===a&&(a=!1);for(var o=kc(r.outShape,"int32"),s=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,d=r.padInfo.top,f=r.padInfo.left,m=kc(e,n,t),g=0;g<r.batchSize;++g)for(var y=0;y<r.inChannels;++y)for(var v=0;v<r.outHeight;++v){for(var b=v*s-d,w=b;w<0;)w+=u;for(var x=Math.min(r.inHeight,h+b),C=0;C<r.outWidth;++C){for(var _=C*l-f,k=_;k<0;)k+=c;for(var S=Math.min(r.inWidth,p+_),O=Number.NEGATIVE_INFINITY,E=-1,M=w;M<x;M+=u)for(var N=M-b,P=k;P<S;P+=c){var T=P-_,I=m.get(g,M,P,y);I>O&&(O=I,E=i?a?((g*r.inHeight+M)*r.inWidth+P)*r.inChannels+y:(M*r.inWidth+P)*r.inChannels+y:N*p+T)}o.set(E,g,v,C,y)}}return o}function Dv(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Fv=function(t){function e(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new up(e,Ml),e}return Yo(e,t),e.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,es().get("IS_NODE")&&Lu("\n============================\nHi there \u{1f44b}. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:t,dtype:n}),r},e.prototype.move=function(t,e,n,r){this.data.set(t,{values:e,dtype:r})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?Ep(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return Qs(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return kc(t.shape,t.dtype,n)},e.prototype.makeOutput=function(t,e,n){var r=this.write(t,e,n);return Ml.makeTensorFromDataId(r,e,n,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return Qo(this,void 0,void 0,(function(){var e;return Zo(this,(function(n){return e=Ks(),t(),[2,{kernelMs:Ks()-e}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,e){var n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Ml.keep(t.clone()),imag:Ml.keep(e.clone())},n},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(Iv(t,"slice"),rp(t.shape,e,n)){var r=ip(e,t.strides),i=bs(n);return rc(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var a=kc(n,t.dtype),o=this.bufferSync(t),s=0;s<a.size;++s){var l=a.indexToLoc(s).map((function(t,n){return t+e[n]}));a.values[s]=o.get.apply(o,l)}return a.toTensor()},e.prototype.stridedSlice=function(t,e,n,r){Iv(t,"stridedSlice");var i=tp(e,n,r);if(i.some((function(t){return 0===t})))return rc([],i);for(var a=kc(i,t.dtype),o=this.bufferSync(t),s=0;s<a.size;s++){for(var l=a.indexToLoc(s),u=new Array(l.length),c=0;c<u.length;c++)u[c]=l[c]*r[c]+e[c];a.set.apply(a,[o.get.apply(o,u)].concat(l))}return a.toTensor()},e.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=kc([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,a=0;a<t.rank;a++)a!==e&&(r[i++]=t.shape[a]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var l=new Array(n);for(a=0;a<l.length;a++)o[e]=a,l[a]=this.slice(t,o,s).reshape(r);return l},e.prototype.reverse=function(t,e){Iv(t,"reverse");for(var n=kc(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var a=n.indexToLoc(i),o=a.slice();e.forEach((function(e){return o[e]=t.shape[e]-1-o[e]})),n.set.apply(n,[r.get.apply(r,o)].concat(a))},a=0;a<n.size;a++)i(a);return n.toTensor()},e.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return ec(t)})),i=t.map((function(t){return nc(t)}));return tc(this.concat(r,e),this.concat(i,e))}var a=t.map((function(t){var n=bs(t.shape.slice(e));return t.as2D(-1,n)})),o=Zu(a.map((function(t){return t.shape})),1),s=kc(o,t[0].dtype).values;if(1===a[0].shape[0]){var l=0;a.forEach((function(t){s.set(n.readSync(t.dataId),l),l+=t.size}))}else{var u=0;a.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var a=i*o[1]+u,l=0;l<t.shape[1];++l)s[a+l]=e[r++];u+=t.shape[1]}))}var c=Zu(t.map((function(t){return t.shape})),e);return rc(s,c,t[0].dtype)},e.prototype.neg=function(t){return Iv(t,"neg"),this.multiply(ac(-1),t)},e.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,bl(t.dtype,e.dtype),(function(t,e){return t+e}))},e.prototype.addN=function(t){var e=this;Iv(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=kc(t[0].shape,t[0].dtype),i=r.values,a=0;a<t.length;a++)for(var o=n[a],s=0;s<i.length;s++)i[s]+=o[s];return r.toTensor()},e.prototype.softmax=function(t,e){var n=Es([e],t.shape),r=this.max(t,n),i=Gu(r.shape,n),a=this.subtract(t,r.reshape(i)),o=this.exp(a),s=this.sum(o,n).reshape(i);return Gh(o,s)},e.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,bl(t.dtype,e.dtype),(function(t,e){return t-e}))},e.prototype.pow=function(t,e){return Iv([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},e.prototype.batchMatMul=function(t,e,n,r){Iv([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],a=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=t.shape[0],l=this.readSync(t.dataId),u=this.readSync(e.dataId),c=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=c[0],p=c[1],d=c[2],f=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=f[0],g=f[1],y=f[2],v=a*o,b=kc([s,a,o],t.dtype),w=b.values,x=this.blockSize,C=0;C<s;C++)for(var _=0;_<a;_+=x)for(var k=0;k<o;k+=x)for(var S=0;S<i;S+=x)for(var O=Math.min(_+x,a),E=Math.min(k+x,o),M=Math.min(S+x,i),N=_;N<O;N++)for(var P=k;P<E;P++){for(var T=0,I=S;I<M;I++)T+=l[C*h+N*p+I*d]*u[I*m+P*g+C*y];w[C*v+(N*o+P)]+=T}return b.toTensor()},e.prototype.fusedBatchMatMul=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.batchMatMul(t.a,t.b,t.transposeA,t.transposeB);return e&&(i=this.add(i,e)),n&&(i=Dv(this,i,n,r)),i},e.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,bl(t.dtype,e.dtype),(function(t,e){return t*e}))},e.prototype.floorDiv=function(t,e){return Iv([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},e.prototype.sum=function(t,e){Iv(t,"sum"),$u("sum",e,t.rank);for(var n=Hu(t.shape,e),r=n[1],i=pc(n[0],bl(t.dtype,"int32")),a=bs(r),o=this.readSync(i.dataId),s=this.readSync(t.dataId),l=0;l<o.length;++l){for(var u=l*a,c=0,h=0;h<a;++h)c+=s[u+h];o[l]=c}return i},e.prototype.prod=function(t,e){Iv(t,"sum");for(var n=Hu(t.shape,e),r=n[1],i=pc(n[0],bl(t.dtype,"int32")),a=bs(r),o=this.readSync(i.dataId),s=this.readSync(t.dataId),l=0;l<o.length;++l){for(var u=l*a,c=1,h=0;h<a;++h)c*=s[u+h];o[l]=c}return i},e.prototype.unsortedSegmentSum=function(t,e,n){Iv(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,a=0;a<i;++a)e=e.expandDims(a+1);for(a=0;a<n;++a){var o=ac(a,"int32"),s=gg(o,e).asType("float32").mul(t).sum(0);r.push(s)}return Ac(r)},e.prototype.argMin=function(t,e){Iv(t,"argMin");var n=[e];$u("argMin",n,t.rank);for(var r=Hu(t.shape,n),i=r[1],a=pc(r[0],"int32"),o=bs(i),s=this.readSync(a.dataId),l=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,h=l[c],p=0,d=0;d<o;++d){var f=l[c+d];f<h&&(h=f,p=d)}s[u]=p}return a},e.prototype.argMax=function(t,e){Iv(t,"argMax");var n=[e];$u("argMax",n,t.rank);for(var r=Hu(t.shape,n),i=r[1],a=pc(r[0],"int32"),o=bs(i),s=this.readSync(a.dataId),l=this.readSync(t.dataId),u=0;u<s.length;++u){for(var c=u*o,h=l[c],p=0,d=0;d<o;++d){var f=l[c+d];f>h&&(h=f,p=d)}s[u]=p}return a},e.prototype.cumsum=function(t,e,n,r){if(Iv(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=bl(t.dtype,"int32"),a=pc(t.shape,i),o=this.readSync(a.dataId),s=this.readSync(t.dataId),l=t.shape[t.rank-1],u=r?function(t,e){return t+l-e-1}:function(t,e){return t+e},c=0;c<s.length;c+=l)for(var h=0;h<l;h++){var p=u(c,h);if(0===h)o[p]=n?0:s[p];else{var d=u(c,h-1);o[p]=n?s[d]+o[d]:s[p]+o[d]}}return a},e.prototype.equal=function(t,e){return Iv([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},e.prototype.notEqual=function(t,e){return Iv([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},e.prototype.less=function(t,e){return Iv([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},e.prototype.lessEqual=function(t,e){return Iv([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},e.prototype.greater=function(t,e){return Iv([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},e.prototype.greaterEqual=function(t,e){return Iv([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},e.prototype.logicalNot=function(t){Iv(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")},e.prototype.logicalAnd=function(t,e){return Iv([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},e.prototype.logicalOr=function(t,e){return Iv([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},e.prototype.select=function(t,e,n){Iv([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),a=this.readSync(n.dataId),o=pc(e.shape,bl(e.dtype,n.dtype)),s=this.readSync(o.dataId),l=0,u=0===t.rank||t.rank>1||1===e.rank?1:bs(e.shape.slice(1)),c=0;c<r.length;c++)for(var h=0;h<u;h++)s[l++]=1===r[c]?i[c]:a[c];return o},e.prototype.where=function(t){Iv([t],"where");var e=this.readSync(t.dataId);return Wp(t.shape,e)},e.prototype.topk=function(t,e,n){return Iv(t,"topk"),Up(this.readSync(t.dataId),t.shape,t.dtype,e)},e.prototype.min=function(t,e){Iv(t,"min"),$u("min",e,t.rank);for(var n=Hu(t.shape,e),r=n[1],i=pc(n[0],t.dtype),a=bs(r),o=this.readSync(i.dataId),s=this.readSync(t.dataId),l=0;l<o.length;++l){for(var u=l*a,c=s[u],h=0;h<a;++h){var p=s[u+h];p<c&&(c=p)}o[l]=c}return i},e.prototype.minimum=function(t,e){return Iv([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},e.prototype.mod=function(t,e){return Iv([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},e.prototype.max=function(t,e){Iv(t,"max"),$u("max",e,t.rank);for(var n=Hu(t.shape,e),r=n[1],i=pc(n[0],t.dtype),a=bs(r),o=this.readSync(i.dataId),s=this.readSync(t.dataId),l=0;l<o.length;++l){for(var u=l*a,c=s[u],h=0;h<a;++h){var p=s[u+h];p>c&&(c=p)}o[l]=c}return i},e.prototype.maximum=function(t,e){return Iv([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},e.prototype.all=function(t,e){Iv(t,"all"),$u("all",e,t.rank);for(var n=Hu(t.shape,e),r=n[1],i=pc(n[0],t.dtype),a=bs(r),o=this.readSync(i.dataId),s=this.readSync(t.dataId),l=0;l<o.length;++l){for(var u=l*a,c=s[u],h=0;h<a;++h)c=c&&s[u+h];o[l]=c}return i},e.prototype.any=function(t,e){Iv(t,"any"),$u("any",e,t.rank);for(var n=Hu(t.shape,e),r=n[1],i=pc(n[0],t.dtype),a=bs(r),o=this.readSync(i.dataId),s=this.readSync(t.dataId),l=0;l<o.length;++l){for(var u=l*a,c=s[u],h=0;h<a;++h)c=c||s[u+h];o[l]=c}return i},e.prototype.squaredDifference=function(t,e){return Iv([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},e.prototype.ceil=function(t){Iv(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.floor=function(t){Iv(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.sign=function(t){Iv(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return this.makeOutput(n,t.shape,"float32")},e.prototype.isNaN=function(t){Iv(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isInf=function(t){Iv(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isFinite=function(t){Iv(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.round=function(t){Iv(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return this.makeOutput(n,t.shape,"float32")},e.prototype.exp=function(t){Iv(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.expm1=function(t){Iv(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.log=function(t){Iv(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.log1p=function(t){Iv(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.sqrt=function(t){Iv(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.rsqrt=function(t){Iv(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.reciprocal=function(t){Iv(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){Iv(t,"relu");for(var e=pc(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},e.prototype.relu6=function(t){Iv(t,"relu");for(var e=pc(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return e},e.prototype.prelu=function(t,e){return Iv([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},e.prototype.elu=function(t){Iv(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return this.makeOutput(e,t.shape,"float32")},e.prototype.eluDer=function(t,e){Iv([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),a=0;a<r.length;++a){var o=r[a];n[a]=o>=1?i[a]:i[a]*(o+1)}return this.makeOutput(n,e.shape,"float32")},e.prototype.selu=function(t){Iv(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return this.makeOutput(e,t.shape,"float32")},e.prototype.clip=function(t,e,n){Iv(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),a=0;a<i.length;++a){var o=i[a];r[a]=o>n?n:o<e?e:o}return this.makeOutput(r,t.shape,"float32")},e.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return this.makeOutput(e,t.shape,"float32")},e.prototype.int=function(t){Iv(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")},e.prototype.sigmoid=function(t){Iv(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")},e.prototype.softplus=function(t){Iv(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var a,o=r[i]>-e,s=r[i]<e,l=Math.exp(r[i]);a=s?l:o?r[i]:Math.log(1+l),n[i]=a}return this.makeOutput(n,t.shape,"float32")},e.prototype.sin=function(t){Iv(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cos=function(t){Iv(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tan=function(t){Iv(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asin=function(t){Iv(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acos=function(t){Iv(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan=function(t){Iv(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan2=function(t,e){return Iv([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},e.prototype.sinh=function(t){Iv(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cosh=function(t){Iv(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tanh=function(t){Iv(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Cs(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asinh=function(t){Iv(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acosh=function(t){Iv(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atanh=function(t){Iv(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.erf=function(t){Iv(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=Math.sign(n[r]),a=Math.abs(n[r]),o=1/(1+.3275911*a);e[r]=i*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-a*a))}return this.makeOutput(e,t.shape,"float32")},e.prototype.step=function(t,e){void 0===e&&(e=0),Iv(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var a=r[i];n[i]=isNaN(a)?NaN:a>0?1:e}return this.makeOutput(n,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.conv2d(t.input,t.filter,t.convInfo);return e&&(i=this.add(i,e)),n&&(i=Dv(this,i,n,r)),i},e.prototype.conv2d=function(t,e,n){Iv([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,l=n.padInfo.top,u="channelsLast"===n.dataFormat,c=kc(n.outShape,t.dtype),h=t.strides[0],p=u?t.strides[1]:t.strides[2],d=u?t.strides[2]:1,f=u?1:t.strides[1],m=c.strides[0],g=u?c.strides[1]:c.strides[2],y=u?c.strides[2]:1,v=u?1:c.strides[1],b=this.readSync(t.dataId),w=this.readSync(e.dataId),x=c.values,C=0;C<n.batchSize;++C)for(var _=C*h,k=C*m,S=0;S<n.outHeight;++S)for(var O=k+S*g,E=S*n.strideHeight-l,M=0;M<r;M++){var N=E+M*a;if(!(N<0||N>=n.inHeight))for(var P=M*e.strides[0],T=_+N*p,I=0;I<n.outWidth;++I)for(var A=O+I*y,R=I*n.strideWidth-s,D=0;D<i;D++){var F=R+D*o;if(!(F<0||F>=n.inWidth))for(var z=T+F*d,L=P+D*e.strides[1],B=0;B<n.inChannels;++B){for(var V=b[z+B*f],U=0;U<n.outChannels;++U)x[A+U*v]+=V*w[L+U];L+=n.outChannels}}}return c.toTensor()},e.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,a=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,l=n.dilationWidth,u=n.padInfo.front,c=n.padInfo.left,h=n.padInfo.top,p=kc(n.outShape,t.dtype),d=this.readSync(t.dataId),f=this.readSync(e.dataId),m=p.values,g=0;g<n.batchSize;++g)for(var y=g*t.strides[0],v=g*p.strides[0],b=0;b<n.outDepth;++b)for(var w=v+b*p.strides[1],x=b*n.strideDepth-u,C=0;C<r;C++){var _=x+C*o;if(!(_<0||_>=n.inDepth))for(var k=C*e.strides[0],S=y+_*t.strides[1],O=0;O<n.outHeight;++O)for(var E=w+O*p.strides[2],M=O*n.strideHeight-h,N=0;N<i;N++){var P=M+N*s;if(!(P<0||P>=n.inHeight))for(var T=k+N*e.strides[1],I=S+P*t.strides[2],A=0;A<n.outWidth;++A)for(var R=E+A*n.outChannels,D=A*n.strideWidth-c,F=0;F<a;F++){var z=D+F*l;if(!(z<0||z>=n.inWidth))for(var L=I+z*n.inChannels,B=T+F*e.strides[2],V=0;V<n.inChannels;++V){for(var U=d[L+V],W=0;W<n.outChannels;++W)m[R+W]+=U*f[B+W];B+=n.outChannels}}}}return p.toTensor()},e.prototype.conv2dDerInput=function(t,e,n){Iv([t,e],"conv2dDerInput");for(var r=kc(n.inShape,"float32"),i=r.values,a=this.readSync(t.dataId),o=this.readSync(e.dataId),s=e.strides,l=s[0],u=s[1],c=s[2],h=n.batchSize,p=n.filterHeight,d=n.filterWidth,f=n.inChannels,m=n.inHeight,g=n.inWidth,y=n.outChannels,v=n.outHeight,b=n.outWidth,w=n.strideHeight,x=n.strideWidth,C=p-1-n.padInfo.top,_=d-1-n.padInfo.left,k="channelsLast"===n.dataFormat,S=r.strides[0],O=k?r.strides[1]:r.strides[2],E=k?r.strides[2]:1,M=k?1:r.strides[1],N=t.strides[0],P=k?t.strides[1]:t.strides[2],T=k?t.strides[2]:1,I=k?1:t.strides[1],A=0;A<h;++A)for(var R=0;R<f;++R)for(var D=0;D<m;++D)for(var F=D-C,z=Math.max(0,Math.ceil(F/w)),L=Math.min(v,(p+F)/w),B=0;B<g;++B){for(var V=B-_,U=Math.max(0,Math.ceil(V/x)),W=Math.min(b,(d+V)/x),j=0,q=z;q<L;++q)for(var H=q*w-F,G=U;G<W;++G)for(var $=N*A+P*q+T*G,K=l*(p-1-H)+u*(d-1-(G*x-V))+c*R,X=0;X<y;++X)j+=a[$+I*X]*o[K+X];i[S*A+O*D+E*B+M*R]=j}return r.toTensor()},e.prototype.conv3dDerInput=function(t,e,n){for(var r=kc(n.inShape,"float32"),i=r.values,a=r.strides,o=a[0],s=a[1],l=a[2],u=a[3],c=this.readSync(t.dataId),h=t.strides,p=h[0],d=h[1],f=h[2],m=h[3],g=this.readSync(e.dataId),y=e.strides,v=y[0],b=y[1],w=y[2],x=y[3],C=n.batchSize,_=n.filterDepth,k=n.filterHeight,S=n.filterWidth,O=n.inChannels,E=n.inDepth,M=n.inHeight,N=n.inWidth,P=n.outChannels,T=n.outDepth,I=n.outHeight,A=n.outWidth,R=n.strideDepth,D=n.strideHeight,F=n.strideWidth,z=_-1-n.padInfo.front,L=k-1-n.padInfo.top,B=S-1-n.padInfo.left,V=0;V<C;++V)for(var U=0;U<O;++U)for(var W=0;W<E;++W)for(var j=W-z,q=Math.max(0,Math.ceil(j/R)),H=Math.min(T,(_+j)/R),G=0;G<M;++G)for(var $=G-L,K=Math.max(0,Math.ceil($/D)),X=Math.min(I,(k+$)/D),Y=0;Y<N;++Y){for(var Q=Y-B,Z=Math.max(0,Math.ceil(Q/F)),J=Math.min(A,(S+Q)/F),tt=0,et=q;et<H;++et)for(var nt=et*R-j,rt=K;rt<X;++rt)for(var it=rt*D-$,at=Z;at<J;++at)for(var ot=p*V+d*et+f*rt+m*at,st=v*(_-1-nt)+b*(k-1-it)+w*(S-1-(at*F-Q))+x*U,lt=0;lt<P;++lt)tt+=c[ot+lt]*g[st+lt];i[o*V+s*W+l*G+u*Y+U]=tt}return r.toTensor()},e.prototype.conv2dDerFilter=function(t,e,n){Iv([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,l=kc(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,h=this.bufferSync(t),p=this.bufferSync(e),d=0;d<a;++d)for(var f=Math.max(0,Math.ceil((c-d)/r)),m=Math.min(n.outHeight,(n.inHeight+c-d)/r),g=0;g<o;++g)for(var y=Math.max(0,Math.ceil((u-g)/i)),v=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.inChannels;++b)for(var w=0;w<n.outChannels;++w){for(var x=0,C=0;C<n.batchSize;++C)for(var _=f;_<m;++_)for(var k=d+_*r-c,S=y;S<v;++S){var O=g+S*i-u;x+=s?h.get(C,k,O,b)*p.get(C,_,S,w):h.get(C,b,k,O)*p.get(C,w,_,S)}l.set(x,d,g,b,w)}return l.toTensor()},e.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,l=n.filterWidth,u=kc(n.filterShape,"float32"),c=u.values,h=u.strides,p=h[0],d=h[1],f=h[2],m=h[3],g=this.readSync(e.dataId),y=e.strides,v=y[0],b=y[1],w=y[2],x=y[3],C=this.readSync(t.dataId),_=t.strides,k=_[0],S=_[1],O=_[2],E=_[3],M=n.padInfo.front,N=n.padInfo.left,P=n.padInfo.top,T=0;T<o;++T)for(var I=Math.max(0,Math.ceil((M-T)/r)),A=Math.min(n.outDepth,(n.inDepth+M-T)/r),R=T*p,D=0;D<s;++D)for(var F=Math.max(0,Math.ceil((P-D)/i)),z=Math.min(n.outHeight,(n.inHeight+P-D)/i),L=D*d+R,B=0;B<l;++B)for(var V=Math.max(0,Math.ceil((N-B)/a)),U=Math.min(n.outWidth,(n.inWidth+N-B)/a),W=B*f+L,j=0;j<n.inChannels;++j)for(var q=j*m+W,H=0;H<n.outChannels;++H){for(var G=0,$=0;$<n.batchSize;++$)for(var K=$*k,X=$*v,Y=I;Y<A;++Y)for(var Q=(T+Y*r-M)*S+K,Z=Y*b+X,J=F;J<z;++J)for(var tt=(D+J*i-P)*O+Q,et=J*w+Z,nt=V;nt<U;++nt)G+=C[(B+nt*a-N)*E+tt+j]*g[nt*x+et+H];c[q+H]=G}return u.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.depthwiseConv2D(t.input,t.filter,t.convInfo);return e&&(i=this.add(i,e)),n&&(i=Dv(this,i,n,r)),i},e.prototype.depthwiseConv2D=function(t,e,n){Iv([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,a=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,l=n.padInfo.top,u=n.outChannels/n.inChannels,c=kc(n.outShape,t.dtype),h=this.readSync(t.dataId),p=this.readSync(e.dataId),d=c.values,f=0;f<n.batchSize;++f)for(var m=f*t.strides[0],g=f*c.strides[0],y=0;y<n.outHeight;++y)for(var v=g+y*c.strides[1],b=y*n.strideHeight-s,w=0;w<r;++w){var x=b+w*a;if(!(x<0||x>=n.inHeight))for(var C=w*e.strides[0],_=m+x*t.strides[1],k=0;k<n.outWidth;++k)for(var S=v+k*c.strides[2],O=k*n.strideWidth-l,E=0;E<i;++E){var M=O+E*o;if(!(M<0||M>=n.inWidth))for(var N=_+M*n.inChannels,P=S,T=C+E*e.strides[1],I=0;I<n.inChannels;++I){for(var A=h[N+I],R=0;R<u;++R)d[P+R]+=A*p[T+R];P+=u,T+=u}}}return c.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,e,n){Iv([t,e],"depthwiseConv2DDerInput");for(var r=kc(n.inShape,"float32"),i=r.values,a=r.strides,o=a[0],s=a[1],l=a[2],u=this.readSync(t.dataId),c=t.strides,h=c[0],p=c[1],d=c[2],f=this.readSync(e.dataId),m=e.strides,g=m[0],y=m[1],v=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,C=n.inChannels,_=n.inHeight,k=n.inWidth,S=n.outHeight,O=n.outWidth,E=n.strideHeight,M=n.strideWidth,N=w-1-n.padInfo.top,P=x-1-n.padInfo.left,T=n.outChannels/C,I=0;I<b;++I)for(var A=0;A<C;++A)for(var R=0;R<_;++R)for(var D=R-N,F=Math.max(0,Math.ceil(D/E)),z=Math.min(S,(w+D)/E),L=0;L<k;++L){for(var B=L-P,V=Math.max(0,Math.ceil(B/M)),U=Math.min(O,(x+B)/M),W=0,j=F;j<z;++j)for(var q=j*E-D,H=V;H<U;++H)for(var G=h*I+p*j+d*H,$=g*(w-1-q)+y*(x-1-(H*M-B))+v*A,K=0;K<T;++K)W+=u[G+(A*T+K)]*f[$+K];i[o*I+s*R+l*L+A]=W}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){Iv([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=kc(n.filterShape,"float32"),l=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,h=this.bufferSync(t),p=this.bufferSync(e),d=0;d<a;++d)for(var f=Math.max(0,Math.ceil((u-d)/r)),m=Math.min(n.outHeight,(n.inHeight+u-d)/r),g=0;g<o;++g)for(var y=Math.max(0,Math.ceil((l-g)/i)),v=Math.min(n.outWidth,(n.inWidth+l-g)/i),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/c),x=b%c,C=0,_=0;_<n.batchSize;++_)for(var k=f;k<m;++k)for(var S=d+k*r-u,O=y;O<v;++O)C+=h.get(_,S,g+O*i-l,w)*p.get(_,k,O,b);s.set(C,d,g,w,x)}return s.toTensor()},e.prototype.tile=function(t,e){return Iv(t,"tile"),Vp(this.bufferSync(t),e)},e.prototype.pad=function(t,e,n){Iv(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),a=this.bufferSync(t),o=kc(r,t.dtype);0!==n&&o.values.fill(n);for(var s=0;s<t.size;s++){var l=a.indexToLoc(s),u=l.map((function(t,e){return t+i[e]}));o.set.apply(o,[a.get.apply(a,l)].concat(u))}return o.toTensor()},e.prototype.gather=function(t,e,n){Iv([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var a=kc(r,t.dtype),o=this.bufferSync(t),s=0;s<a.size;++s){var l=a.indexToLoc(s),u=l.slice();u[n]=i[l[n]];var c=o.locToIndex(u);a.values[s]=o.values[c]}return a.toTensor()},e.prototype.batchToSpaceND=function(t,e,n){Iv([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=Fc(t.shape,e,r),a=zc(i.length,e.length),o=Lc(t.shape,e,r),s=Bc(n,e.length),l=Vc(o,n,e.length);return lp(t.reshape(i),a).reshape(o).slice(s,l)},e.prototype.spaceToBatchND=function(t,e,n){Iv([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var a=1+e.length;a<t.shape.length;++a)i.push([0,0]);var o=t.pad(i),s=Fc(o.shape,e,r,!1),l=zc(s.length,e.length,!1),u=Lc(o.shape,e,r,!1);return lp(o.reshape(s),l).reshape(u)},e.prototype.maxPool=function(t,e){return Iv(t,"maxPool"),Av(this.readSync(t.dataId),0,t.dtype,t.strides,e,"max").toTensor()},e.prototype.maxPoolBackprop=function(t,e,n,r){Iv([e,n],"maxPoolBackprop");for(var i=this.readSync(e.dataId),a=kc(r.outShape,e.dtype,Rv(i,e.shape,e.dtype,r).values),o=r.strideHeight,s=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=h-1-r.padInfo.left,d=c-1-r.padInfo.top,f=kc(e.shape,"float32"),m=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var y=0;y<r.inChannels;++y)for(var v=0;v<r.inHeight;++v)for(var b=0;b<r.inWidth;++b){for(var w=v-d,x=b-p,C=0,_=0;_<c;_+=l){var k=(w+_)/o;if(!(k<0||k>=r.outHeight||Math.floor(k)!==k))for(var S=0;S<h;S+=u){var O=(x+S)/s;if(!(O<0||O>=r.outWidth||Math.floor(O)!==O)){var E=c*h-1-a.get(g,k,O,y)===_*h+S?1:0;0!==E&&(C+=m.get(g,k,O,y)*E)}}}f.set(C,g,v,b,y)}return f.toTensor()},e.prototype.avgPoolBackprop=function(t,e,n){Iv([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,a=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,l=n.dilationWidth,u=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,p=u-1-n.padInfo.top,d=kc(e.shape,"float32"),f=1/(a*o),m=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var y=0;y<n.inChannels;++y)for(var v=0;v<n.inHeight;++v)for(var b=0;b<n.inWidth;++b){for(var w=v-p,x=b-h,C=0,_=0;_<u;_+=s){var k=(w+_)/r;if(!(k<0||k>=n.outHeight||Math.floor(k)!==k))for(var S=0;S<c;S+=l){var O=(x+S)/i;O<0||O>=n.outWidth||Math.floor(O)!==O||(C+=m.get(g,k,O,y))}}d.set(C*f,g,v,b,y)}return d.toTensor()},e.prototype.pool3d=function(t,e,n){Iv(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.front,d=e.padInfo.top,f=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),y=kc(e.outShape,t.dtype),v=y.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[3]*e.outShape[4],C=e.outShape[4],_=0;_<e.batchSize;++_)for(var k=_*b,S=_*t.strides[0],O=0;O<e.inChannels;++O)for(var E=0;E<e.outDepth;++E){for(var M=E*r-p,N=M;N<0;)N+=o;for(var P=Math.min(e.inDepth,u+M),T=k+E*w,I=0;I<e.outHeight;++I){for(var A=I*i-d,R=A;R<0;)R+=s;for(var D=Math.min(e.inHeight,c+A),F=T+I*x,z=0;z<e.outWidth;++z){for(var L=z*a-f,B=L;B<0;)B+=l;for(var V=Math.min(e.inWidth,h+L),U=F+z*C,W=m,j=0,q=0,H=N;H<P;H+=o){for(var G=S+H*t.strides[1],$=R;$<D;$+=s){for(var K=G+$*t.strides[2],X=B;X<V;X+=l){var Y=g[K+X*t.strides[3]+O];if("max"===n&&Y>W?W=Y:"avg"===n&&(j+=Y,q++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}v[U+O]="avg"===n?j/q:W}}}return y.toTensor()},e.prototype.avgPool3d=function(t,e){return Iv(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,e,n){Iv([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,a=n.strideWidth,o=n.filterDepth,s=n.filterHeight,l=n.filterWidth,u=n.dilationDepth,c=n.dilationHeight,h=n.dilationWidth,p=n.effectiveFilterDepth,d=n.effectiveFilterHeight,f=n.effectiveFilterWidth,m=p-1-n.padInfo.front,g=f-1-n.padInfo.left,y=d-1-n.padInfo.top,v=kc(e.shape,"float32"),b=1/(o*s*l),w=this.bufferSync(t),x=0;x<n.batchSize;++x)for(var C=0;C<n.inChannels;++C)for(var _=0;_<n.inDepth;++_)for(var k=0;k<n.inHeight;++k)for(var S=0;S<n.inWidth;++S){for(var O=_-m,E=k-y,M=S-g,N=0,P=0;P<p;P+=u){var T=(O+P)/r;if(!(T<0||T>=n.outDepth||Math.floor(T)!==T))for(var I=0;I<d;I+=c){var A=(E+I)/i;if(!(A<0||A>=n.outHeight||Math.floor(A)!==A))for(var R=0;R<f;R+=h){var D=(M+R)/a;D<0||D>=n.outWidth||Math.floor(D)!==D||(N+=w.get(x,T,A,D,C))}}}v.set(N*b,x,_,k,S,C)}return v.toTensor()},e.prototype.maxPool3d=function(t,e){return Iv(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,e){for(var n=kc(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.front,d=e.padInfo.top,f=e.padInfo.left,m=this.bufferSync(t),g=0;g<e.batchSize;++g)for(var y=0;y<e.inChannels;++y)for(var v=0;v<e.outDepth;++v){for(var b=v*r-p,w=b;w<0;)w+=o;for(var x=Math.min(e.inDepth,u+b),C=0;C<e.outHeight;++C){for(var _=C*i-d,k=_;k<0;)k+=s;for(var S=Math.min(e.inHeight,c+_),O=0;O<e.outWidth;++O){for(var E=O*a-f,M=E;M<0;)M+=l;for(var N=Math.min(e.inWidth,h+E),P=Number.NEGATIVE_INFINITY,T=-1,I=w;I<x;I+=o)for(var A=I-b,R=k;R<S;R+=s)for(var D=R-_,F=M;F<N;F+=l){var z=F-E,L=m.get(g,I,R,F,y);L>=P&&(P=L,T=A*c*h+D*c+z)}n.set(T,g,v,C,O,y)}}}return n.toTensor()},e.prototype.maxPool3dBackprop=function(t,e,n,r){Iv([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),a=r.strideDepth,o=r.strideHeight,s=r.strideWidth,l=r.dilationDepth,u=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=h-1-r.padInfo.front,m=d-1-r.padInfo.left,g=p-1-r.padInfo.top,y=kc(e.shape,"float32"),v=this.bufferSync(i),b=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var x=0;x<r.inChannels;++x)for(var C=0;C<r.inDepth;++C)for(var _=0;_<r.inHeight;++_)for(var k=0;k<r.inWidth;++k){for(var S=C-f,O=_-g,E=k-m,M=0,N=0;N<h;N+=l){var P=(S+N)/a;if(!(P<0||P>=r.outDepth||Math.floor(P)!==P))for(var T=0;T<p;T+=u){var I=(O+T)/o;if(!(I<0||I>=r.outHeight||Math.floor(I)!==I))for(var A=0;A<d;A+=c){var R=(E+A)/s;if(!(R<0||R>=r.outWidth||Math.floor(R)!==R)){var D=h*p*d-1-v.get(w,P,I,R,x)===N*p*d+T*d+A?1:0;0!==D&&(M+=b.get(w,P,I,R,x)*D)}}}}y.set(M,w,C,_,k,x)}return y.toTensor()},e.prototype.cast=function(t,e){return kp(t,e,this)},e.prototype.reshape=function(t,e){return Sp(t,e)},e.prototype.avgPool=function(t,e){return Iv(t,"avgPool"),Iv(t,"maxPool"),Av(this.readSync(t.dataId),0,t.dtype,t.strides,e,"avg").toTensor().toFloat()},e.prototype.resizeBilinear=function(t,e,n,r){Iv(t,"resizeBilinear");for(var i=t.shape,a=i[0],o=i[1],s=i[2],l=i[3],u=this.readSync(t.dataId),c=new Float32Array(bs([a,e,n,l])),h=[r&&e>1?o-1:o,r&&n>1?s-1:s],p=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=0,f=h[0]/p[0],m=h[1]/p[1],g=0;g<a;g++)for(var y=0;y<e;y++)for(var v=f*y,b=Math.floor(v),w=v-b,x=Math.min(o-1,Math.ceil(v)),C=g*t.strides[0]+b*t.strides[1],_=g*t.strides[0]+x*t.strides[1],k=0;k<n;k++)for(var S=m*k,O=Math.floor(S),E=S-O,M=Math.min(s-1,Math.ceil(S)),N=C+O*t.strides[2],P=_+O*t.strides[2],T=C+M*t.strides[2],I=_+M*t.strides[2],A=0;A<l;A++){var R=u[N+A],D=u[P+A],F=R+(u[T+A]-R)*E;c[d++]=F+(D+(u[I+A]-D)*E-F)*w}return rc(c,[a,e,n,l])},e.prototype.resizeBilinearBackprop=function(t,e,n){Iv([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],a=r[1],o=r[2],s=r[3],l=t.shape,u=l[1],c=l[2],h=new Float32Array(i*a*o*s),p=[n&&u>1?a-1:a,n&&c>1?o-1:o],d=[n&&u>1?u-1:u,n&&c>1?c-1:c],f=p[0]/d[0],m=p[1]/d[1],g=this.readSync(t.dataId),y=0,v=0;v<i;v++)for(var b=v*e.strides[0],w=0;w<u;w++)for(var x=w*f,C=Math.floor(x),_=Math.min(Math.ceil(x),a-1),k=b+C*e.strides[1],S=b+_*e.strides[1],O=x-C,E=1-O,M=0;M<c;M++)for(var N=M*m,P=Math.floor(N),T=Math.min(Math.ceil(N),o-1),I=N-P,A=1-I,R=k+P*e.strides[2],D=k+T*e.strides[2],F=S+P*e.strides[2],z=S+T*e.strides[2],L=E*A,B=E*I,V=O*A,U=O*I,W=0;W<s;W++){var j=g[y++];h[R+W]+=j*L,h[D+W]+=j*B,h[F+W]+=j*V,h[z+W]+=j*U}return uc(h,[i,o,a,s],e.dtype)},e.prototype.resizeNearestNeighbor=function(t,e,n,r){Iv(t,"resizeNearestNeighbor");for(var i=t.shape,a=i[0],o=i[1],s=i[2],l=i[3],u=this.readSync(t.dataId),c=new Float32Array(a*e*n*l),h=[r&&e>1?o-1:o,r&&n>1?s-1:s],p=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=h[0]/p[0],f=h[1]/p[1],m=0,g=0;g<a;g++)for(var y=g*t.strides[0],v=0;v<e;v++)for(var b=d*v,w=y+Math.min(o-1,r?Math.round(b):Math.floor(b))*t.strides[1],x=0;x<n;x++)for(var C=f*x,_=w+Math.min(s-1,r?Math.round(C):Math.floor(C))*t.strides[2],k=0;k<l;k++)c[m++]=u[_+k];return rc(c,[a,e,n,l],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){Iv([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],a=r[1],o=r[2],s=r[3],l=t.shape,u=l[1],c=l[2],h=new Float32Array(i*a*o*s),p=this.readSync(t.dataId),d=[n&&u>1?a-1:a,n&&c>1?o-1:o],f=[n&&u>1?u-1:u,n&&c>1?c-1:c],m=d[0]/f[0],g=d[1]/f[1],y=1/m,v=1/g,b=2*Math.ceil(y)+2,w=2*Math.ceil(v)+2,x=0;x<i;x++)for(var C=x*e.strides[0],_=0;_<a;_++)for(var k=C+_*e.strides[1],S=Math.floor(_*y),O=Math.floor(S-b/2),E=0;E<o;E++)for(var M=k+E*e.strides[2],N=Math.floor(E*v),P=Math.floor(N-w/2),T=0;T<s;T++){for(var I=0,A=0;A<b;A++){var R=A+O;if(!(R<0||R>=u)){var D=C+R*t.strides[1],F=R*m;if(_===Math.min(a-1,n?Math.round(F):Math.floor(F)))for(var z=0;z<w;z++){var L=z+P;if(!(L<0||L>=c)){var B=D+L*t.strides[2],V=L*g;E===Math.min(o-1,n?Math.round(V):Math.floor(V))&&(I+=p[B+T])}}}}h[M+T]=I}return uc(h,e.shape,e.dtype)},e.prototype.batchNormalization=function(t,e,n,r,i,a){Iv([t,e,n,i,a],"batchNorm");for(var o=this.readSync(t.dataId),s=this.readSync(e.dataId),l=this.readSync(n.dataId),u=i?this.readSync(i.dataId):new Float32Array([1]),c=a?this.readSync(a.dataId):new Float32Array([0]),h=new Float32Array(o.length),p=c.length,d=u.length,f=l.length,m=s.length,g=0,y=0,v=0,b=0,w=0;w<o.length;++w)h[w]=c[g++]+(o[w]-s[y++])*u[v++]/Math.sqrt(l[b++]+r),g>=p&&(g=0),y>=m&&(y=0),v>=d&&(v=0),b>=f&&(b=0);return uc(h,t.shape)},e.prototype.localResponseNormalization4D=function(t,e,n,r,i){Iv(t,"localResponseNormalization4D");var a=t.shape[3],o=a-1,s=this.readSync(t.dataId),l=t.size,u=new Float32Array(l);function c(t){for(var n=t%a,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,o),l=0;r<=i;r++){var u=s[r];l+=u*u}return l}for(var h=0;h<l;h++){var p=c(h),d=s[h]*Math.pow(n+r*p,-i);u[h]=d}return uc(u,t.shape)},e.prototype.LRNGrad=function(t,e,n,r,i,a,o){Iv(t,"LRNGrad");for(var s=t.shape[3],l=this.readSync(t.dataId),u=this.readSync(e.dataId),c=this.readSync(n.dataId),h=new Float32Array(t.size),p=t.size,d=0;d<p;d++){for(var f=d%s,m=d-f+Math.max(0,f-r),g=d-f+Math.min(s,f+r+1),y=0,v=m;v<g;v++)y+=Math.pow(u[v],2);for(y=a*y+i,v=m;v<g;v++){var b=-2*a*o*u[v]*c[d]/y;d===v&&(b+=Math.pow(y,-o)),h[v]+=b*=l[d]}}return uc(h,t.shape)},e.prototype.multinomial=function(t,e,n,r){Iv(t,"multinomial");for(var i=e?t:op(t),a=i.shape[0],o=i.shape[1],s=pc([a,n],"int32"),l=this.readSync(s.dataId),u=this.readSync(i.dataId),c=0;c<a;++c){var h=c*o,p=new Float32Array(o-1);p[0]=u[h];for(var d=1;d<p.length;++d)p[d]=p[d-1]+u[h+d];for(var f=Cm(r.toString()),m=c*n,g=0;g<n;++g){var y=f();l[m+g]=p.length;for(var v=0;v<p.length;v++)if(y<p[v]){l[m+g]=v;break}}}return s},e.prototype.oneHot=function(t,e,n,r){Iv(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var a=this.readSync(t.dataId),o=0;o<t.size;++o)a[o]>=0&&a[o]<e&&(i[o*e+a[o]]=n);return sc(i,[t.size,e],"int32")},e.prototype.nonMaxSuppression=function(t,e,n,r,i){return Iv(t,"nonMaxSuppression"),Ap(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=kc(t.shape,"float32"),a=kc(t.shape,"float32"),o=ec(t).as2D(n,r),s=nc(t).as2D(n,r),l=0;l<n;l++)for(var u=o.slice([l,0],[1,r]),c=s.slice([l,0],[1,r]),h=tc(u,c),p=this.readSync(this.fftImpl(h,e).dataId),d=0;d<r;d++){var f=Mp(p,d);i.values[l*r+d]=f.real,a.values[l*r+d]=f.imag}return tc(i.toTensor(),a.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=tc(ec(i).div(ac(r)),nc(i).div(ac(r)))),i}var a=this.readSync(t.dataId),o=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(a,r,e));return tc(o.real,o.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return 0==(t&t-1)},e.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,a=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),o=tc(a.real,a.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),l=tc(s.real,s.imag).as1D();o=this.fftRadix2(o,i,n),l=this.fftRadix2(l,i,n);var u=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}(e,n),c=tc(u.real,u.imag).mul(l),h=o.add(c),p=o.sub(c),d=ec(h).concat(ec(p)),f=nc(h).concat(nc(p));return tc(d,f).as1D()},e.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var a=0,o=0,s=0;s<e;s++){var l=Pp(i*s,e,n),u=Mp(t,s);a+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(a/=e,o/=e),Np(r,a,o,i)}return r},e.prototype.depthToSpace=function(t,e,n){ms("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),ms(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],a=t.shape[2],o=t.shape[3],s=i*e,l=a*e,u=o/(e*e),c=this.readSync(t.dataId),h=new Float32Array(r*s*l*u),p=0,d=0;d<r;++d)for(var f=0;f<s;++f)for(var m=Math.floor(f/e),g=f%e,y=0;y<l;++y)for(var v=Math.floor(y/e),b=(g*e+y%e)*u,w=0;w<u;++w)h[p++]=c[w+b+o*(v+a*(m+i*d))];return uc(h,[r,s,l,u])},e.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=Kc(t.shape,e.shape),a=kc(i,n),o=this.readSync(t.dataId),s=this.readSync(e.dataId),l=Gc(t.shape,i),u=Gc(e.shape,i),c=a.values;if(l.length+u.length===0)for(var h=0;h<c.length;++h)c[h]=r(o[h%o.length],s[h%s.length]);else{var p=this.bufferSync(t),d=this.bufferSync(e),f=function(n){var i=a.indexToLoc(n),h=i.slice(-t.rank);l.forEach((function(t){return h[t]=0}));var f=p.locToIndex(h),m=i.slice(-e.rank);u.forEach((function(t){return m[t]=0}));var g=d.locToIndex(m);c[n]=r(o[f],s[g])};for(h=0;h<c.length;++h)f(h)}return a.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=Kc(t.shape,e.shape),i=kc(r,"float32"),a=kc(r,"float32"),o=this.readSync(t.dataId),s=this.readSync(e.dataId),l=Gc(t.shape,r),u=Gc(e.shape,r),c=i.values,h=a.values;if(l.length+u.length===0)for(var p=0;p<c.length;p++){var d=p%o.length,f=p%s.length,m=n(o[2*d],o[2*d+1],s[2*f],s[2*f+1]);c[p]=m.real,h[p]=m.imag}else{var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=this.bufferSync(this.data.get(e.dataId).complexTensors.real),v=function(r){var a=i.indexToLoc(r),p=a.slice(-t.rank);l.forEach((function(t){return p[t]=0}));var d=g.locToIndex(p),f=a.slice(-e.rank);u.forEach((function(t){return f[t]=0}));var m=y.locToIndex(f),v=n(o[2*d],o[2*d+1],s[2*m],s[2*m+1]);c[r]=v.real,h[r]=v.imag};for(p=0;p<c.length;p++)v(p)}return this.complex(i.toTensor(),a.toTensor())},e.prototype.split=function(t,e,n){return Bp(t,e,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,e,n,r,i,a){for(var o=t.shape,s=o[0],l=o[1],u=o[2],c=o[3],h=e.shape[0],p=r[0],d=r[1],f=kc([h,p,d,c],"float32"),m=this.readSync(e.dataId),g=this.readSync(n.dataId),y=this.readSync(t.dataId),v=t.strides,b=f.strides,w=0;w<h;w++){var x=4*w,C=m[x],_=m[x+1],k=m[x+2],S=m[x+3],O=g[w];if(!(O>=s))for(var E=p>1?(k-C)*(l-1)/(p-1):0,M=d>1?(S-_)*(u-1)/(d-1):0,N=0;N<p;N++){var P=p>1?C*(l-1)+N*E:.5*(C+k)*(l-1);if(P<0||P>l-1)for(var T=0;T<d;T++)for(var I=0;I<c;I++){var A=I+T*b[2]+N*b[1]+w*b[0];f.values[A]=a}else if("bilinear"===i){var R=Math.floor(P),D=Math.ceil(P),F=P-R;for(T=0;T<d;T++)if((H=d>1?_*(u-1)+T*M:.5*(_+S)*(u-1))<0||H>u-1)for(I=0;I<c;I++)f.values[A=I+T*b[2]+N*b[1]+w*b[0]]=a;else{var z=Math.floor(H),L=Math.ceil(H),B=H-z;for(I=0;I<c;I++){var V=y[A=I+z*v[2]+R*v[1]+O*v[0]],U=y[A=I+L*v[2]+R*v[1]+O*v[0]],W=y[A=I+z*v[2]+D*v[1]+O*v[0]],j=V+(U-V)*B,q=W+(y[A=I+L*v[2]+D*v[1]+O*v[0]]-W)*B;f.values[A=I+T*b[2]+N*b[1]+w*b[0]]=j+(q-j)*F}}}else for(T=0;T<d;++T){var H;if((H=d>1?_*(u-1)+T*M:.5*(_+S)*(u-1))<0||H>u-1)for(I=0;I<c;I++)f.values[A=I+T*b[2]+N*b[1]+w*b[0]]=a;else{var G=Math.round(H),$=Math.round(P);for(I=0;I<c;I++)f.values[I+T*b[2]+N*b[1]+w*b[0]]=y[I+G*v[2]+$*v[1]+O*v[0]]}}}}return f.toTensor()},e.prototype.sparseToDense=function(t,e,n,r){var i=Qh(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=$h(t,e),a=i[0],o=i[1],s=i[2],l=i[3];if(0===o)return rc([],a,t.dtype);for(var u=new ol([o,s],t.dtype),c=this.readSync(e.dataId),h=this.readSync(t.dataId),p=0;p<o;p++){for(var d=[],f=0,m=0;m<r;m++){var g=c[p*r+m];f+=g*l[m],d.push(g)}if(f<0||f>=t.size/s)throw new Error("Invalid indices: "+d+" does not index into "+t.shape);for(var y=0;y<s;y++)u.values[p*s+y]=h[f*s+y]}return u.toTensor().reshape(a)},e.prototype.scatterND=function(t,e,n){var r=Qh(0,t,n),i=r.sliceRank,a=r.numUpdates,o=r.sliceSize,s=r.strides,l=r.outputSize,u=ac(0);return this.scatter(t,e,n,l,o,a,i,s,u,!0)},e.prototype.fill=function(t,e,n){var r=Ps(n=n||Vs(e),bs(t));return r.fill(e),Ml.makeTensor(r,t,n,this)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var e=Ps(t.dtype,bs(t.shape));return this.makeOutput(e,t.shape,t.dtype)},e.prototype.linspace=function(t,e,n){return Op(t,e,n)},e.prototype.scatter=function(t,e,n,r,i,a,o,s,l,u){var c=[r/i,i],h=this.readSync(t.dataId),p=this.readSync(e.dataId);if(0===r)return rc([],n,e.dtype);var d=new ol(c,e.dtype);d.values.fill(this.readSync(l.dataId)[0]);for(var f=0;f<a;f++){for(var m=[],g=0,y=0;y<o;y++){var v=h[f*o+y];m.push(v),g+=v*s[y]}if(g<0||g>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)u?d.values[g*i+b]+=p[f*i+b]:d.values[g*i+b]=0===e.rank?p[0]:p[f*i+b]}return d.toTensor().reshape(n)},e}(cp);function zv(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,i=r.a,a=r.b,o=n.backend;Iv([i,a],t);var s=o.data.get(i.dataId).values,l=o.data.get(a.dataId).values,u=e(i.shape,a.shape,s,l,i.dtype),c=u[1];return{dataId:o.write(u[0],c,i.dtype),shape:c,dtype:i.dtype}}}}function Lv(t){return function(e,n,r,i,a){var o=Kc(e,n),s=o.length,l=js(o),u=Ns(a,bs(o)),c=e.length,h=n.length,p=js(e),d=js(n),f=Gc(e,o),m=Gc(n,o);if(f.length+m.length===0)for(var g=0;g<u.length;++g)u[g]=t(r[g%r.length],i[g%i.length]);else{var y=function(e){var n=Js(e,s,l),a=n.slice(-c);f.forEach((function(t){return a[t]=0}));var o=Zs(a,c,p),g=n.slice(-h);m.forEach((function(t){return g[t]=0}));var y=Zs(g,h,d);u[e]=t(r[o],i[y])};for(g=0;g<u.length;++g)y(g)}return[u,o]}}Ml.registerBackend("cpu",(function(){return new Fv}),1);var Bv=Lv((function(t,e){return t/e})),Vv=zv(Uc,Bv),Uv={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(t){var e=t.attrs,n=t.inputs.x,r=e.filterSize,i=e.strides,a=e.pad,o=e.includeBatchInIndex,s=t.backend;Iv(n,"MaxPoolWithArgmax");var l=s.data.get(n.dataId).values,u=pp(n.shape,r,i,[1,1],a),c=function(t,e,n,r,i){var a=Av(t,0,n,js(e),i,"max"),o=Rv(t,e,n,i,!0,r);return[a.values,o.values]}(l,n.shape,n.dtype,o,u),h=c[1],p=s.write(c[0],u.outShape,n.dtype),d=s.write(h,u.outShape,n.dtype);return[{dataId:p,shape:u.outShape,dtype:n.dtype},{dataId:d,shape:u.outShape,dtype:"int32"}]}},Wv={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=e.boxes,i=e.scores,a=n.maxOutputSize,o=n.iouThreshold,s=n.scoreThreshold,l=n.softNmsSigma,u=t.backend;Iv(r,"NonMaxSuppressionWithScore");var c=Rp(u.data.get(r.dataId).values,u.data.get(i.dataId).values,a,o,s,l);return[c.selectedIndices,c.selectedScores]}},jv={kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs.x,n=t.backend;Iv(e,"square");for(var r=n.data.get(e.dataId).values,i=new Float32Array(r.length),a=0;a<r.length;++a){var o=r[a];i[a]=o*o}return{dataId:n.write(i,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}},qv=Lv((function(t,e){var n=t-e;return n*n}));function Hv(t,e,n,r,i){for(var a=bs(e),o=e.length,s=js(e),l=js(i),u=Ns(n,bs(i)),c=0;c<a;++c){for(var h=Js(c,o,s),p=new Array(h.length),d=0;d<p.length;d++)p[d]=h[r[d]];u[Zs(p,o,l)]=t[c]}return u}for(var Gv=0,$v=[Wv,jv,zv(Wc,qv),Vv,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(t){var e=t.inputs.x,n=t.attrs.perm,r=t.backend;Iv(e,"transpose");for(var i=new Array(e.shape.length),a=0;a<i.length;a++)i[a]=e.shape[n[a]];var o=Hv(r.data.get(e.dataId).values,e.shape,e.dtype,n,i);return{dataId:r.write(o,i,e.dtype),shape:i,dtype:e.dtype}}},Uv];Gv<$v.length;Gv++)ls($v[Gv]);for(var Kv,Xv=function(t){this.variableNames=["A"];var e=Kp(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Yv=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Kp(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},Qv=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=td(this.rank),a=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+a+"));\n    }\n    "},Zv=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=td(this.rank),a=Gp("rc",this.rank),o=new Array(this.rank);for(r=0;r<e.length;r++)o[e[r]]=a[r];var s="vec2("+o.slice(-2).join()+")",l="++"+a[this.rank-1]+" < "+n[this.rank-1],u="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+u+";\n      if("+l+") {\n        result[1] = "+u+";\n      }\n      --"+a[this.rank-1]+";\n      if(++"+a[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+u+";\n        if("+l+") {\n          result[3] = "+u+";\n        }\n      }\n      setOutput(result);\n    }\n    "},Jv=0,tb=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.backend,n=t.inputs.pixels,r="undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement,i="undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement,a=r?[n.videoWidth,n.videoHeight]:[n.width,n.height],o=a[0],s=a[1],l=[s,o],u=[s,o,t.attrs.numChannels];(i||r)&&(null==Kv&&(Kv=document.createElement("canvas").getContext("2d")),Kv.canvas.width=o,Kv.canvas.height=s,Kv.drawImage(n,0,0,o,s),n=Kv.canvas);var c=e.makeTensorInfo(l,"int32");e.texData.get(c.dataId).usage=Il.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(c.dataId),n);var h=es().getBool("WEBGL_PACK")?new Yv(u):new Xv(u),p=e.runWebGLProgram(h,[c],"int32");return e.disposeData(c.dataId),p}},{kernelName:Uc,backendName:"webgl",kernelFunc:function(t){var e=t.inputs;return function(t,e,n){var r=new dd("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return es().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new md("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",t.shape,e.shape,!0)),n.runWebGLProgram(r,[t,e],"float32")}(e.a,e.b,t.backend)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;Lu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e.scores,a=r.maxOutputSize,o=r.iouThreshold,s=r.scoreThreshold,l=r.softNmsSigma,u=n,c=Rp(u.readSync(e.boxes.dataId),u.readSync(i.dataId),a,o,s,l);return[c.selectedIndices,c.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs.x,n=t.backend,r=new Kf(e.shape,"return x * x;");return n.runWebGLProgram(r,[e],e.dtype)}},{kernelName:Wc,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=e.a,r=e.b,i=t.backend,a=es().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new md("return (a - b) * (a - b);",n.shape,r.shape):new dd("return (a - b) * (a - b);",n.shape,r.shape);return i.compileAndRun(a,[n,r])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(t){for(var e,n=t.inputs.x,r=t.attrs.perm,i=t.backend,a=new Array(n.shape.length),o=0;o<a.length;o++)a[o]=n.shape[r[o]];if(i.shouldExecuteOnCPU([n])){var s=Hv(i.texData.get(n.dataId).values,n.shape,n.dtype,r,a);e=i.makeTensorInfo(a,n.dtype),i.texData.get(e.dataId).values=s}else e=function(t,e,n){var r=es().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Zv(t.shape,e):new Qv(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}(n,r,i);return e}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(t){var e=t.attrs,n=t.inputs.x,r=e.filterSize,i=e.strides,a=e.pad,o=e.includeBatchInIndex,s=t.backend;ms(4===n.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank "+n.shape.length+"."}));var l=[1,1];ms(Cp(i,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+l+"'"}));var u=pp(n.shape,r,i,l,a),c=function(t,e,n,r){var i=new Of(n,"max",!1),a=r.runWebGLProgram(i,[t],"float32");return i=new Of(n,"max",!0,!0,e),[a,r.runWebGLProgram(i,[t],"float32")]}(n,o,u,s);return[c[0],c[1]]}}];Jv<tb.length;Jv++)ls(tb[Jv]);for(var eb=0,nb=[{kernelName:"Add",inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],i=Kc(n.shape,r.shape);return{a:function(){var e=t,r=$c(n.shape,i);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},b:function(){var e=t,n=$c(r.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(t,e){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}},{kernelName:jc,gradFunc:function(t,e,n){for(var r=n.inputShape,i=n.shape,a=Array.from(i),o=r.length-1;o>=0;o--)if(r[o]===i[o])a[o]=1;else if(1!==r[o])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+i+"].");var s=[];for(o=0;o<a.length;o++)a[o]>1&&s.push(o);return{x:function(){return t.sum(s,!0)}}}},{kernelName:Uc,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],i=Kc(n.shape,r.shape);return{a:function(){var e=Gh(t,r.toFloat()),a=$c(n.shape,i);return a.length>0?_y(e,a).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),a=$c(r.shape,i);a.length>0&&(e=_y(e,a).reshape(r.shape));var o=dg(r);return dh(Gh(e,o.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(t,e,n){var r=n.varianceEpsilon,i=e[0],a=e[1],o=e[2],s=e[3],l=Sm(i),u=null==s?ac(1):s,c=$c(a.shape,l.shape),h=[];if(1===a.rank){for(var p=0;p<l.shape.length-1;++p)h.push(l.shape[p]);h.push(1)}var d=qh(i,a),f=Bh(t,u),m=gh(Hc(o,ac(r))),g=Bh(Bh(Bh(m,m),m),ac(-.5));return{x:function(){return Pc(Bh(Bh(t,1===a.rank?Km(m.as4D(1,1,1,a.shape[0]),h):m),u),i.shape)},mean:function(){var t=Bh(Bh(m,ac(-1)),f);return 1===a.rank&&(t=_y(t,c)),Pc(t,a.shape)},variance:function(){var t=Bh(Bh(g,d),f);return 1===a.rank&&(t=_y(t,c)),Pc(t,a.shape)},scale:function(){var e=Bh(d,m),n=Bh(t,e);return 1===a.rank&&(n=_y(n,c)),Pc(n,a.shape)},offset:function(){var e=t;return 1===a.rank&&(e=_y(e,c)),Pc(e,a.shape)}}}},{kernelName:qc,gradFunc:function(t){return{x:function(){return t.toFloat()}}}},{kernelName:"OneHot",inputsToSave:["indices"],gradFunc:function(t,e){var n=e[0];return{indices:function(){return pc(n.shape,"float32")}}}},{kernelName:"PadV2",inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.paddings.map((function(t){return t[0]}));return{x:function(){return t.slice(i,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Wc,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],i=ac(2);return{a:function(){return Bh(t,Bh(i,qh(n,r)))},b:function(){return Bh(t,Bh(i,qh(r,n)))}}}},{kernelName:"Tile",inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],i=n.reps;return{x:function(){var e=yc(r);if(1===r.rank)for(var n=0;n<i[0];++n)e=e.add(t.slice([n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(n=0;n<i[0];++n)for(var a=0;a<i[1];++a)e=e.add(t.slice([n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(n=0;n<i[0];++n)for(a=0;a<i[1];++a)for(var o=0;o<i[2];++o)e=e.add(t.slice([n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(n=0;n<i[0];++n)for(a=0;a<i[1];++a)for(o=0;o<i[2];++o)for(var s=0;s<i[3];++s)e=e.add(t.slice([n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:"Transpose",gradFunc:function(t,e,n){var r=Xu(n.perm);return{x:function(){return lp(t,r)}}}}];eb<nb.length;eb++)us(nb[eb]);var rb=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();es().get("IS_BROWSER")&&es().setPlatform("browser",new rb);var ib,ab=function(){function t(){this.util=n(3),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=es().global.fetch?es().global.fetch(t,e):(null==ib&&(ib=n(2)),ib(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();es().get("IS_NODE")&&es().setPlatform("node",new ab);var ob={float32:4,int32:4,uint16:2,uint8:1,bool:1};function sb(t,e){for(var n={},r=0,i=function(e){var i=e.name,a=e.dtype,o=e.shape,s=bs(o),l=void 0;if("quantization"in e){var u=e.quantization;if("uint8"!==u.dtype&&"uint16"!==u.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+u.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var c=ob[u.dtype],h=t.slice(r,r+s*c),p="uint8"===u.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===a)l=Float32Array.from(p,(function(t){return t*u.scale+u.min}));else{if("int32"!==a)throw new Error("Unsupported dtype in weight '"+i+"': "+a);l=Int32Array.from(p,(function(t){return Math.round(t*u.scale+u.min)}))}r+=s*c}else if("string"===a){var d=bs(e.shape);l=[];for(var f=0;f<d;f++){var m=new Uint32Array(t.slice(r,r+4))[0];r+=4;var g=new Uint8Array(t.slice(r,r+m));l.push(g),r+=m}}else{var y=ob[a];if(h=t.slice(r,r+s*y),"float32"===a)l=new Float32Array(h);else if("int32"===a)l=new Int32Array(h);else{if("bool"!==a)throw new Error("Unsupported dtype in weight '"+i+"': "+a);l=new Uint8Array(h)}r+=s*y}n[i]=rc(l,o,a)},a=0,o=e;a<o.length;a++)i(o[a]);return n}function lb(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var ub="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function cb(t){return ub?Buffer.byteLength(t):new Blob([t]).size}function hb(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function pb(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function db(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:cb(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:cb(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var fb=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),mb="://",gb=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){ms(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(mb)&&(e=e.slice(0,e.indexOf(mb))),ms(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();ms(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function yb(t){if(-1===t.indexOf(mb))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+gb.getSchemes().join(","));return{scheme:t.split(mb)[0],path:t.split(mb)[1]}}function vb(t,e,n){return void 0===n&&(n=!1),Qo(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h;return Zo(this,(function(p){switch(p.label){case 0:return ms(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),ms((r=fb.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),ms(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],ms((a=fb.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),ms(a.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),o=a[0],s=yb(t).scheme,l=yb(t).path,u=s===yb(t).scheme,[4,i.load()];case 1:return c=p.sent(),n&&u?[4,gb.getManager(s).removeModel(l)]:[3,3];case 2:p.sent(),p.label=3;case 3:return[4,o.save(c)];case 4:return h=p.sent(),!n||u?[3,6]:[4,gb.getManager(s).removeModel(l)];case 5:p.sent(),p.label=6;case 6:return[2,h.modelArtifactsInfo]}}))}))}var bb="models_store",wb="model_info_store";function xb(){if(!es().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Cb(t){var e=t.result;e.createObjectStore(bb,{keyPath:"modelPath"}),e.createObjectStore(wb,{keyPath:"modelPath"})}var _b=function(){function t(t){if(this.indexedDB=xb(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Cb(i)},i.onsuccess=function(){var a=i.result;if(null==e){var o=a.transaction(bb,"readonly"),s=o.objectStore(bb).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return a.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return a.close(),r(s.error)},o.oncomplete=function(){return a.close()}}else{var l,u=db(e),c=a.transaction(wb,"readwrite"),h=c.objectStore(wb),p=h.put({modelPath:n.modelPath,modelArtifactsInfo:u});p.onsuccess=function(){var i=(l=a.transaction(bb,"readwrite")).objectStore(bb).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:u});i.onsuccess=function(){return t({modelArtifactsInfo:u})},i.onerror=function(t){var e=(h=c.objectStore(wb)).delete(n.modelPath);e.onsuccess=function(){return a.close(),r(i.error)},e.onerror=function(t){return a.close(),r(i.error)}}},p.onerror=function(t){return a.close(),r(p.error)},c.oncomplete=function(){null==l?a.close():l.oncomplete=function(){return a.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),kb=function(t){return es().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(_b.URL_SCHEME)?(e=t.slice(_b.URL_SCHEME.length),new _b(e)):null;var e};fb.registerSaveRouter(kb),fb.registerLoadRouter(kb);var Sb=function(){function t(){this.indexedDB=xb()}return t.prototype.listModels=function(){return Qo(this,void 0,void 0,(function(){var t=this;return Zo(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Cb(r)},r.onsuccess=function(){var t=r.result,i=t.transaction(wb,"readonly"),a=i.objectStore(wb).getAll();a.onsuccess=function(){for(var t={},n=0,r=a.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},a.onerror=function(e){return t.close(),n(a.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return Qo(this,void 0,void 0,(function(){var e=this;return Zo(this,(function(n){var r;return t=(r=t).startsWith(_b.URL_SCHEME)?r.slice(_b.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Cb(i)},i.onsuccess=function(){var e,a=i.result,o=a.transaction(wb,"readwrite"),s=o.objectStore(wb),l=s.get(t);l.onsuccess=function(){if(null==l.result)return a.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=s.delete(t),o=function(){var i=(e=a.transaction(bb,"readwrite")).objectStore(bb).delete(t);i.onsuccess=function(){return n(l.result.modelArtifactsInfo)},i.onerror=function(t){return r(l.error)}};i.onsuccess=o,i.onerror=function(t){return o(),a.close(),r(l.error)}},l.onerror=function(t){return a.close(),r(l.error)},o.oncomplete=function(){null==e?a.close():e.oncomplete=function(){return a.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(es().getBool("IS_BROWSER"))try{gb.registerManager(_b.URL_SCHEME,new Sb)}catch(gl){}var Ob="/",Eb="tensorflowjs_models",Mb="info",Nb="model_topology",Pb="weight_specs",Tb="weight_data",Ib="model_metadata";function Ab(t){return{info:[Eb,t,Mb].join(Ob),topology:[Eb,t,Nb].join(Ob),weightSpecs:[Eb,t,Pb].join(Ob),weightData:[Eb,t,Tb].join(Ob),modelMetadata:[Eb,t,Ib].join(Ob)}}function Rb(t){var e=t.split(Ob);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(Ob)}var Db=function(){function t(t){if(!es().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Ab(this.modelPath)}return t.prototype.save=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r;return Zo(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=db(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(ub)return Buffer.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},t.prototype.load=function(){return Qo(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return Zo(this,(function(s){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(a=JSON.parse(i),e.format=a.format,e.generatedBy=a.generatedBy,e.convertedBy=a.convertedBy,e.userDefinedMetadata=a.userDefinedMetadata),null==(o=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(ub){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(o),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),Fb=function(t){return es().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Db.URL_SCHEME)?(e=t.slice(Db.URL_SCHEME.length),new Db(e)):null;var e};fb.registerSaveRouter(Fb),fb.registerLoadRouter(Fb);var zb=function(){function t(){ms(es().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),ms("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return Qo(this,void 0,void 0,(function(){var t,e,n,r,i,a;return Zo(this,(function(o){for(t={},e=Eb+Ob,n=Ob+Mb,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(a=Rb(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return Qo(this,void 0,void 0,(function(){var e,n;return Zo(this,(function(r){var i;if(t=(i=t).startsWith(Db.URL_SCHEME)?i.slice(Db.URL_SCHEME.length):i,e=Ab(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(es().getBool("IS_BROWSER"))try{gb.registerManager(Db.URL_SCHEME,new zb)}catch(gl){}function Lb(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Bb=function(){function t(e){if(!es().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r,i;return Zo(this,(function(a){switch(a.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,Lb((function(){return r.dispatchEvent(new MouseEvent("click"))}))];case 2:return a.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,Lb((function(){return i.dispatchEvent(new MouseEvent("click"))}))]);case 3:a.sent(),a.label=4;case 4:return[2,{modelArtifactsInfo:db(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),Vb=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return Qo(this,void 0,void 0,(function(){var t,e,n=this;return Zo(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var a=new FileReader;a.onload=function(a){var o=JSON.parse(a.target.result),s=o.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var l=o.weightsManifest;if(null!=l){var u;try{u=n.checkManifestAndWeightFiles(l,e)}catch(t){return void i(t)}var c=[],h=[],p=[];l.forEach((function(t){t.paths.forEach((function(t){h.push(t),p.push(null)})),c.push.apply(c,t.weights)})),l.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);p[i]=n,-1===p.indexOf(null)&&r({modelTopology:s,weightSpecs:c,weightData:hb(p),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(u[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},a.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},a.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return pb(t.name)})),i={},a=0,o=t;a<o.length;a++)o[a].paths.forEach((function(t){var a=pb(t);if(-1!==n.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: '"+a+"'");if(n.push(a),-1===r.indexOf(a))throw new Error("Weight file with basename '"+a+"' is not provided.");i[t]=e[r.indexOf(a)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function Ub(t,e,n,r){!function(t){ms(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){ms(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),ms(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),ms(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(a){return a.then((function(a){var o=n+ ++i/t.length*(r-n);return e(o),a})),a})))}function Wb(t,e){return Qo(this,void 0,void 0,(function(){var n,r,i,a,o,s,l,u,c;return Zo(this,(function(h){switch(h.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?es().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,a=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=h.sent(),[3,4];case 2:return[4,Ub(r,e.onProgress,i,a)];case 3:o=h.sent(),h.label=4;case 4:return s=o.map((function(t){return t.arrayBuffer()})),l=.5,u=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return c=h.sent(),[3,8];case 6:return[4,Ub(s,e.onProgress,l,u)];case 7:c=h.sent(),h.label=8;case 8:return[2,c]}}))}))}function jb(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),Qo(e,void 0,void 0,(function(){var e,a,o,s,l,u,c,h,p,d;return Zo(this,(function(f){switch(f.label){case 0:if(e=n.map((function(){return!1})),a={},o=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var l=ob["quantization"in t?t.quantization.dtype:t.dtype]*bs(t.shape),u=function(){e[n]=!0,null==a[n]&&(a[n]=[]),a[n].push({manifestEntry:t,groupOffset:r,sizeBytes:l})};null!=i?i.forEach((function(e,n){e===t.name&&(u(),o[n]=!0)})):u(),s.push(t.name),r+=l}))})),!o.every((function(t){return t})))throw l=i.filter((function(t,e){return!o[e]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return u=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),c=[],u.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;c.push(e)}))})),[4,t(c)];case 1:return h=f.sent(),p={},d=0,u.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=h[d+i].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),l=0,u=0;u<e;u++){var c=new Uint8Array(h[d+u]);s.set(c,l),l+=c.byteLength}a[t].forEach((function(t){var e=sb(o.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)p[n]=e[n]})),d+=e})),[2,p]}}))}))}}fb.registerSaveRouter((function(t){return es().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Bb.URL_SCHEME)?function(t){return void 0===t&&(t="model"),new Bb(t)}(t.slice(Bb.URL_SCHEME.length)):null}));var qb=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(ms("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=es().platform.fetch,ms(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&ms(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return Qo(this,void 0,void 0,(function(){var e,n;return Zo(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:db(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},t.prototype.load=function(){return Qo(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,s,l,u,c,h;return Zo(this,(function(p){switch(p.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=p.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");p.label=2;case 2:return p.trys.push([2,4,,5]),[4,t.json()];case 3:return e=p.sent(),[3,5];case 4:throw p.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,a=e.generatedBy,o=e.convertedBy,s=e.format,l=e.userDefinedMetadata,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:h=p.sent(),u=h[0],c=h[1],p.label=7;case 7:return[2,{modelTopology:r,weightSpecs:u,weightData:c,userDefinedMetadata:l,generatedBy:a,convertedBy:o,format:s}]}}))}))},t.prototype.loadWeights=function(t){return Qo(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,l,u,c;return Zo(this,(function(h){switch(h.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],a=this.weightPathPrefix||r,o=[],s=0,l=t;s<l.length;s++)o.push.apply(o,l[s].weights);return u=[],t.forEach((function(t){t.paths.forEach((function(t){u.push(a+t+i)}))})),[4,Wb(u,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return c=h.sent(),[2,[o,hb(c)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function Hb(t){return null!=t.match(qb.URL_SCHEME_REGEX)}var Gb=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return Hb(t)})):Hb(t))?$b(t,{onProgress:e}):null};function $b(t,e){return new qb(t,e)}fb.registerSaveRouter(Gb),fb.registerLoadRouter(Gb);var Kb,Xb=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),Yb=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),Qb=Object.freeze({browserFiles:function(t){return new Vb(t)},browserHTTPRequest:function(t,e){return $b(t,e)},concatenateArrayBuffers:hb,decodeWeights:sb,encodeWeights:function(t,e){return Qo(this,void 0,void 0,(function(){var n,r,i,a,o,s=this;return Zo(this,(function(l){switch(l.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),a=function(a){var o=i[a],l=Array.isArray(t)?t[a].tensor:t[o];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+l.dtype);var u={name:o,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var c=new Promise((function(t){return Qo(s,void 0,void 0,(function(){var e,n,r,i,a,o,s;return Zo(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(e=u.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+4*e.length,r=new Uint8Array(n),i=0,a=0;a<e.length;a++)o=e[a],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,i),r.set(o,i+=4),i+=o.length;return t(r),[2]}}))}))}));r.push(c)}else r.push(l.data());null!=e&&(u.group=e),n.push(u)},o=0;o<i.length;++o)a(o);return[4,Promise.all(r)];case 1:return[2,{data:lb(l.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Xb(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xb({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xb({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return fb.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:db,getSaveHandlers:function(t){return fb.getSaveHandlers(t)},http:$b,isHTTPScheme:Hb,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),Qo(this,void 0,void 0,(function(){return Zo(this,(function(i){return[2,jb((function(t){return Wb(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return fb.registerLoadRouter(t)},registerSaveRouter:function(t){return fb.registerSaveRouter(t)},weightsLoaderFactory:jb,withSaveHandler:function(t){return new Yb(t)},copyModel:function(t,e){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(n){return[2,vb(t,e,!1)]}))}))},listModels:function(){return Qo(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return Zo(this,(function(s){switch(s.label){case 0:t=gb.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?[4,gb.getManager(i=r[n]).listModels()]:[3,4];case 2:for(o in a=s.sent())e[i+mb+o]=a[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(n){return[2,vb(t,e,!0)]}))}))},removeModel:function(t){return Qo(this,void 0,void 0,(function(){var e;return Zo(this,(function(n){return e=yb(t),[2,gb.getManager(e.scheme).removeModel(e.path)]}))}))}}),Zb=Ju({confusionMatrix_:function(t,e,n){var r=Uu(t,"labels","confusionMatrix"),i=Uu(e,"predictions","confusionMatrix");ms(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),ms(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),ms(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),ms(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),ms(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var a=Qm(r.asType("int32"),n),o=Qm(i.asType("int32"),n);return a.transpose().matMul(o).asType("int32")}}),Jb=(Object.freeze({confusionMatrix:Zb}),Ju({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,a=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(i&&i&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=as("FromPixels",Ml.backendName))return Ml.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,l,u=i?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=u[0],h=u[1];if(o?s=t.getContext("2d").getImageData(0,0,c,h).data:r||n?s=t.data:(a||i)&&(null==Kb&&(Kb=document.createElement("canvas").getContext("2d")),Kb.canvas.width=c,Kb.canvas.height=h,Kb.drawImage(t,0,0,c,h),s=Kb.getImageData(0,0,c,h).data),4===e)l=new Int32Array(s);else{var p=c*h;l=new Int32Array(p*e);for(var d=0;d<p;d++)for(var f=0;f<e;++f)l[d*e+f]=s[4*d+f]}return lc(l,[h,c,e],"int32")}})),tw=Object.freeze({toPixels:function(t,e){return Qo(this,void 0,void 0,(function(){var n,r,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,b,w,x,C;return Zo(this,(function(_){switch(_.label){case 0:if(n=Uu(t,"img","toPixels"),t instanceof cl||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],a=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=_.sent(),l=n.min(),u=n.max(),[4,Promise.all([l.data(),u.data()])];case 2:if(c=_.sent(),h=c[0][0],p=c[1][0],l.dispose(),u.dispose(),"float32"===n.dtype){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(d="float32"===n.dtype?255:1,f=new Uint8ClampedArray(a*i*4),m=0;m<i*a;++m)g=void 0,y=void 0,v=void 0,b=void 0,1===o?(g=s[m]*d,y=s[m]*d,v=s[m]*d,b=255):3===o?(g=s[3*m]*d,y=s[3*m+1]*d,v=s[3*m+2]*d,b=255):4===o&&(g=s[4*m]*d,y=s[4*m+1]*d,v=s[4*m+2]*d,b=s[4*m+3]*d),f[0+(w=4*m)]=Math.round(g),f[w+1]=Math.round(y),f[w+2]=Math.round(v),f[w+3]=Math.round(b);return null!=e&&(e.width=a,e.height=i,x=e.getContext("2d"),C=new ImageData(f,a,i),x.putImageData(C,0,0)),n!==t&&n.dispose(),[2,f]}}))}))},fromPixels:Jb}),ew=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),nw=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function rw(t){ms(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),ms("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),ms(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),nw.register(t)}var iw=Object.freeze({Serializable:ew,SerializationMap:nw,registerClass:rw}),aw=(Object.freeze({gpgpu_util:hf,webgl_util:Tu,forceHalfFloat:function(){es().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:dm,setWebGLContext:Fl,GPGPUContext:pf}),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yo(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,a=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:a[t.name]}}));this.applyGradients(o)}else this.applyGradients(a);return Fu(a),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return function(t,e){ms(Us(t),(function(){return"The f passed in variableGrads(f) must be a function"})),ms(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof yl})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Ml.registeredVariables)e.push(Ml.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,a=e.length;ms((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+a+" variables is trainable."}));var o=Ml.gradients(t,e,null,!0),s=o.value,l=o.grads;ms(l.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),ms(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var u={};return e.forEach((function(t,e){null!=l[e]&&(u[t.name]=l[e])})),null!=i&&i.forEach((function(t){return u[t.name]=null})),{value:s,grads:u}}(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&Fu(this.iterations_)},e.prototype.saveIterations=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:ac(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return Qo(this,void 0,void 0,(function(){var e;return Zo(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(ew));Object.defineProperty(aw,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var ow=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=Ml.backend.epsilon()),i}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ml.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:Du((function(){return yc(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:Du((function(){return yc(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;Du((function(){var t=o.mul(e.rho).add(a.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(o.add(e.epsilon).sqrt()).mul(a),r=s.mul(e.rho).add(n.square().mul(1-e.rho));o.assign(t),s.assign(r);var l=n.mul(-e.learningRate).add(i);i.assign(l)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Fu(this.accumulatedGrads.map((function(t){return t.variable}))),Fu(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){var t;return Zo(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){var e;return Zo(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(aw);rw(ow);var sw=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ml.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:Du((function(){return dc(i.shape,e.initialAccumulatorValue).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedGrads[r].variable;Du((function(){var t=o.add(a.square());o.assign(t);var n=a.div(t.add(Ml.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&Fu(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(aw);rw(sw);var lw=function(t){function e(e,n,r,i){void 0===i&&(i=null);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],Du((function(){a.accBeta1=ac(n).variable(),a.accBeta2=ac(r).variable()})),null==i&&(a.epsilon=Ml.backend.epsilon()),a}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Du((function(){var r=qh(1,e.accBeta1),i=qh(1,e.accBeta2);n.forEach((function(n,a){var o=Ml.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:n+"/m",variable:Du((function(){return yc(o).variable(!1)}))}),null==e.accumulatedSecondMoment[a]&&(e.accumulatedSecondMoment[a]={originalName:n+"/v",variable:Du((function(){return yc(o).variable(!1)}))});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var l=e.accumulatedFirstMoment[a].variable,u=e.accumulatedSecondMoment[a].variable,c=l.mul(e.beta1).add(s.mul(1-e.beta1)),h=u.mul(e.beta2).add(s.square().mul(1-e.beta2)),p=c.div(r),d=h.div(i);l.assign(c),u.assign(h);var f=p.div(d.sqrt().add(e.epsilon)).mul(-e.learningRate).add(o);o.assign(f)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Fu(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Fu(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){var t;return Zo(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){var e,n=this;return Zo(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),Du((function(){n.accBeta1.assign(Uh(n.beta1,n.iterations_+1)),n.accBeta2.assign(Uh(n.beta2,n.iterations_+1))})),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(aw);rw(lw);var uw=function(t){function e(e,n,r,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.decay=a,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],Du((function(){o.iteration=ac(0).variable(),o.accBeta1=ac(n).variable()})),null==i&&(o.epsilon=Ml.backend.epsilon()),o}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);Du((function(){var r=qh(1,e.accBeta1),i=Gh(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,a){var o=Ml.registeredVariables[n];null==e.accumulatedFirstMoment[a]&&(e.accumulatedFirstMoment[a]={originalName:n+"/m",variable:yc(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[a]&&(e.accumulatedWeightedInfNorm[a]={originalName:n+"/v",variable:yc(o).variable(!1)});var s=Array.isArray(t)?t[a].tensor:t[n];if(null!=s){var l=e.accumulatedFirstMoment[a].variable,u=e.accumulatedWeightedInfNorm[a].variable,c=l.mul(e.beta1).add(s.mul(1-e.beta1)),h=u.mul(e.beta2),p=s.abs(),d=h.maximum(p);l.assign(c),u.assign(d);var f=i.div(r).mul(c.div(d.add(e.epsilon))).add(o);o.assign(f)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Fu(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Fu(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(aw);rw(uw);var cw=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var a=Ml.registeredVariables[n];Du((function(){var t=e.c.mul(i).add(a);a.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=zu(ac(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(aw);rw(cw);var hw=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=ac(i.momentum),i}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ml.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:Du((function(){return yc(i).variable(!1)}))});var a=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&Du((function(){var t,n=e.m.mul(a).add(o);t=e.useNesterov?e.c.mul(o.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),a.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Fu(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){return Zo(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(cw);rw(hw);var pw=function(t){function e(e,n,r,i,a){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===a&&(a=!1);var o=t.call(this)||this;if(o.learningRate=e,o.decay=n,o.momentum=r,o.epsilon=i,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=a,null==i&&(o.epsilon=Ml.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return Yo(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Ml.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:Du((function(){return yc(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:Du((function(){return yc(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:Du((function(){return yc(i).variable(!1)}))});var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var o=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;Du((function(){var t=o.mul(e.decay).add(a.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,l=n.mul(e.decay).add(a.mul(1-e.decay)),u=s.mul(e.momentum).add(a.mul(e.learningRate).div(t.sub(l.square().add(e.epsilon)).sqrt()));o.assign(t),n.assign(l),s.assign(u);var c=i.sub(u);i.assign(c)}else{var h=o.mul(e.decay).add(a.square().mul(1-e.decay));u=s.mul(e.momentum).add(a.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),o.assign(h),s.assign(u),c=i.sub(u),i.assign(c)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Fu(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Fu(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Fu(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return Qo(this,void 0,void 0,(function(){var t;return Zo(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return Qo(this,void 0,void 0,(function(){var e;return Zo(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(aw);rw(pw);var dw=function(){function t(){}return t.sgd=function(t){return new cw(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new hw(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new pw(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new lw(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new ow(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new uw(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new sw(t,e)},t}(),fw={sgd:dw.sgd,momentum:dw.momentum,adadelta:dw.adadelta,adagrad:dw.adagrad,rmsprop:dw.rmsprop,adamax:dw.adamax,adam:dw.adam},mw="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(t){return t()};function gw(){return new Promise((function(t){return mw((function(){return t()}))}))}cl.prototype.add=function(t){return Hc(this,t)},cl.prototype.broadcastTo=function(t){return Bm(this,t)},cl.prototype.div=function(t){return Gh(this,t)},cl.prototype.divNoNan=function(t){return $m(this,t)},cl.prototype.squaredDifference=function(t){return fg(this,t)},cl.prototype.tile=function(t){return Km(this,t)},cl.prototype.oneHot=function(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=0),Qm(this,t,e,n)},cl.prototype.transpose=function(t){return lp(this,t)},cl.prototype.pad=function(t,e){return Zm(this,t,e)},cl.prototype.batchNorm=function(t,e,n,r,i){return Nm(this,t,e,n,r,i)},ll=Tv;var yw=function(t,e){return(yw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function vw(t,e){function n(){this.constructor=t}yw(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var bw,ww=function(){return(ww=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function xw(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}l((r=r.apply(t,e||[])).next())}))}function Cw(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function _w(){return null==bw&&(bw=Ml.backend.epsilon()),bw}var kw=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return vw(e,t),e}(Error),Sw=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return vw(e,t),e}(Error),Ow=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return vw(e,t),e}(Error),Ew=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return vw(e,t),e}(Error),Mw=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return vw(e,t),e}(Error);function Nw(t,e){if(Array.isArray(t)){for(var n=[],r=0;r<e;r++)n=n.concat(t);return n}return(n=new Array(e)).fill(t),n}function Pw(t,e){if(!t)throw new Mw(e)}function Tw(t,e){for(var n=0,r=0,i=t;r<i.length;r++)i[r]===e&&n++;return n}function Iw(t){return 1===t.length?t[0]:t}function Aw(t){return Array.isArray(t)?t:[t]}function Rw(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function Dw(t){return t.length<=1?t:-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(function(t,e){return e.toUpperCase()}))}!function(t){vw((function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}),t)}(Error);var Fw={};function zw(t){if(null==t)return null;var e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Lw(t,e,n,r,i){var a,o,s;if(void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r="object"),void 0===i&&(i=!1),"string"==typeof t){var l=void 0;if(t in n)l=n[t];else if(t in Fw)l=Fw[t];else if(null==(l=e[t]))throw new Ow("Unknown "+r+": "+t+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var u=t;if(null==u.className||null==u.config)throw new Ow(r+": Improper config format: "+JSON.stringify(u)+".\n'className' and 'config' must set.");var c=u.className,h=void 0,p=void 0;if(c in n?(h=(a=n[c])[0],p=a[1]):c in Fw?(h=(o=Fw.className)[0],p=o[1]):c in e&&(h=(s=e[c])[0],p=s[1]),null==h)throw new Ow("Unknown "+r+": "+c+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(null!=p){for(var d={},f=0,m=Object.keys(Fw);f<m.length;f++)d[x=m[f]]=Fw[x];for(var g=0,y=Object.keys(n);g<y.length;g++)d[x=y[g]]=n[x];u.config.customObjects=d;for(var v=ww({},Fw),b=0,w=Object.keys(n);b<w.length;b++){var x=w[b];Fw[x]=n[x]}!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach((function(e){return t(e)}));else for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],a=e[i];null!=a&&"object"==typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!=typeof a.value?t(a):e[i]=a.value)}}(u.config);var C=p(h,u.config,n,i);return Fw=ww({},v),C}v=ww({},Fw);for(var _=0,k=Object.keys(n);_<k.length;_++)Fw[x=k[_]]=n[x];return C=new h(u.config),Fw=ww({},v),C}function Bw(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function Vw(t){if(null==t)return t;for(var e=[],n=0,r=t;n<r.length;n++){var i=r[n];-1===e.indexOf(i)&&e.push(i)}return e}function Uw(t){if(null==t)throw new Ow("Invalid value in obj: "+JSON.stringify(t));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function Ww(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new Ow(n+" is not a valid "+e+".  Valid values are "+t+" or null/undefined.")}function jw(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=1/0),Pw(n>=0),Pw(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((function(t){return typeof t===e}))}function qw(t,e){Array.isArray(t)?(tl.assert(t.length>0,(function(){return e+" is unexpectedly an empty array."})),t.forEach((function(t,n){return qw(t,"element "+(n+1)+" of "+e)}))):tl.assert(Number.isInteger(t)&&t>0,(function(){return"Expected "+e+" to be a positive integer, but got "+function t(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return t(e)})).join(",")+"]":"string"==typeof e?'"'+e+'"':""+e}(t)+"."}))}function Hw(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function Gw(t,e){return Du((function(){return Sh(_y(Vh(t,t),e,!0))}))}var $w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.getConfig=function(){return{}},e}(iw.Serializable),Kw=function(t){function e(e){var n=t.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return vw(e,t),e.prototype.apply=function(t){var e=this;return Du((function(){var n=Gw(t,e.axis),r=rh(n,0,e.maxValue);return Bh(t,Gh(r,Hc(_w(),n)))}))},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e.className="MaxNorm",e}($w);iw.registerClass(Kw);var Xw=function(t){function e(e){var n=t.call(this)||this;return n.defaultAxis=0,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return vw(e,t),e.prototype.apply=function(t){var e=this;return Du((function(){return Gh(t,Hc(_w(),Gw(t,e.axis)))}))},e.prototype.getConfig=function(){return{axis:this.axis}},e.className="UnitNorm",e}($w);iw.registerClass(Xw);var Yw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return My(t)},e.className="NonNeg",e}($w);iw.registerClass(Yw);var Qw=function(t){function e(e){var n=t.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=e.minValue?e.minValue:n.defaultMinValue,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.rate=null!=e.rate?e.rate:n.defaultRate,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return vw(e,t),e.prototype.apply=function(t){var e=this;return Du((function(){var n=Gw(t,e.axis),r=Hc(Bh(e.rate,rh(n,e.minValue,e.maxValue)),Bh(1-e.rate,n));return Bh(t,Gh(r,Hc(_w(),n)))}))},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e.className="MinMaxNorm",e}($w);iw.registerClass(Qw);var Zw={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Jw(t){return zw(t)}function tx(t,e){return void 0===e&&(e={}),Lw(t,iw.SerializationMap.getMap().classNameMap,e,"constraint")}function ex(t){return null==t?null:"string"==typeof t?tx({className:t in Zw?Zw[t]:t,config:{}}):t instanceof $w?t:tx(t)}Object.freeze({maxNorm:function(t){return new Kw(t)},unitNorm:function(t){return new Xw(t)},nonNeg:function(){return new Yw},minMaxNorm:function(t){return new Qw(t)}});var nx=["channelsFirst","channelsLast"],rx=["valid","same","causal"],ix=["max","avg"],ax=["sum","mul","concat","ave"],ox=new Map;function sx(t){Ww(nx,"DataFormat",t)}function lx(t){Ww(rx,"PaddingMode",t)}function ux(t){Ww(ix,"PoolMode",t)}var cx=[];function hx(t,e){cx.push(t);try{var n=e();return cx.pop(),n}catch(t){throw cx.pop(),t}}function px(t){if(!mx(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===cx.length?"":cx.join("/")+"/")+t}function dx(t){if(!mx(t))throw new Error("Not a valid tensor name: '"+t+"'");ox.has(t)||ox.set(t,0);var e=ox.get(t);if(ox.set(t,ox.get(t)+1),e>0){var n=t+"_"+e;return ox.set(n,1),n}return t}var fx=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function mx(t){return!!t.match(fx)}function gx(t){return t===parseInt(t.toString(),10)}function yx(t,e,n){null==e&&(e=0),null==n&&(n=t.length);for(var r=1,i=e;i<n;++i)r*=t[i];return r}function vx(t){return oc(t=Array.isArray(t)?new Float32Array(t):t)}function bx(t){return xy(vx(t)).dataSync()[0]}function wx(t){return by(vx(t)).dataSync()[0]}function xx(t,e){if(e<t)throw new Ow("end ("+e+") < begin ("+t+") is forbidden.");for(var n=[],r=t;r<e;++r)n.push(r);return n}function Cx(t,e){return t.asType(e)}function _x(t,e){void 0===e&&(e=-1);var n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function kx(t,e,n){return Du((function(){switch(t.rank){case 1:return uy(t,e,n);case 2:return cy(t,[e,0],[n,t.shape[1]]);case 3:return hy(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return py(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ly(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ly(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Ow("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}))}function Sx(t,e,n){return Du((function(){switch(t.rank){case 1:return uy(t,e,n);case 2:return cy(t,[0,e],[t.shape[0],n]);case 3:return hy(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return py(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Ow("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}}))}function Ox(t,e,n,r){return Du((function(){switch(t.rank){case 1:return uy(t,e,n);case 2:switch(r){case 1:return kx(t,e,n);case 2:return Sx(t,e,n);default:throw new Ow("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return kx(t,e,n);case 2:return hy(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Sx(t,e,n);default:throw new Ow("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return kx(t,e,n);case 2:return py(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return py(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Sx(t,e,n);default:throw new Ow("The axis is not within the rank of the tensor "+r)}default:throw new Ow("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}}))}function Ex(t,e){var n;return void 0===e&&(e=-1),e<0&&(e=0!==(n=t[0].rank)?n:0),e===t[0].rank&&(e=-1),vc(t,e)}function Mx(t,e){switch(t.rank){case 1:return bc([t,e]);case 2:return wc([t,e],0);case 3:return xc([t,e],0);case 4:return Cc([t,e],0);default:throw new Ow("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function Nx(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Ow("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+t.rank+")");return Km(t,e)}function Px(t,e,n,r,i){return void 0===e&&(e=0),void 0===n&&(n=1),hg(t,e,n,r,i)}function Tx(t,e,n,r){if(t.rank<2||e.rank<2)throw new Ew("dot requires both inputs to be rank >= 2 but got x shape = "+t.shape+" and y shape = "+e.shape);if(e.rank>=3&&t.shape.slice(-1)[0]!==(c=e.shape.slice(-2)[0]))throw new Ew("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+t.shape+" and  y shape = "+e.shape);if(2===t.rank&&2===e.rank){var i=!1,a=!1;return Pv.matMul({a:t,b:e,transposeA:i,transposeB:a,bias:r?Rx(t.rank,r,"channelsLast"):null,activation:n})}var o=t.shape.slice(),s=o.pop();t=t.reshape([-1,s]);var l=e.shape.slice(),u=l.pop(),c=l.pop(),h=l.concat([u]),p=Array.from({length:e.rank},(function(t,n){return 0===n?e.rank-2:n<=e.rank-2?n-1:n}));e=e.transpose(p).reshape([c,-1]);var d=o.concat(h);return Pv.matMul({a:t,b:e,transposeA:i=!1,transposeB:a=!1,bias:r?Rx(t.rank,r,"channelsLast"):null,activation:n}).reshape(d)}function Ix(t,e,n){return Du((function(){return e=Array.isArray(e)?oc(e,"int32"):e.toInt(),Pg(t,e,n)}))}function Ax(t){return Vh(t,t)}function Rx(t,e,n){var r=e.shape;if(1!==e.rank&&e.rank!==t)throw new Ow("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(t<3)return e;throw new Ow("Unsupported input rank by biasAdd: "+e.rank)}function Dx(t,e,n){return Du((function(){return null==n&&(n="channelsLast"),sx(n),t.add(Rx(t.rank,e,n))}))}function Fx(t,e,n,r){return Du((function(){return $y(t,e,n,r)}))}function zx(t,e,n){return void 0===n&&(n=!1),n?t():e()}var Lx=["fanIn","fanOut","fanAvg"],Bx=["normal","uniform","truncatedNormal"],Vx=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e}(iw.Serializable),Ux=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t,e){return pc(t,e)},e.className="Zeros",e}(Vx);iw.registerClass(Ux);var Wx=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t,e){return hc(t,e)},e.className="Ones",e}(Vx);iw.registerClass(Wx);var jx=function(t){function e(e){var n=t.call(this)||this;if("object"!=typeof e)throw new Ow("Expected argument of type ConstantConfig but got "+e);if(void 0===e.value)throw new Ow("config must have value set but got "+e);return n.value=e.value,n}return vw(e,t),e.prototype.apply=function(t,e){var n=this;return Du((function(){return Bh(ac(n.value),hc(t,e))}))},e.prototype.getConfig=function(){return{value:this.value}},e.className="Constant",e}(Vx);iw.registerClass(jx);var qx=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=e.minval||n.DEFAULT_MINVAL,n.maxval=e.maxval||n.DEFAULT_MAXVAL,n.seed=e.seed,n}return vw(e,t),e.prototype.apply=function(t,e){return pg(t,this.minval,this.maxval,e)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e.className="RandomUniform",e}(Vx);iw.registerClass(qx);var Hx=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return vw(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Ew("randomNormal does not support dType "+e+".");return Px(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="RandomNormal",e}(Vx);iw.registerClass(Hx);var Gx=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return vw(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Ew("truncatedNormal does not support dType "+e+".");return mg(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="TruncatedNormal",e}(Vx);iw.registerClass(Gx);var $x=function(t){function e(e){var n=t.call(this)||this;return n.gain=null!=e.gain?e.gain:1,n}return vw(e,t),e.prototype.apply=function(t,e){var n=this;return Du((function(){if(2!==t.length||t[0]!==t[1])throw new Ow("Identity matrix initializer can only be used for 2D square matrices.");return Bh(n.gain,Xm(t[0]))}))},e.prototype.getConfig=function(){return{gain:this.gain}},e.className="Identity",e}(Vx);iw.registerClass($x);var Kx=function(t){function e(e){var n=t.call(this)||this;if(e.scale<0)throw new Ow("scale must be a positive float. Got: "+e.scale);return n.scale=null==e.scale?1:e.scale,n.mode=null==e.mode?"fanIn":e.mode,function(t){Ww(Lx,"FanMode",t)}(n.mode),n.distribution=null==e.distribution?"normal":e.distribution,function(t){Ww(Bx,"Distribution",t)}(n.distribution),n.seed=e.seed,n}return vw(e,t),e.prototype.apply=function(t,e){var n=function(t,e){var n,r;if(void 0===e&&(e="channelsLast"),sx(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length))if("channelsFirst"===e){var i=yx(t,2);n=t[1]*i,r=t[0]*i}else"channelsLast"===e&&(i=yx(t,0,t.length-2),n=t[t.length-2]*i,r=t[t.length-1]*i);else{var a=yx(t);n=Math.sqrt(a),r=Math.sqrt(a)}return[n,r]}(t),r=n[0],i=n[1],a=this.scale;if(a/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,i):Math.max(1,(r+i)/2),"normal"===this.distribution){var o=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Ew(this.getClassName()+" does not support dType "+e+".");return mg(t,0,o,e,this.seed)}var s=Math.sqrt(3*a);return pg(t,-s,s,e)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e.className="VarianceScaling",e}(Vx);iw.registerClass(Kx);var Xx=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})||this}return vw(e,t),e.prototype.getClassName=function(){return Kx.className},e.className="GlorotUniform",e}(Kx);iw.registerClass(Xx);var Yx=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})||this}return vw(e,t),e.prototype.getClassName=function(){return Kx.className},e.className="GlorotNormal",e}(Kx);iw.registerClass(Yx);var Qx=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return vw(e,t),e.prototype.getClassName=function(){return Kx.className},e.className="HeNormal",e}(Kx);iw.registerClass(Qx);var Zx=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return vw(e,t),e.prototype.getClassName=function(){return Kx.className},e.className="HeUniform",e}(Kx);iw.registerClass(Zx);var Jx=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return vw(e,t),e.prototype.getClassName=function(){return Kx.className},e.className="LeCunNormal",e}(Kx);iw.registerClass(Jx);var tC=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return vw(e,t),e.prototype.getClassName=function(){return Kx.className},e.className="LeCunNormal",e}(Kx);iw.registerClass(tC);var eC=function(t){function e(e){var n=t.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==e.gain?n.DEFAULT_GAIN:e.gain,n.seed=e.seed,null!=n.seed)throw new Ew("Random seed is not implemented for Orthogonal Initializer yet.");return n}return vw(e,t),e.prototype.apply=function(t,e){var n=this;return Du((function(){if(2!==t.length)throw new Ew("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var e=Px(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),r=mv.gramSchmidt(e);return t[0]>t[1]&&(r=r.transpose()),Bh(n.gain,r)}))},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e.className="Orthogonal",e}(Vx);iw.registerClass(eC);var nC={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function rC(t,e){return void 0===e&&(e={}),Lw(t,iw.SerializationMap.getMap().classNameMap,e,"initializer")}function iC(t){return zw(t)}function aC(t){if("string"==typeof t){var e=t in nC?nC[t]:t;if("GlorotNormal"===e)return new Yx;if("GlorotUniform"===e)return new Xx;if("HeNormal"===e)return new Qx;if("HeUniform"===e)return new Zx;if("LeCunNormal"===e)return new Jx;if("LeCunUniform"===e)return new tC;var n={};return n.className=e,n.config={},rC(n)}return t instanceof Vx?t:rC(t)}Object.freeze({zeros:function(){return new Ux},ones:function(){return new Wx},constant:function(t){return new jx(t)},randomUniform:function(t){return new qx(t)},randomNormal:function(t){return new Hx(t)},truncatedNormal:function(t){return new Gx(t)},identity:function(t){return new $x(t)},varianceScaling:function(t){return new Kx(t)},glorotUniform:function(t){return new Xx(t)},glorotNormal:function(t){return new Yx(t)},heNormal:function(t){return new Qx(t)},heUniform:function(t){return new Zx(t)},leCunNormal:function(t){return new Jx(t)},leCunUniform:function(t){return new tC(t)},orthogonal:function(t){return new eC(t)}});var oC=0;function sC(){return oC++}var lC={};function uC(t){return void 0===t&&(t=""),t in lC||(lC[t]=0),lC[t]+=1,t+lC[t].toString()}function cC(t){return Array.isArray(t)&&Array.isArray(t[0])}function hC(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function pC(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new Ow("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function dC(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new Ow("Expected exactly 1 Shape; got "+t.length)}return t}function fC(t){for(var e=0,n=0,r=t;n<r.length;n++){var i=r[n];e+=0===i.shape.length?1:i.shape.reduce((function(t,e){return t*e}))}return e}var mC=function(){function t(t,e,n,r,i){void 0===e&&(e="float32"),void 0===n&&(n="Variable"),void 0===r&&(r=!0),void 0===i&&(i=null),this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=sC(),this.originalName=px(n=null==n?"Variable":n),this.name=dx(this.originalName),this.trainable_=r,this.constraint=i,this.val=cc(t,this.trainable_,this.name,this.dtype)}return t.prototype.read=function(){return this.assertNotDisposed(),this.val},t.prototype.write=function(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},t.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},t.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),t}();function gC(t){return t.map((function(t){return t.read()}))}function yC(t){t.forEach((function(t){t[0].write(t[1])}))}var vC,bC,wC=function(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},xC=function(t,e,n,r,i,a,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=sC(),null!=a&&(this.originalName=px(a),this.name=dx(this.originalName)),this.rank=e.length},CC=0,_C=function(){function t(t,e){this.callArgs=e,this.id=CC++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var n=0,r=t.inboundLayers;n<r.length;n++){var i=r[n];null!=i&&i.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return t.prototype.getConfig=function(){for(var t=[],e=0,n=this.inboundLayers;e<n.length;e++){var r=n[e];t.push(null!=r?r.name:null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},t}(),kC=0,SC=function(t){function e(e){var n=t.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=kC++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=e.name;if(!r){var i=n.getClassName();r=Rw(i)+"_"+uC(i)}if(n.name=r,n.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){var a=void 0;if(null!=e.batchInputShape)a=e.batchInputShape;else if(null!=e.inputShape){var o=null;null!=e.batchSize&&(o=e.batchSize),a=[o].concat(e.inputShape)}n.batchInputShape=a;var s=e.dtype;null==s&&(s=e.inputDType),null==s&&(s="float32"),n.dtype=s}return n.initialWeights=null!=e.weights?e.weights:null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return vw(e,t),e.nodeKey=function(t,e){return t.name+"_ib-"+e.toString()},e.prototype.getNodeAtIndex=function(t,e){if(0===this.inboundNodes.length)throw new Sw("The layer has never been called and thus has no defined "+e+".");if(this.inboundNodes.length<=t)throw new Ow("Asked to get "+e+" at node "+t+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return Iw(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return Iw(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new kw("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new kw("Layer "+this.name+" is not connected, no input to return.");return Iw(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new kw("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new kw("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Iw(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map((function(t){return t()}))},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach((function(e){return e.trainable=t})),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter((function(t){return t.trainable})):[]},set:function(t){this._trainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter((function(t){return!t.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){if(t=Aw(t),null!=this.inputSpec&&0!==this.inputSpec.length){var e=Aw(this.inputSpec);if(t.length!==e.length)throw new Ow("Layer "+this.name+" expects "+e.length+" inputs, but it received "+t.length+" input tensors. Input received: "+t);for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(null!=i){var a=r.rank;if(null!=i.ndim&&a!==i.ndim)throw new Ow("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+i.ndim+", found ndim="+a);if(null!=i.maxNDim&&a>i.maxNDim)throw new Ow("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+i.maxNDim+", found ndim="+a);if(null!=i.minNDim&&a<i.minNDim)throw new Ow("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+i.minNDim+", found ndim="+a+".");if(null!=i.dtype&&r.dtype!==i.dtype)throw new Ow("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+i.dtype+", found dtype="+r.dtype+".");if(i.axes){var o=r.shape;for(var s in i.axes){var l=Number(s),u=i.axes[s];if(null!=u&&-1===[u,null].indexOf(l>=0?o[l]:o[o.length+l]))throw new Ow("Input "+n+" is incompatible with layer "+this.name+": expected axis "+l+" of input shape to have value "+u+" but got shape "+o+".")}}if(null!=i.shape)for(var c=0;c<i.shape.length;++c){var h=i.shape[c],p=r.shape[c];if(null!=h&&null!=p&&h!==p)throw new Ow("Input "+n+" is incompatible with layer "+this.name+": expected shape="+i.shape+", found shape="+r.shape+".")}}}}},e.prototype.call=function(t,e){return t},e.prototype.invokeCallHook=function(t,e){null!=this._callHook&&this._callHook(t,e)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,e){var n=this;e=e||{},this.assertNotDisposed();for(var r=Aw(t),i=!0,a=0,o=r;a<o.length;a++)if(!(o[a]instanceof xC)){i=!1;break}for(var s=!0,l=0,u=r;l<u.length;l++)if(u[l]instanceof xC){s=!1;break}if(i===s)throw new Ow("Arguments to apply() must be all SymbolicTensors or all Tensors");return hx(this.name,(function(){if(!n.built){n.assertInputCompatibility(t);for(var i=[],a=0,o=Aw(t);a<o.length;a++)i.push(o[a].shape);n.build(Iw(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&s&&(n._refCount=1)}if(n.assertInputCompatibility(t),s){for(var l=[],u=0,c=Aw(f=n.call(t,e));u<c.length;u++){var h=c[u];-1!==r.indexOf(h)&&(h=h.clone()),l.push(h)}if(f=Iw(l),null!=n.activityRegularizer)throw new Ew("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}var p=function(t){for(var e=[],n=0,r=t=Aw(t);n<r.length;n++)e.push(r[n].shape);return Iw(e)}(t),d=n.computeOutputShape(p),f=void 0,m="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(t)?p[0]:p),f=null!=d&&d.length>0&&Array.isArray(d[0])?d.map((function(r,i){return new xC(m,r,n,Aw(t),e,n.name,i)})):new xC(m,d,n,Aw(t),e,n.name),n.addInboundNode(t,f,null,null,p,d,e),n._refCount++,null!=n.activityRegularizer)throw new Ew("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}))},e.prototype.warnOnIncompatibleInputShape=function(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var e=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor ("+JSON.stringify(t)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new kw("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var t=[],e=0,n=this.inboundNodes;e<n.length;e++){var r=JSON.stringify(n[e].outputShapes);-1===t.indexOf(r)&&t.push(r)}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new kw("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new Sw("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return fC(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return void 0===t&&(t=!1),gC(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var e=this;Du((function(){var n=e.weights;if(n.length!==t.length)throw new Ow('You called setWeights(weights) on layer "'+e.name+'" with a weight list of length '+t.length+", but the layer was expecting "+n.length+" weights. Provided weights: "+t+"...");if(0!==n.length){for(var r=[],i=gC(n),a=0;a<i.length;++a){var o=i[a],s=n[a],l=t[a];if(!tl.arraysEqual(o.shape,l.shape))throw new Ow("Layer weight shape "+o.shape+" not compatible with provided weight shape "+l.shape);r.push([s,l])}yC(r)}}))},e.prototype.addWeight=function(t,e,n,r,i,a,o){if(-1!==this._addedWeightNames.indexOf(t))throw new Ow("Duplicate weight name "+t+" for layer "+this.name);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=aC("zeros"));var s=r.apply(e,n),l=new mC(s,n,t,a,o);return s.dispose(),null!=i&&this.addLoss((function(){return i.apply(l.read())})),null==a&&(a=!0),a?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var e;null==t||Array.isArray(t)&&0===t.length||(t=Aw(t),null!=this._losses&&(e=this.losses).push.apply(e,t))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,e){var n=this;if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");e.forEach((function(t){if(null!=t)throw new TypeError("Layer "+n.name+" does not support masking, but was passed an inputMask.")}))}return null}return e},e.prototype.addInboundNode=function(t,e,n,r,i,a,o){void 0===o&&(o=null);var s=Aw(t);e=Aw(e),n=Aw(n),r=Aw(r),i=hC(i),a=hC(a);for(var l=[],u=[],c=[],h=0,p=s;h<p.length;h++){var d=p[h];l.push(d.sourceLayer),u.push(d.nodeIndex),c.push(d.tensorIndex)}new _C({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:c,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(var f=0;f<e.length;f++)e[f].sourceLayer=this,e[f].nodeIndex=this.inboundNodes.length-1,e[f].tensorIndex=f},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach((function(t){return t.dispose()})),this.weights.length},e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e}(iw.Serializable),OC=function(t){function e(e){var n=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:uC("input").toString()})||this;if(null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Ow("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new Ow("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Ow("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";n.batchInputShape=r,n.dtype=i,n.inputSpec=[{shape:r}];var a=new xC(n.dtype,n.batchInputShape,n,[],{},n.name);return a.nodeIndex=0,a.tensorIndex=0,new _C({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return vw(e,t),e.prototype.apply=function(t,e){throw new Ow("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e.className="InputLayer",e}(SC);function EC(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new Ow("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));var n=t.dtype;return null==n&&(n="float32"),new OC({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function MC(t){return xw(this,void 0,void 0,(function(){var e,n,r,i,a,o,s,l;return Cw(this,(function(u){switch(u.label){case 0:if(null==t)return[2];for(i in e=[],n=[],r=[],t)"number"!=typeof(a=t[i])&&(e.push((o=a).data()),n.push(i),r.push(o));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(s=u.sent(),l=0;l<s.length;++l)t[n[l]]=s[l][0];Fu(r),u.label=2;case 2:return[2]}}))}))}function NC(t){if(null!=t)for(var e in t){var n=t[e];"number"!=typeof n&&n.dispose()}}iw.registerClass(OC),(bC=vC||(vC={}))[bC.SILENT=0]="SILENT",bC[bC.VERBOSE=1]="VERBOSE";var PC=function(){function t(){this.validationData=null}return t.prototype.setParams=function(t){this.params=t},t.prototype.onEpochBegin=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return[2]}))}))},t.prototype.onEpochEnd=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return[2]}))}))},t.prototype.onBatchBegin=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return[2]}))}))},t.prototype.onBatchEnd=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return[2]}))}))},t.prototype.onTrainBegin=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return[2]}))}))},t.prototype.onTrainEnd=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return[2]}))}))},t.prototype.setModel=function(t){},t}(),TC=function(){function t(t,e){void 0===e&&(e=10),null==t&&(t=[]),this.callbacks=t,this.queueLength=e}return t.prototype.append=function(t){this.callbacks.push(t)},t.prototype.setParams=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setParams(t)},t.prototype.setModel=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setModel(t)},t.prototype.onEpochBegin=function(t,e){return xw(this,void 0,void 0,(function(){var n,r;return Cw(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onEpochEnd=function(t,e){return xw(this,void 0,void 0,(function(){var n,r;return Cw(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onBatchBegin=function(t,e){return xw(this,void 0,void 0,(function(){var n,r;return Cw(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onBatchEnd=function(t,e){return xw(this,void 0,void 0,(function(){var n,r;return Cw(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onBatchEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onTrainBegin=function(t){return xw(this,void 0,void 0,(function(){var e,n;return Cw(this,(function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainBegin(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t.prototype.onTrainEnd=function(t){return xw(this,void 0,void 0,(function(){var e,n;return Cw(this,(function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainEnd(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t}(),IC=function(t){function e(){return t.call(this)||this}return vw(e,t),e.prototype.onEpochBegin=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return this.seen=0,this.totals={},[2]}))}))},e.prototype.onBatchEnd=function(t,e){return xw(this,void 0,void 0,(function(){var t,n,r,i,a=this;return Cw(this,(function(o){for(i in null==e&&(e={}),this.seen+=t=null==e.size?0:e.size,n=function(n){var i=e[n];if("number"==typeof i)r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+i*t;else{var o=void 0;n in r.totals?o=r.totals[n]:r.totals[n]=0;var s=Du((function(){return Hc(a.totals[n],Bh(i,t))}));r.totals[n]=s,null!=o&&o.dispose()}},r=this,e)n(i);return[2]}))}))},e.prototype.onEpochEnd=function(t,e){return xw(this,void 0,void 0,(function(){var t,n,r,i,a=this;return Cw(this,(function(o){if(null!=e)for(t=function(t){if(null==n.totals[t])return"continue";"number"==typeof n.totals[t]?e[t]=n.totals[t]/n.seen:Du((function(){var n=Bh(Gh(1,a.seen),a.totals[t]);e[t]=n,a.totals[t].dispose(),zu(e[t])}))},n=this,r=0,i=this.params.metrics;r<i.length;r++)t(i[r]);return[2]}))}))},e}(PC),AC=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.onTrainBegin=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return this.epoch=[],this.history={},[2]}))}))},e.prototype.onEpochEnd=function(t,e){return xw(this,void 0,void 0,(function(){var n;return Cw(this,(function(r){for(n in null==e&&(e={}),this.epoch.push(t),e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n]);return[2]}))}))},e.prototype.syncData=function(){return xw(this,void 0,void 0,(function(){var t,e,n,r,i,a,o,s;return Cw(this,(function(l){switch(l.label){case 0:for(r in t=[],e=[],n=[],this.history)for(i=this.history[r],a=0;a<i.length;++a)"number"!=typeof i[a]&&(t.push(i[a].data()),e.push(r),n.push(a));return[4,Promise.all(t)];case 1:for(o=l.sent(),s=0;s<o.length;++s)this.history[e[s]][n[s]].dispose(),this.history[e[s]][n[s]]=o[s][0];return[2]}}))}))},e}(PC),RC=function(t){function e(e,n){var r=t.call(this)||this;if(r.currentEpoch=0,r.yieldEvery=n||"auto","auto"===r.yieldEvery&&(r.yieldEvery=125),"never"===r.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return tl.isNumber(r.yieldEvery)&&(r.maybeWait=function(t,e){var n,r=tl.now();return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=tl.now();return o-r<e?n:(r=o,n=t.apply(void 0,i))}}(r.maybeWait.bind(r),r.yieldEvery)),r.trainBegin=e.onTrainBegin,r.trainEnd=e.onTrainEnd,r.epochBegin=e.onEpochBegin,r.epochEnd=e.onEpochEnd,r.batchBegin=e.onBatchBegin,r.batchEnd=e.onBatchEnd,r.yield=e.onYield,r}return vw(e,t),e.prototype.maybeWait=function(t,e,n){return xw(this,void 0,void 0,(function(){var r;return Cw(this,(function(i){switch(i.label){case 0:return r=[],null==this.yield?[3,2]:[4,MC(n)];case 1:i.sent(),r.push(this.yield(t,e,n)),i.label=2;case 2:return r.push(gw()),[4,Promise.all(r)];case 3:return i.sent(),[2]}}))}))},e.prototype.onEpochBegin=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){switch(n.label){case 0:return this.currentEpoch=t,null==this.epochBegin?[3,3]:[4,MC(e)];case 1:return n.sent(),[4,this.epochBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onEpochEnd=function(t,e){return xw(this,void 0,void 0,(function(){var n;return Cw(this,(function(r){switch(r.label){case 0:return n=[],null==this.epochEnd?[3,2]:[4,MC(e)];case 1:r.sent(),n.push(this.epochEnd(t,e)),r.label=2;case 2:return"epoch"===this.yieldEvery&&n.push(gw()),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onBatchBegin=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,MC(e)];case 1:return n.sent(),[4,this.batchBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onBatchEnd=function(t,e){return xw(this,void 0,void 0,(function(){var n;return Cw(this,(function(r){switch(r.label){case 0:return n=[],null==this.batchEnd?[3,2]:[4,MC(e)];case 1:r.sent(),n.push(this.batchEnd(t,e)),r.label=2;case 2:return"batch"===this.yieldEvery?n.push(gw()):tl.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onTrainBegin=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(e){switch(e.label){case 0:return null==this.trainBegin?[3,3]:[4,MC(t)];case 1:return e.sent(),[4,this.trainBegin(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype.onTrainEnd=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(e){switch(e.label){case 0:return null==this.trainEnd?[3,3]:[4,MC(t)];case 1:return e.sent(),[4,this.trainEnd(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e}(PC);function DC(t,e){return null==t&&(t={}),t instanceof PC?[t]:Array.isArray(t)&&t[0]instanceof PC?t:Aw(t).map((function(t){return new RC(t,e)}))}var FC=function(){function t(){}return t.registerCallbackConstructor=function(e,n){tl.assert(e>=0&&Number.isInteger(e),(function(){return"Verbosity level is expected to be an integer >= 0, but got "+e})),t.checkForDuplicate(n),null==t.constructors[e]&&(t.constructors[e]=[]),t.constructors[e].push(n)},t.checkForDuplicate=function(e){for(var n in t.constructors)t.constructors[+n].forEach((function(t){if(t===e)throw new Ow("Duplicate callback constructor.")}))},t.clear=function(){t.constructors={}},t.createCallbacks=function(e){var n=[];for(var r in t.constructors){var i=+r;e>=i&&n.push.apply(n,t.constructors[i])}return n.map((function(t){return new t}))},t.constructors={},t}();function zC(t,e,n,r,i,a,o,s,l){var u=new AC,c=[new IC].concat(FC.createCallbacks(e));null!=t&&c.push.apply(c,t),c.push(u);var h=new TC(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:e,doValidation:s,metrics:l}),{callbackList:h,history:u}}function LC(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=!1),Lw(t,iw.SerializationMap.getMap().classNameMap,e,"layer",n)}function BC(t,e){return Du((function(){"float32"!==t.dtype&&(t=t.asType("float32"));var n=_y(Ax(t),e,!0),r=dc(n.shape,_w()),i=Sh(Ah(n,r));return Gh(t,i)}))}function VC(t,e){return Du((function(){return wy(Ax(qh(e,t)),-1)}))}function UC(t,e){return Du((function(){return wy(Xc(qh(e,t)),-1)}))}function WC(t,e){return Du((function(){var n=qh(t,e),r=rh(Xc(t),_w(),Number.MAX_VALUE),i=Xc(Gh(n,r));return Bh(100,wy(i,-1))}))}function jC(t,e,n){return void 0===n&&(n=!1),Du((function(){if(n)e=op(e);else{var r=_y(e,e.shape.length-1,!0);e=Gh(e,r)}return e=rh(e,_w(),1-_w()),dh(_y(Bh(t.toFloat(),ch(e)),e.shape.length-1))}))}function qC(t,e){return Du((function(){var n=uh(function(t){var e=[yx(t.shape)];return t.reshape(e)}(t)).toInt(),r=(e=rh(e,_w(),1-_w())).shape;return jC(Qm(n,r[r.length-1]).reshape(r),e,!1)}))}function HC(t,e){return Du((function(){var n;return n=rh(e,_w(),1-_w()),n=ch(Gh(n,qh(1,n))),wy(function(t,e){if(!tl.arraysEqual(t.shape,e.shape))throw new Ow("logits and labels must have the same shape, but got shapes "+JSON.stringify(t.shape)+" and "+JSON.stringify(e.shape));return Du((function(){var n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())}))}(t,n),-1)}))}function GC(t,e){return Du((function(){var n=BC(t,-1),r=BC(e,-1),i=Bh(n,r);return dh(_y(i,-1))}))}var $C={meanSquaredError:VC,meanAbsoluteError:UC,meanAbsolutePercentageError:WC,meanSquaredLogarithmicError:function(t,e){return Du((function(){var n=rh(e,_w(),Number.MAX_VALUE),r=ch(Hc(1,n)),i=rh(t,_w(),Number.MAX_VALUE),a=ch(Hc(1,i));return wy(Ax(qh(r,a)),-1)}))},squaredHinge:function(t,e){return Du((function(){var n=Ah(0,qh(1,Bh(t,e)));return wy(Ax(n),-1)}))},hinge:function(t,e){return Du((function(){var n=Ah(0,qh(1,Bh(t,e)));return wy(n,-1)}))},categoricalHinge:function(t,e){return Du((function(){var n=_y(Bh(t,e),-1),r=by(Bh(qh(1,t),e),-1);return Ah(0,Hc(1,qh(r,n)))}))},logcosh:function(t,e){return Du((function(){var n=Math.log(2),r=qh(e,t),i=qh(Hc(r,kh(Bh(-2,r))),n);return wy(i,-1)}))},categoricalCrossentropy:jC,sparseCategoricalCrossentropy:qC,binaryCrossentropy:HC,kullbackLeiblerDivergence:function(t,e){return Du((function(){var n=rh(t,_w(),1),r=rh(e,_w(),1);return _y(Bh(t,ch(Gh(n,r))),-1)}))},poisson:function(t,e){return Du((function(){var n=ch(Hc(_w(),e));return wy(qh(e,Bh(t,n)),-1)}))},cosineProximity:GC};function KC(t){if("string"==typeof t){if(t in $C)return $C[t];var e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss "+t+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Ow(e)}return t}function XC(t,e){return Du((function(){var n=Bh(.5,gc(e)),r=Cx(vg(e,n),t.dtype);return wy(gg(t,r),-1)}))}function YC(t,e){return Du((function(){return Cx(gg(gy(t,-1),gy(e,-1)),"float32")}))}function QC(t,e){return Du((function(){return Um(t.equal(1),e.equal(1)).sum().cast("float32")}))}function ZC(t,e){return Du((function(){var n=QC(t,e),r=function(t,e){return Du((function(){return Um(t.equal(0),e.equal(1)).sum().cast("float32")}))}(t,e),i=n.add(r);return Hm(vg(i,0),n.div(i),0).cast("float32")}))}function JC(t,e){return HC(t,e)}function t_(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),gg(t,e).asType("float32")}var e_=jC,n_=qC,r_={binaryAccuracy:XC,categoricalAccuracy:YC,precision:ZC,categoricalCrossentropy:e_,sparseCategoricalCrossentropy:n_,mse:VC,MSE:VC,mae:UC,MAE:UC,mape:WC,MAPE:WC,cosine:GC};function i_(t){if(Pw(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;for(var e=void 0,n=0,r=Object.keys($C);n<r.length;n++){var i=r[n];if($C[i]===t){e=i;break}}if(void 0!==e)return e;for(var a=0,o=Object.keys(r_);a<o.length;a++)if(r_[i=o[a]]===t){e=i;break}return void 0!==e?e:t.name}function a_(t,e,n){if(void 0===n&&(n=!1),null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!function t(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if("string"!=typeof i)return!1;if(!t(e[i]))return!1}return!0}if(Array.isArray(e)){for(var a=0,o=e;a<o.length;a++)if(!t(o[a]))return!1;return!0}return!1}var s=typeof e;return"string"===s||"number"===s||"boolean"===s}(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(t);r.length>1048576&&console.warn('User-defined metadata of model "'+e+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function o_(t,e,n){void 0===n&&(n=console.log);for(var r="",i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[i]).slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function s_(t,e,n){var r;try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}o_([t.name+" ("+t.getClassName()+")",r,t.countParams().toString()],e,n)}function l_(t,e,n,r){var i;try{i=JSON.stringify(t.outputShape)}catch(t){i="multiple"}for(var a=[],o=0,s=t.inboundNodes;o<s.length;o++){var l=s[o];if(!(null!=n&&n.length>0&&-1===n.indexOf(l)))for(var u=0;u<l.inboundLayers.length;++u)a.push(l.inboundLayers[u].name+"["+l.nodeIndices[u]+"]["+l.tensorIndices[u]+"]")}var c=t.name,h=t.getClassName(),p=0===a.length?"":a[0];for(o_([c+" ("+h+")",i,t.countParams().toString(),p],e,r),u=1;u<a.length;++u)o_(["","","",a[u]],e,r)}function u_(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function c_(t,e){if(null===t)return null;if("string"==typeof t)return Dw(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var n=[],r=t.length,i=0;i<r;++i){var a=t[i];u_(e,i,a)?n.push(a):n.push(c_(a,e))}return n}for(var o={},s=0,l=Object.keys(t);s<l.length;s++){var u=l[s],c=t[u];if("name"===u&&"string"==typeof c)o[u]=c;else{var h=Dw(u);o[h]=c_(c,h)}}return o}var h_=function(){function t(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof t)for(var n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(null==e)return;for(var r=0,i=e;r<i.length;r++){var a=i[r];this.add(a.key,a.value)}}}return t.prototype.add=function(t,e,n){if(null!=this.id2Value[t.id])throw new Ow("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Oc(e,t.dtype)}catch(n){throw new Ow("The dtype of the feed ("+e.dtype+") can not be cast to the dtype of the key '"+t.name+"' ("+t.dtype+").")}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this},t.prototype.addFeed=function(t){this.add(t.key,t.value)},t.prototype.hasKey=function(t){return null!=this.id2Value[t.id]},t.prototype.names=function(){return Object.keys(this.name2Id)},t.prototype.getValue=function(t){if(t instanceof xC){if(null==this.id2Value[t.id])throw new Ow("Nonexistent key: "+t.name);return this.id2Value[t.id]}var e=this.name2Id[t];if(null==e)throw new Ow("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]},t.prototype.getMask=function(t){if(t instanceof xC){if(null==this.id2Value[t.id])throw new Ow("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var e=this.name2Id[t];if(null==e)throw new Ow("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]},t.prototype.disposeMasks=function(){null!=this.id2Mask&&Fu(this.id2Mask)},t}(),p_={},d_={};function f_(t,e,n,r){for(var i=null!=n&&n.training,a=Array.isArray(t),o=a?t:[t],s=o.map((function(t){return t.name})),l=[],u=e.names(),c=0,h=s;c<h.length;c++){var p=h[c];-1!==u.indexOf(p)?l.push(e.getValue(p)):l.push(null)}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var d,f,m=s.join(",")+"|"+e.names().join(",");if(null==p_[m]){var g=function(t,e){tl.assert(null!=t&&t.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===t.length){var i=g_(t[0],e);n=i.sorted,r=i.recipientMap}else for(var a=new Set,o=0,s=t;o<s.length;o++){for(var l=g_(s[o],e),u=l.recipientMap,c=0,h=l.sorted;c<h.length;c++){var p=h[c];a.has(p.name)||(n.push(p),a.add(p.name))}var d=function(t){null==r[t]&&(r[t]=new Set),u[t].forEach((function(e){return r[t].add(e)}))};for(var f in u)d(f)}return{sorted:n,recipientCounts:m_(r)}}(o,e);f=g.recipientCounts,p_[m]=d=g.sorted,d_[m]=f}d=p_[m],f={},i||Object.assign(f,d_[m]);for(var y=new h_(e),v=0;v<d.length;++v){if(null!=r){var b=Ru().numTensors;b>r.maxNumTensors&&(r.maxNumTensors=b),b<r.minNumTensors&&(r.minNumTensors=b)}var w=d[v],x=w.sourceLayer;if(!(x instanceof OC)){for(var C=[],_=[],k=[],S=!1,O=0,E=w.inputs;O<E.length;O++){var M=E[O],N=y.getValue(M),P=y.getMask(M);C.push(N),_.push(P),null!=P&&(S=!0),i||(f[M.name]--,0!==f[M.name]||e.hasKey(M)||-1!==s.indexOf(M.name)||N.isDisposed||!0===M.sourceLayer.stateful||k.push(N))}S&&((n=n||{}).mask=_[0]);var T=Aw(x.apply(C,n)),I=null;x.supportsMasking&&(I=x.computeMask(C,_));for(var A=y_(w),R=Array.isArray(A)?A:[A],D=0;D<R.length;++D){y.hasKey(R[D])||y.add(R[D],T[D],Array.isArray(I)?I[0]:I);var F=s.indexOf(R[D].name);-1!==F&&(l[F]=T[D])}i||Fu(k)}}return y.disposeMasks(),a?l:l[0]}function m_(t){var e={};for(var n in t)e[n]=t[n].size;return e}function g_(t,e){for(var n=new Set,r=[],i={},a=0,o=e.names();a<o.length;a++)n.add(o[a]);var s=[],l=[];for(s.push(t);s.length>0;){var u=s[s.length-1];if(n.has(u.name))s.pop();else{var c=l[l.length-1]===s.length-1;if(0===u.inputs.length||c)s.pop(),r.push(u),n.add(u.name),c&&l.pop();else{l.push(s.length-1);for(var h=0,p=u.inputs;h<p.length;h++){var d=p[h];null==i[d.name]&&(i[d.name]=new Set),i[d.name].add(u.name),n.has(d.name)||s.push(d)}}}}return{sorted:r,recipientMap:i}}function y_(t){var e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{for(var n=null,r=0;r<t.sourceLayer.inboundNodes.length;++r)for(var i=0,a=t.sourceLayer.inboundNodes[r].outputTensors;i<a.length;i++)if(a[i].id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}function v_(t,e){return function(t,e,n){var r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return null}));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided "+n+" is an array of "+t.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){var i=[];return e.forEach((function(e){i.push(e in t?t[e]:null)})),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+e+" keys. Provided "+n+" not understood: "+JSON.stringify(t))}(t,e,"classWeight")}function b_(t,e,n,r){return xw(this,void 0,void 0,(function(){var i,a,o,s,l;return Cw(this,(function(u){switch(u.label){case 0:if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");return null==n?[3,2]:(i=Du((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+t.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+t.rank+") during handling of class weights. The rank is expected to be 1 or 2.")})),s=(o=Array).from,[4,i.data()]);case 1:return a=s.apply(o,[u.sent()]),Fu(i),l=[],a.forEach((function(t){if(null==n[t])throw new Error("classWeight must contain all classes in the training data. The class "+t+" exists in the data but not in classWeight");l.push(n[t])})),[2,oc(l,"float32")];case 2:return[2,null]}}))}))}function w_(t,e){return Bh(t,e)}function x_(t,e){var n,r;r=e.ys,tl.assert(null!=(n=e.xs)&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e}));var i=C_("input",t.inputNames,n),a=C_("output",t.outputNames,r),o=i[0].shape[0];tl.assert(i.length===t.inputs.length,(function(){return"LayersModel has "+t.inputs.length+" inputs, but the dataset provides "+i.length+" inputs.  (Expected input keys: "+JSON.stringify(t.inputNames)+")"})),tl.assert(a.length===t.outputs.length,(function(){return"LayersModel has "+t.outputs.length+" outputs, but the dataset provides "+a.length+" outputs.  (Expected output keys: "+JSON.stringify(t.outputNames)+")"}));for(var s=function(e){tl.assert(i[e].shape[0]===o,(function(){return"Batch size mismatch: input "+t.inputNames[e]+" has "+i[e].shape[0]+"; expected  "+o+" based on input "+t.inputNames[0]+"."}))},l=0;l<i.length;l++)s(l);for(var u=function(e){tl.assert(a[e].shape[0]===o,(function(){return"Batch size mismatch: output "+t.outputNames[e]+" has "+a[e].shape[0]+"; expected  "+o+" based on input "+t.inputNames[0]+"."}))},c=0;c<a.length;c++)u(c);return{xs:i,ys:a}}function C_(t,e,n){if(n instanceof cl)return[n];if(Array.isArray(n))return tl.assert(n.length===e.length,(function(){return"Received an array of "+n.length+" Tensors, but expected "+e.length+" to match the "+t+" keys "+e+"."})),n;for(var r=[],i=0,a=e;i<a.length;i++){var o=a[i];if(null==n[o])throw new Ow("The feature data generated by the dataset lacks the required "+t+" key '"+o+"'.");r.push(n[o])}return r}function __(t,e,n){return xw(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,b,w,x,C,_,k,S,O,E,M,N,P,T,I,A,R;return Cw(this,(function(D){switch(D.label){case 0:if(r=null!=n.batchesPerEpoch,tl.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),tl.assert(null!=n,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),tl.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs})),tl.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch})),tl.assert(null==n.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,D.label=1;case 1:return D.trys.push([1,,26,27]),a=void 0,o=void 0,(i=null!=n.validationData)&&(k_(n.validationData)?tl.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches})):(s=function(t){if(3===t.length)throw new Ew("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData),a=s.xs,o=s.ys)),l=t.makeTrainFunction(),u=t.getDedupedMetricsNames(),c=i?u.slice().concat(u.map((function(t){return"val_"+t}))):u.slice(),h=DC(n.callbacks,n.yieldEvery),p=zC(h,null==n.verbose?1:n.verbose,n.epochs,null,null,function(t,e){var n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,i,c),f=p.history,(d=p.callbackList).setModel(t),t.history=f,[4,d.onTrainBegin()];case 2:return D.sent(),t.stopTraining_=!1,m=null==n.initialEpoch?0:n.initialEpoch,[4,e.iterator()];case 3:g=D.sent(),D.label=4;case 4:return m<n.epochs?(y={},[4,d.onEpochBegin(m)]):[3,23];case 5:return D.sent(),v=0,b=0,r?[3,7]:[4,e.iterator()];case 6:g=D.sent(),D.label=7;case 7:return!r||v<n.batchesPerEpoch?[4,g.next()]:[3,21];case 8:return w=D.sent(),r&&w.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+v+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):null==w.value?[3,15]:(x=x_(t,w.value),C=x.xs,_=x.ys,(k={}).batch=b,k.size=C[0].shape[0],[4,d.onBatchBegin(b,k)]);case 9:if(D.sent(),S=[],null==n.classWeight)return[3,13];O=v_(n.classWeight,t.outputNames),R=0,D.label=10;case 10:return R<O.length?(M=(E=S).push,[4,b_(_[R],null,O[R])]):[3,13];case 11:M.apply(E,[D.sent()]),D.label=12;case 12:return++R,[3,10];case 13:for(N=C.concat(_).concat(S),P=l(N),Fu(N),R=0;R<u.length;++R)k[u[R]]=T=P[R],zu(T);return[4,d.onBatchEnd(b,k)];case 14:D.sent(),NC(k),b++,v++,D.label=15;case 15:return(r?v>=n.batchesPerEpoch:w.done)?i?(I=void 0,k_(n.validationData)?(A=Aw,[4,t.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return I=A.apply(void 0,[D.sent()]),[3,18];case 17:I=Aw(t.evaluate(a,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0})),D.label=18;case 18:for(R=0;R<t.metricsNames.length;++R)y["val_"+t.metricsNames[R]]=I[R];D.label=19;case 19:return[3,21];case 20:return t.stopTraining_?[3,21]:[3,7];case 21:return[4,d.onEpochEnd(m,y)];case 22:return D.sent(),m++,t.stopTraining_?[3,23]:[3,4];case 23:return[4,d.onTrainEnd()];case 24:return D.sent(),[4,t.history.syncData()];case 25:return D.sent(),[2,t.history];case 26:return t.isTraining=!1,[7];case 27:return[2]}}))}))}function k_(t){return"function"==typeof t.iterator}function S_(t,e,n){return xw(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h,p;return Cw(this,(function(d){switch(d.label){case 0:if(r=null!=(n=n||{}).batches,i=t.testFunction,a=[],n.verbose>0)throw new Ew("Verbose mode is not implemented yet.");return tl.assert(!r||n.batches>0&&Number.isInteger(n.batches),(function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)})),function(t){return"function"==typeof t.next}(e)?(s=e,[3,3]):[3,1];case 1:return[4,e.iterator()];case 2:s=d.sent(),d.label=3;case 3:o=s,l=0,u=0,c=function(){var e;return Cw(this,(function(s){switch(s.label){case 0:return[4,o.next()];case 1:return e=s.sent(),a=Du((function(){if(e.value){var n=x_(t,e.value),r=n.xs.concat(n.ys),o=Du((function(){return i(r)}));if(Fu(r),0===u)for(var s=0;s<o.length;++s)a.push(ac(0));var c=r[0].shape[0],h=function(t){var e=o[t],n=a[t];a[t]=Du((function(){return Hc(a[t],Bh(c,e))})),u>0&&Fu(n)};for(s=0;s<o.length;++s)h(s);Fu(o),l+=c,++u}return a})),e.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}}))},d.label=4;case 4:return!r||u<n.batches?[5,c()]:[3,6];case 5:return"break"===d.sent()?[3,6]:[3,4];case 6:for(h=0;h<a.length;++h)p=a[h],a[h]=Gh(a[h],l),Fu(p);return[2,Iw(a)]}}))}))}function O_(t){tl.assert(t>0&&Number.isInteger(t),(function(){return"batchSize is required to be a positive integer, but got "+t}))}function E_(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((function(t){return kx(t,e,n-e)})):kx(t,e,n-e)}function M_(t,e){return Du((function(){return null==t?null:Array.isArray(t)?t.map((function(t){return M_(t,e)})):Ix(t,"int32"===e.dtype?e:e.toInt())}))}function N_(t,e){for(var n=[],r=0,i=null;r<t;)(i=r+e)>=t&&(i=t),n.push([r,i]),r=i;return n}function P_(t,e,n,r,i,a,o,s,l,u,c,h,p,d,f){return xw(this,void 0,void 0,(function(){var m,g,y,v,b,w,x,C;return Cw(this,(function(_){switch(_.label){case 0:if(null==i&&(i=32),null==a&&(a=1),null==c&&(c=!0),null==p&&(p=0),m=!1,null!=l&&null!=u&&(m=!0),null!=f&&(m=!0,null==d))throw new Ow("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(g=t.checkNumSamples(n,i,d,"steps_per_epoch"))&&(y=xx(0,g)),null==o&&(o=1),v=zC(s,o,a,p,g,d,i,m,h),w=v.history,(b=v.callbackList).setModel(t),t.history=w,[4,b.onTrainBegin()];case 1:_.sent(),t.stopTraining_=!1,x=function(a){var o,s,h,p,f;return Cw(this,(function(v){switch(v.label){case 0:return[4,b.onEpochBegin(a)];case 1:if(v.sent(),o={},null==d)return[3,2];throw new Ew("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===c)throw new Ew("batch shuffling is not implemneted yet");c&&tl.shuffle(y),s=oc(y),h=N_(g,i),p=function(a){var c;return Cw(this,(function(p){switch(p.label){case 0:return[4,b.onBatchBegin(a,c={})];case 1:return p.sent(),Du((function(){var p=h[a][0],d=h[a][1],f=kx(s,p,d-p);c.batch=a,c.size=d-p;for(var g=M_(n,f),y=e(g),v=0;v<r.length;++v){var b=r[v],w=y[v];c[b]=w,zu(w)}if(a===h.length-1&&m){var x=t.testLoop(l,u,i);for(v=0;v<r.length;++v)b=r[v],zu(w=x[v]),o["val_"+b]=w}})),[4,b.onBatchEnd(a,c)];case 2:return p.sent(),NC(c),t.stopTraining_?[2,"break"]:[2]}}))},f=0,v.label=3;case 3:return f<h.length?[5,p(f)]:[3,6];case 4:if("break"===v.sent())return[3,6];v.label=5;case 5:return++f,[3,3];case 6:s.dispose(),v.label=7;case 7:return[4,b.onEpochEnd(a,o)];case 8:return v.sent(),t.stopTraining_?[2,"break"]:[2]}}))},C=p,_.label=2;case 2:return C<a?[5,x(C)]:[3,5];case 3:if("break"===_.sent())return[3,5];_.label=4;case 4:return++C,[3,2];case 5:return[4,b.onTrainEnd()];case 6:return _.sent(),[4,t.history.syncData()];case 7:return _.sent(),[2,t.history]}}))}))}function T_(t,e,n,r){return void 0===r&&(r={}),xw(this,void 0,void 0,(function(){var i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,b,w,x,C,_;return Cw(this,(function(k){switch(k.label){case 0:if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,k.label=1;case 1:return k.trys.push([1,,7,8]),O_(h=null==r.batchSize?32:r.batchSize),[4,t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,h)];case 2:if(p=k.sent(),i=p[0],a=p[1],c=p[2],d=!1,f=void 0,!(null!=r.validationData&&r.validationData.length>0))return[3,4];if(d=!0,2!==r.validationData.length)throw 3===r.validationData.length?new Ew("validationData including sample weights is not supported yet."):new Ow("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return[4,t.standardizeUserData(o=r.validationData[0],s=r.validationData[1],null,null,!0,h)];case 3:return m=k.sent(),f=(l=m[0]).concat(u=m[1]),[3,5];case 4:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(d=!0,g=Math.floor(i[0].shape[0]*(1-r.validationSplit)),l=E_(i,g,y=i[0].shape[0]),i=E_(i,0,g),u=E_(a,g,y),a=E_(a,0,g),f=l.concat(u)):null!=r.validationSteps&&(d=!0),k.label=5;case 5:return v=i.concat(a).concat(c),t.checkTrainableWeightsConsistency(),b=t.makeTrainFunction(),w=t.getDedupedMetricsNames(),x=void 0,C=void 0,d?(t.makeTestFunction(),x=t.testFunction,C=w.slice().concat(w.map((function(t){return"val_"+t})))):(x=null,f=[],C=w.slice()),_=DC(r.callbacks,r.yieldEvery),[4,P_(t,b,v,w,h,r.epochs,r.verbose,_,x,f,r.shuffle,C,r.initialEpoch,null,null)];case 6:return[2,k.sent()];case 7:return t.isTraining=!1,A_(i,e),A_(a,n),A_(l,o),A_(u,s),null!=c&&Fu(c),[7];case 8:return[2]}}))}))}function I_(t){var e=[];t instanceof cl&&(t=[t]);for(var n=0;n<t.length;++n){var r=t[n];if(1===r.rank)e.push(_x(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function A_(t,e){if(null!=t){var n=[];if(e instanceof cl)n.push(e.id);else if(Array.isArray(e))e.forEach((function(t){return n.push(t.id)}));else if(null!=e)for(var r in e)n.push(e[r].id);var i=[];if(t instanceof cl)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach((function(t){-1===n.indexOf(t.id)&&i.push(t)}));else if(null!=t)for(var a in t){var o=t[a];-1===n.indexOf(o.id)&&i.push(o)}i.forEach((function(t){t.isDisposed||t.dispose()}))}}function R_(t){return Array.isArray(t)}function D_(t){return!function(t){return t instanceof cl}(t)&&!R_(t)}function F_(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=""),null==e||0===e.length){if(null!=t){var a=!1;if(R_(t)&&t.length>0)a=!0;else if(D_(t)){for(var o in t)if(t.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new Ow("Error when checking model "+i+" expected no data, but got "+t)}return[]}if(null==t)return e.map((function(t){return null}));var s;if(D_(t)){t=t,s=[];for(var l=0,u=e;l<u.length;l++){var c=u[l];if(null==t[c])throw new Ow('No data provided for "'+c+'". Need data for each key in: '+e);s.push(t[c])}}else if(R_(t)){if((t=t).length!==e.length)throw new Ow("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+t);s=t}else{if(t=t,e.length>1)throw new Ow("The model "+i+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+t.shape);s=[t]}if(s=I_(s),null!=n)for(var h=0;h<e.length;++h)if(null!=n[h]){var p=s[h];if(p.shape.length!==n[h].length)throw new Ow("Error when checking "+i+": expected "+e[h]+" to have "+n[h].length+" dimension(s). but got array with shape "+p.shape);for(var d=0;d<n[h].length;++d)if(0!==d||r){var f=n[h][d];if(null!=f&&f>=0&&p.shape[d]!==f)throw new Ow("Error when checking "+i+": expected "+e[h]+" to have shape ["+n[h]+"], but got array with shape ["+p.shape+"].")}}return s}function z_(t,e,n,r,i){var a;if(void 0===r&&(r=!0),void 0===i&&(i=""),Array.isArray(t)){if(t.length!==e.length)throw new Ow("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+t.length+" Tensors(s).");a=t}else{if(e.length>1)throw new Ow("The model expects "+e.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(t.shape)+".");a=[t]}if(null!=n)for(var o=0;o<e.length;++o)if(null!=n[o]){var s=a[o];if(s.shape.length!==n[o].length)throw new Ow("Error when checking "+i+": expected "+e[o]+" to have "+n[o].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var l=0;l<n[o].length;++l)if(0!==l||r){var u=n[o][l];if(null!=u&&u!==s.shape[l])throw new Ow("Error when checking "+i+": expected "+e[o]+" to have shape "+JSON.stringify(n[o])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}var L_=function(t){function e(e){var n=t.call(this,e)||this;return n.isTraining=!1,n}return vw(e,t),e.prototype.summary=function(t,e,n){if(void 0===n&&(n=console.log),!this.built)throw new Ow("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r){void 0===r&&(r=console.log);var i,a=function(t){var e=!0,n=[],r=[];for(var i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(var a=0,o=n;a<o.length;a++){var s=o[a];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){e=!1;break}r.push.apply(r,s)}if(e)for(var l=0,u=t.layers;l<u.length;l++){for(var c=!1,h=0,p=u[l].inboundNodes;h<p.length;h++)if(-1!==r.indexOf(p[h])){if(c){e=!1;break}c=!0}if(!e)break}return e}(t),o=["Layer (type)","Output shape","Param #"];if(a?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(t){return Math.floor(e*t)}))),!a)for(var s in o.push("Receives inputs"),i=[],t.nodesByDepth)i.push.apply(i,t.nodesByDepth[s]);r("_".repeat(e)),o_(o,n,r),r("=".repeat(e));for(var l=t.layers,u=0;u<l.length;++u)a?s_(l[u],n,r):l_(l[u],n,i,r),r((u===l.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();var c=function(t){return fC(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights)}(t),h=fC(t.nonTrainableWeights);r("Total params: "+(c+h)),r("Trainable params: "+c),r("Non-trainable params: "+h),r("_".repeat(e))}(this,t,e,n)},e.prototype.compile=function(t){var e=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){var e={Adagrad:function(){return fw.adagrad(.01)},Adadelta:function(){return fw.adadelta(1,.95,_w())},Adam:function(){return fw.adam(.001,.9,.999,_w())},Adamax:function(){return fw.adamax(.002,.9,.999,_w(),0)},RMSProp:function(){return fw.rmsprop(.001,.9,0,_w())},SGD:function(){return fw.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new Ow("Unknown Optimizer "+t)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof aw))throw new Ow("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Ow("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");n=t.loss.map((function(t){return KC(t)}))}else{var r=KC(t.loss);this.outputs.forEach((function(t){n.push(r)}))}else{for(var i in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(i))throw new Ow('Unknown entry in loss dictionary: "'+i+'". Only expected the following keys: '+this.outputNames);for(var a=0,o=this.outputNames;a<o.length;a++){var s=o[a];null==t.loss[s]&&console.warn('Output "'+s+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+s+" during training"),n.push(KC(t.loss[s]))}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var l=0;l<this.outputs.length;++l){var u=this.internalOutputShapes[l];this.feedOutputNames.push(this.outputNames[l]),this.feedOutputShapes.push(u),this.feedLossFns.push(this.lossFunctions[l])}var c=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],hx("loss",(function(){for(var t=0;t<e.outputs.length;++t)-1===c.indexOf(t)&&e.outputs.length>1&&(e.metricsTensors.push([e.lossFunctions[t],t]),e.metricsNames.push(e.outputNames[t]+"_loss"))}));var h=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return[]}));var n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map((function(t){return n}));for(var r=[],i=0,a=e;i<a.length;i++){var o=a[i],s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}(t.metrics,this.outputNames);hx("metric",(function(){for(var t=function(t){if(-1!==c.indexOf(t))return"continue";!function(n){for(var r,i,a,o=function(n){if("string"==typeof n&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(n)){var o=e.internalOutputShapes[t];1===o[o.length-1]||e.lossFunctions[t]===HC?-1!==["accuracy","acc"].indexOf(n)?i=XC:-1!==["crossentropy","ce"].indexOf(n)&&(i=JC):e.lossFunctions[t]===qC?-1!==["accuracy","acc"].indexOf(n)?i=t_:-1!==["crossentropy","ce"].indexOf(n)&&(i=n_):-1!==["accuracy","acc"].indexOf(n)?i=YC:-1!==["crossentropy","ce"].indexOf(n)&&(i=e_);var s=void 0;-1!==["accuracy","acc"].indexOf(n)?s="acc":-1!==["crossentropy","ce"].indexOf(n)&&(s="ce"),a=i,r=""+s}else{var l=function(t){if("string"==typeof t&&t in r_)return r_[t];if("string"!=typeof t&&null!=t)return t;throw new Ow("Unknown metric "+t)}(n);a=l,r=""+i_(n)}var u;hx(r,(function(){u=a})),function(t,n,r){e.outputNames.length>1&&(n=e.outputNames[t]+"_"+n),e.metricsNames.push(n),e.metricsTensors.push([r,t])}(t,r,u)},s=0,l=n;s<l.length;s++)o(l[s])}(h[t])},n=0;n<e.outputs.length;++n)t(n)})),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,e,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize;O_(r);var i=this.standardizeUserDataXY(t,e,!0,r);try{var a=i[0].concat(i[1]);return this.makeTestFunction(),Iw(this.testLoop(this.testFunction,a,r,n.verbose,n.steps))}finally{A_(i[0],t),A_(i[1],e)}},e.prototype.evaluateDataset=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){return this.makeTestFunction(),[2,S_(this,t,e)]}))}))},e.prototype.checkNumSamples=function(t,e,n,r){var i;if(void 0===r&&(r="steps"),null!=n){if(i=null,null!=e)throw new Ow("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+e)}else{if(null==t)throw new Ow("Either the input data should have a defined shape, or "+r+" shoud be specified.");i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i},e.prototype.execute=function(t,e){if(Array.isArray(e)&&0===e.length)throw new Ow("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(e),r=this.retrieveSymbolicTensors(n?e:[e]),i=new h_;if(t instanceof cl&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Ow("The number of inputs provided ("+t.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var a=0;a<this.inputs.length;++a)i.add(this.inputs[a],t[a])}else for(var o=0,s=this.inputs;o<s.length;o++){var l=s[o],u=t[l.name];if(null==u)throw new Ow("No value is provided for the model's input "+l.name);i.add(l,u)}var c=f_(r,i);return n?c:c[0]},e.prototype.retrieveSymbolicTensors=function(t){for(var e=Nw(null,t.length),n=t.length,r=0,i=this.layers;r<i.length;r++){for(var a=i[r],o=Array.isArray(a.output)?a.output:[a.output],s=o.map((function(t){return t.name})),l=0;l<t.length;++l){var u=s.indexOf(t[l]);if(-1!==u&&(e[l]=o[u],n--),0===n)break}if(0===n)break}if(n>0){var c=[];throw e.forEach((function(e,n){null==e&&c.push(t[n])})),new Ow("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(c))}return e},e.prototype.predictLoop=function(t,e,n){var r=this;return void 0===e&&(e=32),void 0===n&&(n=!1),Du((function(){var i=r.checkNumSamples(t);if(n)throw new Ew("Verbose predictLoop() is not implemented yet.");for(var a=N_(i,e),o=r.outputs.map((function(t){return[]})),s=function(e){Du((function(){var n=E_(t,a[e][0],a[e][1]),i=[];if(Array.isArray(n))for(var o=0;o<n.length;++o)i.push({key:r.inputs[o],value:n[o]});else i.push({key:r.inputs[0],value:n});var s=new h_(i);return f_(r.outputs,s)})).forEach((function(t,e){return o[e].push(t)}))},l=0;l<a.length;++l)s(l);return Iw(o.map((function(t){return vc(t,0)})))}))},e.prototype.predict=function(t,e){void 0===e&&(e={});var n=I_(t);z_(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==e.batchSize?32:e.batchSize;return O_(r),this.predictLoop(n,r)}finally{A_(n,t)}},e.prototype.predictOnBatch=function(t){z_(t,this.inputNames,this.feedInputShapes,!0);var e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)},e.prototype.standardizeUserDataXY=function(t,e,n,r){if(void 0===n&&(n=!0),null==this.optimizer_)throw new Sw("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var i=[],a=0;a<this.feedOutputShapes.length;++a){var o=this.feedOutputShapes[a];i.push(this.feedLossFns[a]===qC?o.slice(0,o.length-1).concat([1]):o)}if(function(t,e,n){var r=Vw(t.map((function(t){return t.shape[0]})));r.sort();var i=Vw(e.map((function(t){return t.shape[0]})));if(i.sort(),r.length>1)throw new Ow("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map((function(t){return t.shape}))));if(i.length>1)throw new Ow("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(t){return t.shape}))));if(r.length>0&&i.length>0&&!tl.arraysEqual(r,i))throw new Ow("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+i[0]+" target sample(s).")}(t=F_(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=F_(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){for(var r=[VC,HC,jC],i=0;i<t.length;++i){var a=t[i],o=e[i],s=n[i];if(null!=o){if(o===jC&&1===a.shape[a.shape.length-1])throw new Ow("You are passing a target array of shape "+a.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var l=a.shape.slice(1),u=s.slice(1),c=0;c<l.length;++c){var h=u[c];if(null!=h&&l[c]!==h)throw new Ow("A target Tensor with shape "+a.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new Ow("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+t[0].shape[0]+" sample(s).");return[t,e]},e.prototype.standardizeUserData=function(t,e,n,r,i,a){return void 0===i&&(i=!0),xw(this,void 0,void 0,(function(){var o,s,l,u,c,h,p,d;return Cw(this,(function(f){switch(f.label){case 0:if(o=this.standardizeUserDataXY(t,e,i,a),s=o[0],l=o[1],null!=n)throw new Error("sample weight is not supported yet.");if(u=null,null==r)return[3,4];c=v_(r,this.outputNames),u=[],h=0,f.label=1;case 1:return h<c.length?(d=(p=u).push,[4,b_(l[h],null,c[h])]):[3,4];case 2:d.apply(p,[f.sent()]),f.label=3;case 3:return++h,[3,1];case 4:return[2,[s,l,u]]}}))}))},e.prototype.testLoop=function(t,e,n,r,i){var a=this;return void 0===r&&(r=0),Du((function(){var o=a.checkNumSamples(e,n,i,"steps"),s=[];if(r>0)throw new Ew("Verbose mode is not implemented yet.");if(null!=i)throw new Ew("steps mode in testLoop() is not implemented yet");for(var l=N_(o,n),u=oc(xx(0,o)),c=0;c<l.length;++c){var h=l[c][0],p=l[c][1],d=kx(u,h,p-h),f=M_(e,d),m=t(f);if(0===c)for(var g=0;g<m.length;++g)s.push(ac(0));for(g=0;g<m.length;++g)s[g]=Hc(s[g],Bh(p-h,m[g]))}for(g=0;g<s.length;++g)s[g]=Gh(s[g],o);return s}))},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,e=[],n=0;n<t.length;++n){var r=t[n],i=r;Tw(t,r)>1&&(i+="_"+Tw(t.slice(0,n),r)),e.push(i)}return e},e.prototype.makeTrainFunction=function(){var t=this;return function(e){var n=[],r=e.slice(0,t.inputs.length),i=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),a=e.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),o=[],s=t.collectedTrainableWeights.map((function(t){return t.read()}));return[t.optimizer_.minimize((function(){for(var e=[],s=0;s<t.inputs.length;++s)e.push({key:t.inputs[s],value:r[s]});var l,u=new h_(e),c=f_(t.outputs,u,{training:!0});for(s=0;s<t.lossFunctions.length;++s){var h=(0,t.lossFunctions[s])(i[s],c[s]);null!=a[s]&&(h=w_(h,a[s]));var p=wy(h);n.push(p),l=0===s?h:Hc(l,h)}for(s=0;s<t.metricsTensors.length;++s){var d=void 0;if(t.outputs.length>1&&s<t.outputs.length)d=n[s];else{var f=t.metricsTensors[s][1];d=wy((0,t.metricsTensors[s][0])(i[f],c[f]))}zu(d),o.push(d)}return l=wy(l),t.calculateLosses().forEach((function(t){l=Hc(l,t)})),l}),!0,s)].concat(o)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(e){return Du((function(){for(var n,r=[],i=e.slice(0,t.inputs.length),a=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),o=[],s=0;s<t.inputs.length;++s)o.push({key:t.inputs[s],value:i[s]});var l=new h_(o),u=f_(t.outputs,l);for(s=0;s<t.lossFunctions.length;++s){var c=wy((0,t.lossFunctions[s])(a[s],u[s]));n=0===s?c:Hc(n,c),r.push(n)}for(s=0;s<t.metricsTensors.length;++s){var h=t.metricsTensors[s][1],p=wy((0,t.metricsTensors[s][0])(a[h],u[h]));r.push(p)}return r}))}},e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),xw(this,void 0,void 0,(function(){return Cw(this,(function(r){return[2,T_(this,t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){return[2,__(this,t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return xw(this,void 0,void 0,(function(){var n,r,i,a,o,s,l,u,c;return Cw(this,(function(h){switch(h.label){case 0:return[4,this.standardizeUserData(t,e)];case 1:n=h.sent(),r=n[0],i=n[1],a=this.makeTrainFunction(),o=a(r.concat(i)),s=[],l=0,u=o,h.label=2;case 2:return l<u.length?[4,u[l].data()]:[3,5];case 3:c=h.sent(),s.push(c[0]),h.label=4;case 4:return l++,[3,2];case 5:return Fu(o),[2,Iw(s)]}}))}))},e.prototype.getNamedWeights=function(t){for(var e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n),a=0;a<r.length;++a)n&&!r[a].trainable||e.push({name:r[a].originalName,tensor:i[a]});return e},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=t.prototype.dispose.call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var n=Ru().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Ru().numTensors}return e},e.prototype.getLossIdentifiers=function(){var t;if("string"==typeof this.loss)t=Rw(this.loss);else if(Array.isArray(this.loss)){for(var e=0,n=this.loss;e<n.length;e++)if("string"!=typeof n[e])throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((function(t){return Rw(t)}))}else{var r=Object.keys(this.loss);t={};for(var i=this.loss,a=0,o=r;a<o.length;a++){var s=o[a];if("string"!=typeof i[s])throw new Error("Serialization of non-string loss is not supported.");t[s]=Rw(i[s])}}return t},e.prototype.getMetricIdentifiers=function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[Rw(i_(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(t){return Rw(i_(t))}));var t={};for(var e in this.metrics)t[e]=Rw(i_(this.metrics[e]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var e,n,r=LC(c_(t.optimizer_config));if("string"==typeof t.loss)e=Dw(t.loss);else if(Array.isArray(t.loss))e=t.loss.map((function(t){return Dw(t)}));else if(null!=t.loss)for(var i in e={},t.loss)e[i]=Dw(t.loss[i]);if(Array.isArray(t.metrics))n=t.metrics.map((function(t){return Dw(t)}));else if(null!=t.metrics)for(var i in n={},t.metrics)n[i]=Dw(t.metrics[i]);this.compile({loss:e,metrics:n,optimizer:r})},e.prototype.save=function(t,e){return xw(this,void 0,void 0,(function(){var n,r,i,a,o,s,l,u,c,h;return Cw(this,(function(p){switch(p.label){case 0:if("string"==typeof t){if(0===(n=Qb.getSaveHandlers(t)).length)throw new Ow("Cannot find any save handlers for URL '"+t+"'");if(n.length>1)throw new Ow("Found more than one ("+n.length+") save handlers for URL '"+t+"'");t=n[0]}if(null==t.save)throw new Ow("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,Qb.encodeWeights(this.getNamedWeights(e))];case 1:return r=p.sent(),i=this.toJSON(null,!1),a={modelTopology:i,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v1.7.2",convertedBy:null},null!=e&&e.includeOptimizer&&null!=this.optimizer?(a.trainingConfig=this.getTrainingConfig(),o="optimizer",c=(u=Qb).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,c.apply(u,[p.sent(),o])];case 3:s=p.sent(),l=s.data,(h=r.specs).push.apply(h,s.specs),r.data=Qb.concatenateArrayBuffers([r.data,l]),p.label=4;case 4:return null!=this.userDefinedMetadata&&(a_(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,[2,t.save(a)]}}))}))},e.prototype.setUserDefinedMetadata=function(t){a_(t,this.name),this.userDefinedMetadata=t},e.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},e.className="Model",e}(function(t){function e(n){var r=t.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var i=r.getClassName().toLowerCase();r.name=uC(i)}if(r.supportsMasking=!1,r.trainable_=!0,r.inputs=Array.isArray(n.inputs)?n.inputs.slice():[n.inputs],r.outputs=Array.isArray(n.outputs)?n.outputs.slice():[n.outputs],Vw(r.inputs).length!==r.inputs.length)throw new Ow("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map((function(t){return t.name})));Vw(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map((function(t){return t.name}))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var a=0,o=r.outputs;a<o.length;a++){var s=(O=o[a]).sourceLayer,l=O.nodeIndex,u=O.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(l),r.outputLayersTensorIndices.push(u)}for(var c=0,h=r.inputs;c<h.length;c++)s=(O=h[c]).sourceLayer,u=O.tensorIndex,Pw(0===(l=O.nodeIndex),"input layer has >1 nodes"),Pw(0===u,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(l),r.inputLayersTensorIndices.push(u);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var p=0;p<r.inputLayers.length;p++){if(!((s=r.inputLayers[p])instanceof OC))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+p+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var d=0,f=r.outputLayers;d<f.length;d++)r.outputNames.push((s=f[d]).name);r.internalInputShapes=r.inputs.map((function(t){return t.shape})),r.internalOutputShapes=r.outputs.map((function(t){return t.shape}));for(var m={},g={},y={},v={},b={},w=[],x=function(t,n,i,a,o,s){null!=a&&null!=o&&null!=s||(a=t.sourceLayer,o=t.nodeIndex,s=t.tensorIndex);var l=a.inboundNodes[o];if(-1!==i.indexOf(l))throw new Sw("The tensor "+t.name+' at layer "'+a.name+'" is part of a cycle.');if(-1===n.indexOf(l)){r.containerNodes.add(e.nodeKey(a,o)),a.id in b||(b[a.id]=Object.keys(b).length),-1===i.indexOf(l)&&i.push(l);for(var u=l.inboundLayers.length,c=0;c<u;c++)x(l.inputTensors[c],n,i,l.inboundLayers[c],l.nodeIndices[c],l.tensorIndices[c]);for(n.push(l);i.indexOf(l)>=0;)i.splice(i.indexOf(l),1);w.push(l)}},C=[],_=[],k=0,S=r.outputs;k<S.length;k++){var O=S[k];x(O,C,_)}for(var E=0,M=w.slice().reverse();E<M.length;E++){g[($=M[E]).id]=$,$.id in m||(m[$.id]=0);var N=m[$.id];for(N=Math.max(N,null==y[$.outboundLayer.id]?0:y[$.outboundLayer.id]),y[$.outboundLayer.id]=N,v[$.outboundLayer.id]=$.outboundLayer,m[$.id]=N,p=0;p<$.inboundLayers.length;p++){var P=$.inboundLayers[p].inboundNodes[l=$.nodeIndices[p]];m[P.id]=Math.max(N+1,null==m[P.id]?0:m[P.id]),g[P.id]=P}}var T={};for(var I in m)(N=m[I])in T||(T[N]=[]),T[N].push(g[I]);var A={};for(var R in y)(N=y[R])in A||(A[N]=[]),A[N].push(v[R]);var D=Object.keys(A).map((function(t){return parseInt(t,10)})).sort(Bw);r.layers=[];for(var F=0,z=D;F<z.length;F++){var L=A[N=z[F]];L.sort((function(t,e){var n=b[t.id],r=b[e.id];return n<r?-1:n>r?1:0}));for(var B=0,V=L;B<V.length;B++)(s=V[B])instanceof e&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=A,D=Object.keys(T).map((function(t){return parseInt(t,10)})).sort(Bw);for(var U=r.inputs.slice(),W=[],j=0,q=D;j<q.length;j++)for(var H=0,G=T[N=q[j]];H<G.length;H++){var $;if(null!=(s=($=G[H]).outboundLayer)){for(var K=0,X=$.inputTensors;K<X.length;K++)if(-1===U.indexOf(O=X[K]))throw new Sw("Graph disconnected: cannot obtain value for tensor "+O+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+W);for(var Y=0,Q=$.outputTensors;Y<Q.length;Y++)U.push(O=Q[Y]);W.push(s.name)}}r.nodesByDepth=T;for(var Z=r.layers.map((function(t){return t.name})),J=function(t){var e=Z.filter((function(e){return e===t})).length;if(1!==e)throw new Sw('The name "'+t+'" is used '+e+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(Z))},tt=0,et=Z;tt<et.length;tt++)J(et[tt]);return r.outboundNodes=[],r.inboundNodes=[],new _C({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(t){return null})),outputMasks:r.outputs.map((function(t){return null})),inputShapes:r.inputs.map((function(t){return t.shape})),outputShapes:r.outputs.map((function(t){return t.shape}))}),r.built=!0,r._refCount=1,r}return vw(e,t),e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(var e=0,n=this.layers;e<n.length;e++)t.numDisposedVariables+=n[e].dispose().numDisposedVariables;for(var r=0,i=this.internalContainerRefs;r<i.length;r++)t.numDisposedVariables+=i[r].dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach((function(e){e._trainableWeights.forEach((function(e){return e.trainable=t}))})),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new Ow("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var t=[],e=0,n=this.layers;e<n.length;e++)t=t.concat(n[e].trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var i=[],a=0,o=this.layers;a<o.length;a++)i.push.apply(i,(r=o[a]).trainableWeights);return i.concat(t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.loadWeights=function(t,e){void 0===e&&(e=!0);for(var n={},r=0,i=0,a=this.layers;i<a.length;i++)for(var o=0,s=a[i].weights;o<s.length;o++){var l=s[o];if(null!=n[l.originalName])throw new Ow("Duplicate weight name: "+l.originalName);n[l.originalName]=l,r++}var u=[];for(var c in t){if(null!=n[c])u.push([n[c],t[c]]);else if(e)throw new Ow("Provided weight data has no target variable: "+c);delete n[c]}if(e){var h=[];for(var p in n)h.push(p);if(h.length>0)throw new Ow(h.length+" of "+r+" weights are not set: "+h)}yC(u)},e.prototype.updatedConfig=function(){var t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers 1.7.2",e.backend="TensorFlow.js",e},e.prototype.toJSON=function(t,e){void 0===e&&(e=!0);var n=function t(e,n){if(null==e)return null;if("string"==typeof e)return Rw(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var r=[],i=e.length,a=0;a<i;++a){var o=e[a];u_(n,a,o)?r.push(o):r.push(t(o,n))}return r}for(var s={},l=0,u=Object.keys(e);l<u.length;l++){var c=u[l],h=e[c];s[Rw(c)]="name"!==c&&"className"!==c||"string"!=typeof h?t(h,c):h}return s}(this.updatedConfig());return e?JSON.stringify(n):n},e.prototype.call=function(t,e){var n=this;return Du((function(){t=Aw(t);for(var r=new h_,i=0;i<n.inputs.length;++i)r.add(n.inputs[i],t[i]);return f_(n.outputs,r,e)}))},e.prototype.computeMask=function(t,e){var n=this;return Du((function(){var r;return t=Aw(t),r=null==e?Nw(null,t.length):Aw(e),n.runInternalGraph(t,r)[1]}))},e.prototype.computeOutputShape=function(t){var e=hC(t);if(e.length!==this.inputLayers.length)throw new Ow("Invalid inputShape argument "+t+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},r=0;r<e.length;r++){var i=this.inputLayers[r];n[b=i.name+"_0_0"]=e[r]}var a=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(Bw);if(a.length>1)for(var o=0,s=a;o<s.length;o++)for(var l=0,u=this.nodesByDepth[s[o]];l<u.length;l++){var c=u[l];if(i=c.outboundLayer,-1===this.inputLayers.map((function(t){return t.id})).indexOf(i.id)){for(var h=[],p=0;p<c.inboundLayers.length;p++){var d=c.tensorIndices[p],f=n[b=c.inboundLayers[p].name+"_"+c.nodeIndices[p]+"_"+d];h.push(f)}var m=hC(i.computeOutputShape(Iw(h))),g=i.inboundNodes.indexOf(c);for(p=0;p<m.length;p++)n[b=i.name+"_"+g+"_"+p]=m[p]}}var y=[],v=[];for(r=0;r<this.outputLayers.length;r++){var b=(i=this.outputLayers[r]).name+"_"+(g=this.outputLayersNodeIndices[r])+"_"+(d=this.outputLayersTensorIndices[r]);v.push(b)}for(r=0;r<v.length;r++){var w=v[r];Pw(w in n),y.push(n[w])}return Iw(y)},e.prototype.runInternalGraph=function(t,e){null==e&&(e=Nw(null,t.length));for(var n={},r=0;r<this.inputs.length;++r){var i=this.inputs[r],a=t[r],o=e[r];n[i.id]=[a,o]}for(var s=0,l=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(Bw);s<l.length;s++)for(var u=0,c=this.nodesByDepth[l[s]];u<c.length;u++){for(var h=c[u],p=h.outboundLayer,d=h.inputTensors,f=h.outputTensors,m=new Array,g=0,y=d;g<y.length;g++)(i=y[g]).id in n&&m.push(n[i.id]);if(m.length===d.length){var v={},b=void 0,w=void 0,x=void 0,C=void 0;if(null!=h.callArgs&&(v=h.callArgs),1===m.length){var _=m[0],k=_[0],S=_[1];null==v.mask&&(v.mask=S),x=Aw(p.call(k,v)),C=Aw(p.computeMask(k,S)),b=[k],w=[S]}else b=m.map((function(t){return t[0]})),w=m.map((function(t){return t[1]})),null==v.mask&&(v.mask=w),x=Aw(p.call(b,v)),C=Aw(p.computeMask(b,w));if(p.activityRegularizer)throw new Ew("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(r=0;r<f.length;++r)n[(i=f[r]).id]=[a=x[r],o=C[r]]}}for(var O=[],E=[],M=[],N=0,P=this.outputs;N<P.length;N++){Pw((i=P[N]).id in n,"Could not compute output "+i.name+" : "+i.id);var T=n[i.id],I=T[0];o=T[1],M.push(I.shape),O.push(I),E.push(o)}return[O,E,M]},e.prototype.buildNodeConversionMap=function(t){for(var n,r={},i=0,a=this.layers;i<a.length;i++){var o=a[i];n=o instanceof e?1:0;for(var s=0;s<o.inboundNodes.length;s++){var l=e.nodeKey(o,s);this.containerNodes.has(l)&&(r[l]=n,n+=1)}}return r},e.prototype.getLayer=function(t,e){if(null!=e){if(this.layers.length<=e)throw new Ow("Was asked to retrieve layer at index "+e+", but model only has "+this.layers.length+" layer(s).");return this.layers[e]}if(null==t)throw new Ow("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var i=r[n];if(i.name===t)return i}throw new Ow("No such layer: "+t)},e.prototype.calculateLosses=function(){var t=this;return Du((function(){for(var n=[],r=0,i=t.layers;r<i.length;r++)for(var a=i[r],o=0;o<a.inboundNodes.length;++o){var s=e.nodeKey(a,o);t.containerNodes.has(s)&&n.push.apply(n,a.calculateLosses())}return n}))},e.prototype.getConfig=function(){for(var t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],i=0,a=this.layers;i<a.length;i++){for(var o=(w=a[i]).getClassName(),s=w.getConfig(),l=[],u=0;u<w.inboundNodes.length;u++){var c=w.inboundNodes[u],h=e.nodeKey(w,u),p={};if(this.containerNodes.has(h)){if(c.callArgs)try{JSON.stringify(c.callArgs),p=c.callArgs}catch(t){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+c.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),p={}}if(c.inboundLayers.length>0){for(var d=[],f=0;f<c.inboundLayers.length;f++){var m=c.inboundLayers[f],g=c.nodeIndices[f],y=c.tensorIndices[f];null==(C=n[e.nodeKey(m,g)])&&(C=0),d.push([m.name,C,y,p])}l.push(d)}}}var v={};v.name=w.name,v.className=o,v.config=s,v.inboundNodes=l,r.push(v)}t.layers=r;var b=[];for(f=0;f<this.inputLayers.length;f++){var w=this.inputLayers[f];h=e.nodeKey(w,g=this.inputLayersNodeIndices[f]),this.containerNodes.has(h)&&(null!==(C=n[h])&&void 0!==C||(C=0),b.push([w.name,C,y=this.inputLayersTensorIndices[f]]))}t.inputLayers=b;var x=[];for(f=0;f<this.outputLayers.length;f++){var C;h=e.nodeKey(w=this.outputLayers[f],g=this.outputLayersNodeIndices[f]),this.containerNodes.has(h)&&(null!==(C=n[h])&&void 0!==C||(C=0),x.push([w.name,C,y=this.outputLayersTensorIndices[f]]))}return t.outputLayers=x,t},e.fromConfig=function(t,e,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var i={},a={};function o(t,e){t.name in a?a[t.name].push(e):a[t.name]=[e]}function s(t,e){for(var n,r=[],a=0,s=e;a<s.length;a++){var l=s[a],u=l[0],c=l[1],h=l[2];if(n=null==l[3]?{}:l[3],!(u in i))return void o(t,e);var p=i[u];if(p.inboundNodes.length<=c)return void o(t,e);r.push(p.inboundNodes[c].outputTensors[h])}r.length>0&&t.apply(Iw(r),n)}function l(t){var n=t.name,a=LC(t,null!=e.customObjects?e.customObjects:{});a.setFastWeightInitDuringBuild(r),i[n]=a,t.inboundNodes.forEach((function(t){if(!(t instanceof Array))throw new Ow("Corrupted configuration, expected array for nodeData: "+t);o(a,t)}))}for(var u=e.name,c=e.layers,h=0,p=c;h<p.length;h++)l(m=p[h]);for(;!Uw(a);)for(var d=0,f=c;d<f.length;d++){var m=f[d];if((N=i[m.name]).name in a){var g=a[N.name];delete a[N.name];for(var y=0,v=g;y<v.length;y++)s(N,v[y])}}for(var b=[],w=[],x=0,C=e.inputLayers;x<C.length;x++){var _=(m=C[x])[0],k=m[1],S=m[2];Pw(_ in i);var O=(N=i[_]).inboundNodes[k].outputTensors;b.push(O[S])}for(var E=0,M=e.outputLayers;E<M.length;E++){var N;_=(m=M[E])[0],k=m[1],S=m[2],Pw(_ in i),O=(N=i[_]).inboundNodes[k].outputTensors,w.push(O[S])}return new t({inputs:b,outputs:w,name:u})},Object.defineProperty(e.prototype,"stateful",{get:function(){if(this._stateful)throw new Ow("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var t=0,e=this.layers;t<e.length;t++)if(e[t].stateful)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){var t=this;Du((function(){t.layers.forEach((function(t){t.stateful&&t.resetStates()}))}))},e}(SC));function B_(t,e,n){return xw(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h;return Cw(this,(function(p){switch(p.label){case 0:if(null==n&&(n={}),null==t.load)throw new Ow("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,t.load()];case 1:if(r=p.sent(),null!=(i=r.modelTopology).model_config&&(i=i.model_config),a=null==n.strict||n.strict,o=null!=r.weightData&&null!=r.weightSpecs&&a,s=LC(c_(i),e,o),null!=(l=r.trainingConfig)&&s.loadTrainingConfig(l),null!=r.userDefinedMetadata&&s.setUserDefinedMetadata(r.userDefinedMetadata),null==r.weightData)return[3,4];if(null==r.weightSpecs)throw new Ow("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return u=function(t,e){var n=Qb.decodeWeights(t,e),r={},i=[];return e.forEach((function(t){"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs),h=u.optimizerWeights,s.loadWeights(c=u.modelWeights,a),null!=s.optimizer&&h.length>0?[4,s.optimizer.setWeights(h)]:[3,3];case 2:p.sent(),p.label=3;case 3:Fu(c),Fu(h.map((function(t){return t.tensor}))),p.label=4;case 4:return[2,s]}}))}))}iw.registerClass(L_);var V_=function(t){function e(e){var n=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},n.trainable=!0,n.built=!1,n.name=null!=e.name?e.name:uC("sequential_"),null!=e.layers)for(var r=0,i=e.layers;r<i.length;r++)n.add(i[r]);return n}return vw(e,t),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some((function(t){return t<0})))throw new Ow("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")},e.prototype.add=function(t){var n,r=t instanceof e||t instanceof L_;if(r){if(1!==(n=t).outputs.length)throw new Ow("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new Ow("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new Ow("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var i=EC({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new Ow("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new Ow("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,n,r){if((null==n||null!=r&&r>0)&&(n=e.sourceLayer,r=e.nodeIndex),0===n.inboundNodes.length)return[e];var i=n.inboundNodes[r];if(0===i.inboundLayers.length)return i.inputTensors;for(var a=[],o=0;o<i.inboundLayers.length;o++)for(var s=0,l=t(i.inputTensors[o],i.inboundLayers[o],i.nodeIndices[o]);s<l.length;s++){var u=l[s];-1===a.indexOf(u)&&a.push(u)}return a}(this.outputs[0])}this.inboundNodes=[],new _C({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Nw(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(t){return t.shape})),outputShapes:this.outputs[0].shape})}else{var a=t.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,e){return null==this.model&&this.build(),this.model.call(t,e)},e.prototype.build=function(t){if(dC(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new L_({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),t.prototype.countParams.call(this)},e.prototype.summary=function(e,n,r){void 0===r&&(r=console.log),this.built||this.build(),t.prototype.summary.call(this,e,n,r)},e.prototype.setWeights=function(t){null==this.model&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,e,n){if(void 0===n&&(n={}),!this.built)throw new Sw("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)},e.prototype.evaluateDataset=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){if(!this.built)throw new Sw("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,e)]}))}))},e.prototype.predict=function(t,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(t,e)},e.prototype.predictOnBatch=function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return null==this.model?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!0,configurable:!0}),e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),xw(this,void 0,void 0,(function(){return Cw(this,(function(r){if(!this.built)throw new Sw("The model needs to be compiled before being used.");return[2,this.model.fit(t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){if(!this.built)throw new Sw("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return xw(this,void 0,void 0,(function(){return Cw(this,(function(n){return[2,this.model.trainOnBatch(t,e)]}))}))},e.fromConfig=function(t,n,r,i){var a;void 0===r&&(r={}),void 0===i&&(i=!1);var o={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new Ow("Legacy serialization format not supported yet.");a=n}else tl.assert(null!=n.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),a=n.layers,delete n.layers,o=n;var s=new t(o);if(!(s instanceof e))throw new Ew("Sequential.fromConfig called on non-Sequential input: "+s);for(var l=0,u=a;l<u.length;l++){var c=LC(u[l],void 0,i);i&&c.setFastWeightInitDuringBuild(!0),s.add(c)}return s},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(null==this.model)throw new Ow("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(null==this.model)throw new Ow("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e],i={};i.className=r.getClassName(),i.config=r.getConfig(),t.push(i)}return{name:this.name,layers:t}},e.className="Sequential",e}(L_);iw.registerClass(V_);var U_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.getConfig=function(){return{}},e}(iw.Serializable),W_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=1),function(t,e){if(void 0===e&&(e=1),1!==e)throw new Ew("Support for alpha values other than 1 ("+e+") is not implemented yet.");return Sy(t)}(t,e)},e.className="elu",e}(U_);iw.registerClass(W_);var j_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return Py(t)},e.className="selu",e}(U_);iw.registerClass(j_);var q_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return My(t)},e.className="relu",e}(U_);iw.registerClass(q_);var H_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return Du((function(){return Dh(6,My(t))}))},e.className="relu6",e}(U_);iw.registerClass(H_);var G_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return t},e.className="linear",e}(U_);iw.registerClass(G_);var $_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return yh(t)},e.className="sigmoid",e}(U_);iw.registerClass($_);var K_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return function(t){return Du((function(){var e=Hc(.5,Bh(.2,t));return rh(e,0,1)}))}(t)},e.className="hardSigmoid",e}(U_);iw.registerClass(K_);var X_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return kh(t)},e.className="softplus",e}(U_);iw.registerClass(X_);var Y_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return function(t){return Du((function(){return Gh(t,Xc(t).add(1))}))}(t)},e.className="softsign",e}(U_);iw.registerClass(Y_);var Q_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t){return Mh(t)},e.className="tanh",e}(U_);iw.registerClass(Q_);var Z_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),op(t,e)},e.className="softmax",e}(U_);iw.registerClass(Z_);var J_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),sp(t,e)},e.className="logSoftmax",e}(U_);function tk(t){return t.getClassName()}function ek(t,e){return void 0===e&&(e={}),Lw(t,iw.SerializationMap.getMap().classNameMap,e,"activation")}function nk(t){var e;return null==t?ek(e={className:"linear",config:{}}):"string"==typeof t?((e={}).className=t,e.config={},ek(e)):t instanceof U_?t:ek(t)}function rk(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}iw.registerClass(J_);var ik=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e}(iw.Serializable),ak=function(t){function e(e){var n=t.call(this)||this;return rk(e),n.l1=null==e||null==e.l1?.01:e.l1,n.l2=null==e||null==e.l2?.01:e.l2,n.hasL1=0!==n.l1,n.hasL2=0!==n.l2,n}return vw(e,t),e.prototype.apply=function(t){var e=this;return Du((function(){var n=pc([1]);return e.hasL1&&(n=Hc(n,_y(Bh(e.l1,Xc(t))))),e.hasL2&&(n=Hc(n,_y(Bh(e.l2,Ax(t))))),n.asScalar()}))},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,e){return new t({l1:e.l1,l2:e.l2})},e.className="L1L2",e}(ik);iw.registerClass(ak);var ok={l1l2:"L1L2"};function sk(t){return zw(t)}function lk(t,e){return void 0===e&&(e={}),Lw(t,iw.SerializationMap.getMap().classNameMap,e,"regularizer")}function uk(t){return null==t?null:"string"==typeof t?lk({className:t in ok?ok[t]:t,config:{}}):t instanceof ik?t:lk(t)}var ck=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,null!=e&&(n.maxValue=e.maxValue),n}return vw(e,t),e.prototype.call=function(t,e){t=pC(t);var n=My(t);return null!=this.maxValue&&(n=rh(n,0,this.maxValue)),n},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={maxValue:this.maxValue},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ReLU",e}(SC);iw.registerClass(ck);var hk=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_ALPHA=.3,null==e&&(e={}),n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return vw(e,t),e.prototype.call=function(t,e){var n=pC(t);return Oy(n,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LeakyReLU",e}(SC);iw.registerClass(hk);var pk=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),n.supportsMasking=!0,n.alphaInitializer=aC(e.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=uk(e.alphaRegularizer),n.alphaConstraint=ex(e.alphaConstraint),null==e.sharedAxes)n.sharedAxes=null;else if(Array.isArray(e.sharedAxes))n.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new Ow("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);n.sharedAxes=[e.sharedAxes]}return n}return vw(e,t),e.prototype.build=function(t){var e=(t=dC(t)).slice(1);if(null!=this.sharedAxes)for(var n=0,r=this.sharedAxes;n<r.length;n++)e[(a=r[n])-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var i={};if(null!=this.sharedAxes)for(var a=1;a<t.length;++a)i[a]=t[a];this.inputSpec=[new wC({ndim:t.length,axes:i})],this.built=!0},e.prototype.call=function(t,e){return t=pC(t),Ey(t,this.alpha.read())},e.prototype.getConfig=function(){var e={alphaInitializer:iC(this.alphaInitializer),alphaRegularizer:sk(this.alphaRegularizer),alphaConstraint:Jw(this.alphaConstraint),sharedAxes:this.sharedAxes},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="PReLU",e}(SC);iw.registerClass(pk);var dk=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==n.DEFAULT_ALPHA)throw new Ew("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return vw(e,t),e.prototype.call=function(t,e){var n=pC(t);return Sy(n)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ELU",e}(SC);iw.registerClass(dk);var fk=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_THETA=1,null==e&&(e={}),n.theta=null==e.theta?n.DEFAULT_THETA:e.theta,n}return vw(e,t),e.prototype.call=function(t,e){var n=pC(t);return n.mul(Cx(n.greater(this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={theta:this.theta},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ThresholdedReLU",e}(SC);iw.registerClass(fk);var mk=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_AXIS=1,null==e&&(e={}),n.softmax=(new Z_).apply,n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n}return vw(e,t),e.prototype.call=function(t,e){var n=pC(t);return this.softmax(n,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Softmax",e}(SC);function gk(t,e,n){if("number"==typeof t)return Nw(t,e);if(t.length!==e)throw new Ow("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+t.length+" elements.");for(var r=0;r<e;++r){var i=t[r];if(!gx(i))throw new Ow("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+JSON.stringify(t)+" including a non-integer number "+i)}return t}function yk(t,e,n,r,i){return void 0===i&&(i=1),null==t?t:Math.floor((("same"===n?t:t-(e+(e-1)*(i-1))+1)+r-1)/r)}function vk(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+wx([n-e,0]);else{if("same"!==r)throw new Ow("Unsupport padding mode: "+r+".");t*=e}return t}function bk(t,e){return Du((function(){return sx(e),"channelsFirst"===e?lp(t,[0,2,3,1]):t}))}function wk(t,e){return Du((function(){return sx(e),"channelsFirst"===e?lp(t,[0,2,3,4,1]):t}))}function xk(t,e,n,r,i,a,o,s){return void 0===r&&(r=[1,1]),void 0===i&&(i="valid"),void 0===s&&(s=null),Du((function(){if(null==a&&(a="channelsLast"),sx(a),3!==t.rank&&4!==t.rank)throw new Ow("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+t.rank+".");if(3!==e.rank&&4!==e.rank)throw new Ow("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+t.rank+".");var l=bk(t,a);if("causal"===i)throw new Ew("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Pv.conv2d({x:l,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===a&&(l=lp(l,[0,3,1,2])),l}))}iw.registerClass(mk);var Ck=function(t){function e(n,r){var i=t.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(r),i.rank=n,qw(i.rank,"rank"),1!==i.rank&&2!==i.rank&&3!==i.rank)throw new Ew("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=gk(r.kernelSize,n,"kernelSize"),i.strides=gk(null==r.strides?1:r.strides,n,"strides"),i.padding=null==r.padding?"valid":r.padding,lx(i.padding),i.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,sx(i.dataFormat),i.activation=nk(r.activation),i.useBias=null==r.useBias||r.useBias,i.biasInitializer=aC(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=ex(r.biasConstraint),i.biasRegularizer=uk(r.biasRegularizer),i.activityRegularizer=uk(r.activityRegularizer),i.dilationRate=gk(null==r.dilationRate?1:r.dilationRate,n,"dilationRate"),1===i.rank&&Array.isArray(i.dilationRate)&&1!==i.dilationRate.length)throw new Ow("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(2===i.rank){if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate];else if(2!==i.dilationRate.length)throw new Ow("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(3===i.rank)if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(3!==i.dilationRate.length)throw new Ow("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate));return i}return vw(e,t),e.verifyArgs=function(t){if(Pw("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!jw(t.kernelSize,"number",1,3))throw new Ow("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(t.kernelSize)+".")},e.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:tk(this.activation),useBias:this.useBias,biasInitializer:iC(this.biasInitializer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),biasConstraint:Jw(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(SC),_k=function(t){function e(n,r){var i=t.call(this,n,r)||this;return i.kernel=null,e.verifyArgs(r),i.filters=r.filters,qw(i.filters,"filters"),i.kernelInitializer=aC(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=ex(r.kernelConstraint),i.kernelRegularizer=uk(r.kernelRegularizer),i}return vw(e,t),e.prototype.build=function(t){var e;t=dC(t);var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Ow("The channel dimension of the input should be defined. Found "+t[n]);var r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(e={},e[n]=r,e)}],this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){var e;t=pC(t);var r=null==n.bias?null:n.bias.read(),i=Hw(n.activation.getClassName());if(null!=i&&2===n.rank)e=xk(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,i);else{if(1===n.rank)e=function(t,e,n,r,i,a,o){return void 0===r&&(r=1),void 0===i&&(i="valid"),void 0===o&&(o=1),Du((function(){if(null==a&&(a="channelsLast"),sx(a),3!==t.shape.length)throw new Ow("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new Ow("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new Ow("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===a&&(t=lp(t,[0,2,1])),"causal"===i)throw new Ew("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=Dg(t,e,r,"same"===i?"same":"valid","NWC",o);return null!=n&&(s=Dx(s,n)),s}))}(t,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)e=xk(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Ew("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r,i,a,o){return void 0===r&&(r=[1,1,1]),void 0===i&&(i="valid"),Du((function(){if(null==a&&(a="channelsLast"),sx(a),4!==t.rank&&5!==t.rank)throw new Ow("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new Ow("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");var s=wk(t,a);if("causal"===i)throw new Ew("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=zg(s,e,r,"same"===i?"same":"valid","NDHWC",o),null!=n&&(s=Dx(s,n)),"channelsFirst"===a&&(s=lp(s,[0,4,1,2,3])),s}))}(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(e=n.activation.apply(e))}return e}))},e.prototype.computeOutputShape=function(t){t=dC(t);for(var e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<n.length;++r){var i=yk(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(i)}var a=[t[0]];return"channelsLast"===this.dataFormat?(a=a.concat(e)).push(this.filters):(a.push(this.filters),a=a.concat(e)),a},e.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:iC(this.kernelInitializer),kernelRegularizer:sk(this.kernelRegularizer),kernelConstraint:Jw(this.kernelConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.verifyArgs=function(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new Ow("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))},e}(Ck),kk=function(t){function e(n){var r=t.call(this,2,n)||this;return e.verifyArgs(n),r}return vw(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!jw(t.kernelSize,"number",1,2))throw new Ow("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv2D",e}(_k);iw.registerClass(kk);var Sk=function(t){function e(n){var r=t.call(this,3,n)||this;return e.verifyArgs(n),r}return vw(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new Ow("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv3D",e}(_k);iw.registerClass(Sk);var Ok=function(t){function e(e){var n=t.call(this,e)||this;if(n.inputSpec=[new wC({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new Ow("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return vw(e,t),e.prototype.build=function(t){var e;if(4!==(t=dC(t)).length)throw new Ow("Input should have rank 4; Received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Ow("The channel dimension of the inputs should be defined. Found `None`.");var r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new wC({ndim:4,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){var e=pC(t);if(4!==e.shape.length)throw new Ow("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);var r,i,a=e.shape;"channelsFirst"===n.dataFormat?(r=2,i=3):(r=1,i=2);var o=a[i],s=n.kernelSize[1],l=n.strides[1],u=[a[0],vk(a[r],n.strides[0],n.kernelSize[0],n.padding),vk(o,l,s,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=lp(e,[0,2,3,1]));var c=qg(e,n.kernel.read(),u,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(c=lp(c,[0,3,1,2])),null!=n.bias&&(c=Dx(c,n.bias.read(),n.dataFormat)),null!=n.activation&&(c=n.activation.apply(c)),c}))},e.prototype.computeOutputShape=function(t){var e,n,r,i=(t=dC(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3):(e=3,n=1,r=2);var a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],l=this.strides[1];return i[e]=this.filters,i[n]=vk(i[n],s,a,this.padding),i[r]=vk(i[r],l,o,this.padding),i},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e.className="Conv2DTranspose",e}(kk);iw.registerClass(Ok);var Ek=function(t){function e(e){return t.call(this,2,e)||this}return vw(e,t),e.className="SeparableConv2D",e}(function(t){function e(e,n){var r=t.call(this,e,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new Ow("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new Ow("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new Ow("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=aC(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=uk(n.depthwiseRegularizer),r.depthwiseConstraint=ex(n.depthwiseConstraint),r.pointwiseInitializer=aC(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=uk(n.pointwiseRegularizer),r.pointwiseConstraint=ex(n.pointwiseConstraint),r}return vw(e,t),e.prototype.build=function(t){var e;if((t=dC(t)).length<this.rank+2)throw new Ow("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n]||t[n]<0)throw new Ow("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[n]));for(var r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),a=[],o=0;o<this.rank;++o)a.push(1);a.push(r*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new wC({ndim:this.rank+2,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){var e;if(t=pC(t),1===n.rank)throw new Ew("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=lp(t,[0,2,3,1])),e=jg(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=Dx(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=lp(e,[0,3,1,2])),e}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=iC(this.depthwiseInitializer),e.pointwiseInitializer=iC(this.pointwiseInitializer),e.depthwiseRegularizer=sk(this.depthwiseRegularizer),e.pointwiseRegularizer=sk(this.pointwiseRegularizer),e.depthwiseConstraint=Jw(this.depthwiseConstraint),e.pointwiseConstraint=Jw(this.pointwiseConstraint),e},e.className="SeparableConv",e}(_k));iw.registerClass(Ek);var Mk=function(t){function e(n){var r=t.call(this,1,n)||this;return e.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return vw(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!jw(t.kernelSize,"number",1,1))throw new Ow("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv1D",e}(_k);iw.registerClass(Mk);var Nk=function(t){function e(e){var n=t.call(this,e)||this;return n.cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,n.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,n.inputSpec=[{ndim:4}],n}return vw(e,t),e.prototype.computeOutputShape=function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,e){var n=this;return Du((function(){return t=pC(t),"channelsLast"===n.dataFormat?Ox(Ox(t,n.cropping[0][0],t.shape[1]-n.cropping[0][0]-n.cropping[0][1],2),n.cropping[1][0],t.shape[2]-n.cropping[1][1]-n.cropping[1][0],3):Ox(Ox(t,n.cropping[0][0],t.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),n.cropping[1][0],t.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))},e.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Cropping2D",e}(SC);iw.registerClass(Nk);var Pk=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=null==e.size?n.DEFAULT_SIZE:e.size,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,n}return vw(e,t),e.prototype.computeOutputShape=function(t){if("channelsFirst"===this.dataFormat){var e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}return[t[0],e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2],t[3]]},e.prototype.call=function(t,e){var n=this;return Du((function(){var e=pC(t),r=e.shape;if("channelsFirst"===n.dataFormat){e=lp(e,[0,2,3,1]);var i=n.size[0]*r[2],a=n.size[1]*r[3],o=e.resizeNearestNeighbor([i,a]);return lp(o,[0,3,1,2])}return e.resizeNearestNeighbor([i=n.size[0]*r[1],a=n.size[1]*r[2]])}))},e.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="UpSampling2D",e}(SC);iw.registerClass(Pk);var Tk=function(t){function e(e){var n=t.call(this,2,e)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,n.depthwiseInitializer=aC(e.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=ex(e.depthwiseConstraint),n.depthwiseRegularizer=uk(e.depthwiseRegularizer),n}return vw(e,t),e.prototype.build=function(t){if((t=dC(t)).length<4)throw new Ow("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");var e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new Ow("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[e]+").");var n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){var e=function(t,e,n,r,i,a){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),Du((function(){null==i&&(i="channelsLast"),sx(i);var a=bk(t,i);if(4!==t.rank)throw new Ow("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new Ow("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return a=Vg(a,e,n,"same"===r?"same":"valid","NHWC",null),"channelsFirst"===i&&(a=lp(a,[0,3,1,2])),a}))}(t=pC(t),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat);return n.useBias&&(e=Dx(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),e}))},e.prototype.computeOutputShape=function(t){t=dC(t);var e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=yk("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),i=yk(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,r,i]:[t[0],r,i,n]},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=iC(this.depthwiseInitializer),e.depthwiseRegularizer=sk(this.depthwiseRegularizer),e.depthwiseConstraint=Jw(this.depthwiseRegularizer),e},e.className="DepthwiseConv2D",e}(Ck);iw.registerClass(Tk);var Ik=function(t){function e(e){var n=t.call(this,e)||this;return n.rate=Math.max(Math.min(e.rate,1),0),n.noiseShape=e.noiseShape,n.seed=e.seed,n.supportsMasking=!0,n}return vw(e,t),e.prototype.getNoiseShape=function(t){if(null==this.noiseShape)return this.noiseShape;for(var e=t.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t);if(0<n.rate&&n.rate<1){var i=null!=e.training&&e.training,a=n.getNoiseShape(r);return zx((function(){return Fx(r,n.rate,a,n.seed)}),(function(){return r}),i)}return t}))},e.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.dispose=function(){return t.prototype.dispose.call(this)},e.className="Dropout",e}(SC);iw.registerClass(Ik);var Ak=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[{ndim:3}],n}return vw(e,t),e.prototype.getNoiseShape=function(t){var e=t.shape;return[e[0],1,e[2]]},e.className="SpatialDropout1D",e}(Ik);iw.registerClass(Ak);var Rk=function(t){function e(e){var n=t.call(this,e)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=[r,e.inputDim]}return n.units=e.units,qw(n.units,"units"),n.activation=nk(e.activation),null!=e.useBias&&(n.useBias=e.useBias),n.kernelInitializer=aC(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=aC(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=ex(e.kernelConstraint),n.biasConstraint=ex(e.biasConstraint),n.kernelRegularizer=uk(e.kernelRegularizer),n.biasRegularizer=uk(e.biasRegularizer),n.activityRegularizer=uk(e.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return vw(e,t),e.prototype.build=function(t){var e,n=(t=dC(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(e={},e[-1]=n,e)}],this.built=!0},e.prototype.computeOutputShape=function(t){var e=(t=dC(t)).slice();return e[e.length-1]=this.units,e},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r,i=pC(t),a=Hw(n.activation.getClassName());return null!=a?r=Tx(i,n.kernel.read(),a,n.bias?n.bias.read():null):(r=Tx(i,n.kernel.read()),null!=n.bias&&(r=Dx(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))},e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),biasInitializer:iC(this.biasInitializer),kernelRegularizer:sk(this.kernelRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),biasConstraint:Jw(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dense",e}(SC);iw.registerClass(Rk);var Dk=function(t){function e(e){var n=this;return(n=t.call(this,e=e||{})||this).inputSpec=[{minNDim:3}],n.dataFormat=e.dataFormat,n}return vw(e,t),e.prototype.computeOutputShape=function(t){for(var e=0,n=(t=dC(t)).slice(1);e<n.length;e++)if(null==n[e])throw new Ow('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],yx(t,1)]},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var i=[0],a=2;a<r.rank;++a)i.push(a);i.push(1),r=r.transpose(i)}return function(t){if(t.rank<=1)throw new Ow("batchFlatten requires a minimum rank of 2. Got rank: "+t.rank+".");var e=[t.shape[0],yx(t.shape,1)];return t.reshape(e)}(r)}))},e.prototype.getConfig=function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Flatten",e}(SC);iw.registerClass(Dk);var Fk=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.activation=nk(e.activation),n}return vw(e,t),e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t);return n.activation.apply(r)}))},e.prototype.getConfig=function(){var e={activation:tk(this.activation)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Activation",e}(SC);iw.registerClass(Fk);var zk=function(t){function e(e){var n=t.call(this,e)||this;return n.n=e.n,n.inputSpec=[{ndim:2}],n}return vw(e,t),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,e){var n=this;return Du((function(){return function(t,e){return Du((function(){if(2!==t.shape.length)throw new Ow("repeat() expects a rank-2 tensor, but received a rank-"+t.shape.length+" tensor.");return Nx(_x(t,1),[1,e,1])}))}(t=pC(t),n.n)}))},e.prototype.getConfig=function(){var e={n:this.n},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="RepeatVector",e}(SC);iw.registerClass(zk);var Lk=function(t){function e(e){var n=t.call(this,e)||this;n.targetShape=e.targetShape;for(var r=0;r<n.targetShape.length;++r)n.isUnknown(n.targetShape[r])&&(n.targetShape[r]=null);return n}return vw(e,t),e.prototype.isUnknown=function(t){return t<0||null==t},e.prototype.fixUnknownDimension=function(t,e){for(var n="Total size of new array must be unchanged.",r=e.slice(),i=1,a=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==a)throw new Ow("Can only specifiy one unknown dimension.");a=o}else i*=s}var l=yx(t);if(null!==a){if(0===i||l%i!=0)throw new Ow(n);r[a]=l/i}else if(l!==i)throw new Ow(n);return r},e.prototype.computeOutputShape=function(t){for(var e=!1,n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t),i=r.shape,a=i.slice(0,1).concat(n.fixUnknownDimension(i.slice(1),n.targetShape));return r.reshape(a)}))},e.prototype.getConfig=function(){var e={targetShape:this.targetShape},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Reshape",e}(SC);iw.registerClass(Lk);var Bk=function(t){function e(e){var n=t.call(this,e)||this;if(null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var r=xx(1,e.dims.length+1);if(!tl.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=e.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new wC({ndim:n.dims.length+1})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){var e=(t=dC(t)).slice();return this.dims.forEach((function(n,r){e[r+1]=t[n]})),e},e.prototype.call=function(t,e){return lp(pC(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var e={dims:this.dims},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Permute",e}(SC);iw.registerClass(Bk);var Vk=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,n.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,n}return vw(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,e),n},e.prototype.computeMask=function(t,e){var n=pC(t);return my(Og(n,this.maskValue),-1)},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t),i=my(Og(r,n.maskValue),-1,!0);return r.mul(i.asType(r.dtype))}))},e.className="Masking",e}(SC);iw.registerClass(Vk);var Uk=function(t){function e(e){var n=t.call(this,e)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=null==e.inputLength?[r,null]:[r].concat(Aw(e.inputLength))}return n.inputDim=e.inputDim,qw(n.inputDim,"inputDim"),n.outputDim=e.outputDim,qw(n.outputDim,"outputDim"),n.embeddingsInitializer=aC(e.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=uk(e.embeddingsRegularizer),n.activityRegularizer=uk(e.activityRegularizer),n.embeddingsConstraint=ex(e.embeddingsConstraint),n.maskZero=e.maskZero,n.supportsMasking=e.maskZero,n.inputLength=e.inputLength,n}return vw(e,t),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,e){var n=this;return Du((function(){return n.maskZero?(t=pC(t),Og(t,yc(t))):null}))},e.prototype.computeOutputShape=function(t){if(t=dC(t),null==this.inputLength)return t.concat([this.outputDim]);var e=Aw(this.inputLength);if(e.length!==t.length-1)throw new Ow('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(var n=0,r=0;r<e.length;++r){var i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new Ow('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);null==i&&(e[n]=a),n++}return[t[0]].concat(e,[this.outputDim])},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t);return"int32"!==r.dtype&&(r=Cx(r,"int32")),Ix(n.embeddings.read(),r.as1D()).reshape(dC(n.computeOutputShape(r.shape)))}))},e.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:iC(this.embeddingsInitializer),embeddingsRegularizer:sk(this.embeddingsRegularizer),activityRegularizer:sk(this.activityRegularizer),embeddingsConstraint:Jw(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Embedding",e}(SC);iw.registerClass(Uk);var Wk=function(t){function e(e){var n=t.call(this,e||{})||this;return n.supportsMasking=!0,n}return vw(e,t),e.prototype.mergeFunction=function(t){throw new Ew},e.prototype.computeElementwiseOpOutputShape=function(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(var n=t.slice(0,t.length-e.length),r=0;r<e.length;++r){var i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new Ow("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n},e.prototype.build=function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[dC(t)]),(t=t).length<2)throw new Ow("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(var e=[],n=0,r=t;n<r.length;n++)null!=(o=r[n])&&null!==o[0]&&e.push(o[0]);if((e=Vw(e)).length>1)throw new Ow("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(var i=null==t[0]?null:t[0].slice(1),a=1;a<t.length;++a){var o=null==t[a]?null:t[a].slice(1);i=this.computeElementwiseOpOutputShape(i,o)}var s=t.map((function(t){return t.length}));this.reshapeRequired=-1!==t.indexOf(null)||1!==Vw(s).length},e.prototype.call=function(t,e){var n=this;return Du((function(){if(t=t,n.reshapeRequired){var e=[],r=t.map((function(t){return t.rank}));if(-1===r.indexOf(null)){for(var i=wx(r),a=0,o=t;a<o.length;a++){for(var s=(p=o[a]).rank,l=0;l<i-s;++l)p=_x(p,1);e.push(p)}return n.mergeFunction(e)}for(var u=!1,c=0,h=t;c<h.length;c++){var p;if(null==(s=(p=h[c]).rank)){var d=p.shape,f=d[0],m=d.slice(1).concat([f]),g=p.reshape([f].concat(yx(d.slice(1))));g=(g=lp(g,[1,0])).reshape(m),e.push(g),u=!0}else if(s>1){var y=xx(1,s).concat([0]);e.push(lp(p,y)),u=!0}else e.push(p)}var v=n.mergeFunction(e),b=v.rank;if(u)if(null==b){var w=v.shape;m=[f=w[w.length-1]].concat(w.slice(0,w.length-1)),v=lp(v.reshape([-1,f]),[1,0]).reshape(m)}else b>1&&(y=[b-1].concat(xx(0,b-1)),v=lp(v,y));return v}return n.mergeFunction(t)}))},e.prototype.computeOutputShape=function(t){var e;e=null==(t=t)[0]?null:t[0].slice(1);for(var n=1;n<t.length;++n){var r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}for(var i=[],a=0,o=t;a<o.length;a++)null!=(r=o[a])&&null!==r[0]&&i.push(r[0]);return 1===(i=Vw(i)).length?i.concat(e):[null].concat(e)},e.prototype.computeMask=function(t,e){return Du((function(){if(null==e)return null;if(!Array.isArray(e))throw new Ow("`mask` should be an Array");if(!Array.isArray(t))throw new Ow("`inputs` should be an Array");if(e.length!==t.length)throw new Ow("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+t.length+" vs "+e.length+")");if(e.every((function(t){return null==t})))return null;for(var n=(e=e.map((function(t){return null==t?t:Nc(t,0)})))[0],r=1;r<e.length-1;++r)n=Um(n,e[r]);return n}))},e}(SC),jk=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.mergeFunction=function(t){return Du((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Hc(e,t[n]);return e}))},e.className="Add",e}(Wk);iw.registerClass(jk);var qk=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.mergeFunction=function(t){return Du((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Bh(e,t[n]);return e}))},e.className="Multiply",e}(Wk);iw.registerClass(qk);var Hk=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.mergeFunction=function(t){return Du((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Hc(e,t[n]);return Bh(1/t.length,e)}))},e.className="Average",e}(Wk);iw.registerClass(Hk);var Gk=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.mergeFunction=function(t){return Du((function(){for(var e=t[0],n=1;n<t.length;++n)e=Ah(e,t[n]);return e}))},e.className="Maximum",e}(Wk);iw.registerClass(Gk);var $k=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.mergeFunction=function(t){return Du((function(){for(var e=t[0],n=1;n<t.length;++n)e=Dh(e,t[n]);return e}))},e.className="Minimum",e}(Wk);iw.registerClass($k);var Kk=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_AXIS=-1,null==e&&(e={}),n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return vw(e,t),e.prototype.build=function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new Ow("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var e=!0,n=0,r=t=t;n<r.length;n++)if(null!=(c=r[n])){e=!1;break}if(!e){for(var i=[],a=0;a<t.length;++a){var o=t[a].slice();o.splice(this.axis,1);for(var s=!1,l=0,u=i;l<u.length;l++){var c=u[l];if(tl.arraysEqual(c,o)){s=!0;break}}s||i.push(o)}if(i.length>1)throw new Ow("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var e=this;return Du((function(){return Ex(t,e.axis)}))},e.prototype.computeOutputShape=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Ow("A `Concatenate` layer should be called on a list of inputs.");for(var e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,i=0,a=e.slice(1);i<a.length;i++){var o=a[i];if(null==n[r]||null==o[r]){n[r]=null;break}n[r]+=o[r]}return n},e.prototype.computeMask=function(t,e){var n=this;if(null==e)return null;if(!Array.isArray(e))throw new Ow("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Ow("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new Ow("Mismatch in the length of mask ("+e.length+") and the legnth of inputs ("+t.length+")");return Du((function(){var r=!0;if(e.forEach((function(t){null==t||(r=!1)})),r)return null;for(var i=[],a=0;a<t.length;++a)i.push(null==e[a]?gc(t[a]).asType("bool"):e[a].rank<t[a].rank?Nc(e[a],-1):e[a]);var o=vc(i,n.axis);return fy(o,-1,!1)}))},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Concatenate",e}(Wk);function Xk(t,e){for(;t<0;)t+=e;return t}iw.registerClass(Kk);var Yk=function(t){function e(e){var n=t.call(this,e)||this;return n.axes=e.axes,n.normalize=null!=e.normalize&&e.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return vw(e,t),e.prototype.build=function(t){tl.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0],n=t[1];if(e.length>3||n.length>3)throw new Ew("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new Ow("Dimension incompatibility: "+e[r[0]]+" !== "+n[r[1]])},e.prototype.mergeFunction=function(t){if(2!==t.length)throw new Ow("A `Dot` layer must be called on exactly 2 inputs, but received "+t.length+" input(s).");var e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((function(e,n){return Xk(e,t[n].shape.length)})):[Xk(this.axes,n.shape.length),Xk(this.axes,r.shape.length)],this.normalize&&(n=BC(n,e[0]),r=BC(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ew("batchDot is not implemented for tensors of 4D or higher rank yet");if(tl.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, but got "+t.shape.length})),tl.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, but got "+e.shape.length})),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new Ew("batchDot is not implemented for complex64-type Tensors yet.");var r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);var a=n;return Du((function(){var n,o;if(r>i){n=r-i;for(var s=[],l=0;l<n;++l)s.push(1);e=e.reshape(e.shape.concat(s))}else if(i>r){for(n=i-r,s=[],l=0;l<n;++l)s.push(1);t=t.reshape(t.shape.concat(s))}else n=0;if(o=2===t.shape.length&&2===e.shape.length?a[0]===a[1]?t.mulStrict(e).sum(a[0]):t.transpose([1,0]).mulStrict(e).sum(a[1]):t.matMul(e,a[0]!==t.shape.length-1,a[1]===e.shape.length-1),n>0){var u,c=[];for(l=u=r>i?r+i-3:r-1;l<u+n;++l)c.push(l);o=o.squeeze(c)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,r,e)},e.prototype.interpretAxes=function(t,e){return Array.isArray(this.axes)?this.axes:[Xk(this.axes,t.length),Xk(this.axes,e.length)]},e.prototype.computeOutputShape=function(t){tl.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new Ew("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var i=e.concat(n);return 1===i.length&&i.push(1),i},e.prototype.computeMask=function(t,e){return null},e.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dot",e}(Wk);iw.registerClass(Yk);var Qk=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.stddev=e.stddev,n}return vw(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t);return zx((function(){return Px(r.shape,0,n.stddev).add(r)}),(function(){return r}),e.training||!1)}))},e.className="GaussianNoise",e}(SC);iw.registerClass(Qk);var Zk=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n}return vw(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e);var r=pC(t);return n.rate>0&&n.rate<1?zx((function(){var t=Math.sqrt(n.rate/(1-n.rate));return r.mul(Px(r.shape,1,t))}),(function(){return r}),e.training||!1):r}))},e.className="GaussianDropout",e}(SC);iw.registerClass(Zk);var Jk=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n.noiseShape=e.noiseShape,n}return vw(e,t),e.prototype._getNoiseShape=function(t){return this.noiseShape||pC(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Du((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(t);return zx((function(){var e=pC(t),i=-1.7580993408473766,a=bg(pg(r),n.rate);a=Cx(a,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(i,2)),-.5),s=-o*i*n.rate;return e.mul(a).add(a.add(-1).mul(i)).mul(o).add(s)}),(function(){return pC(t)}),e.training||!1)}return t}))},e.className="AlphaDropout",e}(SC);function tS(t,e,n,r,i,a){var o;if(void 0===a&&(a=.001),2===t.rank)o=Im(t,e,n,r,i,a);else if(3===t.rank)o=Dm(t,e,n,r,i,a);else{if(4!==t.rank)throw new Ew("batchNormalization is not implemented for array of rank "+t.rank+" yet");o=Lm(t,e,n,r,i,a)}return o}iw.registerClass(Jk);var eS=function(t){function e(e){var n=this;return null==e&&(e={}),(n=t.call(this,e)||this).supportsMasking=!0,n.axis=null==e.axis?-1:e.axis,n.momentum=null==e.momentum?.99:e.momentum,n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=aC(e.betaInitializer||"zeros"),n.gammaInitializer=aC(e.gammaInitializer||"ones"),n.movingMeanInitializer=aC(e.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=aC(e.movingVarianceInitializer||"ones"),n.betaConstraint=ex(e.betaConstraint),n.gammaConstraint=ex(e.gammaConstraint),n.betaRegularizer=uk(e.betaRegularizer),n.gammaRegularizer=uk(e.gammaRegularizer),n}return vw(e,t),e.prototype.build=function(t){var e;t=dC(t);var n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(null==r)throw new Ow("Axis "+n+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new wC({ndim:t.length,axes:(e={},e[n]=r,e)})];var i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){var r=null!=e.training&&e.training,i=pC(t),a=i.shape,o=a.length,s=xx(0,o),l=n.axis>=0?n.axis:n.axis+o;s.splice(l,1);var u=Nw(1,o);u[l]=a[l];var c=s.slice();c.sort();var h=!tl.arraysEqual(c,xx(0,o).slice(0,o-1));if(!r)return function(){if(h){var t=n.movingMean.read().reshape(u),e=n.movingVariance.read().reshape(u),r=n.center?n.beta.read().reshape(u):null,a=n.scale?n.gamma.read().reshape(u):null;return tS(i,t,e,r,a,n.epsilon)}return tS(i,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var p=function(t,e,n,r,i){return void 0===i&&(i=.001),tl.arraysEqual(r.slice().sort(),xx(0,t.rank-1))?function(t,e,n,r,i){return void 0===i&&(i=.001),Du((function(){var a=Cy(t,r),o=a.mean,s=a.variance;return[tS(t,o,s,n,e,i),o,s]}))}(t,e,n,r,i):function(t,e,n,r,i){return void 0===i&&(i=.001),Du((function(){for(var a=Cy(t,r),o=a.mean,s=a.variance,l=[],u=0,c=xx(0,t.rank);u<c.length;u++){var h=c[u];-1!==r.indexOf(h)?l.push(1):l.push(t.shape[h])}var p=o.reshape(l),d=s.reshape(l),f=null==e?null:e.reshape(l),m=null==n?null:n.reshape(l);return[tS(t,p,d,m,f,i),o,s]}))}(t,e,n,r,i)}(i,n.gamma.read(),n.beta.read(),s,n.epsilon),d=p[0],f=p[2],m=function(t,e,n){Du((function(){var r=1-n,i=t.read(),a=i.sub(e).mul(r);t.write(i.sub(a))}))};return m(n.movingMean,p[1],n.momentum),m(n.movingVariance,f,n.momentum),d}))},e.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:iC(this.betaInitializer),gammaInitializer:iC(this.gammaInitializer),movingMeanInitializer:iC(this.movingMeanInitializer),movingVarianceInitializer:iC(this.movingVarianceInitializer),betaRegularizer:sk(this.betaRegularizer),gammaRegularizer:sk(this.gammaRegularizer),betaConstraint:Jw(this.betaConstraint),gammaConstraint:Jw(this.gammaConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="BatchNormalization",e}(SC);iw.registerClass(eS);var nS=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).axis=null==e.axis?-1:e.axis,"number"==typeof n.axis){if(!Number.isInteger(n.axis))throw new Error("Expected axis to be an integer, but received "+n.axis)}else{if(!Array.isArray(n.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(n.axis));for(var r=0,i=n.axis;r<i.length;r++)if(!Number.isInteger(i[r]))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(n.axis))}return n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=aC(e.betaInitializer||"zeros"),n.gammaInitializer=aC(e.gammaInitializer||"ones"),n.betaRegularizer=uk(e.betaRegularizer),n.gammaRegularizer=uk(e.gammaRegularizer),n.supportsMasking=!0,n}return vw(e,t),e.prototype.build=function(t){var e=(t=dC(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=e);for(var r=0,i=this.axis;r<i.length;r++){var a=i[r];if(a<0||a>=e)throw new Error("Invalid axis: "+a)}if(this.axis.length!==Vw(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var o=this.axis.map((function(e){return t[e]}));this.gamma=this.scale?this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0},e.prototype.call=function(t,e){var n=this,r=pC(t),i=r.shape,a=i.length;return Du((function(){for(var t=Cy(r,n.axis,!0),e=t.mean,o=t.variance,s=Nw(1,a),l=0,u=n.axis;l<u.length;l++){var c=u[l];s[c]=i[c]}for(var h=function(t){return null!=t&&t.shape.length!==a&&n.axis!==[a-1]?t.reshape(s):t},p=h(n.gamma.read()),d=h(n.beta.read()),f=[],m=[],g=0;g<a;++g)-1!==n.axis.indexOf(g)?(f.push(i[g]),m.push(1)):(f.push(1),m.push(i[g]));return e=e.tile(f),o=o.tile(f),p=p.tile(m),d=d.tile(m),tS(r,e,o,d,p,n.epsilon)}))},e.prototype.getConfig=function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:iC(this.betaInitializer),gammaInitializer:iC(this.gammaInitializer),betaRegularizer:sk(this.betaRegularizer),gammaRegularizer:sk(this.gammaRegularizer)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LayerNormalization",e}(SC);iw.registerClass(nS);var rS=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)n.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Ow("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");var r=void 0,i=void 0;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Ow("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(r=e.padding[0],2!==e.padding[1].length)throw new Ow("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");i=e.padding[1]}n.padding=[r,i]}return n.inputSpec=[new wC({ndim:4})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){return t=dC(t),"channelsFirst"===this.dataFormat?[t[0],t[1],null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null]:[t[0],null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,t[3]]},e.prototype.call=function(t,e){var n=this;return Du((function(){return function(t,e,n){return Du((function(){if(4!==t.rank)throw new Ow("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new Ow("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new Ow("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");return Zm(t,"channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]])}))}(pC(t),n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ZeroPadding2D",e}(SC);function iS(t,e,n,r,i,a){return Du((function(){var o;sx(i),ux(a),lx(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=bk(t,i);var s="same"===r?"same":"valid";return o="max"===a?ny(t,e,n,s):ry(t,e,n,s),"channelsFirst"===i&&(o=lp(o,[0,3,1,2])),o}))}function aS(t,e,n,r,i,a){return Du((function(){var o;sx(i),ux(a),lx(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=wk(t,i);var s="same"===r?"same":"valid";return o="max"===a?ay(t,e,n,s):oy(t,e,n,s),"channelsFirst"===i&&(o=lp(o,[0,4,1,2,3])),o}))}iw.registerClass(rS);var oS=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=2),n=t.call(this,e)||this,"number"==typeof e.poolSize)n.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new Ow("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));n.poolSize=e.poolSize}if(qw(n.poolSize,"poolSize"),null==e.strides)n.strides=n.poolSize;else if("number"==typeof e.strides)n.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new Ow("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));n.strides=e.strides}return qw(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,lx(n.padding),n.inputSpec=[new wC({ndim:3})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){var e=yk((t=dC(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]},e.prototype.call=function(t,e){var n=this;return Du((function(){n.invokeCallHook(t,e),t=_x(pC(t),2);var r=n.poolingFunction(pC(t),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Ic(r,[2])}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(SC),sS=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return sx(i),lx(r),iS(t,e,n,r,i,"max")},e.className="MaxPooling1D",e}(oS);iw.registerClass(sS);var lS=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return sx(i),lx(r),iS(t,e,n,r,i,"avg")},e.className="AveragePooling1D",e}(oS);iw.registerClass(lS);var uS=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Ow("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides];return qw(n.poolSize,"poolSize"),qw(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,sx(n.dataFormat),lx(n.padding),n.inputSpec=[new wC({ndim:4})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){t=dC(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=yk(e,this.poolSize[0],this.padding,this.strides[0]),n=yk(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return Du((function(){return n.invokeCallHook(t,e),n.poolingFunction(pC(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(SC),cS=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return sx(i),lx(r),iS(t,e,n,r,i,"max")},e.className="MaxPooling2D",e}(uS);iw.registerClass(cS);var hS=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return sx(i),lx(r),iS(t,e,n,r,i,"avg")},e.className="AveragePooling2D",e}(uS);iw.registerClass(hS);var pS=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Ow("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides,e.strides];return qw(n.poolSize,"poolSize"),qw(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,sx(n.dataFormat),lx(n.padding),n.inputSpec=[new wC({ndim:5})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){t=dC(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=yk(e,this.poolSize[0],this.padding,this.strides[0]),n=yk(n,this.poolSize[1],this.padding,this.strides[1]),r=yk(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]},e.prototype.call=function(t,e){var n=this;return Du((function(){return n.invokeCallHook(t,e),n.poolingFunction(pC(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(SC),dS=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return sx(i),lx(r),aS(t,e,n,r,i,"max")},e.className="MaxPooling3D",e}(pS);iw.registerClass(dS);var fS=function(t){function e(e){return t.call(this,e)||this}return vw(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return sx(i),lx(r),aS(t,e,n,r,i,"avg")},e.className="AveragePooling3D",e}(pS);iw.registerClass(fS);var mS=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[new wC({ndim:3})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,e){throw new Ew},e}(SC),gS=function(t){function e(e){return t.call(this,e||{})||this}return vw(e,t),e.prototype.call=function(t,e){return Du((function(){var e=pC(t);return wy(e,1)}))},e.className="GlobalAveragePooling1D",e}(mS);iw.registerClass(gS);var yS=function(t){function e(e){return t.call(this,e||{})||this}return vw(e,t),e.prototype.call=function(t,e){return Du((function(){var e=pC(t);return by(e,1)}))},e.className="GlobalMaxPooling1D",e}(mS);iw.registerClass(yS);var vS=function(t){function e(e){var n=t.call(this,e)||this;return n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,sx(n.dataFormat),n.inputSpec=[new wC({ndim:4})],n}return vw(e,t),e.prototype.computeOutputShape=function(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,e){throw new Ew},e.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(SC),bS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.call=function(t,e){var n=this;return Du((function(){var e=pC(t);return wy(e,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))},e.className="GlobalAveragePooling2D",e}(vS);iw.registerClass(bS);var wS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.call=function(t,e){var n=this;return Du((function(){var e=pC(t);return by(e,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))},e.className="GlobalMaxPooling2D",e}(vS);function xS(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new Ow("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function CS(t,e,n,r,i,a,o,s){return void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),Du((function(){var l=e.shape.length;if(l<3)throw new Ow("Input should be at least 3D, but is "+l+"D.");var u=[1,0].concat(xx(2,l));if(e=lp(e,u),null!=a)throw new Ew("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=i.asType("bool").asType("float32")).rank===l-1&&(i=Nc(i,-1)),i=lp(i,u)),r&&(e=Xg(e,0),null!=i&&(i=Xg(i,0)));var c,h,p=[],d=n,f=e.shape[0],m=Rc(e);null!=i&&(h=Rc(i));for(var g,y=function(e){var n=m[e],r=Du((function(){return t(n,d)}));if(null==i)c=r[0],d=r[1];else{var a=Du((function(){var t=h[e],n=gc(t).sub(t);return{output:r[0].mul(t).addStrict(d[0].mul(n)),newStates:d.map((function(e,i){return r[1][i].mul(t).addStrict(e.mul(n))}))}}));c=a.output,d=a.newStates}s&&p.push(c)},v=0;v<f;++v)y(v);return s&&(g=Ac(p,1)),[c,g,d]}))}iw.registerClass(wS);var _S=function(t){function e(e){var n,r=t.call(this,e)||this;if(null==e.cell)throw new Ow("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(e.cell)?new TS({cells:e.cell}):e.cell).stateSize)throw new Ow("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new wC({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return vw(e,t),e.prototype.getStates=function(){return null==this.states_?xx(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(t){return null})):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){cC(t)&&(t=t[0]),t=t;var e=this.cell.stateSize;Array.isArray(e)||(e=[e]);var n,r=e[0];if(n=this.returnSequences?[t[0],t[1],r]:[t[0],r],this.returnState){for(var i=[],a=0,o=e;a<o.length;a++)i.push([t[0],o[a]]);return[n].concat(i)}return n},e.prototype.computeMask=function(t,e){var n=this;return Du((function(){Array.isArray(e)&&(e=e[0]);var t=n.returnSequences?e:null;if(n.returnState){var r=n.states.map((function(t){return null}));return[t].concat(r)}return t}))},Object.defineProperty(e.prototype,"states",{get:function(){if(null==this.states_){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[],n=0;n<t;++n)e.push(null);return e}return this.states_},set:function(t){this.states_=t},enumerable:!0,configurable:!0}),e.prototype.build=function(t){if(null!=this.numConstants)throw new Ew("Constants support is not implemented in RNN yet.");cC(t)&&(t=t[0]),t=t,this.inputSpec[0]=new wC({shape:[this.stateful?t[0]:null,null,t[t.length-1]]});var e,n=[t[0]].concat(t.slice(2));if(this.cell.build(n),e=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!tl.arraysEqual(this.stateSpec.map((function(t){return t.shape[t.shape.length-1]})),e))throw new Ow("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=e.map((function(t){return new wC({shape:[null,t]})}));this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,e){var n=this;void 0===e&&(e=!1),Du((function(){if(!n.stateful)throw new kw("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new Ow("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states_)n.states_=Array.isArray(n.cell.stateSize)?n.cell.stateSize.map((function(t){return pc([r,t])})):[pc([r,n.cell.stateSize])];else if(null==t)Fu(n.states_),null!=n.keptStates&&(Fu(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(t){return pc([r,t])})):n.states_[0]=pc([r,n.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==n.states_.length)throw new Ow("Layer "+n.name+" expects "+n.states_.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);!0===e?n.keptStates.push(n.states_.slice()):Fu(n.states_);for(var i=0;i<n.states_.length;++i){var a=t[i],o=Array.isArray(n.cell.stateSize)?n.cell.stateSize[i]:n.cell.stateSize,s=[r,o];if(!tl.arraysEqual(a.shape,s))throw new Ow("State "+i+" is incompatible with layer "+n.name+": expected shape="+s+", received shape="+a.shape);n.states_[i]=a}}n.states_=n.states_.map((function(t){return zu(t.clone())}))}))},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,i=null==n?null:n.constants;null==n&&(n={});var a=xS(e,r,i,this.numConstants);e=a.inputs,i=a.constants;var o=[],s=[];if(null!=(r=a.initialState)){n.initialState=r,o=o.concat(r),this.stateSpec=[];for(var l=0,u=r;l<u.length;l++)this.stateSpec.push(new wC({shape:u[l].shape}));s=s.concat(this.stateSpec)}if(null!=i&&(n.constants=i,o=o.concat(i),this.numConstants=i.length),o[0]instanceof xC){var c=[e].concat(o),h=this.inputSpec.concat(s),p=this.inputSpec;this.inputSpec=h;var d=t.prototype.apply.call(this,c,n);return this.inputSpec=p,d}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return Du((function(){var r=null==e?null:e.mask,i=null==e?null:e.training,a=null==e?null:e.initialState;t=pC(t),null==a&&(a=n.stateful?n.states_:n.getInitialState(t));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(a.length!==o)throw new Ow("RNN Layer has "+o+" state(s) but was passed "+a.length+" initial state(s).");n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:i},l=CS((function(t,e){var r=n.cell.call([t].concat(e),s);return[r[0],r.slice(1)]}),t,a,n.goBackwards,r,null,n.unroll,n.returnSequences),u=l[0],c=l[1],h=l[2];n.stateful&&n.resetStates(h,i);var p=n.returnSequences?c:u;return n.returnState?[p].concat(h):p}))},e.prototype.getInitialState=function(t){var e=this;return Du((function(){var n=pc(t.shape);return n=_x(n=_y(n,[1,2])),Array.isArray(e.cell.stateSize)?e.cell.stateSize.map((function(t){return t>1?Nx(n,[1,t]):n})):e.cell.stateSize>1?[Nx(n,[1,e.cell.stateSize])]:[n]}))},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var n=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:n};var r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=LC(e.cell,n);return new t(Object.assign(e,{cell:r}))},e.className="RNN",e}(SC);iw.registerClass(_S);var kS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e}(SC),SS=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,qw(n.units,"units"),n.activation=nk(null==e.activation?n.DEFAULT_ACTIVATION:e.activation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=aC(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=aC(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=aC(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=uk(e.kernelRegularizer),n.recurrentRegularizer=uk(e.recurrentRegularizer),n.biasRegularizer=uk(e.biasRegularizer),n.kernelConstraint=ex(e.kernelConstraint),n.recurrentConstraint=ex(e.recurrentConstraint),n.biasConstraint=ex(e.biasConstraint),n.dropout=bx([1,wx([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=bx([1,wx([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return vw(e,t),e.prototype.build=function(t){t=dC(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){if(2!==(t=t).length)throw new Ow("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");var r=t[1];t=t[0];var i,a=null!=e.training&&e.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=IS((function(){return gc(t)}),n.dropout,a)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=IS((function(){return gc(r)}),n.recurrentDropout,a));var o=n.dropoutMask,s=n.recurrentDropoutMask;i=Tx(null!=o?Bh(t,o):t,n.kernel.read()),null!=n.bias&&(i=Dx(i,n.bias.read())),null!=s&&(r=Bh(r,s));var l=Hc(i,Tx(r,n.recurrentKernel.read()));return null!=n.activation&&(l=n.activation.apply(l)),[l,l]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),recurrentInitializer:iC(this.recurrentInitializer),biasInitializer:iC(this.biasInitializer),kernelRegularizer:sk(this.kernelRegularizer),recurrentRegularizer:sk(this.recurrentRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),recurrentConstraint:Jw(this.recurrentConstraint),biasConstraint:Jw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="SimpleRNNCell",e}(kS);iw.registerClass(SS);var OS=function(t){function e(e){return e.cell=new SS(e),t.call(this,e)||this}return vw(e,t),e.prototype.call=function(e,n){var r=this;return Du((function(){return null!=r.cell.dropoutMask&&(Fu(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Fu(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),recurrentInitializer:iC(this.recurrentInitializer),biasInitializer:iC(this.biasInitializer),kernelRegularizer:sk(this.kernelRegularizer),recurrentRegularizer:sk(this.recurrentRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),recurrentConstraint:Jw(this.recurrentConstraint),biasConstraint:Jw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return new t(e)},e.className="SimpleRNN",e}(_S);iw.registerClass(OS);var ES=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,qw(n.units,"units"),n.activation=nk(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=nk(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=aC(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=aC(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=aC(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=uk(e.kernelRegularizer),n.recurrentRegularizer=uk(e.recurrentRegularizer),n.biasRegularizer=uk(e.biasRegularizer),n.kernelConstraint=ex(e.kernelConstraint),n.recurrentConstraint=ex(e.recurrentConstraint),n.biasConstraint=ex(e.biasConstraint),n.dropout=bx([1,wx([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=bx([1,wx([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return vw(e,t),e.prototype.build=function(t){var e=(t=dC(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){if(2!==(t=t).length)throw new Ow("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");var r=null!=e.training&&e.training,i=t[1];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=IS((function(){return gc(t)}),n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=IS((function(){return gc(i)}),n.recurrentDropout,r,3));var a,o,s,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=Bh(t,n.dropoutMask[0]));var u=Tx(t,n.kernel.read());n.useBias&&(u=Dx(u,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(i=Bh(i,l[0]));var c=n.recurrentKernel.read(),h=_c(c,[2*n.units,n.units],c.rank-1),p=h[1],d=Tx(i,h[0]),f=_c(u,3,u.rank-1),m=f[0],g=f[1],y=f[2],v=_c(d,2,d.rank-1),b=v[1];a=n.recurrentActivation.apply(Hc(m,v[0])),o=n.recurrentActivation.apply(Hc(g,b));var w=Tx(Bh(o,i),p);s=n.activation.apply(Hc(y,w));var x=Hc(Bh(a,i),Bh(Hc(1,dh(a)),s));return[x,x]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),recurrentActivation:tk(this.recurrentActivation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),recurrentInitializer:iC(this.recurrentInitializer),biasInitializer:iC(this.biasInitializer),kernelRegularizer:sk(this.kernelRegularizer),recurrentRegularizer:sk(this.recurrentRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),recurrentConstraint:Jw(this.recurrentConstraint),biasConstraint:Jw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="GRUCell",e}(kS);iw.registerClass(ES);var MS=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ES(e),t.call(this,e)||this}return vw(e,t),e.prototype.call=function(e,n){var r=this;return Du((function(){return null!=r.cell.dropoutMask&&(Fu(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Fu(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),recurrentActivation:tk(this.recurrentActivation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),recurrentInitializer:iC(this.recurrentInitializer),biasInitializer:iC(this.biasInitializer),kernelRegularizer:sk(this.kernelRegularizer),recurrentRegularizer:sk(this.recurrentRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),recurrentConstraint:Jw(this.recurrentConstraint),biasConstraint:Jw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="GRU",e}(_S);iw.registerClass(MS);var NS=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,qw(n.units,"units"),n.activation=nk(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=nk(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=aC(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=aC(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=aC(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=e.unitForgetBias,n.kernelRegularizer=uk(e.kernelRegularizer),n.recurrentRegularizer=uk(e.recurrentRegularizer),n.biasRegularizer=uk(e.biasRegularizer),n.kernelConstraint=ex(e.kernelConstraint),n.recurrentConstraint=ex(e.recurrentConstraint),n.biasConstraint=ex(e.biasConstraint),n.dropout=bx([1,wx([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=bx([1,wx([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return vw(e,t),e.prototype.build=function(t){var e,n,r=(t=dC(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var i=this.biasInitializer,a=this.units;n=new((e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vw(e,t),e.prototype.apply=function(t,e){var n=i.apply([a]),r=(new Wx).apply([a]),o=i.apply([2*a]);return Mx(Mx(n,r),o)},e}(Vx)).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,e){var n=this;return Du((function(){var r=null!=e.training&&e.training;if(3!==(t=t).length)throw new Ow("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");var i=t[1],a=t[2];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=IS((function(){return gc(t)}),n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=IS((function(){return gc(i)}),n.recurrentDropout,r,4));var o,s,l,u,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=Bh(t,n.dropoutMask[0]));var h=Tx(t,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(i=Bh(i,c[0])),h=Hc(h,Tx(i,n.recurrentKernel.read())),n.useBias&&(h=Dx(h,n.bias.read()));var p=_c(h,4,h.rank-1),d=p[1],f=p[2],m=p[3];o=n.recurrentActivation.apply(p[0]),s=n.recurrentActivation.apply(d),l=Hc(Bh(s,a),Bh(o,n.activation.apply(f))),u=n.recurrentActivation.apply(m);var g=Bh(u,n.activation.apply(l));return[g,g,l]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),recurrentActivation:tk(this.recurrentActivation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),recurrentInitializer:iC(this.recurrentInitializer),biasInitializer:iC(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:sk(this.kernelRegularizer),recurrentRegularizer:sk(this.recurrentRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),recurrentConstraint:Jw(this.recurrentConstraint),biasConstraint:Jw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LSTMCell",e}(kS);iw.registerClass(NS);var PS=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new NS(e),t.call(this,e)||this}return vw(e,t),e.prototype.call=function(e,n){var r=this;return Du((function(){return null!=r.cell.dropoutMask&&(Fu(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Fu(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:tk(this.activation),recurrentActivation:tk(this.recurrentActivation),useBias:this.useBias,kernelInitializer:iC(this.kernelInitializer),recurrentInitializer:iC(this.recurrentInitializer),biasInitializer:iC(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:sk(this.kernelRegularizer),recurrentRegularizer:sk(this.recurrentRegularizer),biasRegularizer:sk(this.biasRegularizer),activityRegularizer:sk(this.activityRegularizer),kernelConstraint:Jw(this.kernelConstraint),recurrentConstraint:Jw(this.recurrentConstraint),biasConstraint:Jw(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="LSTM",e}(_S);iw.registerClass(PS);var TS=function(t){function e(e){var n=t.call(this,e)||this;return n.cells=e.cells,n}return vw(e,t),Object.defineProperty(e.prototype,"stateSize",{get:function(){for(var t=[],e=0,n=this.cells.slice().reverse();e<n.length;e++){var r=n[e];Array.isArray(r.stateSize)?t.push.apply(t,r.stateSize):t.push(r.stateSize)}return t},enumerable:!0,configurable:!0}),e.prototype.call=function(t,e){var n=this;return Du((function(){for(var r=(t=t).slice(1),i=[],a=0,o=n.cells.slice().reverse();a<o.length;a++){var s=o[a];Array.isArray(s.stateSize)?i.push(r.splice(0,s.stateSize.length)):i.push(r.splice(0,1))}i.reverse();for(var l,u=[],c=0;c<n.cells.length;++c)s=n.cells[c],r=i[c],l=0===c?[t[0]].concat(r):[l[0]].concat(r),l=s.call(l,e),u.push(l.slice(1));r=[];for(var h=0,p=u.slice().reverse();h<p.length;h++)r.push.apply(r,p[h]);return[l[0]].concat(r)}))},e.prototype.build=function(t){var e;cC(t)&&(t=t[0]),t=t,this.cells.forEach((function(n,r){hx("RNNCell_"+r,(function(){n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0},e.prototype.getConfig=function(){for(var e=[],n=0,r=this.cells;n<r.length;n++){var i=r[n];e.push({className:i.getClassName(),config:i.getConfig()})}var a={cells:e},o=t.prototype.getConfig.call(this);return Object.assign(a,o),a},e.fromConfig=function(t,e,n){void 0===n&&(n={});for(var r=[],i=0,a=e.cells;i<a.length;i++)r.push(LC(a[i],n));return new t({cells:r})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var t=[],e=0,n=this.cells;e<n.length;e++)t.push.apply(t,n[e].trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.cells;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var i=[],a=0,o=this.cells;a<o.length;a++)i.push.apply(i,(r=o[a]).trainableWeights);return i.concat(t)}return t},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){for(var t=[],e=0,n=this.cells;e<n.length;e++)t.push.apply(t,n[e].weights);return gC(t)},e.prototype.setWeights=function(t){for(var e=[],n=0,r=this.cells;n<r.length;n++)for(var i=r[n],a=t.splice(i.weights.length),o=0;o<i.weights.length;++o)e.push([i.weights[o],a[o]]);yC(e)},e.className="StackedRNNCells",e}(kS);function IS(t,e,n,r){function i(){return Fx(t(),e)}if(void 0===n&&(n=null),void 0===r&&(r=1),r>1){for(var a=[],o=0;o<r;o++)a.push(zx(i,t,n));return a.map((function(t){return zu(t.clone())}))}return zu(zx(i,t,n).clone())}iw.registerClass(TS);var AS=function(t){function e(e){var n=t.call(this,e)||this;return n.layer=e.layer,n}return vw(e,t),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=LC(e.layer,n);delete e.layer;var i={layer:r};return Object.assign(i,e),new t(i)},e}(SC),RS=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n}return vw(e,t),e.prototype.build=function(e){if((e=dC(e)).length<3)throw new Ow("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),t.prototype.build.call(this,e)},e.prototype.computeOutputShape=function(t){var e=[(t=dC(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))},e.prototype.call=function(t,e){var n=this;return Du((function(){return CS((function(t,r){return[pC(n.layer.call(t,e)),[]]}),t=pC(t),[],!1,null,null,!1,!0)[1]}))},e.className="TimeDistributed",e}(AS);iw.registerClass(RS);var DS=function(t){function e(e){var n=t.call(this,e)||this,r=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=r,n.forwardLayer=LC(i),r.goBackwards=!0!==r.goBackwards;var a={};if(a.className=e.layer.getClassName(),a.config=r,n.backwardLayer=LC(a),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(t){Ww(ax,"BidirectionalMergeMode",t)}(n.mergeMode),e.weights)throw new Ew("weights support is not implemented for Bidirectional layer yet.");return n._stateful=e.layer.stateful,n.returnSequences=e.layer.returnSequences,n.returnState=e.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=e.layer.inputSpec,n.numConstants=null,n}return vw(e,t),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))},e.prototype.computeOutputShape=function(t){var e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):Iw(n)},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,i=null==n?null:n.constants;null==n&&(n={});var a=xS(e,r,i,this.numConstants);if(e=a.inputs,r=a.initialState,i=a.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==i)return t.prototype.apply.call(this,e,n);var o=[],s=[];if(null!=r){var l=r.length;if(l%2>0)throw new Ow("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,o.push.apply(o,r);var u=r.map((function(t){return new wC({shape:t.shape})}));this.forwardLayer.stateSpec=u.slice(0,l/2),this.backwardLayer.stateSpec=u.slice(l/2),s.push.apply(s,u)}if(null!=i)throw new Ew("Support for constants in Bidirectional layers is not implemented yet.");for(var c=o[0]instanceof xC,h=0,p=o;h<p.length;h++)if(p[h]instanceof xC!==c)throw new Ow("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){var d=[e].concat(o),f=this.inputSpec.concat(s),m=this.inputSpec;this.inputSpec=f;var g=t.prototype.apply.call(this,d,n);return this.inputSpec=m,g}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return Du((function(){var r,i,a,o,s=e.initialState;if(null==s)r=n.forwardLayer.call(t,e),i=n.backwardLayer.call(t,e);else{var l=s.slice(0,s.length/2),u=s.slice(s.length/2);r=n.forwardLayer.call(t,Object.assign(e,{initialState:l})),i=n.backwardLayer.call(t,Object.assign(e,{initialState:u}))}return n.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),n.returnSequences&&(i=Xg(i,1)),"concat"===n.mergeMode?o=Ex([r,i]):"sum"===n.mergeMode?o=Hc(r,i):"ave"===n.mergeMode?o=Bh(.5,Hc(r,i)):"mul"===n.mergeMode?o=Bh(r,i):null==n.mergeMode&&(o=[r,i]),n.returnState?null==n.mergeMode?o.concat(a):[o].concat(a):o}))},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var e=this;hx(this.forwardLayer.name,(function(){e.forwardLayer.build(t)})),hx(this.backwardLayer.name,(function(){e.backwardLayer.build(t)})),this.built=!0},e.prototype.computeMask=function(t,e){var n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(t){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.fromConfig=function(t,e){var n=LC(e.layer);if(delete e.layer,null!=e.numConstants)throw new Ew("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=e;return r.layer=n,new t(r)},e.className="Bidirectional",e}(AS);function FS(t){return new lS(t)}function zS(t){return new hS(t)}function LS(t){return new fS(t)}function BS(t){return new yS(t)}function VS(t){return new wS(t)}function US(t){return new sS(t)}function WS(t){return new cS(t)}function jS(t,e){return t<e}function qS(t,e){return t>e}iw.registerClass(DS),Object.freeze({inputLayer:function(t){return new OC(t)},elu:function(t){return new dk(t)},reLU:function(t){return new ck(t)},leakyReLU:function(t){return new hk(t)},prelu:function(t){return new pk(t)},softmax:function(t){return new mk(t)},thresholdedReLU:function(t){return new fk(t)},conv1d:function(t){return new Mk(t)},conv2d:function(t){return new kk(t)},conv2dTranspose:function(t){return new Ok(t)},conv3d:function(t){return new Sk(t)},separableConv2d:function(t){return new Ek(t)},cropping2D:function(t){return new Nk(t)},upSampling2d:function(t){return new Pk(t)},depthwiseConv2d:function(t){return new Tk(t)},activation:function(t){return new Fk(t)},dense:function(t){return new Rk(t)},dropout:function(t){return new Ik(t)},spatialDropout1d:function(t){return new Ak(t)},flatten:function(t){return new Dk(t)},repeatVector:function(t){return new zk(t)},reshape:function(t){return new Lk(t)},permute:function(t){return new Bk(t)},embedding:function(t){return new Uk(t)},add:function(t){return new jk(t)},average:function(t){return new Hk(t)},concatenate:function(t){return new Kk(t)},maximum:function(t){return new Gk(t)},minimum:function(t){return new $k(t)},multiply:function(t){return new qk(t)},dot:function(t){return new Yk(t)},batchNormalization:function(t){return new eS(t)},layerNormalization:function(t){return new nS(t)},zeroPadding2d:function(t){return new rS(t)},averagePooling1d:FS,avgPool1d:function(t){return FS(t)},avgPooling1d:function(t){return FS(t)},averagePooling2d:zS,avgPool2d:function(t){return zS(t)},avgPooling2d:function(t){return zS(t)},averagePooling3d:LS,avgPool3d:function(t){return LS(t)},avgPooling3d:function(t){return LS(t)},globalAveragePooling1d:function(t){return new gS(t)},globalAveragePooling2d:function(t){return new bS(t)},globalMaxPooling1d:BS,globalMaxPooling2d:VS,maxPooling1d:US,maxPooling2d:WS,maxPooling3d:function(t){return new dS(t)},gru:function(t){return new MS(t)},gruCell:function(t){return new ES(t)},lstm:function(t){return new PS(t)},lstmCell:function(t){return new NS(t)},simpleRNN:function(t){return new OS(t)},simpleRNNCell:function(t){return new SS(t)},rnn:function(t){return new _S(t)},stackedRNNCells:function(t){return new TS(t)},bidirectional:function(t){return new DS(t)},timeDistributed:function(t){return new RS(t)},globalMaxPool1d:BS,globalMaxPool2d:VS,maxPool1d:US,maxPool2d:WS,Layer:SC,RNN:_S,RNNCell:kS,input:function(t){return EC(t)},gaussianNoise:function(t){return new Qk(t)},gaussianDropout:function(t){return new Zk(t)},alphaDropout:function(t){return new Jk(t)},masking:function(t){return new Vk(t)}}),Object.freeze({binaryAccuracy:function(t,e){return XC(t,e)},binaryCrossentropy:function(t,e){return JC(t,e)},sparseCategoricalAccuracy:function(t,e){return t_(t,e)},categoricalAccuracy:function(t,e){return YC(t,e)},categoricalCrossentropy:function(t,e){return e_(t,e)},precision:function(t,e){return ZC(t,e)},recall:function(t,e){return function(t,e){return Du((function(){var n=QC(t,e),r=function(t,e){return Du((function(){return Um(t.equal(1),e.equal(0)).sum().cast("float32")}))}(t,e),i=n.add(r);return Hm(vg(i,0),n.div(i),0).cast("float32")}))}(t,e)},cosineProximity:function(t,e){return GC(t,e)},meanAbsoluteError:function(t,e){return UC(t,e)},meanAbsolutePercentageError:function(t,e){return WC(t,e)},MAPE:function(t,e){return WC(t,e)},mape:function(t,e){return WC(t,e)},meanSquaredError:function(t,e){return VC(t,e)},MSE:function(t,e){return VC(t,e)},mse:function(t,e){return VC(t,e)}}),Object.freeze({modelFromJSON:function(t,e){return xw(this,void 0,void 0,(function(){var n,r,i,a,o,s,l,u;return Cw(this,(function(c){switch(c.label){case 0:return"modelTopology"in t||(t={modelTopology:t}),null!=(n=(t=t).modelTopology).model_config&&(n=n.model_config),r=c_(n),i=LC(r,e),null==t.weightsManifest?[3,2]:[4,Qb.loadWeights(t.weightsManifest,t.pathPrefix,i.weights.map((function(t){return t.originalName})))];case 1:for(a=c.sent(),o={},s=0,l=i.weights;s<l.length;s++)o[(u=l[s]).originalName]=a[u.originalName];i.loadWeights(o),Fu(a),c.label=2;case 2:return[2,i]}}))}))}}),Object.freeze({l1l2:function(t){return new ak(t)},l1:function(t){return function(t){return rk(t),new ak({l1:null!=t?t.l1:null,l2:0})}(t)},l2:function(t){return function(t){return rk(t),new ak({l2:null!=t?t.l2:null,l1:0})}(t)}}),function(t){function e(e){var n=t.call(this)||this;if(null==e&&(e={}),e.restoreBestWeights)throw new Ew("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=e.monitor||"val_loss",n.minDelta=Math.abs(e.minDelta||0),n.patience=e.patience||0,n.verbose=e.verbose||0,n.mode=e.mode||"auto",n.baseline=e.baseline,-1===["auto","min","max"].indexOf(n.mode)&&(console.warn("EarlyStopping mode '"+n.mode+"' is invalid. Falling back to mode 'auto'."),n.mode="auto"),n.monitorFunc="min"===n.mode?jS:"max"===n.mode?qS:-1!==n.monitor.indexOf("acc")?qS:jS,n.monitorFunc===jS&&(n.minDelta*=-1),n}vw(e,t),e.prototype.onTrainBegin=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return this.wait=0,this.stoppedEpoch=0,this.best=null!=this.baseline?this.baseline:this.monitorFunc===jS?1/0:-1/0,[2]}))}))},e.prototype.onEpochEnd=function(t,e){return xw(this,void 0,void 0,(function(){var n;return Cw(this,(function(r){switch(r.label){case 0:return[4,MC(e)];case 1:return r.sent(),null==(n=this.getMonitorValue(e))?[2]:(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)),[2])}}))}))},e.prototype.onTrainEnd=function(t){return xw(this,void 0,void 0,(function(){return Cw(this,(function(t){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]}))}))},e.prototype.getMonitorValue=function(t){null==t&&(t={});var e=t[this.monitor];return null==e&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(t)),e}}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=null,e}return vw(e,t),e.prototype.setModel=function(t){if(!(t instanceof L_))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e}(PC));var HS,GS,$S=function(){return($S=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function KS(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}l((r=r.apply(t,e||[])).next())}))}function XS(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(HS||(HS={})),function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(GS||(GS={}));var YS={};function QS(t){return YS[t]}function ZS(t,e,n,r){var i=e.inputParams[t];if(i&&void 0!==i.inputIndexStart){var a=i.inputIndexStart,o=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?a+1:i.inputIndexEnd;if("tensor"===i.type)return JS(e.inputNames[i.inputIndexStart],n,r);if("tensors"===i.type)return e.inputNames.slice(a,o).map((function(t){return JS(t,n,r)}));var s=Array.prototype.slice.call(JS(e.inputNames.slice(a)[0],n,r).dataSync());return"number"===i.type?s[0]:s}var l=e.attrParams[t];return l&&l.value}function JS(t,e,n){var r=nO(t),i=r[0],a=r[1],o=n.currentContextIds.find((function(t){return!!e[eO(i,t)]}));return void 0!==o?e[eO(i,o)][a]:void 0}function tO(t,e){var n=nO(t),r=n[1];return[eO(n[0],e&&e.currentContextId),r]}function eO(t,e){return e?t+"-"+e:t}function nO(t){var e=t.lastIndexOf(":");return-1===e?[t,0]:[t.substring(0,e),Number(t.substring(e+1))]}function rO(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}var iO=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),aO=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),oO=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),sO=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),lO=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),uO=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),cO=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),hO=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),pO=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),dO=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),fO=Object.freeze({json:[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),mO=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),gO=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),yO=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),vO=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),bO=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),wO=function(){function t(){var t=[].concat.apply([],[iO,aO,oO,sO,lO,uO,cO,dO,pO,hO,fO,mO,gO,yO,vO,bO].map((function(t){return t.json})));this.opMappers=t.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(t,e){var n=this;void 0===e&&(e={});var r=[],i=[],a=t.node.reduce((function(t,e){return t[e.name]=n.mapNode(e),e.op.startsWith("Placeholder")&&r.push(t[e.name]),"Const"===e.op&&i.push(t[e.name]),t}),{}),o=[],s=[],l={},u={};null!=e&&(l=this.mapSignatureEntries(e.inputs),u=this.mapSignatureEntries(e.outputs));var c=Object.keys(a);return c.forEach((function(t){var e=a[t];e.inputNames.forEach((function(t){var n=tO(t)[0];e.inputs.push(a[n]),a[n].children.push(e)}))})),0===Object.keys(u).length?c.forEach((function(t){var e=a[t];0===e.children.length&&s.push(e)})):Object.keys(u).forEach((function(t){var e=tO(t)[0],n=a[e];null!=n&&(n.signatureKey=u[t],s.push(n))})),Object.keys(l).length>0?Object.keys(l).forEach((function(t){var e=tO(t)[0],n=a[e];n&&(n.signatureKey=l[t],o.push(n))})):o=r,{nodes:a,inputs:o,outputs:s,weights:i,placeholders:r,signature:e}},t.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce((function(e,n){return e[t[n].name]=n,e}),{})},t.prototype.mapNode=function(t){var e=QS(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.substr(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,i=void 0;switch(n.type){case"string":void 0===(i=CO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=CO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(i=TO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=TO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(i=kO(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(i=kO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(i=PO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=PO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(i=_O(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=_O(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(i=AO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=AO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(i=NO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=NO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(i=IO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=IO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(i=OO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=OO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(i=EO(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=EO(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+t.op)}return e[n.name]={value:i,type:r},e}),{})),n},t}();function xO(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var e=es().global;if(void 0!==e.atob)return e.atob(t);if("undefined"!=typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function CO(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return null!=i?xO(i.s,r):n}function _O(t,e,n){var r=t[e];return r?r.b:n}function kO(t,e,n){var r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function SO(t){switch("string"==typeof t&&(t=HS[t]),t){case HS.DT_FLOAT:return"float32";case HS.DT_INT32:case HS.DT_INT64:case HS.DT_INT8:case HS.DT_UINT8:return"int32";case HS.DT_BOOL:return"bool";case HS.DT_DOUBLE:return"float32";case HS.DT_STRING:return"string";default:return null}}function OO(t,e,n){var r=t[e];return r&&r.type?SO(r.type):n}function EO(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return SO(t)})):n}function MO(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)})):[]}function NO(t,e,n){var r=t[e];return r&&r.shape?MO(r.shape):n}function PO(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"==typeof t?t:parseInt(t,10)})):n}function TO(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return i&&i.list&&i.list.s?i.list.s.map((function(t){return xO(t,r)})):n}function IO(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return MO(t)})):n}function AO(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var RO=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(t){return r.getInput(t)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(t,e){return t[e]=r.getAttr(e),t}),{}))}return t.prototype.getInput=function(t){return JS(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return JS(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return kO(this.node.rawAttrs,t,e);if(null!=n.s)return CO(this.node.rawAttrs,t,e);if(null!=n.b)return _O(this.node.rawAttrs,t,e);if(null!=n.shape)return NO(this.node.rawAttrs,t,e);if(null!=n.type)return OO(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return PO(this.node.rawAttrs,t,e);if(null!=n.list.s)return TO(this.node.rawAttrs,t,e);if(null!=n.list.shape)return IO(this.node.rawAttrs,t,e);if(null!=n.list.b)return AO(this.node.rawAttrs,t,e);if(null!=n.list.type)return EO(this.node.rawAttrs,t,e)}return e},t}(),DO=function(){function t(e,n,r,i,a,o,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach((function(t){return t.tensor.dispose()})),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map((function(t){return e.read(t)}))},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+",\n          because the value dtype is "+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach((function(t,r){return n.write(t,e[r])}))},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return rc([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ac(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(0===this.size())return rc([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),vc(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,Rc(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var r=0,i=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var a=0===r?0:e.size/r,o=[];Du((function(){e=e.reshape([1,r,a]);for(var s=0;s<t.length;++s)o[s]=ly(e,[0,0===s?0:i[s-1],0],[1,t[s],a]).reshape(n.elementShape);return o}));for(var s=[],l=0;l<t.length;l++)s[l]=l;this.writeMany(s,o)},t.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){void 0===n&&(n=""),tl.assert(this.shapesEqualAllowUndefinedSize(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))},t.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0},t.nextId=0,t}();function FO(t,e,n){var r=function(t,e,n){switch(t.category){case"arithmetic":return Du((function(){return function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[Hc(ZS("a",t,e,n),ZS("b",t,e,n))];case"AddN":return[_m(ZS("tensors",t,e,n))];case"FloorMod":case"Mod":return[zh(ZS("a",t,e,n),ZS("b",t,e,n))];case"Mul":return[Bh(ZS("a",t,e,n),ZS("b",t,e,n))];case"RealDiv":case"Div":return[Gh(ZS("a",t,e,n),ZS("b",t,e,n))];case"DivNoNan":return[$m(ZS("a",t,e,n),ZS("b",t,e,n))];case"FloorDiv":return[Ih(ZS("a",t,e,n),ZS("b",t,e,n))];case"Sub":return[qh(ZS("a",t,e,n),ZS("b",t,e,n))];case"Minimum":return[Dh(ZS("a",t,e,n),ZS("b",t,e,n))];case"Maximum":return[Ah(ZS("a",t,e,n),ZS("b",t,e,n))];case"Pow":return[Uh(ZS("a",t,e,n),ZS("b",t,e,n))];case"SquaredDifference":return[fg(ZS("a",t,e,n),ZS("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"basic_math":return Du((function(){return function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[Xc(ZS("x",t,e,n))];case"Acos":return[Yc(ZS("x",t,e,n))];case"Acosh":return[Qc(ZS("x",t,e,n))];case"Asin":return[Zc(ZS("x",t,e,n))];case"Asinh":return[Jc(ZS("x",t,e,n))];case"Atan":return[th(ZS("x",t,e,n))];case"Atan2":return[Ph(ZS("x",t,e,n),ZS("y",t,e,n))];case"Atanh":return[eh(ZS("x",t,e,n))];case"Ceil":return[nh(ZS("x",t,e,n))];case"Complex":return[tc(ZS("real",t,e,n),ZS("imag",t,e,n))];case"Cos":return[ih(ZS("x",t,e,n))];case"Cosh":return[ah(ZS("x",t,e,n))];case"Elu":return[Sy(ZS("x",t,e,n))];case"Erf":return[oh(ZS("x",t,e,n))];case"Exp":return[sh(ZS("x",t,e,n))];case"Expm1":return[lh(ZS("x",t,e,n))];case"Floor":return[uh(ZS("x",t,e,n))];case"Log":return[ch(ZS("x",t,e,n))];case"Log1p":return[hh(ZS("x",t,e,n))];case"Imag":return[nc(ZS("x",t,e,n))];case"Neg":return[dh(ZS("x",t,e,n))];case"Reciprocal":return[fh(ZS("x",t,e,n))];case"Real":return[ec(ZS("x",t,e,n))];case"Relu":return[My(ZS("x",t,e,n))];case"Round":return[mh(ZS("x",t,e,n))];case"Selu":return[Py(ZS("x",t,e,n))];case"Sigmoid":return[yh(ZS("x",t,e,n))];case"Sin":return[Ch(ZS("x",t,e,n))];case"Sign":return[vh(ZS("x",t,e,n))];case"Sinh":return[_h(ZS("x",t,e,n))];case"Softplus":return[kh(ZS("x",t,e,n))];case"Sqrt":return[Sh(ZS("x",t,e,n))];case"Square":return[dg(ZS("x",t,e,n))];case"Tanh":return[Mh(ZS("x",t,e,n))];case"Tan":return[Eh(ZS("x",t,e,n))];case"Relu6":case"ClipByValue":return[rh(ZS("x",t,e,n),ZS("clipValueMin",t,e,n),ZS("clipValueMax",t,e,n))];case"Rsqrt":return[gh(JS(t.inputNames[0],e,n))];case"Prod":return[ky(ZS("x",t,e,n),ZS("axes",t,e,n))];case"LeakyRelu":return[Oy(ZS("x",t,e,n),ZS("alpha",t,e,n))];case"Prelu":return[Ey(ZS("x",t,e,n),ZS("alpha",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"control":return function(t,e,n){return KS(void 0,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,b,w,x,C,_,k,S,O,E,M,N,P,T,I,A,R,D,F;return XS(this,(function(z){switch(z.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[ZS("pred",t,e,n).clone()]];case 2:return r=ZS("pred",t,e,n),i=ZS("data",t,e,n),[4,r.data()];case 3:return[2,z.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(a=t.inputNames.find((function(t){return void 0!==JS(t,e,n)})))?[JS(a,e,n).clone()]:void 0];case 5:return o=ZS("frameName",t,e,n),s=ZS("tensor",t,e,n),n.enterFrame(o),[2,[s.clone()]];case 6:return l=ZS("tensor",t,e,n),n.exitFrame(),[2,[l.clone()]];case 7:return u=ZS("tensor",t,e,n),n.nextIteration(),[2,[u.clone()]];case 8:return c=ZS("size",t,e,n),h=ZS("dtype",t,e,n),p=ZS("elementShape",t,e,n),d=ZS("dynamicSize",t,e,n),f=ZS("clearAfterRead",t,e,n),m=ZS("identicalElementShapes",t,e,n),g=ZS("name",t,e,n),y=new DO(g,h,c,p,m,d,f),n.addTensorArray(y),[2,[ac(y.id),ac(1)]];case 9:return v=ZS("tensorArrayId",t,e,n),b=ZS("index",t,e,n),w=ZS("tensor",t,e,n),n.getTensorArray(v).write(b,w),[2,[ac(1)]];case 10:return x=ZS("tensorArrayId",t,e,n),C=ZS("index",t,e,n),[2,[n.getTensorArray(x).read(C)]];case 11:return _=ZS("tensorArrayId",t,e,n),k=ZS("indices",t,e,n),S=ZS("dtype",t,e,n),[2,[n.getTensorArray(_).gather(k,S)]];case 12:return O=ZS("tensorArrayId",t,e,n),E=ZS("indices",t,e,n),M=ZS("tensor",t,e,n),n.getTensorArray(O).scatter(E,M),[2,[ac(1)]];case 13:return N=ZS("tensorArrayId",t,e,n),P=n.getTensorArray(N),T=ZS("dtype",t,e,n),[2,[P.concat(T)]];case 14:return I=ZS("tensorArrayId",t,e,n),A=ZS("tensor",t,e,n),R=ZS("lengths",t,e,n),n.getTensorArray(I).split(R,A),[2,[ac(1)]];case 15:return D=ZS("tensorArrayId",t,e,n),[2,[ac(n.getTensorArray(D).size(),"int32")]];case 16:return F=ZS("tensorArrayId",t,e,n),n.getTensorArray(F).clearAndClose(),[2,[ac(0)]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"convolution":return Du((function(){return function(t,e,n){switch(t.op){case"Conv1D":var r=ZS("stride",t,e,n),i=ZS("pad",t,e,n),a=ZS("dataFormat",t,e,n).toUpperCase(),o=ZS("dilation",t,e,n);return[Dg(ZS("x",t,e,n),ZS("filter",t,e,n),r,i,a,o)];case"Conv2D":r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),a=ZS("dataFormat",t,e,n).toUpperCase();var s=ZS("dilations",t,e,n);return[Fg(ZS("x",t,e,n),ZS("filter",t,e,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var l=ZS("fusedOps",t,e,n),u=l[0],c=l[1],h="biasadd"===u,p="prelu"===c,d="fusedbatchnorm"===u,f=ZS("numArgs",t,e,n);if(h){if(p&&2!==f)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!p&&1!==f)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(d)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),a=ZS("dataFormat",t,e,n).toUpperCase(),s=ZS("dilations",t,e,n);var m=ZS("args",t,e,n),g=m[0],y=m[1];return[("_FusedConv2D"===t.op?Pv.conv2d:Pv.depthwiseConv2d)({x:ZS("x",t,e,n),filter:ZS("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:a,dilations:[s[1],s[2]],bias:g,activation:c,preluActivationWeights:y})];case"Conv2DBackpropInput":case"Conv2dTranspose":var v=ZS("outputShape",t,e,n);return r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),[qg(ZS("x",t,e,n),ZS("filter",t,e,n),v,[r[1],r[2]],i)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),s=ZS("dilations",t,e,n),a=ZS("dataFormat",t,e,n).toUpperCase(),[Vg(ZS("input",t,e,n),ZS("filter",t,e,n),[r[1],r[2]],i,a,[s[1],s[2]])];case"Conv3D":return r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),a=ZS("dataFormat",t,e,n).toUpperCase(),s=ZS("dilations",t,e,n),[zg(ZS("x",t,e,n),ZS("filter",t,e,n),[r[1],r[2],r[3]],i,a,[s[1],s[2],s[3]])];case"AvgPool":r=ZS("strides",t,e,n),i=ZS("pad",t,e,n);var b=ZS("kernelSize",t,e,n);return[ry(ZS("x",t,e,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPool":return r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),b=ZS("kernelSize",t,e,n),[ny(ZS("x",t,e,n),[b[1],b[2]],[r[1],r[2]],i)];case"MaxPoolWithArgmax":r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),b=ZS("kernelSize",t,e,n);var w=ZS("includeBatchInIndex",t,e,n),x=sy(ZS("x",t,e,n),[b[1],b[2]],[r[1],r[2]],i,w);return[x.result,x.indexes];case"AvgPool3D":return r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),b=ZS("kernelSize",t,e,n),[oy(ZS("x",t,e,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];case"MaxPool3D":return r=ZS("strides",t,e,n),i=ZS("pad",t,e,n),b=ZS("kernelSize",t,e,n),[ay(ZS("x",t,e,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],i)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"creation":return Du((function(){return function(t,e,n){switch(t.op){case"Fill":var r=ZS("shape",t,e,n),i=ZS("dtype",t,e,n);return[dc(r,ZS("value",t,e,n),i)];case"LinSpace":var a=ZS("start",t,e,n);return[fc(a,ZS("stop",t,e,n),ZS("num",t,e,n))];case"Multinomial":var o=ZS("logits",t,e,n),s=ZS("numSamples",t,e,n),l=ZS("seed",t,e,n);return[Ym(o,s,l)];case"OneHot":var u=ZS("indices",t,e,n),c=ZS("depth",t,e,n),h=ZS("onValue",t,e,n),p=ZS("offValue",t,e,n);return[Qm(u,c,h,p)];case"Ones":return[hc(ZS("shape",t,e,n),ZS("dtype",t,e,n))];case"OnesLike":return[gc(ZS("x",t,e,n))];case"RandomUniform":return[pg(ZS("shape",t,e,n),ZS("minval",t,e,n),ZS("maxval",t,e,n),ZS("dtype",t,e,n))];case"Range":return[mc(a=ZS("start",t,e,n),ZS("stop",t,e,n),ZS("step",t,e,n),ZS("dtype",t,e,n))];case"TruncatedNormal":r=ZS("shape",t,e,n);var d=ZS("mean",t,e,n),f=ZS("stdDev",t,e,n);return l=ZS("seed",t,e,n),[mg(r,d,f,ZS("dtype",t,e,n),l)];case"Zeros":return[pc(ZS("shape",t,e,n),ZS("dtype",t,e,n))];case"ZerosLike":return[yc(ZS("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"dynamic":return function(t,e,n){return KS(void 0,void 0,void 0,(function(){var r,i,a,o,s,l,u,c;return XS(this,(function(h){switch(h.label){case 0:switch(t.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=ZS("boxes",t,e,n),i=ZS("scores",t,e,n),a=ZS("maxOutputSize",t,e,n),o=ZS("iouThreshold",t,e,n),s=ZS("scoreThreshold",t,e,n),"NonMaxSuppressionV5"!==t.op?[3,3]:(l=ZS("softNmsSigma",t,e,n),[4,Cv.nonMaxSuppressionWithScoreAsync(r,i,a,o,s,l)]);case 2:return[2,[(c=h.sent()).selectedIndices,c.selectedScores]];case 3:return[4,Cv.nonMaxSuppressionAsync(r,i,a,o,s)];case 4:return[2,[h.sent()]];case 5:return u=ZS("condition",t,e,n).asType("bool"),[4,Gm(u)];case 6:return c=[h.sent()],u.dispose(),[2,c];case 7:return[2,Dc(ZS("x",t,e,n),ZS("y",t,e,n))];case 8:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"evaluation":return Du((function(){return function(t,e,n){switch(t.op){case"TopKV2":var r=ZS("x",t,e,n),i=ZS("k",t,e,n),a=ZS("sorted",t,e,n),o=zy(r,i,a);return[o.values,o.indices];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"image":return Du((function(){return function(t,e,n){switch(t.op){case"ResizeBilinear":var r=ZS("images",t,e,n),i=ZS("size",t,e,n),a=ZS("alignCorners",t,e,n);return[Cv.resizeBilinear(r,[i[0],i[1]],a)];case"ResizeNearestNeighbor":return r=ZS("images",t,e,n),i=ZS("size",t,e,n),a=ZS("alignCorners",t,e,n),[Cv.resizeNearestNeighbor(r,[i[0],i[1]],a)];case"CropAndResize":var o=ZS("image",t,e,n),s=ZS("boxes",t,e,n),l=ZS("boxInd",t,e,n),u=ZS("cropSize",t,e,n),c=ZS("method",t,e,n),h=ZS("extrapolationValue",t,e,n);return[Cv.cropAndResize(o,s,l,u,c,h)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"graph":return Du((function(){return function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=ZS("default",t,e,n);return[JS(t.name,e,n)||r];case"Placeholder":return[JS(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[ZS("x",t,e,n).clone()];case"IdentityN":return ZS("x",t,e,n).map((function(t){return t.clone()}));case"Snapshot":return[ZS("x",t,e,n).clone()];case"Shape":return[oc(ZS("x",t,e,n).shape,"int32")];case"ShapeN":return ZS("x",t,e,n).map((function(t){return oc(t.shape)}));case"Size":return[ac(ZS("x",t,e,n).size,"int32")];case"Rank":return[ac(ZS("x",t,e,n).rank,"int32")];case"NoOp":return[ac(1)];case"Print":var i=ZS("x",t,e,n),a=ZS("data",t,e,n),o=ZS("message",t,e,n),s=ZS("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var l=0;l<a.length;l++)console.log(Array.prototype.slice.call(a[l].dataSync()).slice(0,s));return[i];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"logical":return Du((function(){return function(t,e,n){switch(t.op){case"Equal":return[gg(ZS("a",t,e,n),ZS("b",t,e,n))];case"NotEqual":return[Og(ZS("a",t,e,n),ZS("b",t,e,n))];case"Greater":return[vg(ZS("a",t,e,n),ZS("b",t,e,n))];case"GreaterEqual":return[bg(ZS("a",t,e,n),ZS("b",t,e,n))];case"Less":return[Cg(ZS("a",t,e,n),ZS("b",t,e,n))];case"LessEqual":return[_g(ZS("a",t,e,n),ZS("b",t,e,n))];case"LogicalAnd":return[Um(ZS("a",t,e,n),ZS("b",t,e,n))];case"LogicalNot":return[Wm(ZS("a",t,e,n))];case"LogicalOr":return[jm(ZS("a",t,e,n),ZS("b",t,e,n))];case"Select":return[Hm(ZS("condition",t,e,n),ZS("a",t,e,n),ZS("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"matrices":return Du((function(){return function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Gg(ZS("a",t,e,n),ZS("b",t,e,n),ZS("transposeA",t,e,n),ZS("transposeB",t,e,n))];case"Transpose":return[lp(ZS("x",t,e,n),ZS("perm",t,e,n))];case"_FusedMatMul":var r=ZS("fusedOps",t,e,n),i=r[1],a="biasadd"===r[0],o="prelu"===i,s=ZS("numArgs",t,e,n);if(a){if(o&&2!==s)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==s)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=ZS("args",t,e,n),u=l[0],c=l[1];return[Pv.matMul({a:ZS("a",t,e,n),b:ZS("b",t,e,n),transposeA:ZS("transposeA",t,e,n),transposeB:ZS("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:c})];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"normalization":return Du((function(){return function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Nm(ZS("x",t,e,n),ZS("mean",t,e,n),ZS("variance",t,e,n),ZS("offset",t,e,n),ZS("scale",t,e,n),ZS("epsilon",t,e,n))];case"LRN":return[Ty(ZS("x",t,e,n),ZS("radius",t,e,n),ZS("bias",t,e,n),ZS("alpha",t,e,n),ZS("beta",t,e,n))];case"Softmax":return[op(ZS("x",t,e,n))];case"LogSoftmax":return[sp(ZS("x",t,e,n))];case"SparseToDense":return[qy(ZS("sparseIndices",t,e,n),ZS("outputShape",t,e,n),ZS("sparseValues",t,e,n),ZS("defaultValue",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"reduction":return Du((function(){return function(t,e,n){switch(t.op){case"Max":var r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n);return[by(ZS("x",t,e,n),r,i)];case"Mean":return r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n),[wy(ZS("x",t,e,n),r,i)];case"Min":return r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n),[xy(ZS("x",t,e,n),r,i)];case"Sum":return r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n),[_y(ZS("x",t,e,n),r,i)];case"All":return r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n),[fy(ZS("x",t,e,n),r,i)];case"Any":return r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n),[my(ZS("x",t,e,n),r,i)];case"ArgMax":return r=ZS("axis",t,e,n),[gy(ZS("x",t,e,n),r)];case"ArgMin":return r=ZS("axis",t,e,n),[yy(ZS("x",t,e,n),r)];case"Prod":return r=ZS("axis",t,e,n),i=ZS("keepDims",t,e,n),[ky(ZS("x",t,e,n),r,i)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"slice_join":return Du((function(){return function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=ZS("n",t,e,n),i=ZS("axis",t,e,n),a=ZS("tensors",t,e,n);return a=a.slice(0,r),[vc(a,i)];case"GatherV2":case"Gather":i=ZS("axis",t,e,n);var o=ZS("x",t,e,n),s=ZS("indices",t,e,n);return[Pg(o,s.asType("int32"),i)];case"ReverseV2":case"Reverse":return i=ZS("axis",t,e,n),o=ZS("x",t,e,n),[Xg(o,i)];case"Slice":var l=ZS("begin",t,e,n),u=ZS("size",t,e,n);return[ly(ZS("x",t,e,n),l,u)];case"StridedSlice":l=ZS("begin",t,e,n);var c=ZS("end",t,e,n),h=ZS("strides",t,e,n),p=ZS("beginMask",t,e,n),d=ZS("endMask",t,e,n),f=ZS("ellipsisMask",t,e,n),m=ZS("newAxisMask",t,e,n),g=ZS("shrinkAxisMask",t,e,n),y=ZS("x",t,e,n);if(1===l.length&&y.shape.length>1)for(var v=1;v<y.shape.length;v++)l.push(0),c.push(y.shape[v]),h.push(h[0]);return[Fy(y,l,c,h,p,d,f,m,g)];case"Pack":return Du((function(){var r=ZS("axis",t,e,n),i=ZS("tensors",t,e,n),a=i[0].shape,o=i[0].squeeze().shape,s=i.map((function(t){var e=tl.arraysEqual(t.shape,a);if(!e&&!tl.arraysEqual(t.squeeze().shape,o))throw new Error("the input tensors shape does not match");return e?t:t.reshape(a)}));return[Ac(s,r)]}));case"Unpack":return Du((function(){var r=ZS("axis",t,e,n),i=ZS("tensor",t,e,n);return Rc(i,r)}));case"Tile":var b=ZS("reps",t,e,n);return[Km(ZS("x",t,e,n),b)];case"Split":case"SplitV":i=ZS("axis",t,e,n);var w=ZS("numOrSizeSplits",t,e,n);return _c(ZS("x",t,e,n),w,i);case"ScatterNd":s=ZS("indices",t,e,n);var x=ZS("values",t,e,n),C=ZS("shape",t,e,n);return[Ly(s,x,C)];case"GatherNd":var _=ZS("x",t,e,n);return s=ZS("indices",t,e,n),[Hy(_,s)];case"SparseToDense":s=ZS("sparseIndices",t,e,n),C=ZS("outputShape",t,e,n);var k=ZS("sparseValues",t,e,n),S=ZS("defaultValue",t,e,n);return[qy(s,k,C,k.dtype===S.dtype?S:S.asType(k.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"spectral":return Du((function(){return function(t,e,n){switch(t.op){case"FFT":return[By(ZS("x",t,e,n))];case"IFFT":return[Vy(ZS("x",t,e,n))];case"RFFT":return[Uy(ZS("x",t,e,n))];case"IRFFT":return[Wy(ZS("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"transformation":return Du((function(){return function(t,e,n){switch(t.op){case"Cast":return[Oc(ZS("x",t,e,n),ZS("dtype",t,e,n))];case"ExpandDims":var r=ZS("axis",t,e,n);return[Nc(ZS("x",t,e,n),r)];case"Squeeze":return r=ZS("axis",t,e,n),[Ic(ZS("x",t,e,n),r)];case"Reshape":return[Pc(ZS("x",t,e,n),ZS("shape",t,e,n))];case"PadV2":case"Pad":return[Zm(ZS("x",t,e,n),rO(ZS("padding",t,e,n),2),ZS("constantValue",t,e,n))];case"SpaceToBatchND":var i=ZS("blockShape",t,e,n),a=rO(ZS("paddings",t,e,n),2);return[Tc(ZS("x",t,e,n),i,a)];case"BatchToSpaceND":i=ZS("blockShape",t,e,n);var o=rO(ZS("crops",t,e,n),2);return[Sc(ZS("x",t,e,n),i,o)];case"DepthToSpace":var s=ZS("blockSize",t,e,n),l=ZS("dataFormat",t,e,n).toUpperCase();return[Mc(ZS("x",t,e,n),s,l)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n)}));case"custom":var r=QS(t.op);if(r&&r.customExecutor)return r.customExecutor(new RO(t,e,n));throw TypeError("Custom op "+t.op+" is not registered.");default:throw TypeError("Unknown op '"+t.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return r instanceof Promise?r.then((function(t){return[].concat(t)})):[].concat(r)}var zO=function(){function t(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId})).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t}();function LO(t,e,n){for(var r=new Set,i=[],a=null,o=null,s=new Set,l=Object.keys(t).map((function(t){return nO(t)[0]})),u=e.slice();u.length>0;){var c=u.pop();(UO(c)||WO(c))&&null==a&&(o=(a=c).children.map((function(t){return t.name})).filter((function(t){return r.has(t)}))),r.add(c.name),null==n[c.name]&&-1===l.indexOf(c.name)&&(0!==c.inputs.length?c.inputs.forEach((function(t){s.has(t.name)||(s.add(t.name),u.push(t))})):i.push(c.name))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:a,syncInputs:o}}var BO=["Switch","Merge","Enter","Exit","NextIteration"],VO=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function UO(t){return BO.indexOf(t.op)>=0}function WO(t){return VO.indexOf(t.op)>=0}var jO=function(){function t(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this._inputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this._inputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this._outputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},t.prototype.compile=function(t,e){var n=LO(t,e,this.weightMap),r=n.missingInputs,i=n.dynamicNode;if(null!=i)throw new Error("This execution contains the node '"+i.name+"', which has the dynamic op '"+i.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+n.syncInputs+"]");if(r.length>0){var a=e.map((function(t){return t.name})),o=Object.keys(t);throw new Error("Cannot compute the outputs ["+a+"] from the provided inputs ["+o+"]. Missing the following inputs: ["+r+"]")}return function(t,e,n){var r=n.usedNodes,i=[];Object.keys(n.inputs).map((function(t){return nO(t)[0]})).map((function(e){return t.nodes[e]})).forEach((function(t){r.has(t.name)&&i.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&i.push(t)}));for(var a=new Set,o=[];i.length>0;){var s=i.pop();a.add(s.name),e[s.name]||o.push(s),s.children.forEach((function(t){!a.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return a.has(t.name)}))&&i.push(t)}))}return o}(this.graph,this.weightMap,n)},t.prototype.execute=function(t,e){var n=this;t=this.mapInputs(t);var r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);var i=r.map((function(t){return n.graph.nodes[nO(t)[0]]})),a=e.map((function(t){return n.graph.nodes[nO(t)[0]]})),o=this.getCompilationKey(i,a),s=this.compiledMap.get(o);null==s&&(s=this.compile(t,a),this.compiledMap.set(o,s));var l={};return Du((function(){var r=new zO(n._weightMap,l),i=$S({},n.weightMap);Object.keys(t).forEach((function(e){var n=nO(e),r=n[0],a=[];a[n[1]]=t[e],i[r]=a}));for(var a=n.getFrozenTensorIds(i),o={},u=0;u<s.length;u++){var c=s[u];if(!i[c.name]){var h=FO(c,i,r);if(h instanceof Promise)throw new Error("The execution of the op '"+c.op+"' returned a promise. Please use model.executeAsync() instead.");i[c.name]=h,n.checkTensorForDisposal(c.name,c,i,r,a,e,o)}}return e.map((function(t){return JS(t,i,r)}))}))},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,i,a,o){"control"!==e.category&&-1===a.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var e=function(t,e,n){return e[eO(t,n.currentContextId)]}(t.name,n,r);null!=e&&e.forEach((function(t){if(t&&!i.has(t.id)){var e=o[t.id];1===e?(t.dispose(),delete o[t.id]):null!=e&&o[t.id]--}}))}})))},t.prototype.executeAsync=function(t,e){return KS(this,void 0,void 0,(function(){var n,r,i,a,o,s=this;return XS(this,(function(l){switch(l.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e),n=new zO(this._weightMap,{}),[4,this.executeWithControlFlow(t,n,e)];case 1:return r=l.sent(),i=e.map((function(t){return JS(t,r,n)})),a=new Set(i.map((function(t){return t.id}))),o=new Set(Object.keys(t).map((function(e){return t[e].id}))),Object.keys(r).forEach((function(t){r[t].forEach((function(t){!t||t.isDisposed||a.has(t.id)||o.has(t.id)||-1!==s.weightIds.indexOf(t.id)||t.dispose()}))})),[2,i]}}))}))},t.prototype.executeWithControlFlow=function(t,e,n){return KS(this,void 0,void 0,(function(){var r,i,a,o,s,l,u,c,h,p,d,f,m,g,y,v,b=this;return XS(this,(function(w){switch(w.label){case 0:r=Object.keys(t),i=r.map((function(t){return b.graph.nodes[nO(t)[0]]})),a=n.map((function(t){return b.graph.nodes[nO(t)[0]]})),o=LO(t,a,this.weightMap),s=o.usedNodes,l=o.missingInputs,u=o.dynamicNode,c=o.syncInputs,h=i.concat(this.graph.weights).map((function(t){return{node:t,contexts:e.currentContext}})),p=$S({},this.weightMap),Object.keys(t).forEach((function(e){var n=nO(e),r=n[0],i=[];i[n[1]]=t[e],p[r]=i})),d={},f=this.getFrozenTensorIds(p),m={},w.label=1;case 1:return h.length>0?(g=this.processStack(i,h,e,p,m,f,n,d,s),[4,Promise.all(g)]):[3,3];case 2:return w.sent(),[3,1];case 3:if(null==u&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=a.filter((function(t){return!UO(t)&&!JS(t.name,p,e)})).map((function(t){return t.name}))).length>0)throw v="",null!=u&&(v="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+c+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+l+"]. "+v);return[2,p]}}))}))},t.prototype.processStack=function(t,e,n,r,i,a,o,s,l){for(var u=this,c=[],h=function(){var h=e.pop();n.currentContext=h.contexts;var d="";if("Enter"===h.node.op&&ZS("isConstant",h.node,r,n)&&(d=tO(h.node.name,n)[0]),-1===t.indexOf(h.node)){var f=FO(h.node,r,n);d||(d=tO(h.node.name,n)[0]);var m=n.currentContext;f instanceof Promise?c.push(f.then((function(t){return r[d]=t,n.currentContext=m,u.checkTensorForDisposal(d,h.node,r,n,a,o,s),u.processChildNodes(h.node,e,n,r,i,l),t}))):(r[d]=f,p.checkTensorForDisposal(d,h.node,r,n,a,o,s),p.processChildNodes(h.node,e,n,r,i,l))}else p.processChildNodes(h.node,e,n,r,i,l)},p=this;e.length>0;)h();return c},t.prototype.processChildNodes=function(t,e,n,r,i,a){t.children.forEach((function(t){var o=tO(t.name,n)[0];!i[o]&&a.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!JS(t,r,n)}))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!JS(t,r,n)}))&&(i[o]=!0,e.push({contexts:n.currentContext,node:t})))}))},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],i=nO(n)[0],a=e.graph.nodes[i];if(a.attrParams.shape&&a.attrParams.shape.value){var o=a.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((function(t,e){return-1===o[e]||o[e]===t}));tl.assert(s,(function(){return"The shape of dict['"+a.name+"'] provided in model.execute(dict) must be ["+o+"], but was ["+r.shape+"]"}))}a.attrParams.dtype&&a.attrParams.dtype.value&&tl.assert(r.dtype===a.attrParams.dtype.value,(function(){return"The dtype of dict['"+a.name+"'] provided in model.execute(dict) must be "+a.attrParams.dtype.value+", but was "+r.dtype}))}))},t.prototype.mapInputs=function(t){var e={};for(var n in t)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?e[this._signature.inputs[n].name]=t[n]:e[n]=t[n];return e},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter((function(t){var n=nO(t)[0];return null==e.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},t.prototype.mapOutputs=function(t){var e=this;return t.map((function(t){return null!=e._signature&&null!=e._signature.outputs&&null!=e._signature.outputs[t]?e._signature.outputs[t].name:t}),{})},t.prototype.checkOutputs=function(t){var e=this;t.forEach((function(t){var n=nO(t)[0];if(!e.graph.nodes[n])throw new Error("The output '"+t+"' is not found in the graph")}))},t}();!function(){function t(t,e){void 0===e&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=Qb.browserHTTPRequest(t,this.loadOptions);else{var e=Qb.getLoadHandlers(t,this.loadOptions.onProgress);if(0===e.length)e.push(Qb.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},t.prototype.load=function(){return KS(this,void 0,void 0,(function(){var t,e,n,r;return XS(this,(function(i){switch(i.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=i.sent(),n={},null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=(e=this.artifacts.modelTopology).versions.producer+"."+e.versions.minConsumer,r=Qb.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new jO(wO.Instance.transformGraph(e,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}}))}))},t.prototype.save=function(t,e){return KS(this,void 0,void 0,(function(){var e;return XS(this,(function(n){if("string"==typeof t){if(0===(e=Qb.getSaveHandlers(t)).length)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(e.length>1)throw new Error("Found more than one ("+e.length+") save handlers for URL '"+t+"'");t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]}))}))},t.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},t.prototype.normalizeInputs=function(t){if(!(t instanceof cl||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return KS(this,void 0,void 0,(function(){var n;return XS(this,(function(r){switch(r.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})},t.prototype.dispose=function(){this.executor.dispose()}}();var qO=function(t,e){return(qO=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function HO(t,e){function n(){this.constructor=t}qO(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function GO(t,e,n,r){return new(n||(n=Promise))((function(i,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(o,s)}l((r=r.apply(t,e||[])).next())}))}function $O(t,e){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function KO(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var XO=KO((function(t){!function(t,e,n){function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var n=new function(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}(t),i=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,i&&("object"==typeof i&&r(i,n),a.state=function(){return r(n,{})}),a}e&&e.exports?e.exports=i:this.alea=i}(0,t)})),YO=KO((function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var n=new function(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}(t),i=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&r(i,n),a.state=function(){return r(n,{})}),a}e&&e.exports?e.exports=i:this.xor128=i}(0,t)})),QO=KO((function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&r(i,n),a.state=function(){return r(n,{})}),a}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)})),ZO=KO((function(t){!function(t,e,n){function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}(t),i=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,i&&(i.x&&r(i,n),a.state=function(){return r(n,{})}),a}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)})),JO=KO((function(t){!function(t,e,n){function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n=i[a]=(n^=n>>>15)^(t^=t>>>12),e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=0==(n=s[127&a]^=r+(o=o+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=o,t.X=s,t.i=i}(e,t)}(t),i=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,i&&(i.X&&r(i,n),a.state=function(){return r(n,{})}),a}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)})),tE=KO((function(t){!function(t,e,n){function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}(t),i=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&r(i,n),a.state=function(){return r(n,{})}),a}e&&e.exports?e.exports=i:this.tychei=i}(0,t)})),eE=KO((function(t){!function(e,r){var i,a=this,o=256,s="random",l=r.pow(o,6),u=r.pow(2,52),c=2*u,h=255;function p(t,n,p){var g=[],y=f(function t(e,n){var r,i=[],a=typeof e;if(n&&"object"==a)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==a?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,m(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(a.crypto||a.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=a.navigator,r=n&&n.plugins;return[+new Date,a,r,a.screen,m(e)]}}():t,3),g),v=new function(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=h&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=h&i+1],n=n*o+s[h&(s[i]=s[a=h&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}(g),b=function(){for(var t=v.g(6),e=l,n=0;t<u;)t=(t+n)*o,e*=o,n=v.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|v.g(4)},b.quick=function(){return v.g(4)/4294967296},b.double=b,f(m(v.S),e),(n.pass||p||function(t,e,n,i){return i&&(i.S&&d(i,v),t.state=function(){return d(v,{})}),n?(r[s]=t,e):t})(b,y,"global"in n?n.global:this==r,n.state)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(r["seed"+s]=p,f(r.random(),e),t.exports){t.exports=p;try{i=n(4)}catch(t){}}}([],Math)}));eE.alea=XO,eE.xor128=YO,eE.xorwow=QO,eE.xorshift7=ZO,eE.xor4096=JO,eE.tychei=tE;var nE=eE.alea;function rE(t,e,n,r){if(void 0===n&&(n=new Map),void 0===r&&(r=new Set),null==t)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(oE(t)){var a=Array.isArray(t)?[]:{};for(var o in r.add(t),t){var s=rE(t[o],e,n,r);a[o]=s}return r.delete(t),a}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,i.value),i.value}function iE(t){return null===t?null:oE(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function aE(t,e){return GO(this,void 0,void 0,(function(){var n,r,i,a,o,s;return $O(this,(function(l){switch(l.label){case 0:n=new Map,rE(t,e,n),r=0,i=Array.from(n.keys()),l.label=1;case 1:return r<i.length?(o=n.get(a=i[r]))instanceof Promise?[4,o]:[3,3]:[3,4];case 2:s=l.sent(),n.set(a,s),l.label=3;case 3:return r++,[3,1];case 4:return[2,rE(t,e,n)]}}))}))}function oE(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof cl))}function sE(t){return function(t,e){return rE(t,e)}(t,lE)}function lE(t){return t instanceof cl?{value:t.clone(),recurse:!1}:oE(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var uE=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,n=t;e<n.length;e++)this.push(n[e])},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n},t}(),cE=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return HO(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),n=this.length(),r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},e.INITIAL_CAPACITY=32,e}(uE);function hE(t){return new gE(t)}function pE(t,e){return new EE(t,e)}var dE,fE=function(){function t(){}return t.prototype.toArray=function(){return GO(this,void 0,void 0,(function(){var t,e;return $O(this,(function(n){switch(n.label){case 0:return t=[],[4,this.next()];case 1:e=n.sent(),n.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=n.sent(),[3,2];case 4:return[2,t]}}))}))},t.prototype.toArrayForTest=function(){return GO(this,void 0,void 0,(function(){var t,e,n;return $O(this,(function(r){switch(r.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(e.push(n.value),[4,t.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,e]}}))}))},t.prototype.resolveFully=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}}))}))},t.prototype.resolveWhile=function(t){return GO(this,void 0,void 0,(function(){var e,n;return $O(this,(function(r){switch(r.label){case 0:return[4,this.next()];case 1:e=r.sent(),n=t(e.value),r.label=2;case 2:return e.done||!n?[3,4]:[4,this.next()];case 3:return e=r.sent(),n=t(e.value),[3,2];case 4:return[2]}}))}))},t.prototype.handleErrors=function(t){return new _E(this,t)},t.prototype.filter=function(t){return new xE(this,t)},t.prototype.map=function(t){return new CE(this,t)},t.prototype.mapAsync=function(t){return new kE(this,t)},t.prototype.serialMapAsync=function(t){return new kE(this,t).serial()},t.prototype.flatmap=function(t){return new OE(this,t)},t.prototype.forEachAsync=function(t){return GO(this,void 0,void 0,(function(){return $O(this,(function(e){return[2,this.map(t).resolveFully()]}))}))},t.prototype.serialForEach=function(t){return GO(this,void 0,void 0,(function(){return $O(this,(function(e){return[2,this.serialMapAsync(t).resolveWhile((function(t){return!0===t}))]}))}))},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new wE(this,t,e)},t.prototype.columnMajorBatch=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=iE),this.rowMajorBatch(t,e).map((function(t){return function(t,e){return void 0===e&&(e=iE),function t(e,n,r){void 0===r&&(r=new Set);var i=e[0];if(r.has(i))throw new Error("Circular references are not supported.");var a=n(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(oE(i)){var o=Array.isArray(i)?[]:{};r.add(i);var s=function(i){var a=t(e.map((function(t){return t[i]})),n,r);o[i]=a};for(var l in i)s(l);return r.delete(i),o}throw new Error("Can't recurse into non-iterable type: "+i)}return a.value}(t,e)}(t,n)}))},t.prototype.concatenate=function(t,e){return new EE(function(t){return new mE(t)}([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new bE(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new vE(this,t)},t.prototype.prefetch=function(t){return new ME(this,t)},t.prototype.shuffle=function(t,e){return new NE(this,t,e)},t.prototype.serial=function(){return new yE(this)},t}(),mE=function(t){function e(e){var n=t.call(this)||this;return n.items=e,n.trav=0,n}return HO(e,t),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:sE(t),done:!1}])}))}))},e}(fE),gE=function(t){function e(e){var n=t.call(this)||this;return n.nextFn=e,n}return HO(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]}))}))},e}(fE),yE=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return[2,this.upstream.next()]}))}))},e}(fE),vE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=e.sent()).done?[2,t]:(Fu(t.value),[3,0]);case 2:return[2,this.upstream.next()]}}))}))},e}(fE),bE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]}))}))},e}(fE),wE=function(t){function e(e,n,r){void 0===r&&(r=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=n,i.enableSmallLastBatch=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){var t,e;return $O(this,(function(n){switch(n.label){case 0:t=[],n.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=n.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}}))}))},e}(fE),xE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.predicate=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){switch(e.label){case 0:return[4,this.upstream.next()];case 1:return(t=e.sent()).done||this.predicate(t.value)?[2,t]:(Fu(t.value),[3,0]);case 2:return[2]}}))}))},e}(fE),CE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return $O(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((t=s.sent()).done)return[2,{value:null,done:!0}];for(e=Sl.getTensorsInContainer(t.value),n=this.transform(t.value),r=Sl.getTensorsInContainer(n),i=0,a=e;i<a.length;i++)Sl.isTensorInList(o=a[i],r)||o.dispose();return[2,{value:n,done:!1}]}}))}))},e}(fE),_E=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.handler=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}}))}))},e}(fE),kE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return $O(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:return(t=s.sent()).done?[2,{value:null,done:!0}]:(e=Sl.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(n=s.sent(),r=Sl.getTensorsInContainer(n),i=0,a=e;i<a.length;i++)Sl.isTensorInList(o=a[i],r)||o.dispose();return[2,{value:n,done:!1}]}}))}))},e}(fE),SE=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new cE,e.lastRead=Promise.resolve({value:null,done:!1}),e}return HO(e,t),e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}}))}))},e}(fE),OE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r,i,a,o;return $O(this,(function(s){switch(s.label){case 0:return[4,this.upstream.next()];case 1:if((t=s.sent()).done)return[2,!1];for(e=Sl.getTensorsInContainer(t.value),n=this.transform(t.value),r=Sl.getTensorsInContainer(n),this.outputQueue.pushAll(n),i=0,a=e;i<a.length;i++)Sl.isTensorInList(o=a[i],r)||o.dispose();return[2,!0]}}))}))},e}(SE),EE=function(t){function e(e,n){var r=t.call(this)||this;return r.baseErrorHandler=n,r.lastRead=null,r.iterator=null,r.moreIterators=e,r}return HO(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]}))}))},e.prototype.readFromChain=function(t){return GO(this,void 0,void 0,(function(){var e,n;return $O(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return r.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=r.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),r.label=3;case 3:return[4,this.iterator.next()];case 4:return(n=r.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,n]}}))}))},e}(fE);!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(dE||(dE={})),function(t){function e(e,n){void 0===n&&(n=dE.FAIL);var r=t.call(this)||this;return r.iterators=e,r.mismatchMode=n,r.count=0,r.currentPromise=null,r}HO(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return GO(this,void 0,void 0,(function(){function e(t){return t instanceof fE?{value:t.next().then((function(t){return n++,t.done&&r++,t.value})),recurse:!1}:{value:null,recurse:!0}}var n,r,i;return $O(this,(function(a){switch(a.label){case 0:return[4,t];case 1:return a.sent(),n=0,r=0,[4,aE(this.iterators,e)];case 2:if(i=a.sent(),n===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case dE.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case dE.SHORTEST:return[2,{value:null,done:!0}]}return this.count++,[2,{value:i,done:!1}]}}))}))},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]}))}))}}(fE);var ME=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.bufferSize=n,r.buffer=new uE(n),r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(fE),NE=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.upstream=e,i.windowSize=n,i.upstreamExhausted=!1,i.random=nE(r||tl.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return HO(e,t),e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t=this;return $O(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return GO(this,void 0,void 0,(function(){var t,e;return $O(this,(function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=n.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}}))}))},e}(ME),PE=function(){function t(){this.size=null}return t.prototype.batch=function(t,e){var n=this;void 0===e&&(e=!0);var r=this;return tl.assert(t>0,(function(){return"batchSize needs to be positive, but it is\n      "+t})),TE((function(){return GO(n,void 0,void 0,(function(){return $O(this,(function(n){switch(n.label){case 0:return[4,r.iterator()];case 1:return[2,n.sent().columnMajorBatch(t,e,IE)]}}))}))}),this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){var e,r;return $O(this,(function(i){switch(i.label){case 0:return[4,n.iterator()];case 1:return r=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,r.apply(e,[i.sent()])]}}))}))}),this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().filter((function(e){return Du((function(){return t(e)}))}))]}}))}))}),this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return GO(this,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}}))}))},t.prototype.forEach=function(t){return GO(this,void 0,void 0,(function(){return $O(this,(function(e){return Au("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]}))}))},t.prototype.map=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().map((function(e){return Du((function(){return t(e)}))}))]}}))}))}),this.size)},t.prototype.mapAsync=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().mapAsync(t)]}}))}))}),this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return TE((function(){return GO(e,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().prefetch(t)]}}))}))}),this.size)},t.prototype.repeat=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){var e=this;return $O(this,(function(r){return[2,pE(hE((function(){return GO(e,void 0,void 0,(function(){var t;return $O(this,(function(e){switch(e.label){case 0:return t={},[4,n.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}}))}))})).take(t))]}))}))}),null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().skip(t)]}}))}))}),null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,e,n){var r=this;if(void 0===n&&(n=!0),null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var i=this,a=nE(e||tl.now().toString());return TE((function(){return GO(r,void 0,void 0,(function(){var e;return $O(this,(function(r){switch(r.label){case 0:return e=a.int32(),n&&(e+=a.int32()),[4,i.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}}))}))}),this.size)},t.prototype.take=function(t){var e=this,n=this;return TE((function(){return GO(e,void 0,void 0,(function(){return $O(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().take(t)]}}))}))}),null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}}))}))},t.prototype.toArrayForTest=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}}))}))},t.MAX_BUFFER_SIZE=1e4,t}();function TE(t,e){return void 0===e&&(e=null),new(function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.size=e,t}return HO(r,n),r.prototype.iterator=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(e){return[2,t()]}))}))},r}(PE))}function IE(t){return null===t?null:function(t){return null==t||function(t){return null===t||"object"!=typeof t&&"function"!=typeof t}(t)||Array.isArray(t)||"object"==typeof t&&t instanceof cl||tl.isTypedArray(t)}(t[0])?{value:AE(t),recurse:!1}:{value:null,recurse:!0}}function AE(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof cl?Ac(t):rc(t)}var RE=function(t){function e(e){var n=t.call(this)||this;return n.input=e,n}return HO(e,t),e.prototype.iterator=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:return[4,this.input.iterator()];case 1:return[2,t.sent().decodeUTF8().split("\n").map((function(t){return t.endsWith("\r")&&(t=t.slice(0,-1)),t}))]}}))}))},e}(PE),DE=Symbol("out"),FE=Symbol("field"),zE=Symbol("quote"),LE=Symbol("quoteafterquote"),BE=Symbol("quoteinquote"),VE=(function(t){function e(e,n){var r=t.call(this)||this;return r.input=e,r.hasHeader=!0,r.fullColumnNames=null,r.columnNamesValidated=!1,r.columnConfigs=null,r.configuredColumnsOnly=!1,r.delimiter=",",r.delimWhitespace=!1,r.base=new RE(e),n||(n={}),r.hasHeader=!1!==n.hasHeader,r.fullColumnNames=n.columnNames,r.columnConfigs=n.columnConfigs,r.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(tl.assert(null==n.delimiter,(function(){return"Delimiter should not be provided when delimWhitespace is true."})),r.delimWhitespace=!0,r.delimiter=" "):r.delimiter=n.delimiter?n.delimiter:",",r}HO(e,t),e.prototype.columnNames=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}}))}))},e.prototype.setColumnNames=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r,i,a,o=this;return $O(this,(function(s){switch(s.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=s.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&tl.assert(t.length===this.fullColumnNames.length,(function(){return"The length of provided columnNames ("+o.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."})),this.fullColumnNames||(this.fullColumnNames=t),e=this.fullColumnNames.reduce((function(t,e){return t[e]=t[e]+1||1,t}),{}),n=Object.keys(e).filter((function(t){return e[t]>1})),tl.assert(0===n.length,(function(){return"Duplicate column names found: "+n.toString()})),this.columnConfigs)for(r=0,i=Object.keys(this.columnConfigs);r<i.length;r++)if(-1===this.fullColumnNames.indexOf(a=i[r]))throw new Error('The key "'+a+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}}))}))},e.prototype.maybeReadHeaderLine=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){switch(e.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,e.sent().next()];case 2:if((t=e.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,this.parseRow(t.value,!1)];case 3:return[2,null]}}))}))},e.prototype.iterator=function(){return GO(this,void 0,void 0,(function(){var t,e=this;return $O(this,(function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[4,this.base.iterator()];case 3:return t=n.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map((function(t){return e.makeDataElement(t)}))]}}))}))},e.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),n={},r={},i=0;i<this.fullColumnNames.length;i++){var a=this.fullColumnNames[i],o=this.columnConfigs?this.columnConfigs[a]:null;if(!this.configuredColumnsOnly||o){var s=e[i],l=null;if(""===s)if(o&&void 0!==o.default)l=o.default;else{if(o&&(o.required||o.isLabel))throw new Error("Required column "+a+" is empty in this line: "+t);l=void 0}else{var u=Number(s);if(isNaN(u))l=o&&"bool"===o.dtype?this.getBoolean(s):s;else if(o&&o.dtype)switch(o.dtype){case"float32":l=u;break;case"int32":l=Math.floor(u);break;case"bool":l=this.getBoolean(s);break;default:l=u}else l=u}o&&o.isLabel?r[a]=l:n[a]=l}}return 0===Object.keys(r).length?n:{xs:n,ys:r}},e.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},e.prototype.parseRow=function(t,e){void 0===e&&(e=!0);for(var n=[],r=0,i=t.length,a=DE,o=0;o<i;o++)switch(a){case DE:switch(t.charAt(o)){case'"':r=o+1,a=zE;break;case this.delimiter:if(r=o+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),a=DE;break;default:a=FE,r=o}break;case FE:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(r,o)),a=DE,r=o+1}break;case zE:switch(t.charAt(o)){case'"':a=LE}break;case LE:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(r,o-1)),a=DE,r=o+1;break;case'"':a=zE;break;default:a=BE}break;case BE:switch(t.charAt(o)){case'"':a=zE}}if(n.push(a===LE?t.substring(r,i-1):t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+n);return n}}(PE),function(t){function e(e){var n=t.call(this)||this;n.microphoneConfig=e,n.isClosed=!1,n.fftSize=e.fftSize||1024;var r=Math.log2(n.fftSize);if(n.fftSize<0||r<4||r>14||!Number.isInteger(r))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+n.fftSize);if(n.numFrames=e.numFramesPerSpectrogram||43,n.sampleRateHz=e.sampleRateHz,n.columnTruncateLength=e.columnTruncateLength||n.fftSize,n.audioTrackConstraints=e.audioTrackConstraints,n.smoothingTimeConstant=e.smoothingTimeConstant||0,n.includeSpectrogram=!1!==e.includeSpectrogram,n.includeWaveform=!0===e.includeWaveform,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}HO(e,t),e.prototype.summary=function(){return"microphone"},e.create=function(t){return void 0===t&&(t={}),GO(this,void 0,void 0,(function(){var n;return $O(this,(function(r){switch(r.label){case 0:if(es().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new e(t)).start()];case 1:return r.sent(),[2,n]}}))}))},e.prototype.start=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r;return $O(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return t.stream=i.sent(),[3,3];case 2:throw e=i.sent(),new Error("Error thrown while initializing video stream: "+e.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(n=window.AudioContext||window.webkitAudioContext,this.audioContext=new n,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}}))}))},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r,i;return $O(this,(function(a){switch(a.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return n=a.sent(),this.includeSpectrogram&&(r=this.flattenQueue(n.freqDataQueue),t=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(i=this.flattenQueue(n.timeDataQueue),e=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:e},done:!1}]}}))}))},e.prototype.capture=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.getAudioData=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r=this;return $O(this,(function(i){return t=[],e=[],n=0,[2,new Promise((function(i){var a=setInterval((function(){r.includeSpectrogram&&(r.analyser.getFloatFrequencyData(r.freqData),r.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(r.freqData.slice(0,r.columnTruncateLength))),r.includeWaveform&&(r.analyser.getFloatTimeDomainData(r.timeData),e.push(r.timeData.slice())),++n===r.numFrames&&(clearInterval(a),i({freqDataQueue:t,timeDataQueue:e}))}),r.fftSize/r.sampleRateHz*1e3)}))]}))}))},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((function(t,r){return n.set(t,r*e)})),n},e.prototype.getTensorFromAudioDataArray=function(t,e){var n=new Float32Array(tl.sizeFromShape(e));return n.set(t,n.length-t.length),rc(n,e)}}(fE),function(t){function e(e,n){var r=t.call(this)||this;if(r.webcamVideoElement=e,r.webcamConfig=n,r.isClosed=!0,r.resize=!1,r.needToResize())if(r.resize=!0,r.cropSize=[r.webcamConfig.resizeHeight,r.webcamConfig.resizeWidth],r.cropBoxInd=oc([0],"int32"),r.webcamConfig.centerCrop){var i=1*r.webcamConfig.resizeWidth/r.webcamVideoElement.width,a=1*r.webcamConfig.resizeHeight/r.webcamVideoElement.height,o=(1-i)/2,s=(1-a)/2;r.cropBox=sc([s,o,a+s,o+i],[1,4])}else r.cropBox=sc([0,0,1,1],[1,4]);return r}HO(e,t),e.prototype.summary=function(){return"webcam"},e.create=function(t,n){return void 0===n&&(n={}),GO(this,void 0,void 0,(function(){var r;return $O(this,(function(i){switch(i.label){case 0:if(es().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}return[4,(r=new e(t,n)).start()];case 1:return i.sent(),[2,r]}}))}))},e.prototype.start=function(){return GO(this,void 0,void 0,(function(){var t,e,n=this;return $O(this,(function(r){switch(r.label){case 0:this.webcamConfig.facingMode&&tl.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(function(){return"Invalid webcam facing mode: "+n.webcamConfig.facingMode+". Please provide 'user' or 'environment'"})),r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=r.sent(),[3,4];case 3:throw(e=r.sent()).message="Error thrown while initializing video stream: "+e.message,e;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise((function(t){n.webcamVideoElement.onloadedmetadata=function(){t()}}))]}}))}))},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){if(this.isClosed)return[2,{value:null,done:!0}];try{t=tw.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(t))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(t){throw new Error("Error thrown cropping the video: "+t.message)}finally{t.dispose()}return[2]}))}))},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var e=this;return Du((function(){var n,r=t.toFloat().expandDims(0),i=(n=Cv.cropAndResize(r,e.cropBox,e.cropBoxInd,e.cropSize,"bilinear")).shape;return n.reshape(i.slice(1))}))},e.prototype.capture=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.stop=function(){this.stream.getTracks().forEach((function(t){return t.stop()}));try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")}}(fE),function(){}),UE=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return HO(e,t),e.prototype.split=function(t){return new WE(this,t)},e}(fE),WE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.impl=new jE(e,n),r}return HO(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return[2,this.impl.next()]}))}))},e}(UE),jE=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.separator=n,r.carryover="",r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return GO(this,void 0,void 0,(function(){var t,e,n,r;return $O(this,(function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:if((t=i.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],n=0,r=e.slice(0,-1);n<r.length;n++)this.outputQueue.push(r[n]);return this.carryover=e[e.length-1],[2,!0]}}))}))},e}(SE),qE=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return HO(e,t),e.prototype.decodeUTF8=function(){return new HE(this)},e}(fE),HE=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.impl=new GE(e),n}return HO(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return[2,this.impl.next()]}))}))},e}(UE),GE=function(t){function e(e){var r=t.call(this)||this;if(r.upstream=e,es().get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var i=n(5).StringDecoder;r.decoder=new i("utf8")}return r}return HO(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return GO(this,void 0,void 0,(function(){var t,e,n;return $O(this,(function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done?[2,!1]:(e=t.value,n=es().get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(n),[2,!0])}}))}))},e}(SE),$E=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.file=e,r.options=n,tl.assert(e instanceof Uint8Array||!!es().get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),(function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."})),r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return HO(e,t),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return GO(this,void 0,void 0,(function(){var t,e,n=this;return $O(this,(function(r){switch(r.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise((function(t,e){var r=n.offset+n.chunkSize;if(n.file instanceof Uint8Array)t(new Uint8Array(n.file.slice(n.offset,r)));else{var i=new FileReader;i.onload=function(n){var r=i.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},i.onabort=function(t){return e(new Error("Aborted"))},i.onerror=function(t){return e(new Error(t.type))};var a=n.file.slice(n.offset,r);i.readAsArrayBuffer(a)}n.offset=r})),e={},[4,t]);case 1:return[2,(e.value=r.sent(),e.done=!1,e)]}}))}))},e}(qE);function KE(t,e){return void 0===e&&(e={}),GO(this,void 0,void 0,(function(){var n,r,i,a,o;return $O(this,(function(s){switch(s.label){case 0:return"string"==typeof t?n=t:(n=t.url,r=XE(t)),[4,tl.fetch(n,r)];case 1:return(i=s.sent()).ok?(o=Uint8Array.bind,[4,i.arrayBuffer()]):[3,3];case 2:return a=new(o.apply(Uint8Array,[void 0,s.sent()])),[2,new $E(a,e)];case 3:throw new Error(i.statusText)}}))}))}var XE=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function YE(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var QE=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.input=e,r.options=n,r}return HO(e,t),e.prototype.iterator=function(){return GO(this,void 0,void 0,(function(){var t;return $O(this,(function(e){return YE(this.input)&&es().get("IS_NODE")&&(t=n(6),this.input=t.readFileSync(this.input.substr(7))),[2,new $E(this.input,this.options)]}))}))},e}(VE);!function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.url=e,r.fileOptions=n,r}HO(e,t),e.prototype.iterator=function(){return GO(this,void 0,void 0,(function(){return $O(this,(function(t){return YE(this.url)?[2,new QE(this.url,this.fileOptions).iterator()]:[2,KE(this.url,this.fileOptions)]}))}))}}(VE);class ZE{constructor(t){this.spinner=t,this.loadingText="",this.fileTypes=[".png",".jpg",".jpeg"]}ngOnInit(){"undefined"!=typeof Worker?(this.predictWorker=new Worker("assets/predict-worker.worker.js"),this.predictWorker.addEventListener("message",t=>{this.result=t.data,console.log(t.data),this.result=this.result.map(t=>(100*t).toFixed(2)),this.spinner.hide()})):alert("Your browser needs to be updated to run this application properly."),this.loadingText="Setting up...",this.spinner.show(),function(t,e){return null==e&&(e={}),function(t,e){return xw(this,void 0,void 0,(function(){var n;return Cw(this,(function(r){if(null==e&&(e={}),"string"==typeof t){if(0===(n=Qb.getLoadHandlers(t,e.onProgress)).length)n.push(Qb.browserHTTPRequest(t,e));else if(n.length>1)throw new Ow("Found more than one ("+n.length+") load handlers for URL '"+t+"'");t=n[0]}return[2,B_(t,void 0,e)]}))}))}("assets/trained/model.json",e)}().then(t=>{this.spinner.hide(),this.model=t}).catch(()=>{this.spinner.hide()})}uploadFile(t){if(t.length>0){if(t.length>1)return void alert("Upload 1 photo only");const e=t[0];if(this.validateFile(e)){this.loadingText="Analyzing...",this.spinner.show();const t=new FileReader;t.readAsDataURL(e),t.onload=t=>{this.uploadedFile=e.name,this.imgURL=t.target.result,this.resultImgURL=this.imgURL;const n=document.createElement("canvas"),r=n.getContext("2d"),i=document.createElement("img");i.src=this.imgURL,n.width=224,n.height=224,i.addEventListener("load",()=>{r.drawImage(i,0,0,i.width,i.height,0,0,n.width,n.height);let t=r.getImageData(0,0,n.width,n.height);this.predictWorker.postMessage({data:t})})}}}}validateFile(t){if(!t)return;const e=t.name.split("."),n=e[e.length-1].toLowerCase();if(!this.fileTypes.includes(`.${n}`)){const t=`Please only upload file of types: \n${this.fileTypes.join(", ")}`;return alert(t),!1}return!0}}class JE{}const tM=new St("Location Initialized");class eM{}const nM=new St("appBaseHref");class rM{constructor(t,e){this._subject=new di,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=rM.stripTrailingSlash(iM(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+rM.normalizeQueryParams(e))}normalize(t){return rM.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,iM(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+rM.normalizeQueryParams(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+rM.normalizeQueryParams(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)})}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}static normalizeQueryParams(t){return t&&"?"!==t[0]?"?"+t:t}static joinWithSlash(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}static stripTrailingSlash(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}}function iM(t){return t.replace(/\/index.html$/,"")}class aM extends eM{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=rM.joinWithSlash(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+rM.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+rM.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}class oM extends eM{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return rM.joinWithSlash(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+rM.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+rM.normalizeQueryParams(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+rM.normalizeQueryParams(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}const sM=function(){var t={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return t[t.Zero]="Zero",t[t.One]="One",t[t.Two]="Two",t[t.Few]="Few",t[t.Many]="Many",t[t.Other]="Other",t}(),lM=new St("UseV4Plurals");class uM{}class cM extends uM{constructor(t,e){super(),this.locale=t,this.deprecatedPluralFn=e}getPluralCategory(t,e){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(e||this.locale,t):function(t){return function(t){const e=t.toLowerCase().replace(/_/g,"-");let n=ci[e];if(n)return n;const r=e.split("-")[0];if(n=ci[r],n)return n;if("en"===r)return pi;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[hi.PluralCase]}(e||this.locale)(t)){case sM.Zero:return"zero";case sM.One:return"one";case sM.Two:return"two";case sM.Few:return"few";case sM.Many:return"many";default:return"other"}}}class hM{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}class pM{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){Kt()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. `+"See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(Ip){throw new Error(`Cannot find a differ supporting object '${e}' of type '${t=e,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new hM(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new dM(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const a=new dM(t,i);e.push(a)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}class dM{constructor(t,e){this.record=t,this.view=e}}class fM{constructor(t,e){this._viewContainer=t,this._context=new mM,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){gM("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){gM("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}class mM{constructor(){this.$implicit=null,this.ngIf=null}}function gM(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${gt(e)}'.`)}class yM{}const vM=new St("DocumentToken");function bM(t){return"browser"===t}function wM(t){return"server"===t}let xM=(()=>{class t{}return t.ngInjectableDef=dt({token:t,providedIn:"root",factory:()=>new CM(It(vM),window,It(Ht))}),t})();class CM{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const e=this.document.querySelector(`#${t}`);if(e)return void this.scrollToElement(e);const n=this.document.querySelector(`[name='${t}']`);if(n)return void this.scrollToElement(n)}catch(bC){this.errorHandler.handleError(bC)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(Ip){return!1}}}const _M=new x(t=>t.complete());function kM(t){return t?function(t){return new x(e=>t.schedule(()=>e.complete()))}(t):_M}function SM(t){const e=new x(e=>{e.next(t),e.complete()});return e._isScalar=!0,e.value=t,e}function OM(...t){let e=t[t.length-1];switch(N(e)?t.pop():e=void 0,t.length){case 0:return kM(e);case 1:return e?H(t,e):SM(t[0]);default:return H(t,e)}}class EM extends E{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new k;return this._value}next(t){super.next(this._value=t)}}function MM(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}MM.prototype=Object.create(Error.prototype);const NM=MM,PM={};class TM{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new IM(t,this.resultSelector))}}class IM extends U{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(PM),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(V(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const a=this.values,o=this.toRespond?a[n]===PM?--this.toRespond:this.toRespond:0;a[n]=e,0===o&&(this.resultSelector?this._tryResultSelector(a):this.destination.next(a.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function AM(t){return new x(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?G(n):kM()).subscribe(e)})}function RM(){return Q(1)}function DM(t,e){return function(n){return n.lift(new FM(t,e))}}class FM{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new zM(t,this.predicate,this.thisArg))}}class zM extends m{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}function LM(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}LM.prototype=Object.create(Error.prototype);const BM=LM;function VM(t){return function(e){return 0===t?kM():e.lift(new UM(t))}}class UM{constructor(t){if(this.total=t,this.total<0)throw new BM}call(t,e){return e.subscribe(new WM(t,this.total))}}class WM extends m{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function jM(t,e,n){return function(r){return r.lift(new qM(t,e,n))}}class qM{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new HM(t,this.nextOrObserver,this.error,this.complete))}}class HM extends m{constructor(t,e,n,i){super(t),this._tapNext=v,this._tapError=v,this._tapComplete=v,this._tapError=n||v,this._tapComplete=i||v,r(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||v,this._tapError=e.error||v,this._tapComplete=e.complete||v)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}const GM=(t=$M)=>jM({hasValue:!1,next(){this.hasValue=!0},complete(){if(!this.hasValue)throw t()}});function $M(){return new NM}function KM(t=null){return e=>e.lift(new XM(t))}class XM{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new YM(t,this.defaultValue))}}class YM extends m{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function QM(t,e){const n=arguments.length>=2;return r=>r.pipe(t?DM((e,n)=>t(e,n,r)):Y,VM(1),n?KM(e):GM(()=>new NM))}function ZM(t){return function(e){const n=new JM(t),r=e.lift(n);return n.caught=r}}class JM{constructor(t){this.selector=t}call(t,e){return e.subscribe(new tN(t,this.selector,this.caught))}}class tN extends U{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new P(this,void 0,void 0);this.add(r),V(this,n,void 0,void 0,r)}}}function eN(t){return e=>0===t?kM():e.lift(new nN(t))}class nN{constructor(t){if(this.total=t,this.total<0)throw new BM}call(t,e){return e.subscribe(new rN(t,this.total))}}class rN extends m{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function iN(t,e){const n=arguments.length>=2;return r=>r.pipe(t?DM((e,n)=>t(e,n,r)):Y,eN(1),n?KM(e):GM(()=>new NM))}class aN{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new oN(t,this.predicate,this.thisArg,this.source))}}class oN extends m{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}function sN(t,e){return"function"==typeof e?n=>n.pipe(sN((n,r)=>G(t(n,r)).pipe(W((t,i)=>e(n,t,r,i))))):e=>e.lift(new lN(t))}class lN{constructor(t){this.project=t}call(t,e){return e.subscribe(new uN(t,this.project))}}class uN extends U{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new P(this,void 0,void 0);this.destination.add(i),this.innerSubscription=V(this,t,e,n,i)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function cN(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new hN(t,e,n))}}class hN{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new pN(t,this.accumulator,this.seed,this.hasSeed))}}class pN extends m{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}function dN(t,e){return $(t,e,1)}class fN{constructor(t){this.callback=t}call(t,e){return e.subscribe(new mN(t,this.callback))}}class mN extends m{constructor(t,e){super(t),this.add(new p(e))}}let gN=null;function yN(){return gN}const vN={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},bN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wN={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},xN=(()=>{if(kt.Node)return kt.Node.prototype.contains||function(t){return!!(16&this.compareDocumentPosition(t))}})();class CN extends class extends class{constructor(){this.resourceLoaderType=null}get attrToPropMap(){return this._attrToPropMap}set attrToPropMap(t){this._attrToPropMap=t}}{constructor(){super(),this._animationPrefix=null,this._transitionEnd=null;try{const t=this.createElement("div",document);if(null!=this.getStyle(t,"animationName"))this._animationPrefix="";else{const e=["Webkit","Moz","O","ms"];for(let n=0;n<e.length;n++)if(null!=this.getStyle(t,e[n]+"AnimationName")){this._animationPrefix="-"+e[n].toLowerCase()+"-";break}}const e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(e).forEach(n=>{null!=this.getStyle(t,n)&&(this._transitionEnd=e[n])})}catch(Ip){this._animationPrefix=null,this._transitionEnd=null}}getDistributedNodes(t){return t.getDistributedNodes()}resolveAndSetHref(t,e,n){t.href=null==n?e:e+"/../"+n}supportsDOMEvents(){return!0}supportsNativeShadowDOM(){return"function"==typeof document.body.createShadowRoot}getAnimationPrefix(){return this._animationPrefix?this._animationPrefix:""}getTransitionEnd(){return this._transitionEnd?this._transitionEnd:""}supportsAnimation(){return null!=this._animationPrefix&&null!=this._transitionEnd}}{parse(t){throw new Error("parse not implemented")}static makeCurrent(){var t;t=new CN,gN||(gN=t)}hasProperty(t,e){return e in t}setProperty(t,e,n){t[e]=n}getProperty(t,e){return t[e]}invoke(t,e,n){t[e](...n)}logError(t){window.console&&(console.error?console.error(t):console.log(t))}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}get attrToPropMap(){return vN}contains(t,e){return xN.call(t,e)}querySelector(t,e){return t.querySelector(e)}querySelectorAll(t,e){return t.querySelectorAll(e)}on(t,e,n){t.addEventListener(e,n,!1)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}createMouseEvent(t){const e=this.getDefaultDocument().createEvent("MouseEvent");return e.initEvent(t,!0,!0),e}createEvent(t){const e=this.getDefaultDocument().createEvent("Event");return e.initEvent(t,!0,!0),e}preventDefault(t){t.preventDefault(),t.returnValue=!1}isPrevented(t){return t.defaultPrevented||null!=t.returnValue&&!t.returnValue}getInnerHTML(t){return t.innerHTML}getTemplateContent(t){return"content"in t&&this.isTemplateElement(t)?t.content:null}getOuterHTML(t){return t.outerHTML}nodeName(t){return t.nodeName}nodeValue(t){return t.nodeValue}type(t){return t.type}content(t){return this.hasProperty(t,"content")?t.content:t}firstChild(t){return t.firstChild}nextSibling(t){return t.nextSibling}parentElement(t){return t.parentNode}childNodes(t){return t.childNodes}childNodesAsList(t){const e=t.childNodes,n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r];return n}clearNodes(t){for(;t.firstChild;)t.removeChild(t.firstChild)}appendChild(t,e){t.appendChild(e)}removeChild(t,e){t.removeChild(e)}replaceChild(t,e,n){t.replaceChild(e,n)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}insertBefore(t,e,n){t.insertBefore(n,e)}insertAllBefore(t,e,n){n.forEach(n=>t.insertBefore(n,e))}insertAfter(t,e,n){t.insertBefore(n,e.nextSibling)}setInnerHTML(t,e){t.innerHTML=e}getText(t){return t.textContent}setText(t,e){t.textContent=e}getValue(t){return t.value}setValue(t,e){t.value=e}getChecked(t){return t.checked}setChecked(t,e){t.checked=e}createComment(t){return this.getDefaultDocument().createComment(t)}createTemplate(t){const e=this.getDefaultDocument().createElement("template");return e.innerHTML=t,e}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createElementNS(t,e,n){return(n=n||this.getDefaultDocument()).createElementNS(t,e)}createTextNode(t,e){return(e=e||this.getDefaultDocument()).createTextNode(t)}createScriptTag(t,e,n){const r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(t,e),r}createStyleElement(t,e){const n=(e=e||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(t,e)),n}createShadowRoot(t){return t.createShadowRoot()}getShadowRoot(t){return t.shadowRoot}getHost(t){return t.host}clone(t){return t.cloneNode(!0)}getElementsByClassName(t,e){return t.getElementsByClassName(e)}getElementsByTagName(t,e){return t.getElementsByTagName(e)}classList(t){return Array.prototype.slice.call(t.classList,0)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}hasClass(t,e){return t.classList.contains(e)}setStyle(t,e,n){t.style[e]=n}removeStyle(t,e){t.style[e]=""}getStyle(t,e){return t.style[e]}hasStyle(t,e,n){const r=this.getStyle(t,e)||"";return n?r==n:r.length>0}tagName(t){return t.tagName}attributeMap(t){const e=new Map,n=t.attributes;for(let r=0;r<n.length;r++){const t=n.item(r);e.set(t.name,t.value)}return e}hasAttribute(t,e){return t.hasAttribute(e)}hasAttributeNS(t,e,n){return t.hasAttributeNS(e,n)}getAttribute(t,e){return t.getAttribute(e)}getAttributeNS(t,e,n){return t.getAttributeNS(e,n)}setAttribute(t,e,n){t.setAttribute(e,n)}setAttributeNS(t,e,n,r){t.setAttributeNS(e,n,r)}removeAttribute(t,e){t.removeAttribute(e)}removeAttributeNS(t,e,n){t.removeAttributeNS(e,n)}templateAwareRoot(t){return this.isTemplateElement(t)?this.content(t):t}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}getBoundingClientRect(t){try{return t.getBoundingClientRect()}catch(Ip){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}}getTitle(t){return t.title}setTitle(t,e){t.title=e||""}elementMatches(t,e){return!!this.isElementNode(t)&&(t.matches&&t.matches(e)||t.msMatchesSelector&&t.msMatchesSelector(e)||t.webkitMatchesSelector&&t.webkitMatchesSelector(e))}isTemplateElement(t){return this.isElementNode(t)&&"TEMPLATE"===t.nodeName}isTextNode(t){return t.nodeType===Node.TEXT_NODE}isCommentNode(t){return t.nodeType===Node.COMMENT_NODE}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}hasShadowRoot(t){return null!=t.shadowRoot&&t instanceof HTMLElement}isShadowRoot(t){return t instanceof DocumentFragment}importIntoDoc(t){return document.importNode(this.templateAwareRoot(t),!0)}adoptNode(t){return document.adoptNode(t)}getHref(t){return t.getAttribute("href")}getEventKey(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&wN.hasOwnProperty(e)&&(e=wN[e]))}return bN[e]||e}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=kN||(kN=document.querySelector("base"),kN)?kN.getAttribute("href"):null;return null==e?null:(n=e,_N||(_N=document.createElement("a")),_N.setAttribute("href",n),"/"===_N.pathname.charAt(0)?_N.pathname:"/"+_N.pathname);var n}resetBaseElement(){kN=null}getUserAgent(){return window.navigator.userAgent}setData(t,e,n){this.setAttribute(t,"data-"+e,n)}getData(t,e){return this.getAttribute(t,"data-"+e)}getComputedStyle(t){return getComputedStyle(t)}supportsWebAnimation(){return"function"==typeof Element.prototype.animate}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return function(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}(document.cookie,t)}setCookie(t,e){document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)}}let _N,kN=null;function SN(){return!!window.history.pushState}const ON=new St("TRANSITION_ID"),EN=[{provide:gi,useFactory:function(t,e,n){return()=>{n.get(yi).donePromise.then(()=>{const n=yN();Array.prototype.slice.apply(n.querySelectorAll(e,"style[ng-transition]")).filter(e=>n.getAttribute(e,"ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[ON,vM,Oe],multi:!0}];class MN{static init(){var t;t=new MN,Ji=t}addToWindow(t){kt.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},kt.getAllAngularTestabilities=()=>t.getAllTestabilities(),kt.getAllAngularRootElements=()=>t.getAllRootElements(),kt.frameworkStabilizers||(kt.frameworkStabilizers=[]),kt.frameworkStabilizers.push(t=>{const e=kt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,n--,0==n&&t(r)};e.forEach((function(t){t.whenStable(i)}))})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?yN().isShadowRoot(e)?this.findTestabilityInTree(t,yN().getHost(e),!0):this.findTestabilityInTree(t,yN().parentElement(e),!0):null}}function NN(t,e){"undefined"!=typeof COMPILED&&COMPILED||((kt.ng=kt.ng||{})[t]=e)}const PN=(()=>({ApplicationRef:oa,NgZone:Wi}))();function TN(t){return ya(t)}const IN=new St("EventManagerPlugins");class AN{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}class RN{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=yN().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}class DN{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}class FN extends DN{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>yN().remove(t))}}const zN={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},LN=/%COMP%/g;function BN(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?BN(t,i,n):(i=i.replace(LN,t),n.push(i))}return n}function VN(t){return e=>{!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}class UN{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new WN(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case Vt.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new HN(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case Vt.Native:case Vt.ShadowDom:return new GN(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=BN(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}class WN{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(zN[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=zN[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=zN[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&rn.DashCase?t.style.setProperty(e,n,r&rn.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&rn.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){qN(e,"property"),t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return qN(e,"listener"),"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,VN(n)):this.eventManager.addEventListener(t,e,VN(n))}}const jN=(()=>"@".charCodeAt(0))();function qN(t,e){if(t.charCodeAt(0)===jN)throw new Error(`Found the synthetic ${e} ${t}. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.`)}class HN extends WN{constructor(t,e,n,r){super(t),this.component=n;const i=BN(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(LN,r+"-"+n.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(LN,t)}(r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class GN extends WN{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===Vt.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=BN(r.id,r.styles,[]);for(let a=0;a<i.length;a++){const t=document.createElement("style");t.textContent=i[a],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}const $N=(()=>"undefined"!=typeof Zone&&Zone.__symbol__||function(t){return"__zone_symbol__"+t})(),KN=$N("addEventListener"),XN=$N("removeEventListener"),YN={},QN="__zone_symbol__propagationStopped",ZN=(()=>{const t="undefined"!=typeof Zone&&Zone[$N("BLACK_LISTED_EVENTS")];if(t){const e={};return t.forEach(t=>{e[t]=t}),e}})(),JN=function(t){return!!ZN&&ZN.hasOwnProperty(t)},tP=function(t){const e=YN[t.type];if(!e)return;const n=this[e];if(!n)return;const r=[t];if(1===n.length){const t=n[0];return t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}{const e=n.slice();for(let n=0;n<e.length&&!0!==t[QN];n++){const t=e[n];t.zone!==Zone.current?t.zone.run(t.handler,this,r):t.handler.apply(this,r)}}};class eP extends RN{constructor(t,e,n){super(t),this.ngZone=e,n&&wM(n)||this.patchEvent()}patchEvent(){if("undefined"==typeof Event||!Event||!Event.prototype)return;if(Event.prototype.__zone_symbol__stopImmediatePropagation)return;const t=Event.prototype.__zone_symbol__stopImmediatePropagation=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[QN]=!0),t&&t.apply(this,arguments)}}supports(t){return!0}addEventListener(t,e,n){let r=n;if(!t[KN]||Wi.isInAngularZone()&&!JN(e))t.addEventListener(e,r,!1);else{let n=YN[e];n||(n=YN[e]=$N("ANGULAR"+e+"FALSE"));let i=t[n];const a=i&&i.length>0;i||(i=t[n]=[]);const o=JN(e)?Zone.root:Zone.current;if(0===i.length)i.push({zone:o,handler:r});else{let t=!1;for(let e=0;e<i.length;e++)if(i[e].handler===r){t=!0;break}t||i.push({zone:o,handler:r})}a||t[KN](e,tP,!1)}return()=>this.removeEventListener(t,e,r)}removeEventListener(t,e,n){let r=t[XN];if(!r)return t.removeEventListener.apply(t,[e,n,!1]);let i=YN[e],a=i&&t[i];if(!a)return t.removeEventListener.apply(t,[e,n,!1]);let o=!1;for(let s=0;s<a.length;s++)if(a[s].handler===n){o=!0,a.splice(s,1);break}o?0===a.length&&r.apply(t,[e,tP,!1]):t.removeEventListener.apply(t,[e,n,!1])}}const nP={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},rP=new St("HammerGestureConfig"),iP=new St("HammerLoader");class aP{constructor(){this.events=[],this.overrides={}}buildHammer(t){const e=new Hammer(t,this.options);e.get("pinch").set({enable:!0}),e.get("rotate").set({enable:!0});for(const n in this.overrides)e.get(n).set(this.overrides[n]);return e}}class oP extends RN{constructor(t,e,n,r){super(t),this._config=e,this.console=n,this.loader=r}supports(t){return!(!nP.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t)||!window.Hammer&&!this.loader&&(this.console.warn(`The "${t}" event cannot be bound because Hammer.JS is not `+"loaded and no custom loader has been specified."),1))}addEventListener(t,e,n){const r=this.manager.getZone();if(e=e.toLowerCase(),!window.Hammer&&this.loader){let r=!1,i=()=>{r=!0};return this.loader().then(()=>{if(!window.Hammer)return this.console.warn("The custom HAMMER_LOADER completed, but Hammer.JS is not present."),void(i=()=>{});r||(i=this.addEventListener(t,e,n))}).catch(()=>{this.console.warn(`The "${e}" event cannot be bound because the custom `+"Hammer.JS loader failed."),i=()=>{}}),()=>{i()}}return r.runOutsideAngular(()=>{const i=this._config.buildHammer(t),a=function(t){r.runGuarded((function(){n(t)}))};return i.on(e,a),()=>{i.off(e,a),"function"==typeof i.destroy&&i.destroy()}})}isCustomEvent(t){return this._config.events.indexOf(t)>-1}}const sP=["alt","control","meta","shift"],lP={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};class uP extends RN{constructor(t){super(t)}supports(t){return null!=uP.parseEventName(t)}addEventListener(t,e,n){const r=uP.parseEventName(e),i=uP.eventCallback(r.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>yN().onAndCancel(t,r.domEventName,i))}static parseEventName(t){const e=t.toLowerCase().split("."),n=e.shift();if(0===e.length||"keydown"!==n&&"keyup"!==n)return null;const r=uP._normalizeKey(e.pop());let i="";if(sP.forEach(t=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),i+=t+".")}),i+=r,0!=e.length||0===r.length)return null;const a={};return a.domEventName=n,a.fullKey=i,a}static getEventFullKey(t){let e="",n=yN().getEventKey(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),sP.forEach(r=>{r!=n&&(0,lP[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(t,e,n){return r=>{uP.getEventFullKey(r)===t&&n.runGuarded(()=>e(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}class cP{}class hP extends cP{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case ge.NONE:return e;case ge.HTML:return e instanceof dP?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"HTML"),function(t,e){let n=null;try{fe=fe||new Xt(t);let r=e?String(e):"";n=fe.getInertBodyElement(r);let i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=fe.getInertBodyElement(r)}while(r!==a);const o=new ce,s=o.sanitizeChildren(me(n)||n);return Kt()&&o.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n){const t=me(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}(this._doc,String(e)));case ge.STYLE:return e instanceof fP?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"Style"),function(t){if(!(t=String(t).trim()))return"";const e=t.match(be);return e&&Zt(e[1])===e[1]||t.match(ve)&&function(t){let e=!0,n=!0;for(let r=0;r<t.length;r++){const i=t.charAt(r);"'"===i&&n?e=!e:'"'===i&&e&&(n=!n)}return e&&n}(t)?t:(Kt()&&console.warn(`WARNING: sanitizing unsafe style value ${t} (see http://g.co/ng/security#xss).`),"unsafe")}(e));case ge.SCRIPT:if(e instanceof mP)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"Script"),new Error("unsafe value used in a script context");case ge.URL:return e instanceof yP||e instanceof gP?e.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(e,"URL"),Zt(String(e)));case ge.RESOURCE_URL:if(e instanceof yP)return e.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(e,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}checkNotSafeValue(t,e){if(t instanceof pP)throw new Error(`Required a safe ${e}, got a ${t.getTypeName()} `+"(see http://g.co/ng/security#xss)")}bypassSecurityTrustHtml(t){return new dP(t)}bypassSecurityTrustStyle(t){return new fP(t)}bypassSecurityTrustScript(t){return new mP(t)}bypassSecurityTrustUrl(t){return new gP(t)}bypassSecurityTrustResourceUrl(t){return new yP(t)}}class pP{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity}`+" (see http://g.co/ng/security#xss)"}}class dP extends pP{getTypeName(){return"HTML"}}class fP extends pP{getTypeName(){return"Style"}}class mP extends pP{getTypeName(){return"Script"}}class gP extends pP{getTypeName(){return"URL"}}class yP extends pP{getTypeName(){return"ResourceURL"}}const vP=na(ba,"browser",[{provide:Ci,useValue:"browser"},{provide:xi,useValue:function(){CN.makeCurrent(),MN.init()},multi:!0},{provide:JE,useClass:class extends JE{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=yN().getLocation(),this._history=yN().getHistory()}getBaseHrefFromDOM(){return yN().getBaseHref(this._doc)}onPopState(t){yN().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){yN().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){SN()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){SN()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}},deps:[vM]},{provide:vM,useFactory:function(){return document},deps:[]}]);function bP(){return new Ht}class wP{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:wP,providers:[{provide:vi,useValue:t.appId},{provide:ON,useExisting:vi},EN]}}}"undefined"!=typeof window&&window;class xP{constructor(t,e){this.id=t,this.url=e}}class CP extends xP{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class _P extends xP{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class kP extends xP{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class SP extends xP{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class OP extends xP{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EP extends xP{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class MP extends xP{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class NP extends xP{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class PP extends xP{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class TP{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class IP{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class AP{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class RP{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class DP{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class FP{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zP{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class LP{}class BP{constructor(t){this.params=t||{}}has(t){return this.params.hasOwnProperty(t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function VP(t){return new BP(t)}function UP(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function WP(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let a=0;a<r.length;a++){const e=r[a],n=t[a];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}class jP{constructor(t,e){this.routes=t,this.module=e}}function qP(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];HP(r,GP(e,r))}}function HP(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&qP(t.children,e)}function GP(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function $P(t){const e=t.children&&t.children.map($P),n=e?Object.assign({},t,{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=LP),n}function KP(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let a=0;a<n.length;a++)if(i=n[a],t[i]!==e[i])return!1;return!0}function XP(t){return Array.prototype.concat.apply([],t)}function YP(t){return t.length>0?t[t.length-1]:null}function QP(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function ZP(t){return je(t)?t:We(t)?G(Promise.resolve(t)):OM(t)}function JP(t,e,n){return n?function(t,e){return KP(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!rT(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>e[n]===t[n])}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!rT(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!rT(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),a=i.slice(n.segments.length);return!!rT(n.segments,t)&&!!n.children.primary&&e(n.children.primary,r,a)}}(e,n,n.segments)}(t.root,e.root)}class tT{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=VP(this.queryParams)),this._queryParamMap}toString(){return sT.serialize(this)}}class eT{constructor(t,e){this.segments=t,this.children=e,this.parent=null,QP(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return lT(this)}}class nT{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=VP(this.parameters)),this._parameterMap}toString(){return fT(this)}}function rT(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function iT(t,e){let n=[];return QP(t.children,(t,r)=>{"primary"===r&&(n=n.concat(e(t,r)))}),QP(t.children,(t,r)=>{"primary"!==r&&(n=n.concat(e(t,r)))}),n}class aT{}class oT{parse(t){const e=new bT(t);return new tT(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`${`/${function t(e,n){if(!e.hasChildren())return lT(e);if(n){const n=e.children.primary?t(e.children.primary,!1):"",r=[];return QP(e.children,(e,n)=>{"primary"!==n&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=iT(e,(n,r)=>"primary"===r?[t(e.children.primary,!1)]:[`${r}:${t(n,!1)}`]);return`${lT(e)}/(${n.join("//")})`}}(t.root,!0)}`}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${cT(e)}=${cT(t)}`).join("&"):`${cT(e)}=${cT(n)}`});return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const sT=new oT;function lT(t){return t.segments.map(t=>fT(t)).join("/")}function uT(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function cT(t){return uT(t).replace(/%3B/gi,";")}function hT(t){return uT(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function pT(t){return decodeURIComponent(t)}function dT(t){return pT(t.replace(/\+/g,"%20"))}function fT(t){return`${hT(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${hT(t)}=${hT(e[t])}`).join("")}`;var e}const mT=/^[^\/()?;=#]+/;function gT(t){const e=t.match(mT);return e?e[0]:""}const yT=/^[^=?&#]+/,vT=/^[^?&#]+/;class bT{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new eT([],{}):new eT([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new eT(t,e)),n}parseSegment(){const t=gT(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new nT(pT(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=gT(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=gT(this.remaining);t&&(n=t,this.capture(n))}t[pT(e)]=pT(n)}parseQueryParam(t){const e=function(t){const e=t.match(yT);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(vT);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=dT(e),i=dT(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=gT(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");const a=this.parseChildren();e[i]=1===Object.keys(a).length?a.primary:new eT([],a),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class wT{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=xT(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=xT(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=CT(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return CT(t,this._root).map(t=>t.value)}}function xT(t,e){if(t===e.value)return e;for(const n of e.children){const e=xT(t,n);if(e)return e}return null}function CT(t,e){if(t===e.value)return[e];for(const n of e.children){const r=CT(t,n);if(r.length)return r.unshift(e),r}return[]}class _T{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function kT(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class ST extends wT{constructor(t,e){super(t),this.snapshot=e,TT(this,t)}toString(){return this.snapshot.toString()}}function OT(t,e){const n=function(t,e){const n=new NT([],{},{},"",{},"primary",e,null,t.root,-1,{});return new PT("",new _T(n,[]))}(t,e),r=new EM([new nT("",{})]),i=new EM({}),a=new EM({}),o=new EM({}),s=new EM(""),l=new ET(r,i,o,s,a,"primary",e,n.root);return l.snapshot=n.root,new ST(new _T(l,[]),n)}class ET{constructor(t,e,n,r,i,a,o,s){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=a,this.component=o,this._futureSnapshot=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(W(t=>VP(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(W(t=>VP(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function MT(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign({},t.params,e.params),data:Object.assign({},t.data,e.data),resolve:Object.assign({},t.resolve,e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class NT{constructor(t,e,n,r,i,a,o,s,l,u,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=a,this.component=o,this.routeConfig=s,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=VP(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=VP(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class PT extends wT{constructor(t,e){super(e),this.url=t,TT(this,e)}toString(){return IT(this._root)}}function TT(t,e){e.value._routerState=t,e.children.forEach(e=>TT(t,e))}function IT(t){const e=t.children.length>0?` { ${t.children.map(IT).join(", ")} } `:"";return`${t.value}${e}`}function AT(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,KP(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),KP(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!KP(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),KP(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function RT(t,e){return KP(t.params,e.params)&&function(t,e){return rT(t,e)&&t.every((t,n)=>KP(t.parameters,e[n].parameters))}(t.url,e.url)&&!(!t.parent!=!e.parent)&&(!t.parent||RT(t.parent,e.parent))}function DT(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function FT(t,e,n,r,i){let a={};return r&&QP(r,(t,e)=>{a[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new tT(n.root===t?e:function t(e,n,r){const i={};return QP(e.children,(e,a)=>{i[a]=e===n?r:t(e,n,r)}),new eT(e.segments,i)}(n.root,t,e),a,i)}class zT{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&DT(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==YP(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class LT{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function BT(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:`${t}`}function VT(t,e,n){if(t||(t=new eT([],{})),0===t.segments.length&&t.hasChildren())return UT(t,e,n);const r=function(t,e,n){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return a;const e=t.segments[i],o=BT(n[r]),s=r<n.length-1?n[r+1]:null;if(i>0&&void 0===o)break;if(o&&s&&"object"==typeof s&&void 0===s.outlets){if(!HT(o,s,e))return a;r+=2}else{if(!HT(o,{},e))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new eT(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new eT(t.segments.slice(r.pathIndex),t.children),UT(e,0,i)}return r.match&&0===i.length?new eT(t.segments,{}):r.match&&!t.hasChildren()?WT(t,e,n):r.match?UT(t,0,i):WT(t,e,n)}function UT(t,e,n){if(0===n.length)return new eT(t.segments,{});{const r=function(t){return"object"!=typeof t[0]?{primary:t}:void 0===t[0].outlets?{primary:t}:t[0].outlets}(n),i={};return QP(r,(n,r)=>{null!==n&&(i[r]=VT(t.children[r],e,n))}),QP(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new eT(t.segments,i)}}function WT(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){const t=jT(n[i].outlets);return new eT(r,t)}if(0===i&&DT(n[0])){r.push(new nT(t.segments[e].path,n[0])),i++;continue}const a=BT(n[i]),o=i<n.length-1?n[i+1]:null;a&&o&&DT(o)?(r.push(new nT(a,qT(o))),i+=2):(r.push(new nT(a,{})),i++)}return new eT(r,{})}function jT(t){const e={};return QP(t,(t,n)=>{null!==t&&(e[n]=WT(new eT([],{}),0,t))}),e}function qT(t){const e={};return QP(t,(t,n)=>e[n]=`${t}`),e}function HT(t,e,n){return t==n.path&&KP(e,n.parameters)}class GT{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),AT(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=kT(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),QP(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=kT(t),i=t.value.component?n.children:e;QP(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=kT(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new FP(t.value.snapshot))}),t.children.length&&this.forwardEvent(new RP(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(AT(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),$T(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function $T(t){AT(t.value),t.children.forEach($T)}function KT(t){return"function"==typeof t}function XT(t){return t instanceof tT}class YT{constructor(t){this.segmentGroup=t||null}}class QT{constructor(t){this.urlTree=t}}function ZT(t){return new x(e=>e.error(new YT(t)))}function JT(t){return new x(e=>e.error(new QT(t)))}function tI(t){return new x(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class eI{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(Ft)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(W(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(ZM(t=>{if(t instanceof QT)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof YT)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(W(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(ZM(t=>{if(t instanceof YT)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new eT([],{primary:t}):t;return new tT(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(W(t=>new eT([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return OM({});const n=[],r=[],i={};return QP(t,(t,a)=>{const o=e(a,t).pipe(W(t=>i[a]=t));"primary"===a?n.push(o):r.push(o)}),OM.apply(null,n.concat(r)).pipe(RM(),QM(),W(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,a){return OM(...n).pipe(W(o=>this.expandSegmentAgainstRoute(t,e,n,o,r,i,a).pipe(ZM(t=>{if(t instanceof YT)return OM(null);throw t}))),RM(),iN(t=>!!t),ZM((t,n)=>{if(t instanceof NM||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return OM(new eT([],{}));throw new YT(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,a,o){return aI(r)!==a?ZT(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a):ZT(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?JT(i):this.lineralizeSegments(n,i).pipe($(n=>{const i=new eT(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,a){const{matched:o,consumedSegments:s,lastChild:l,positionalParamSegments:u}=nI(e,r,i);if(!o)return ZT(e);const c=this.applyRedirectCommands(s,r.redirectTo,u);return r.redirectTo.startsWith("/")?JT(c):this.lineralizeSegments(r,c).pipe($(r=>this.expandSegment(t,e,n,r.concat(i.slice(l)),a,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(W(t=>(n._loadedConfig=t,new eT(r,{})))):OM(new eT(r,{}));const{matched:i,consumedSegments:a,lastChild:o}=nI(e,n,r);if(!i)return ZT(e);const s=r.slice(o);return this.getChildConfig(t,n,r).pipe($(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:o}=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some(n=>iI(t,e,n)&&"primary"!==aI(n))}(t,n,r)?{segmentGroup:rI(new eT(e,function(t,e){const n={};n.primary=e;for(const r of t)""===r.path&&"primary"!==aI(r)&&(n[aI(r)]=new eT([],{}));return n}(r,new eT(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some(n=>iI(t,e,n))}(t,n,r)?{segmentGroup:rI(new eT(t.segments,function(t,e,n,r){const i={};for(const a of n)iI(t,e,a)&&!r[aI(a)]&&(i[aI(a)]=new eT([],{}));return Object.assign({},r,i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,a,s,r);return 0===o.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(W(t=>new eT(a,t))):0===r.length&&0===o.length?OM(new eT(a,{})):this.expandSegment(n,i,r,o,"primary",!0).pipe(W(t=>new eT(a.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?OM(new jP(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?OM(e._loadedConfig):function(t,e,n){const r=e.canLoad;return r&&0!==r.length?G(r).pipe(W(r=>{const i=t.get(r);let a;if(function(t){return t&&KT(t.canLoad)}(i))a=i.canLoad(e,n);else{if(!KT(i))throw new Error("Invalid CanLoad guard");a=i(e,n)}return ZP(a)})).pipe(RM(),(i=t=>!0===t,t=>t.lift(new aN(i,void 0,t)))):OM(!0);var i}(t.injector,e,n).pipe($(n=>n?this.configLoader.load(t.injector,e).pipe(W(t=>(e._loadedConfig=t,t))):function(t){return new x(e=>e.error(UP(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):OM(new jP([],t))}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return OM(n);if(r.numberOfChildren>1||!r.children.primary)return tI(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new tT(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return QP(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let a={};return QP(e.children,(e,i)=>{a[i]=this.createSegmentGroup(t,e,n,r)}),new eT(i,a)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function nI(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||WP)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function rI(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new eT(t.segments.concat(e.segments),e.children)}return t}function iI(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function aI(t){return t.outlet||"primary"}class oI{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class sI{constructor(t,e){this.component=t,this.route=e}}function lI(t,e,n){const r=t._root;return function t(e,n,r,i,a={canDeactivateChecks:[],canActivateChecks:[]}){const o=kT(n);return e.children.forEach(e=>{!function(e,n,r,i,a={canDeactivateChecks:[],canActivateChecks:[]}){const o=e.value,s=n?n.value:null,l=r?r.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const u=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!rT(t.url,e.url);case"pathParamsOrQueryParamsChange":return!rT(t.url,e.url)||!KP(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!RT(t,e)||!KP(t.queryParams,e.queryParams);case"paramsChange":default:return!RT(t,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);u?a.canActivateChecks.push(new oI(i)):(o.data=s.data,o._resolvedData=s._resolvedData),t(e,n,o.component?l?l.children:null:r,i,a),u&&a.canDeactivateChecks.push(new sI(l&&l.outlet&&l.outlet.component||null,s))}else s&&cI(n,l,a),a.canActivateChecks.push(new oI(i)),t(e,null,o.component?l?l.children:null:r,i,a)}(e,o[e.value.outlet],r,i.concat([e.value]),a),delete o[e.value.outlet]}),QP(o,(t,e)=>cI(t,r.getContext(e),a)),a}(r,e?e._root:null,n,[r.value])}function uI(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function cI(t,e,n){const r=kT(t),i=t.value;QP(r,(t,r)=>{cI(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new sI(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const hI=Symbol("INITIAL_VALUE");function pI(){return sN(t=>function(...t){let e=null,n=null;return N(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),H(t,n).lift(new TM(e))}(...t.map(t=>t.pipe(eN(1),function(...t){return e=>{let n=t[t.length-1];N(n)?t.pop():n=null;const r=t.length;return function(...t){return RM()(OM(...t))}(1!==r||n?r>0?H(t,n):kM(n):SM(t[0]),e)}}(hI)))).pipe(cN((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==hI)return t;if(r===hI&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||XT(r))return r}return t},t)},hI),DM(t=>t!==hI),W(t=>XT(t)?t:!0===t),eN(1)))}function dI(t,e){return null!==t&&e&&e(new DP(t)),OM(!0)}function fI(t,e){return null!==t&&e&&e(new AP(t)),OM(!0)}function mI(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?OM(r.map(r=>AM(()=>{const i=uI(r,e,n);let a;if(function(t){return t&&KT(t.canActivate)}(i))a=ZP(i.canActivate(e,t));else{if(!KT(i))throw new Error("Invalid CanActivate guard");a=ZP(i(e,t))}return a.pipe(iN())}))).pipe(pI()):OM(!0)}function gI(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>AM(()=>OM(e.guards.map(i=>{const a=uI(i,e.node,n);let o;if(function(t){return t&&KT(t.canActivateChild)}(a))o=ZP(a.canActivateChild(r,t));else{if(!KT(a))throw new Error("Invalid CanActivateChild guard");o=ZP(a(r,t))}return o.pipe(iN())})).pipe(pI())));return OM(i).pipe(pI())}class yI{}class vI{constructor(t,e,n,r,i,a){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=a}recognize(){try{const t=xI(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new NT([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new _T(n,e),i=new PT(this.url,r);return this.inheritParamsAndData(i._root),OM(i)}catch(bC){return new x(e=>e.error(bC))}}inheritParamsAndData(t){const e=t.value,n=MT(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=iT(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};t.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(n),n.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const i of t)try{return this.processSegmentAgainstRoute(i,e,n,r)}catch(bC){if(!(bC instanceof yI))throw bC}if(this.noLeftoversInUrl(e,n,r))return[];throw new yI}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new yI;if((t.outlet||"primary")!==r)throw new yI;let i,a=[],o=[];if("**"===t.path){const a=n.length>0?YP(n).parameters:{};i=new NT(n,a,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,kI(t),r,t.component,t,bI(e),wI(e)+n.length,SI(t))}else{const s=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new yI;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||WP)(n,t,e);if(!r)throw new yI;const i={};QP(r.posParams,(t,e)=>{i[e]=t.path});const a=r.consumed.length>0?Object.assign({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:a}}(e,t,n);a=s.consumedSegments,o=n.slice(s.lastChild),i=new NT(a,s.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,kI(t),r,t.component,t,bI(e),wI(e)+a.length,SI(t))}const s=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:u}=xI(e,a,o,s,this.relativeLinkResolution);if(0===u.length&&l.hasChildren()){const t=this.processChildren(s,l);return[new _T(i,t)]}if(0===s.length&&0===u.length)return[new _T(i,[])];const c=this.processSegment(s,l,u,"primary");return[new _T(i,c)]}}function bI(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function wI(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function xI(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some(n=>CI(t,e,n)&&"primary"!==_I(n))}(t,n,r)){const i=new eT(e,function(t,e,n,r){const i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const a of n)if(""===a.path&&"primary"!==_I(a)){const n=new eT([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[_I(a)]=n}return i}(t,e,r,new eT(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>CI(t,e,n))}(t,n,r)){const a=new eT(t.segments,function(t,e,n,r,i,a){const o={};for(const s of r)if(CI(t,n,s)&&!i[_I(s)]){const n=new eT([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===a?t.segments.length:e.length,o[_I(s)]=n}return Object.assign({},i,o)}(t,e,n,r,t.children,i));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:n}}const a=new eT(t.segments,t.children);return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:n}}function CI(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function _I(t){return t.outlet||"primary"}function kI(t){return t.data||{}}function SI(t){return t.resolve||{}}function OI(t,e,n,r){const i=uI(t,e,r);return ZP(i.resolve?i.resolve(e,n):i(e,n))}function EI(t){return function(e){return e.pipe(sN(e=>{const n=t(e);return n?G(n).pipe(W(()=>e)):G([e])}))}}class MI{}class NI{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}const PI=new St("ROUTES");class TI{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(W(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new jP(XP(r.injector.get(PI)).map($P),r)}))}loadModuleFactory(t){return"string"==typeof t?G(this.loader.load(t)):ZP(t()).pipe($(t=>t instanceof zt?OM(t):G(this.compiler.compileModuleAsync(t))))}}class II{}class AI{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function RI(t){throw t}function DI(t,e,n){return e.parse("/")}function FI(t,e){return OM(null)}class zI{constructor(t,e,n,r,i,a,o,s){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=s,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new E,this.errorHandler=RI,this.malformedUriErrorHandler=DI,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:FI,afterPreactivation:FI},this.urlHandlingStrategy=new AI,this.routeReuseStrategy=new NI,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(Ft),this.console=i.get(ki);const l=i.get(Wi);this.isNgZoneEnabled=l instanceof Wi,this.resetConfig(s),this.currentUrlTree=new tT(new eT([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new TI(a,o,t=>this.triggerEvent(new TP(t)),t=>this.triggerEvent(new IP(t))),this.routerState=OT(this.currentUrlTree,this.rootComponentType),this.transitions=new EM({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(DM(t=>0!==t.id),W(t=>Object.assign({},t,{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),sN(t=>{let n=!1,r=!1;return OM(t).pipe(jM(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign({},this.lastSuccessfulNavigation,{previousNavigation:null}):null}}),sN(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return OM(t).pipe(sN(t=>{const n=this.transitions.getValue();return e.next(new CP(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?_M:[t]}),sN(t=>Promise.resolve(t)),(r=this.ngModule.injector,i=this.configLoader,a=this.urlSerializer,o=this.config,function(t){return t.pipe(sN(t=>function(t,e,n,r,i){return new eI(t,e,n,r,i).apply()}(r,i,a,t.extractedUrl,o).pipe(W(e=>Object.assign({},t,{urlAfterRedirects:e})))))}),jM(t=>{this.currentNavigation=Object.assign({},this.currentNavigation,{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(a){return a.pipe($(a=>function(t,e,n,r,i="emptyOnly",a="legacy"){return new vI(t,e,n,r,i,a).recognize()}(t,e,a.urlAfterRedirects,n(a.urlAfterRedirects),r,i).pipe(W(t=>Object.assign({},a,{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),jM(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),jM(t=>{const n=new OP(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,i,a,o;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:a,extras:o}=t,s=new CP(n,this.serializeUrl(r),i,a);e.next(s);const l=OT(r,this.rootComponentType).snapshot;return OM(Object.assign({},t,{targetSnapshot:l,urlAfterRedirects:r,extras:Object.assign({},o,{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),_M}),EI(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:a,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!a,replaceUrl:!!o})}),jM(t=>{const e=new EP(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),W(t=>Object.assign({},t,{guards:lI(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe($(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:o}}=n;return 0===o.length&&0===a.length?OM(Object.assign({},n,{guardsResult:!0})):function(t,e,n,r){return G(t).pipe($(t=>function(t,e,n,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?OM(a.map(a=>{const o=uI(a,e,i);let s;if(function(t){return t&&KT(t.canDeactivate)}(o))s=ZP(o.canDeactivate(t,e,n,r));else{if(!KT(o))throw new Error("Invalid CanDeactivate guard");s=ZP(o(t,e,n,r))}return s.pipe(iN())})).pipe(pI()):OM(!0)}(t.component,t.route,n,e,r)),iN(t=>!0!==t,!0))}(o,r,i,t).pipe($(n=>n&&"boolean"==typeof n?function(t,e,n,r){return G(e).pipe(dN(e=>G([fI(e.route.parent,r),dI(e.route,r),gI(t,e.path,n),mI(t,e.route,n)]).pipe(RM(),iN(t=>!0!==t,!0))),iN(t=>!0!==t,!0))}(r,a,t,e):OM(n)),W(t=>Object.assign({},n,{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),jM(t=>{if(XT(t.guardsResult)){const e=UP(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),jM(t=>{const e=new MP(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),DM(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new kP(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),EI(t=>{if(t.guards.canActivateChecks.length)return OM(t).pipe(jM(t=>{const e=new NP(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(e=this.paramsInheritanceStrategy,n=this.ngModule.injector,function(t){return t.pipe($(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;return i.length?G(i).pipe(dN(t=>function(t,e,n,r){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return OM({});if(1===i.length){const a=i[0];return OI(t[a],e,n,r).pipe(W(t=>({[a]:t})))}const a={};return G(i).pipe($(i=>OI(t[i],e,n,r).pipe(W(t=>(a[i]=t,t))))).pipe(QM(),W(()=>a))}(t._resolve,t,e,r).pipe(W(e=>(t._resolvedData=e,t.data=Object.assign({},t.data,MT(t,n).resolve),null)))}(t.route,r,e,n)),function(t,e){return arguments.length>=2?function(n){return b(cN(t,e),VM(1),KM(e))(n)}:function(e){return b(cN((e,n,r)=>t(e,n,r+1)),VM(1))(e)}}((t,e)=>t),W(e=>t)):OM(t)}))}),jM(t=>{const e=new PP(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}));var e,n}),EI(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:a,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!a,replaceUrl:!!o})}),W(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const a=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new _T(i,a)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new ET(new EM((i=n.value).url),new EM(i.params),new EM(i.queryParams),new EM(i.fragment),new EM(i.data),i.outlet,i.component,i),a=n.children.map(n=>t(e,n));return new _T(r,a)}}var i}(t,e._root,n?n._root:void 0);return new ST(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign({},t,{targetRouterState:e})}),jM(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(a=this.rootContexts,o=this.routeReuseStrategy,s=t=>this.triggerEvent(t),W(t=>(new GT(o,t.targetRouterState,t.currentRouterState,s).activate(a),t))),jM({next(){n=!0},complete(){n=!0}}),(i=()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new kP(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null},t=>t.lift(new fN(i))),ZM(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=XT(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new kP(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),t.resolve(!1),r&&this.navigateByUrl(n.url)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new SP(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(jl){t.reject(jl)}}var i;return _M}));var i,a,o,s}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign({},this.getTransition(),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){qP(t),this.config=t.map($P),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:a,queryParamsHandling:o,preserveFragment:s}=e;Kt()&&a&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const l=n||this.routerState.root,u=s?this.currentUrlTree.fragment:i;let c=null;if(o)switch(o){case"merge":c=Object.assign({},this.currentUrlTree.queryParams,r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=a?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return FT(e.root,e.root,e,r,i);const a=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new zT(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return QP(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new zT(n,e,r)}(n);if(a.toRoot())return FT(e.root,new eT([],{}),e,r,i);const o=function(t,e,n){if(t.isAbsolute)return new LT(e.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new LT(n.snapshot._urlSegment,!0,0);const r=DT(t.commands[0])?0:1;return function(t,e,n){let r=t,i=e,a=n;for(;a>i;){if(a-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new LT(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(a,e,t),s=o.processChildren?UT(o.segmentGroup,o.index,a.commands):VT(o.segmentGroup,o.index,a.commands);return FT(o.segmentGroup,s,e,r,i)}(l,this.currentUrlTree,t,c,u)}navigateByUrl(t,e={skipLocationChange:!1}){Kt()&&this.isNgZoneEnabled&&!Wi.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=XT(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(bC){e=this.malformedUriErrorHandler(bC,this.urlSerializer,t)}return e}isActive(t,e){if(XT(t))return JP(this.currentUrlTree,t,e);const n=this.parseUrl(t);return JP(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new _P(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r){const i=this.getTransition();if(i&&"imperative"!==e&&"imperative"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"hashchange"==e&&"popstate"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(i&&"popstate"==e&&"hashchange"===i.source&&i.rawUrl.toString()===t.toString())return Promise.resolve(!0);let a=null,o=null;const s=new Promise((t,e)=>{a=t,o=e}),l=++this.navigationId;return this.setTransition({id:l,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:a,reject:o,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign({},r,{navigationId:n})):this.location.go(i,"",Object.assign({},r,{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}class LI{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new BI,this.attachRef=null}}class BI{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new LI,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class VI{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new di,this.deactivateEvents=new di,this.name=r||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new UI(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}class UI{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===ET?this.route:t===BI?this.childContexts:this.parent.get(t,e)}}class WI{}class jI{preload(t,e){return e().pipe(ZM(()=>OM(null)))}}class qI{preload(t,e){return OM(null)}}class HI{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new TI(e,n,e=>t.triggerEvent(new TP(e)),e=>t.triggerEvent(new IP(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(DM(t=>t instanceof _P),dN(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ft);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return G(n).pipe(Q(),W(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe($(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}class GI{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof CP?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof _P&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof zP&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new zP(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}const $I=new St("ROUTER_CONFIGURATION"),KI=new St("ROUTER_FORROOT_GUARD"),XI=[rM,{provide:aT,useClass:oT},{provide:zI,useFactory:nA,deps:[oa,aT,BI,rM,Oe,la,Ti,PI,$I,[II,new lt],[MI,new lt]]},BI,{provide:ET,useFactory:rA,deps:[zI]},{provide:la,useClass:ha},HI,qI,jI,{provide:$I,useValue:{enableTracing:!1}}];function YI(){return new ea("Router",zI)}class QI{constructor(t,e){}static forRoot(t,e){return{ngModule:QI,providers:[XI,eA(t),{provide:KI,useFactory:tA,deps:[[zI,new lt,new ct]]},{provide:$I,useValue:e||{}},{provide:eM,useFactory:JI,deps:[JE,[new st(nM),new lt],$I]},{provide:GI,useFactory:ZI,deps:[zI,xM,$I]},{provide:WI,useExisting:e&&e.preloadingStrategy?e.preloadingStrategy:qI},{provide:ea,multi:!0,useFactory:YI},[iA,{provide:gi,multi:!0,useFactory:aA,deps:[iA]},{provide:sA,useFactory:oA,deps:[iA]},{provide:_i,multi:!0,useExisting:sA}]]}}static forChild(t){return{ngModule:QI,providers:[eA(t)]}}}function ZI(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new GI(t,e,n)}function JI(t,e,n={}){return n.useHash?new aM(t,e):new oM(t,e)}function tA(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function eA(t){return[{provide:Re,multi:!0,useValue:t},{provide:PI,multi:!0,useValue:t}]}function nA(t,e,n,r,i,a,o,s,l={},u,c){const h=new zI(null,e,n,r,i,a,o,XP(s));if(u&&(h.urlHandlingStrategy=u),c&&(h.routeReuseStrategy=c),l.errorHandler&&(h.errorHandler=l.errorHandler),l.malformedUriErrorHandler&&(h.malformedUriErrorHandler=l.malformedUriErrorHandler),l.enableTracing){const t=yN();h.events.subscribe(e=>{t.logGroup(`Router Event: ${e.constructor.name}`),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return l.onSameUrlNavigation&&(h.onSameUrlNavigation=l.onSameUrlNavigation),l.paramsInheritanceStrategy&&(h.paramsInheritanceStrategy=l.paramsInheritanceStrategy),l.urlUpdateStrategy&&(h.urlUpdateStrategy=l.urlUpdateStrategy),l.relativeLinkResolution&&(h.relativeLinkResolution=l.relativeLinkResolution),h}function rA(t){return t.routerState.root}class iA{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new E}appInitializer(){return this.injector.get(tM,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(zI),r=this.injector.get($I);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?OM(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get($I),n=this.injector.get(HI),r=this.injector.get(GI),i=this.injector.get(zI),a=this.injector.get(oa);t===a.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}function aA(t){return t.appInitializer.bind(t)}function oA(t){return t.bootstrapListener.bind(t)}const sA=new St("Router Initializer");var lA=Wn({encapsulation:2,styles:[],data:{}});function uA(t){return Va(0,[(t()(),Oa(0,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),Xr(1,212992,null,0,VI,[BI,On,Xe,[8,null],Ce],null,null)],(function(t,e){t(e,1,0)}),null)}function cA(t){return Va(0,[(t()(),Oa(0,0,null,null,1,"ng-component",[],null,null,null,uA,lA)),Xr(1,49152,null,0,LP,[],null,null)],null,null)}var hA=Sr("ng-component",LP,cA,{},{},[]);class pA{}class dA{}class fA{constructor(t){this._animationMode=t}}class mA{}const gA=new St("cdk-dir-doc",{providedIn:"root",factory:function(){return At(vM)}});let yA=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new di,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.ngInjectableDef=dt({factory:function(){return new t(It(gA,8))},token:t,providedIn:"root"}),t})();class vA{}const bA=new sn("8.2.3");let wA;try{wA="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(Ip){wA=!1}class xA{}class CA extends p{constructor(t,e){super()}schedule(t,e=0){return this}}class _A extends CA{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(bC){n=!0,r=!!bC&&bC||new Error(bC)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let kA=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class SA extends kA{constructor(t,e=kA.now){super(t,()=>SA.delegate&&SA.delegate!==this?SA.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return SA.delegate&&SA.delegate!==this?SA.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const OA=new sn("8.2.3"),EA=new St("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});class MA{constructor(t,e){this._sanityChecksEnabled=t,this._hammerLoader=e,this._hasDoneGlobalChecks=!1,this._hasCheckedHammer=!1,this._document="object"==typeof document&&document?document:null,this._window="object"==typeof window&&window?window:null,this._areChecksEnabled()&&!this._hasDoneGlobalChecks&&(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_areChecksEnabled(){return this._sanityChecksEnabled&&Kt()&&!this._isTestEnv()}_isTestEnv(){const t=this._window;return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){this._document&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._document||!this._document.body||"function"!=typeof getComputedStyle)return;const t=this._document.createElement("div");t.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(t);const e=getComputedStyle(t);e&&"none"!==e.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),this._document.body.removeChild(t)}_checkCdkVersionMatch(){OA.full!==bA.full&&console.warn("The Angular Material version ("+OA.full+") does not match the Angular CDK version ("+bA.full+").\nPlease ensure the versions of these two packages exactly match.")}_checkHammerIsAvailable(){!this._hasCheckedHammer&&this._window&&(!this._areChecksEnabled()||this._window.Hammer||this._hammerLoader||console.warn("Could not find HammerJS. Certain Angular Material components may not work correctly."),this._hasCheckedHammer=!0)}}let NA;try{NA="undefined"!=typeof Intl}catch(Ip){NA=!1}class PA{}class TA{}function IA(t,e=null){return{type:2,steps:t,options:e}}function AA(t){return{type:6,styles:t,offset:null}}function RA(t){Promise.resolve(null).then(t)}class DA{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){RA(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){}getPosition(){return 0}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class FA{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?RA(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){let t=0;return this.players.forEach(e=>{const n=e.getPosition();t=Math.min(n,t)}),t}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function zA(){return"undefined"!=typeof process}function LA(t){switch(t.length){case 0:return new DA;case 1:return t[0];default:return new FA(t)}}function BA(t,e,n,r,i={},a={}){const o=[],s=[];let l=-1,u=null;if(r.forEach(t=>{const n=t.offset,r=n==l,c=r&&u||{};Object.keys(t).forEach(n=>{let r=n,s=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,o),s){case"!":s=i[n];break;case"*":s=a[n];break;default:s=e.normalizeStyleValue(n,r,s,o)}c[r]=s}),r||s.push(c),u=c,l=n}),o.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${o.join(t)}`)}return s}function VA(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&UA(n,"start",t)));break;case"done":t.onDone(()=>r(n&&UA(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&UA(n,"destroy",t)))}}function UA(t,e,n){const r=n.totalTime,i=WA(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),a=t._data;return null!=a&&(i._data=a),i}function WA(t,e,n,r,i="",a=0,o){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function jA(t,e,n){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=n)):(r=t[e],r||(r=t[e]=n)),r}function qA(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let HA=(t,e)=>!1,GA=(t,e)=>!1,$A=(t,e,n)=>[];const KA=zA();(KA||"undefined"!=typeof Element)&&(HA=(t,e)=>t.contains(e),GA=(()=>{if(KA||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):GA}})(),$A=(t,e,n)=>{let r=[];if(n)r.push(...t.querySelectorAll(e));else{const n=t.querySelector(e);n&&r.push(n)}return r});let XA=null,YA=!1;function QA(t){XA||(XA=("undefined"!=typeof document?document.body:null)||{},YA=!!XA.style&&"WebkitAppearance"in XA.style);let e=!0;return XA.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in XA.style,!e&&YA)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in XA.style),e}const ZA=GA,JA=HA,tR=$A;function eR(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}class nR{validateStyleProperty(t){return QA(t)}matchesElement(t,e){return ZA(t,e)}containsElement(t,e){return JA(t,e)}query(t,e,n){return tR(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,a=[],o){return new DA(n,r)}}let rR=(()=>{class t{}return t.NOOP=new nR,t})();function iR(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:aR(parseFloat(e[1]),e[2])}function aR(t,e){switch(e){case"s":return 1e3*t;default:return t}}function oR(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,a="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=aR(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(i=aR(parseFloat(o),n[4]));const s=n[5];s&&(a=s)}else r=t;if(!n){let n=!1,a=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(a,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:a}}(t,e,n)}function sR(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function lR(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else sR(t,n);return n}function uR(t,e,n){return n?e+":"+n+";":""}function cR(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=uR(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=uR(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function hR(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=bR(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),zA()&&cR(t))}function pR(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=bR(e);t.style[n]=""}),zA()&&cR(t))}function dR(t){return Array.isArray(t)?1==t.length?t[0]:IA(t):t}const fR=new RegExp("{{\\s*(.+?)\\s*}}","g");function mR(t){let e=[];if("string"==typeof t){const n=t.toString();let r;for(;r=fR.exec(n);)e.push(r[1]);fR.lastIndex=0}return e}function gR(t,e,n){const r=t.toString(),i=r.replace(fR,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push(`Please provide a value for the animation param ${r}`),i=""),i.toString()});return i==r?t:i}function yR(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const vR=/-+([a-z0-9])/g;function bR(t){return t.replace(vR,(...t)=>t[1].toUpperCase())}function wR(t,e){return 0===t||0===e}function xR(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let a=e[0],o=[];if(r.forEach(t=>{a.hasOwnProperty(t)||o.push(t),a[t]=n[t]}),o.length)for(var i=1;i<e.length;i++){let n=e[i];o.forEach((function(e){n[e]=_R(t,e)}))}}return e}function CR(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function _R(t,e){return window.getComputedStyle(t)[e]}function kR(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],a=r[2],o=r[3];e.push(ER(i,o)),"<"!=a[0]||"*"==i&&"*"==o||e.push(ER(o,i))}(t,n,e)):n.push(t),n}const SR=new Set(["true","1"]),OR=new Set(["false","0"]);function ER(t,e){const n=SR.has(t)||OR.has(t),r=SR.has(e)||OR.has(e);return(i,a)=>{let o="*"==t||t==i,s="*"==e||e==a;return!o&&n&&"boolean"==typeof i&&(o=i?SR.has(t):OR.has(t)),!s&&r&&"boolean"==typeof a&&(s=a?SR.has(e):OR.has(e)),o&&s}}const MR=new RegExp("s*:selfs*,?","g");function NR(t,e,n){return new PR(t).build(e,n)}class PR{constructor(t){this._driver=t}build(t,e){const n=new TR(e);return this._resetContextStyleTimingState(n),CR(this,dR(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],a=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,a.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:a,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,a=r||{};if(n.styles.forEach(t=>{if(IR(t)){const e=t;Object.keys(e).forEach(t=>{mR(e[t]).forEach(t=>{a.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=yR(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=CR(this,dR(t.animation),e);return{type:1,matchers:kR(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:AR(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>CR(this,t,e)),options:AR(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=CR(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:AR(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return RR(oR(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=RR(0,0,"");return t.dynamic=!0,t.strValue=r,t}return n=n||oR(r,e),RR(n.duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:AA({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,a=!1;if(!i){a=!0;const t={};n.easing&&(t.easing=n.easing),i=AA(t)}e.currentTime+=n.duration+n.delay;const o=this.visitStyle(i,e);o.isEmptyStep=a,r=o}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?"*"==t?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(IR(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const a=e.collectedStyles[e.currentQuerySelector],o=a[n];let s=!0;o&&(i!=r&&i>=o.startTime&&r<=o.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),s=!1),i=o.startTime),s&&(a[n]={startTime:i,endTime:r}),e.options&&function(t,e,n){const r=e.params||{},i=mR(t);i.length&&i.forEach(t=>{r.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let a=!1,o=!1,s=0;const l=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let l=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(IR(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(IR(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),u=0;return null!=l&&(r++,u=n.offset=l),o=o||u<0||u>1,a=a||u<s,s=u,i.push(u),n});o&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),a&&e.errors.push("Please ensure that all keyframe offsets are in order");const u=t.steps.length;let c=0;r>0&&r<u?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(c=1/(u-1));const h=u-1,p=e.currentTime,d=e.currentAnimateTimings,f=d.duration;return l.forEach((t,r)=>{const a=c>0?r==h?1:c*r:i[r],o=a*f;e.currentTime=p+d.delay+o,d.duration=o,this._validateStyleAst(t,e),t.offset=a,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:CR(this,dR(t.animation),e),options:AR(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:AR(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:AR(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,a]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(MR,"")),[t=t.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,".ng-animating"),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,jA(e.collectedStyles,e.currentQuerySelector,{});const o=CR(this,dR(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:o,originalSelector:t.selector,options:AR(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:oR(t.timings,e.errors,!0);return{type:12,animation:CR(this,dR(t.animation),e),timings:n,options:null}}}class TR{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function IR(t){return!Array.isArray(t)&&"object"==typeof t}function AR(t){var e;return t?(t=sR(t)).params&&(t.params=(e=t.params)?sR(e):null):t={},t}function RR(t,e,n){return{duration:t,delay:e,easing:n}}function DR(t,e,n,r,i,a,o=null,s=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}class FR{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const zR=new RegExp(":enter","g"),LR=new RegExp(":leave","g");function BR(t,e,n,r,i,a={},o={},s,l,u=[]){return(new VR).buildKeyframes(t,e,n,r,i,a,o,s,l,u)}class VR{buildKeyframes(t,e,n,r,i,a,o,s,l,u=[]){l=l||new FR;const c=new WR(t,e,l,r,i,u,[]);c.options=s,c.currentTimeline.setStyles([a],null,c.errors,s),CR(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(o).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([o],null,c.errors,s)}return h.length?h.map(t=>t.buildKeyframes()):[DR(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&e.transformIntoNewTimeline(a)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?iR(n.duration):null,a=null!=n.delay?iR(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,a);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),CR(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&(r=e.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=UR);const t=iR(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>CR(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?iR(t.options.delay):0;t.steps.forEach(a=>{const o=e.createSubContext(t.options);i&&o.delayNextStep(i),CR(this,a,o),r=Math.max(r,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return oR(e.params?gR(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,a=e.createSubContext().currentTimeline;a.easing=n.easing,t.styles.forEach(t=>{a.forwardTime((t.offset||0)*i),a.setStyles(t.styles,t.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?iR(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=UR);let a=n;const o=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=o.length;let s=null;o.forEach((n,r)=>{e.currentQueryIndex=r;const o=e.createSubContext(t.options,n);i&&o.delayNextStep(i),n===e.element&&(s=o.currentTimeline),CR(this,t.animation,o),o.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,o.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(a),s&&(e.currentTimeline.mergeTimelineCollectedStyles(s),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,a=Math.abs(i.duration),o=a*(e.currentQueryTotal-1);let s=a*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}const l=e.currentTimeline;s&&l.delayNextStep(s);const u=l.currentTime;CR(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-u+(r.startTime-n.currentTimeline.startTime)}}const UR={};class WR{constructor(t,e,n,r,i,a,o,s){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=a,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=UR,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=s||new jR(this._driver,e,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=iR(n.duration)),null!=n.delay&&(r.delay=iR(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=gR(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new WR(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=UR,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new qR(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,a){let o=[];if(r&&o.push(this.element),t.length>0){t=(t=t.replace(zR,"."+this._enterClassName)).replace(LR,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),o.push(...e)}return i||0!=o.length||a.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),o}}class jR{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new jR(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||"*",this._currentKeyframe[t]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},a=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e),r.forEach(t=>{n[t]="*"})):lR(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(a).forEach(t=>{const e=gR(a[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:"*"),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,a)=>{const o=lR(i,!0);Object.keys(o).forEach(n=>{const r=o[n];"!"==r?t.add(n):"*"==r&&e.add(n)}),n||(o.offset=a/this.duration),r.push(o)});const i=t.size?yR(t.values()):[],a=e.size?yR(e.values()):[];if(n){const t=r[0],e=sR(t);t.offset=0,e.offset=1,r=[t,e]}return DR(this.element,r,i,a,this.duration,this.startTime,this.easing,!1)}}class qR extends jR{constructor(t,e,n,r,i,a,o=!1){super(t,e,a.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=o,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],a=n+e,o=e/a,s=lR(t[0],!1);s.offset=0,i.push(s);const l=lR(t[0],!1);l.offset=HR(o),i.push(l);const u=t.length-1;for(let r=1;r<=u;r++){let o=lR(t[r],!1);o.offset=HR((e+o.offset*n)/a),i.push(o)}n=a,e=0,r="",t=i}return DR(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function HR(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class GR{}class $R extends GR{normalizePropertyName(t,e){return bR(t)}normalizeStyleValue(t,e,n,r){let i="";const a=n.toString().trim();if(KR[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return a+i}}const KR=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function XR(t,e,n,r,i,a,o,s,l,u,c,h,p){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:l,preStyleProps:u,postStyleProps:c,totalTime:h,errors:p}}const YR={};class QR{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],a=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):a}build(t,e,n,r,i,a,o,s,l,u){const c=[],h=this.ast.options&&this.ast.options.params||YR,p=this.buildStyles(n,o&&o.params||YR,c),d=s&&s.params||YR,f=this.buildStyles(r,d,c),m=new Set,g=new Map,y=new Map,v="void"===r,b={params:Object.assign({},h,d)},w=u?[]:BR(t,e,this.ast.animation,i,a,p,f,b,l,c);let x=0;if(w.forEach(t=>{x=Math.max(t.duration+t.delay,x)}),c.length)return XR(e,this._triggerName,n,r,v,p,f,[],[],g,y,x,c);w.forEach(t=>{const n=t.element,r=jA(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=jA(y,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const C=yR(m.values());return XR(e,this._triggerName,n,r,v,p,f,w,C,g,y,x)}}class ZR{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=sR(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let a=i[t];a.length>1&&(a=gR(a,r,e)),n[t]=a})}}),n}}class JR{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new ZR(t.style,t.options&&t.options.params||{})}),tD(this.states,"true","1"),tD(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new QR(t,e,this.states))}),this.fallbackTransition=new QR(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function tD(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const eD=new FR;class nD{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=NR(this._driver,e,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=BA(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let a;const o=new Map;if(i?(a=BR(this._driver,e,i,"ng-enter","ng-leave",{},{},n,eD,r),a.forEach(t=>{const e=jA(o,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),a=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);o.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,"*")})});const s=LA(a.map(t=>{const e=o.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=s,s.onDestroy(()=>this.destroy(t)),this.players.push(s),s}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error(`Unable to find the timeline player referenced by ${t}`);return e}listen(t,e,n,r){const i=WA(e,"","","");return VA(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const rD=[],iD={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},aD={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class oD{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(r=n?t.value:t)?r:null,n){const e=sR(t);delete e.value,this.options=e}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const sD=new oD("void");class lD{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,mD(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const a=jA(this._elementListeners,t,[]),o={name:e,phase:n,callback:r};a.push(o);const s=jA(this._engine.statesByElement,t,{});return s.hasOwnProperty(e)||(mD(t,"ng-trigger"),mD(t,"ng-trigger-"+e),s[e]=sD),()=>{this._engine.afterFlush(()=>{const t=a.indexOf(o);t>=0&&a.splice(t,1),this._triggers[e]||delete s[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),a=new cD(this.id,e,t);let o=this._engine.statesByElement.get(t);o||(mD(t,"ng-trigger"),mD(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,o={}));let s=o[e];const l=new oD(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&s&&l.absorbOptions(s.options),o[e]=l,s||(s=sD),"void"!==l.value&&s.value===l.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(s.params,l.params)){const e=[],n=i.matchStyles(s.value,s.params,e),r=i.matchStyles(l.value,l.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{pR(t,n),hR(t,r)})}return}const u=jA(this._engine.playersByElement,t,[]);u.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=i.matchTransition(s.value,l.value,t,l.params),h=!1;if(!c){if(!r)return;c=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:s,toState:l,player:a,isFallbackTransition:h}),h||(mD(t,"ng-animate-queued"),a.onStart(()=>{gD(t,"ng-animate-queued")})),a.onDone(()=>{let e=this.players.indexOf(a);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(a);t>=0&&n.splice(t,1)}}),this.players.push(a),u.push(a),a}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e,n=!1){this._engine.driver.query(t,".ng-trigger",!0).forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)})}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const a=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,"void",r);n&&a.push(n)}}),a.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&LA(a).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const i=this._triggers[r].fallbackTransition,a=this._engine.statesByElement.get(t)[r]||sD,o=new oD("void"),s=new cD(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:i,fromState:a,toState:o,player:s,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e,!0),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}this.prepareLeaveAnimationListeners(t),r?n.markElementAsRemoved(this.id,t,!1,e):(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}insertNode(t,e){mD(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,a=this._elementListeners.get(i);a&&a.forEach(e=>{if(e.name==n.triggerName){const r=WA(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,VA(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class uD{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new lD(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(hD(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!hD(e))return;const i=e.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),mD(t,"ng-animate-disabled")):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),gD(t,"ng-animate-disabled"))}removeNode(t,e,n,r){if(hD(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return hD(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,".ng-trigger",!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,".ng-animating",!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return LA(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=iD,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,".ng-animate-disabled")&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)mD(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?LA(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${t.join("\n")}`)}_flushAnimations(t,e){const n=new FR,r=[],i=new Map,a=[],o=new Map,s=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(t=>{u.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)u.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),p=fD(h,this.collectedEnterElements),d=new Map;let f=0;p.forEach((t,e)=>{const n="ng-enter"+f++;d.set(e,n),t.forEach(t=>mD(t,n))});const m=[],g=new Set,y=new Set;for(let P=0;P<this.collectedLeaveElements.length;P++){const t=this.collectedLeaveElements[P],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):y.add(t))}const v=new Map,b=fD(h,Array.from(g));b.forEach((t,e)=>{const n="ng-leave"+f++;v.set(e,n),t.forEach(t=>mD(t,n))}),t.push(()=>{p.forEach((t,e)=>{const n=d.get(e);t.forEach(t=>gD(t,n))}),b.forEach((t,e)=>{const n=v.get(e);t.forEach(t=>gD(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const w=[],x=[];for(let P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(w.push(e),this.collectedEnterElements.length){const t=i.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const u=!c||!this.driver.containsElement(c,i),h=v.get(i),p=d.get(i),f=this._buildInstruction(t,n,p,h,u);if(!f.errors||!f.errors.length)return u?(e.onStart(()=>pR(i,f.fromStyles)),e.onDestroy(()=>hR(i,f.toStyles)),void r.push(e)):t.isFallbackTransition?(e.onStart(()=>pR(i,f.fromStyles)),e.onDestroy(()=>hR(i,f.toStyles)),void r.push(e)):(f.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,f.timelines),a.push({instruction:f,player:e,element:i}),f.queriedElements.forEach(t=>jA(o,t,[]).push(e)),f.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=s.get(e);t||s.set(e,t=new Set),n.forEach(e=>t.add(e))}}),void f.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=l.get(e);r||l.set(e,r=new Set),n.forEach(t=>r.add(t))}));x.push(f)});if(x.length){const t=[];x.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),w.forEach(t=>t.destroy()),this.reportError(t)}const C=new Map,_=new Map;a.forEach(t=>{const e=t.element;n.has(e)&&(_.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,C))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{jA(C,e,[]).push(t),t.destroy()})});const k=m.filter(t=>vD(t,s,l)),S=new Map;dD(S,this.driver,y,l,"*").forEach(t=>{vD(t,s,l)&&k.push(t)});const O=new Map;p.forEach((t,e)=>{dD(O,this.driver,new Set(t),s,"!")}),k.forEach(t=>{const e=S.get(t),n=O.get(t);S.set(t,Object.assign({},e,n))});const E=[],M=[],N={};a.forEach(t=>{const{element:e,player:a,instruction:o}=t;if(n.has(e)){if(u.has(e))return a.onDestroy(()=>hR(e,o.toStyles)),a.disabled=!0,a.overrideTotalTime(o.totalTime),void r.push(a);let t=N;if(_.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=_.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>_.set(e,t))}const n=this._buildAnimation(a.namespaceId,o,C,i,O,S);if(a.setRealPlayer(n),t===N)E.push(a);else{const e=this.playersByElement.get(t);e&&e.length&&(a.parentPlayer=LA(e)),r.push(a)}}else pR(e,o.fromStyles),a.onDestroy(()=>hR(e,o.toStyles)),M.push(a),u.has(e)&&r.push(a)}),M.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=LA(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let P=0;P<m.length;P++){const t=m[P],e=t.__ng_removed;if(gD(t,"ng-leave"),e&&e.hasAnimation)continue;let n=[];if(o.size){let e=o.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,".ng-animating",!0);for(let t=0;t<r.length;t++){let e=o.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?yD(this,t,r):this.processLeaveNode(t)}return m.length=0,E.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),E}elementContainsData(t,e){let n=!1;const r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let a=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(a=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||"void"==i;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&a.push(e)})}}return(n||r)&&(a=a.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),a}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,a=e.isRemovalTransition?void 0:e.triggerName;for(const o of e.timelines){const t=o.element,s=t!==r,l=jA(n,t,[]);this._getPreviousPlayers(t,s,i,a,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),l.push(t)})}pR(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,a){const o=e.triggerName,s=e.element,l=[],u=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;u.add(h);const p=h.__ng_removed;if(p&&p.removedBeforeQueried)return new DA(e.duration,e.delay);const d=h!==s,f=function(t){const e=[];return function t(e,n){for(let r=0;r<e.length;r++){const i=e[r];i instanceof FA?t(i.players,n):n.push(i)}}(t,e),e}((n.get(h)||rD).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=i.get(h),g=a.get(h),y=BA(0,this._normalizer,0,e.keyframes,m,g),v=this._buildPlayer(e,y,f);if(e.subTimeline&&r&&c.add(h),d){const e=new cD(t,o,h);e.setRealPlayer(v),l.push(e)}return v});l.forEach(t=>{jA(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,t.element,t))}),u.forEach(t=>mD(t,"ng-animating"));const p=LA(h);return p.onDestroy(()=>{u.forEach(t=>gD(t,"ng-animating")),hR(s,e.toStyles)}),c.forEach(t=>{jA(r,t,[]).push(p)}),p}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new DA(t.duration,t.delay)}}class cD{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new DA,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>VA(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){jA(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function hD(t){return t&&1===t.nodeType}function pD(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function dD(t,e,n,r,i){const a=[];n.forEach(t=>a.push(pD(t)));const o=[];r.forEach((n,r)=>{const a={};n.forEach(t=>{const n=a[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r.__ng_removed=aD,o.push(r))}),t.set(r,a)});let s=0;return n.forEach(t=>pD(t,a[s++])),o}function fD(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;return e.forEach(t=>{const e=function t(e){if(!e)return 1;let a=i.get(e);if(a)return a;const o=e.parentNode;return a=n.has(o)?o:r.has(o)?1:t(o),i.set(e,a),a}(t);1!==e&&n.get(e).push(t)}),n}function mD(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function gD(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function yD(t,e,n){LA(n).onDone(()=>t.processLeaveNode(e))}function vD(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class bD{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new uD(t,e,n),this._timelineEngine=new nD(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const a=t+"-"+r;let o=this._triggerCache[a];if(!o){const t=[],e=NR(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);o=function(t,e){return new JR(t,e)}(r,e),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(e,r,o)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=qA(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=qA(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function wD(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=CD(e[0]),e.length>1&&(r=CD(e[e.length-1]))):e&&(n=CD(e)),n||r?new xD(t,n,r):null}let xD=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&hR(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(hR(this._element,this._initialStyles),this._endStyles&&(hR(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(pR(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(pR(this._element,this._endStyles),this._endStyles=null),hR(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function CD(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];_D(i)&&(e=e||{},e[i]=t[i])}return e}function _D(t){return"display"===t||"position"===t}class kD{constructor(t,e,n,r,i,a,o){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=a,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=PD(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),ND(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),MD(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){SD(this._element,this._name,"paused")}resume(){SD(this._element,this._name,"running")}setPosition(t){const e=OD(this._element,this._name);this._position=t*this._duration,ND(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),MD(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=PD(t,"").split(","),r=ED(n,e);r>=0&&(n.splice(r,1),ND(t,"",n.join(",")))}(this._element,this._name))}}function SD(t,e,n){ND(t,"PlayState",n,OD(t,e))}function OD(t,e){const n=PD(t,"");return n.indexOf(",")>0?ED(n.split(","),e):ED([n],e)}function ED(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function MD(t,e,n){n?t.removeEventListener("animationend",e):t.addEventListener("animationend",e)}function ND(t,e,n,r){const i="animation"+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function PD(t,e){return t.style["animation"+e]}class TD{constructor(t,e,n,r,i,a,o,s){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=o,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=a||"linear",this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new kD(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:_R(this.element,n))})}this.currentSnapshot=t}}class ID extends DA{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=eR(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class AD{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(t){return QA(t)}matchesElement(t,e){return ZA(t,e)}containsElement(t,e){return JA(t,e)}query(t,e,n){return tR(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>eR(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=" ";const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=`${i}}\n`}),r+="}\n";const a=document.createElement("style");return a.innerHTML=r,a}animate(t,e,n,r,i,a=[],o){o&&this._notifyFaultyScrubber();const s=a.filter(t=>t instanceof TD),l={};wR(n,r)&&s.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const u=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=xR(t,e,l));if(0==n)return new ID(t,u);const c=`gen_css_kf_${this._count++}`,h=this.buildKeyframeElement(t,c,e);document.querySelector("head").appendChild(h);const p=wD(t,e),d=new TD(t,e,c,n,r,i,u,p);return d.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),d}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class RD{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:_R(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class DD{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(FD().toString()),this._cssKeyframesDriver=new AD}validateStyleProperty(t){return QA(t)}matchesElement(t,e){return ZA(t,e)}containsElement(t,e){return JA(t,e)}query(t,e,n){return tR(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,a=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,a);const s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);const l={},u=a.filter(t=>t instanceof RD);wR(n,r)&&u.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>l[t]=e[t])});const c=wD(t,e=xR(t,e=e.map(t=>lR(t,!1)),l));return new RD(t,e,s,c)}}function FD(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}class zD extends TA{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:Vt.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?IA(t):t;return VD(this._renderer,null,e,"register",[n]),new LD(e,this._renderer)}}class LD extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new BD(this._id,t,e||{},this._renderer)}}class BD{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return VD(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){return 0}}function VD(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}class UD{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new WD("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;return this._currentId++,this.engine.register(i,t),e.data.animation.forEach(e=>this.engine.registerTrigger(r,i,t,e.name,e)),new jD(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}class WD{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&"@.disabled"==e?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class jD extends WD{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&"@.disabled"==e?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),a="";return"@"!=i.charAt(0)&&([i,a]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,a,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}class qD extends bD{constructor(t,e,n){super(t.body,e,n)}}function HD(){return"function"==typeof FD()?new DD:new AD}function GD(){return new $R}function $D(t,e,n){return new UD(t,e,n)}const KD=new St("AnimationModuleType");class XD{}var YD=Wn({encapsulation:2,styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(.4,0,.2,1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}@media (-ms-high-contrast:active){.mat-card{outline:solid 1px}}.mat-card-actions,.mat-card-content,.mat-card-subtitle{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media (max-width:599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card-content>:first-child,.mat-card>:first-child{margin-top:0}.mat-card-content>:last-child:not(.mat-card-footer),.mat-card>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-subtitle:not(:first-child),.mat-card-title:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],data:{}});function QD(t){return Va(2,[Da(null,0),Da(null,1)],null,null)}function ZD(t){return e=>e.lift(new JD(t))}class JD{constructor(t){this.notifier=t}call(t,e){const n=new tF(t),r=V(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class tF extends U{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,n,r,i){this.seenValue=!0,this.complete()}notifyComplete(){}}class eF{}class nF{constructor(t=!1,e="all",n="",r="",i=0){this.matches=t,this.mediaQuery=e,this.mqAlias=n,this.suffix=r,this.priority=i,this.property=""}clone(){return new nF(this.matches,this.mediaQuery,this.mqAlias,this.suffix)}}let rF=(()=>{class t{constructor(){this.stylesheet=new Map}addStyleToElement(t,e,n){const r=this.stylesheet.get(t);r?r.set(e,n):this.stylesheet.set(t,new Map([[e,n]]))}clearStyles(){this.stylesheet.clear()}getStyleForElement(t,e){const n=this.stylesheet.get(t);let r="";if(n){const t=n.get(e);"number"!=typeof t&&"string"!=typeof t||(r=t+"")}return r}}return t.ngInjectableDef=dt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const iF={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[]},aF=new St("Flex Layout token, config options for the library",{providedIn:"root",factory:()=>iF}),oF=new St("FlexLayoutServerLoaded",{providedIn:"root",factory:()=>!1}),sF=new St("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:()=>null});function lF(t,e){return t=t?t.clone():new nF,e&&(t.mqAlias=e.alias,t.mediaQuery=e.mediaQuery,t.suffix=e.suffix,t.priority=e.priority),t}const uF=["row","column","row-reverse","column-reverse"];function cF(t){if(t)switch(t.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":t="wrap-reverse";break;case"no":case"none":case"nowrap":t="nowrap";break;default:t="wrap"}return t}class hF{constructor(t,e,n,r){this.elementRef=t,this.styleBuilder=e,this.styler=n,this.marshal=r,this.DIRECTIVE_KEY="",this.inputs=[],this.mru={},this.destroySubject=new E,this.styleCache=new Map}get parentElement(){return this.elementRef.nativeElement.parentElement}get nativeElement(){return this.elementRef.nativeElement}get activatedValue(){return this.marshal.getValue(this.nativeElement,this.DIRECTIVE_KEY)}set activatedValue(t){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,this.marshal.activatedAlias)}ngOnChanges(t){Object.keys(t).forEach(e=>{if(-1!==this.inputs.indexOf(e)){const n=e.split(".").slice(1).join(".");this.setValue(t[e].currentValue,n)}})}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete(),this.marshal.releaseElement(this.nativeElement)}init(t=[]){this.marshal.init(this.elementRef.nativeElement,this.DIRECTIVE_KEY,this.updateWithValue.bind(this),this.clearStyles.bind(this),t)}addStyles(t,e){const n=this.styleBuilder,r=n.shouldCache;let i=this.styleCache.get(t);i&&r||(i=n.buildStyles(t,e),r&&this.styleCache.set(t,i)),this.mru=Object.assign({},i),this.applyStyleToElement(i),n.sideEffect(t,i,e)}clearStyles(){Object.keys(this.mru).forEach(t=>{this.mru[t]=""}),this.applyStyleToElement(this.mru),this.mru={}}triggerUpdate(){this.marshal.triggerUpdate(this.nativeElement,this.DIRECTIVE_KEY)}getFlexFlowDirection(t,e=!1){if(t){const[n,r]=this.styler.getFlowDirection(t);if(!r&&e){const e=function(t){let[e,n,r]=function(t){t=t?t.toLowerCase():"";let[e,n,r]=t.split(" ");return uF.find(t=>t===e)||(e=uF[0]),"inline"===n&&(n="inline"!==r?r:"",r="inline"),[e,cF(n),!!r]}(t);return function(t,e=null,n=!1){return{display:n?"inline-flex":"flex","box-sizing":"border-box","flex-direction":t,"flex-wrap":e||null}}(e,n,r)}(n);this.styler.applyStyleToElements(e,[t])}return n.trim()}return"row"}applyStyleToElement(t,e,n=this.nativeElement){this.styler.applyStyleToElement(n,t,e)}setValue(t,e){this.marshal.setValue(this.nativeElement,this.DIRECTIVE_KEY,t,e)}updateWithValue(t){this.addStyles(t)}}const pF=[{alias:"xs",mediaQuery:"screen and (min-width: 0px) and (max-width: 599.9px)",priority:1e3},{alias:"sm",mediaQuery:"screen and (min-width: 600px) and (max-width: 959.9px)",priority:900},{alias:"md",mediaQuery:"screen and (min-width: 960px) and (max-width: 1279.9px)",priority:800},{alias:"lg",mediaQuery:"screen and (min-width: 1280px) and (max-width: 1919.9px)",priority:700},{alias:"xl",mediaQuery:"screen and (min-width: 1920px) and (max-width: 4999.9px)",priority:600},{alias:"lt-sm",overlapping:!0,mediaQuery:"screen and (max-width: 599.9px)",priority:950},{alias:"lt-md",overlapping:!0,mediaQuery:"screen and (max-width: 959.9px)",priority:850},{alias:"lt-lg",overlapping:!0,mediaQuery:"screen and (max-width: 1279.9px)",priority:750},{alias:"lt-xl",overlapping:!0,priority:650,mediaQuery:"screen and (max-width: 1919.9px)"},{alias:"gt-xs",overlapping:!0,mediaQuery:"screen and (min-width: 600px)",priority:-950},{alias:"gt-sm",overlapping:!0,mediaQuery:"screen and (min-width: 960px)",priority:-850},{alias:"gt-md",overlapping:!0,mediaQuery:"screen and (min-width: 1280px)",priority:-750},{alias:"gt-lg",overlapping:!0,mediaQuery:"screen and (min-width: 1920px)",priority:-650}],dF="(orientation: portrait) and (min-width: 600px) and (max-width: 839.9px)",fF="(orientation: landscape) and (min-width: 960px) and (max-width: 1279.9px)",mF="(orientation: portrait) and (min-width: 840px)",gF="(orientation: landscape) and (min-width: 1280px)",yF={HANDSET:"(orientation: portrait) and (max-width: 599.9px), (orientation: landscape) and (max-width: 959.9px)",TABLET:`${dF} , ${fF}`,WEB:`${mF}, ${gF} `,HANDSET_PORTRAIT:"(orientation: portrait) and (max-width: 599.9px)",TABLET_PORTRAIT:`${dF} `,WEB_PORTRAIT:`${mF}`,HANDSET_LANDSCAPE:"(orientation: landscape) and (max-width: 959.9px)]",TABLET_LANDSCAPE:`${fF}`,WEB_LANDSCAPE:`${gF}`},vF=[{alias:"handset",priority:2e3,mediaQuery:yF.HANDSET},{alias:"handset.landscape",priority:2e3,mediaQuery:yF.HANDSET_LANDSCAPE},{alias:"handset.portrait",priority:2e3,mediaQuery:yF.HANDSET_PORTRAIT},{alias:"tablet",priority:2100,mediaQuery:yF.TABLET},{alias:"tablet.landscape",priority:2100,mediaQuery:yF.TABLET},{alias:"tablet.portrait",priority:2100,mediaQuery:yF.TABLET_PORTRAIT},{alias:"web",priority:2200,mediaQuery:yF.WEB,overlapping:!0},{alias:"web.landscape",priority:2200,mediaQuery:yF.WEB_LANDSCAPE,overlapping:!0},{alias:"web.portrait",priority:2200,mediaQuery:yF.WEB_PORTRAIT,overlapping:!0}],bF=/(\.|-|_)/g;function wF(t){let e=t.length>0?t.charAt(0):"",n=t.length>1?t.slice(1):"";return e.toUpperCase()+n}const xF=new St("Token (@angular/flex-layout) Breakpoints",{providedIn:"root",factory:()=>{const t=At(sF),e=At(aF),n=[].concat.apply([],(t||[]).map(t=>Array.isArray(t)?t:[t]));return function(t,e=[]){const n={};return t.forEach(t=>{n[t.alias]=t}),e.forEach(t=>{n[t.alias]?function(t,...e){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(let n of e)if(null!=n)for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}(n[t.alias],t):n[t.alias]=t}),(r=Object.keys(n).map(t=>n[t])).forEach(t=>{t.suffix||(t.suffix=t.alias.replace(bF,"|").split("|").map(wF).join(""),t.overlapping=!!t.overlapping)}),r;var r}((e.disableDefaultBps?[]:pF).concat(e.addOrientationBps?vF:[]),n)}});function CF(t,e){return(e&&e.priority||0)-(t&&t.priority||0)}function _F(t,e){return(t.priority||0)-(e.priority||0)}let kF=(()=>{class t{constructor(t){this.findByMap=new Map,this.items=[...t].sort(_F)}findByAlias(t){return t?this.findWithPredicate(t,e=>e.alias==t):null}findByQuery(t){return this.findWithPredicate(t,e=>e.mediaQuery==t)}get overlappings(){return this.items.filter(t=>1==t.overlapping)}get aliases(){return this.items.map(t=>t.alias)}get suffixes(){return this.items.map(t=>t.suffix?t.suffix:"")}findWithPredicate(t,e){let n=this.findByMap.get(t);return n||(n=this.items.find(e)||null,this.findByMap.set(t,n)),n||null}}return t.ngInjectableDef=dt({factory:function(){return new t(It(xF))},token:t,providedIn:"root"}),t})(),SF=(()=>{class t{constructor(t,e,n){this._zone=t,this._platformId=e,this._document=n,this.source=new EM(new nF(!0)),this.registry=new Map,this._observable$=this.source.asObservable()}get activations(){const t=[];return this.registry.forEach((e,n)=>{e.matches&&t.push(n)}),t}isActive(t){const e=this.registry.get(t);return!!e&&e.matches}observe(t,e=!1){if(t&&t.length){const n=this._observable$.pipe(DM(n=>!e||t.indexOf(n.mediaQuery)>-1));return Z(new x(e=>{const n=this.registerQuery(t);if(n.length){const t=n.pop();n.forEach(t=>{e.next(t)}),this.source.next(t)}e.complete()}),n)}return this._observable$}registerQuery(t){const e=Array.isArray(t)?t:[t],n=[];return function(t,e){const n=t.filter(t=>!OF[t]);if(n.length>0){const t=n.join(", ");try{const r=e.createElement("style");r.setAttribute("type","text/css"),r.styleSheet||r.appendChild(e.createTextNode(`\n/*\n  @angular/flex-layout - workaround for possible browser quirk with mediaQuery listeners\n  see http://bit.ly/2sd4HMP\n*/\n@media ${t} {.fx-query-test{ }}\n`)),e.head.appendChild(r),n.forEach(t=>OF[t]=r)}catch(bC){console.error(bC)}}}(e,this._document),e.forEach(t=>{let e=this.registry.get(t);e||(e=this.buildMQL(t),e.addListener(e=>{this._zone.run(()=>this.source.next(new nF(e.matches,t)))}),this.registry.set(t,e)),e.matches&&n.push(new nF(!0,t))}),n}buildMQL(t){return function(t,e){return e&&window.matchMedia("all").addListener?window.matchMedia(t):{matches:"all"===t||""===t,media:t,addListener:()=>{},removeListener:()=>{}}}(t,bM(this._platformId))}}return t.ngInjectableDef=dt({factory:function(){return new t(It(Wi),It(Ci),It(vM))},token:t,providedIn:"root"}),t})();const OF={},EF={alias:"print",mediaQuery:"print",priority:1e3};let MF=(()=>{class t{constructor(t,e){this.breakpoints=t,this.layoutConfig=e,this.isPrinting=!1,this.queue=new NF,this.deactivations=[]}withPrintQuery(t){return[...t,"print"]}isPrintEvent(t){return t.mediaQuery.startsWith("print")}get printAlias(){return this.layoutConfig.printWithBreakpoints||[]}get printBreakPoints(){return this.printAlias.map(t=>this.breakpoints.findByAlias(t)).filter(t=>null!==t)}getEventBreakpoints({mediaQuery:t}){const e=this.breakpoints.findByQuery(t);return(e?[...this.printBreakPoints,e]:this.printBreakPoints).sort(CF)}updateEvent(t){let e=this.breakpoints.findByQuery(t.mediaQuery);return this.isPrintEvent(t)&&(e=this.getEventBreakpoints(t)[0],t.mediaQuery=e?e.mediaQuery:""),lF(t,e)}interceptEvents(t){return e=>{this.isPrintEvent(e)?e.matches&&!this.isPrinting?(this.startPrinting(t,this.getEventBreakpoints(e)),t.updateStyles()):!e.matches&&this.isPrinting&&(this.stopPrinting(t),t.updateStyles()):this.collectActivations(e)}}blockPropagation(){return t=>!(this.isPrinting||this.isPrintEvent(t))}startPrinting(t,e){this.isPrinting=!0,t.activatedBreakpoints=this.queue.addPrintBreakpoints(e)}stopPrinting(t){t.activatedBreakpoints=this.deactivations,this.deactivations=[],this.queue.clear(),this.isPrinting=!1}collectActivations(t){if(!this.isPrinting)if(t.matches)this.deactivations=[];else{const e=this.breakpoints.findByQuery(t.mediaQuery);e&&(this.deactivations.push(e),this.deactivations.sort(CF))}}}return t.ngInjectableDef=dt({factory:function(){return new t(It(kF),It(aF))},token:t,providedIn:"root"}),t})();class NF{constructor(){this.printBreakpoints=[]}addPrintBreakpoints(t){return t.push(EF),t.sort(CF),t.forEach(t=>this.addBreakpoint(t)),this.printBreakpoints}addBreakpoint(t){t&&void 0===this.printBreakpoints.find(e=>e.mediaQuery===t.mediaQuery)&&(this.printBreakpoints=function(t){return!!t&&t.mediaQuery.startsWith("print")}(t)?[t,...this.printBreakpoints]:[...this.printBreakpoints,t])}clear(){this.printBreakpoints=[]}}function PF(t){for(let e in t){let n=t[e]||"";switch(e){case"display":t.display="flex"===n?["-webkit-flex","flex"]:"inline-flex"===n?["-webkit-inline-flex","inline-flex"]:n;break;case"align-items":case"align-self":case"align-content":case"flex":case"flex-basis":case"flex-flow":case"flex-grow":case"flex-shrink":case"flex-wrap":case"justify-content":t["-webkit-"+e]=n;break;case"flex-direction":n=n||"row",t["-webkit-flex-direction"]=n,t["flex-direction"]=n;break;case"order":t.order=t["-webkit-"+e]=isNaN(+n)?"0":n}}return t}let TF=(()=>{class t{constructor(t,e,n,r){this._serverStylesheet=t,this._serverModuleLoaded=e,this._platformId=n,this.layoutConfig=r}applyStyleToElement(t,e,n=null){let r={};"string"==typeof e&&(r[e]=n,e=r),r=this.layoutConfig.disableVendorPrefixes?e:PF(e),this._applyMultiValueStyleToElement(r,t)}applyStyleToElements(t,e=[]){const n=this.layoutConfig.disableVendorPrefixes?t:PF(t);e.forEach(t=>{this._applyMultiValueStyleToElement(n,t)})}getFlowDirection(t){let e=this.lookupStyle(t,"flex-direction");return[e||"row",this.lookupInlineStyle(t,"flex-direction")||wM(this._platformId)&&this._serverModuleLoaded?e:""]}lookupAttributeValue(t,e){return t.getAttribute(e)||""}lookupInlineStyle(t,e){return bM(this._platformId)?t.style.getPropertyValue(e):this._getServerStyle(t,e)}lookupStyle(t,e,n=!1){let r="";return t&&((r=this.lookupInlineStyle(t,e))||(bM(this._platformId)?n||(r=getComputedStyle(t).getPropertyValue(e)):this._serverModuleLoaded&&(r=this._serverStylesheet.getStyleForElement(t,e)))),r?r.trim():""}_applyMultiValueStyleToElement(t,e){Object.keys(t).sort().forEach(n=>{const r=t[n],i=Array.isArray(r)?r:[r];i.sort();for(let t of i)t=t?t+"":"",bM(this._platformId)||!this._serverModuleLoaded?bM(this._platformId)?e.style.setProperty(n,t):this._setServerStyle(e,n,t):this._serverStylesheet.addStyleToElement(e,n,t)})}_setServerStyle(t,e,n){e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();const r=this._readStyleAttribute(t);r[e]=n||"",this._writeStyleAttribute(t,r)}_getServerStyle(t,e){return this._readStyleAttribute(t)[e]||""}_readStyleAttribute(t){const e={},n=t.getAttribute("style");if(n){const t=n.split(/;+/g);for(let n=0;n<t.length;n++){const r=t[n].trim();if(r.length>0){const t=r.indexOf(":");if(-1===t)throw new Error(`Invalid CSS style: ${r}`);e[r.substr(0,t).trim()]=r.substr(t+1).trim()}}}return e}_writeStyleAttribute(t,e){let n="";for(const r in e)e[r]&&(n+=r+":"+e[r]+";");t.setAttribute("style",n)}}return t.ngInjectableDef=dt({factory:function(){return new t(It(rF,8),It(oF,8),It(Ci),It(aF))},token:t,providedIn:"root"}),t})();class IF{constructor(){this.shouldCache=!0}sideEffect(t,e,n){}}function AF(t,e="1",n="1"){let r=[e,n,t],i=t.indexOf("calc");if(i>0){r[2]=RF(t.substring(i).trim());let e=t.substr(0,i).trim().split(" ");2==e.length&&(r[0]=e[0],r[1]=e[1])}else if(0==i)r[2]=RF(t.trim());else{let i=t.split(" ");r=3===i.length?i:[e,n,t]}return r}function RF(t){return t.replace(/[\s]/g,"").replace(/[\/\*\+\-]/g," $& ")}let DF=(()=>{class t{constructor(t,e,n){this.matchMedia=t,this.breakpoints=e,this.hook=n,this.activatedBreakpoints=[],this.elementMap=new Map,this.elementKeyMap=new WeakMap,this.watcherMap=new WeakMap,this.updateMap=new WeakMap,this.clearMap=new WeakMap,this.subject=new E,this.observeActivations()}get activatedAlias(){return this.activatedBreakpoints[0]?this.activatedBreakpoints[0].alias:""}onMediaChange(t){const e=this.findByQuery(t.mediaQuery);e&&((t=lF(t,e)).matches&&-1===this.activatedBreakpoints.indexOf(e)?(this.activatedBreakpoints.push(e),this.activatedBreakpoints.sort(CF),this.updateStyles()):t.matches||-1===this.activatedBreakpoints.indexOf(e)||(this.activatedBreakpoints.splice(this.activatedBreakpoints.indexOf(e),1),this.activatedBreakpoints.sort(CF),this.updateStyles()))}init(t,e,n,r,i=[]){FF(this.updateMap,t,e,n),FF(this.clearMap,t,e,r),this.buildElementKeyMap(t,e),this.watchExtraTriggers(t,e,i)}getValue(t,e,n){const r=this.elementMap.get(t);if(r){const t=void 0!==n?r.get(n):this.getActivatedValues(r,e);if(t)return t.get(e)}}hasValue(t,e){const n=this.elementMap.get(t);if(n){const t=this.getActivatedValues(n,e);if(t)return void 0!==t.get(e)||!1}return!1}setValue(t,e,n,r){let i=this.elementMap.get(t);if(i){const a=(i.get(r)||new Map).set(e,n);i.set(r,a),this.elementMap.set(t,i)}else i=(new Map).set(r,(new Map).set(e,n)),this.elementMap.set(t,i);const a=this.getValue(t,e);void 0!==a&&this.updateElement(t,e,a)}trackValue(t,e){return this.subject.asObservable().pipe(DM(n=>n.element===t&&n.key===e))}updateStyles(){this.elementMap.forEach((t,e)=>{const n=new Set(this.elementKeyMap.get(e));let r=this.getActivatedValues(t);r&&r.forEach((t,r)=>{this.updateElement(e,r,t),n.delete(r)}),n.forEach(n=>{if(r=this.getActivatedValues(t,n),r){const t=r.get(n);this.updateElement(e,n,t)}else this.clearElement(e,n)})})}clearElement(t,e){const n=this.clearMap.get(t);if(n){const r=n.get(e);r&&(r(),this.subject.next({element:t,key:e,value:""}))}}updateElement(t,e,n){const r=this.updateMap.get(t);if(r){const i=r.get(e);i&&(i(n),this.subject.next({element:t,key:e,value:n}))}}releaseElement(t){const e=this.watcherMap.get(t);e&&(e.forEach(t=>t.unsubscribe()),this.watcherMap.delete(t));const n=this.elementMap.get(t);n&&(n.forEach((t,e)=>n.delete(e)),this.elementMap.delete(t))}triggerUpdate(t,e){const n=this.elementMap.get(t);if(n){const r=this.getActivatedValues(n,e);r&&(e?this.updateElement(t,e,r.get(e)):r.forEach((e,n)=>this.updateElement(t,n,e)))}}buildElementKeyMap(t,e){let n=this.elementKeyMap.get(t);n||(n=new Set,this.elementKeyMap.set(t,n)),n.add(e)}watchExtraTriggers(t,e,n){if(n&&n.length){let r=this.watcherMap.get(t);if(r||(r=new Map,this.watcherMap.set(t,r)),!r.get(e)){const i=Z(...n).subscribe(()=>{const n=this.getValue(t,e);this.updateElement(t,e,n)});r.set(e,i)}}}findByQuery(t){return this.breakpoints.findByQuery(t)}getActivatedValues(t,e){for(let r=0;r<this.activatedBreakpoints.length;r++){const n=t.get(this.activatedBreakpoints[r].alias);if(n&&(void 0===e||n.has(e)))return n}const n=t.get("");return void 0===e||n&&n.has(e)?n:void 0}observeActivations(){const t=this.breakpoints.items.map(t=>t.mediaQuery);this.matchMedia.observe(this.hook.withPrintQuery(t)).pipe(jM(this.hook.interceptEvents(this)),DM(this.hook.blockPropagation())).subscribe(this.onMediaChange.bind(this))}}return t.ngInjectableDef=dt({factory:function(){return new t(It(SF),It(kF),It(MF))},token:t,providedIn:"root"}),t})();function FF(t,e,n,r){if(void 0!==r){let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n,r)}}const zF=["row","column","row-reverse","column-reverse"];function LF(t){t=t?t.toLowerCase():"";let[e,n,r]=t.split(" ");return zF.find(t=>t===e)||(e=zF[0]),"inline"===n&&(n="inline"!==r?r:"",r="inline"),[e,VF(n),!!r]}function BF(t){let[e]=LF(t);return e.indexOf("row")>-1}function VF(t){if(t)switch(t.toLowerCase()){case"reverse":case"wrap-reverse":case"reverse-wrap":t="wrap-reverse";break;case"no":case"none":case"nowrap":t="nowrap";break;default:t="wrap"}return t}let UF=(()=>{class t extends IF{buildStyles(t){return function(t){let[e,n,r]=LF(t);return function(t,e=null,n=!1){return{display:n?"inline-flex":"flex","box-sizing":"border-box","flex-direction":t,"flex-wrap":e||null}}(e,n,r)}(t)}}return t.ngInjectableDef=dt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const WF=["fxLayout","fxLayout.xs","fxLayout.sm","fxLayout.md","fxLayout.lg","fxLayout.xl","fxLayout.lt-sm","fxLayout.lt-md","fxLayout.lt-lg","fxLayout.lt-xl","fxLayout.gt-xs","fxLayout.gt-sm","fxLayout.gt-md","fxLayout.gt-lg"];class jF extends hF{constructor(t,e,n,r){super(t,n,e,r),this.elRef=t,this.styleUtils=e,this.styleBuilder=n,this.marshal=r,this.DIRECTIVE_KEY="layout",this.styleCache=HF,this.init()}}class qF extends jF{constructor(){super(...arguments),this.inputs=WF}}const HF=new Map,GF={"margin-left":null,"margin-right":null,"margin-top":null,"margin-bottom":null};let $F=(()=>{class t extends IF{constructor(t){super(),this._styler=t}buildStyles(t,e){return t.endsWith(ez)?function(t,e){let n="0px",r="0px";return"rtl"===e?r="-"+t:n="-"+t,{margin:`0px ${n} ${"-"+t} ${r}`}}(t=t.slice(0,t.indexOf(ez)),e.directionality):{}}sideEffect(t,e,n){const r=n.items;if(t.endsWith(ez)){const e=function(t,e){let n="0px",r="0px";return"rtl"===e?r=t:n=t,{padding:`0px ${n} ${t} ${r}`}}(t=t.slice(0,t.indexOf(ez)),n.directionality);this._styler.applyStyleToElements(e,n.items)}else{const e=r.pop(),i=function(t,e){const n=nz(e.directionality,e.layout),r=Object.assign({},GF);return r[n]=t,r}(t,n);this._styler.applyStyleToElements(i,r),this._styler.applyStyleToElements(GF,[e])}}}return t.ngInjectableDef=dt({factory:function(){return new t(It(TF))},token:t,providedIn:"root"}),t})();const KF=["fxLayoutGap","fxLayoutGap.xs","fxLayoutGap.sm","fxLayoutGap.md","fxLayoutGap.lg","fxLayoutGap.xl","fxLayoutGap.lt-sm","fxLayoutGap.lt-md","fxLayoutGap.lt-lg","fxLayoutGap.lt-xl","fxLayoutGap.gt-xs","fxLayoutGap.gt-sm","fxLayoutGap.gt-md","fxLayoutGap.gt-lg"];class XF extends hF{constructor(t,e,n,r,i,a){super(t,i,r,a),this.elRef=t,this.zone=e,this.directionality=n,this.styleUtils=r,this.styleBuilder=i,this.marshal=a,this.layout="row",this.DIRECTIVE_KEY="layout-gap",this.observerSubject=new E;const o=[this.directionality.change,this.observerSubject.asObservable()];this.init(o),this.marshal.trackValue(this.nativeElement,"layout").pipe(ZD(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}get childrenNodes(){const t=this.nativeElement.children,e=[];for(let n=t.length;n--;)e[n]=t[n];return e}ngAfterContentInit(){this.buildChildObservable(),this.triggerUpdate()}ngOnDestroy(){super.ngOnDestroy(),this.observer&&this.observer.disconnect()}onLayoutChange(t){const e=t.value.split(" ");this.layout=e[0],zF.find(t=>t===this.layout)||(this.layout="row"),this.triggerUpdate()}updateWithValue(t){const e=this.childrenNodes.filter(t=>1===t.nodeType&&this.willDisplay(t)).sort((t,e)=>{const n=+this.styler.lookupStyle(t,"order"),r=+this.styler.lookupStyle(e,"order");return isNaN(n)||isNaN(r)||n===r?0:n>r?1:-1});if(e.length>0){const n=this.directionality.value,r=this.layout;"row"===r&&"rtl"===n?this.styleCache=QF:"row"===r&&"rtl"!==n?this.styleCache=JF:"column"===r&&"rtl"===n?this.styleCache=ZF:"column"===r&&"rtl"!==n&&(this.styleCache=tz),this.addStyles(t,{directionality:n,items:e,layout:r})}}clearStyles(){const t=Object.keys(this.mru).length>0,e=t?"padding":nz(this.directionality.value,this.layout);t&&super.clearStyles(),this.styleUtils.applyStyleToElements({[e]:""},this.childrenNodes)}willDisplay(t){const e=this.marshal.getValue(t,"show-hide");return!0===e||void 0===e&&"none"!==this.styleUtils.lookupStyle(t,"display")}buildChildObservable(){this.zone.runOutsideAngular(()=>{"undefined"!=typeof MutationObserver&&(this.observer=new MutationObserver(t=>{t.some(t=>t.addedNodes&&t.addedNodes.length>0||t.removedNodes&&t.removedNodes.length>0)&&this.observerSubject.next()}),this.observer.observe(this.nativeElement,{childList:!0}))})}}class YF extends XF{constructor(){super(...arguments),this.inputs=KF}}const QF=new Map,ZF=new Map,JF=new Map,tz=new Map,ez=" grid";function nz(t,e){switch(e){case"column":return"margin-bottom";case"column-reverse":return"margin-top";case"row":return"rtl"===t?"margin-left":"margin-right";case"row-reverse":return"rtl"===t?"margin-right":"margin-left";default:return"rtl"===t?"margin-left":"margin-right"}}function rz(t,...e){if(null==t)throw TypeError("Cannot convert undefined or null to object");for(let n of e)if(null!=n)for(let e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}let iz=(()=>{class t extends IF{constructor(t){super(),this.layoutConfig=t}buildStyles(t,e){let[n,r,...i]=t.split(" "),a=i.join(" ");const o=e.direction.indexOf("column")>-1?"column":"row",s=BF(o)?"max-width":"max-height",l=BF(o)?"min-width":"min-height",u=String(a).indexOf("calc")>-1,c=u||"auto"===a,h=String(a).indexOf("%")>-1&&!u,p=String(a).indexOf("px")>-1||String(a).indexOf("rem")>-1||String(a).indexOf("em")>-1||String(a).indexOf("vw")>-1||String(a).indexOf("vh")>-1;let d=u||p;n="0"==n?0:n,r="0"==r?0:r;const f=!n&&!r;let m={};const g={"max-width":null,"max-height":null,"min-width":null,"min-height":null};switch(a||""){case"":const t=!1!==this.layoutConfig.useColumnBasisZero;a="row"===o?"0%":t?"0.000000001px":"auto";break;case"initial":case"nogrow":n=0,a="auto";break;case"grow":a="100%";break;case"noshrink":r=0,a="auto";break;case"auto":break;case"none":n=0,r=0,a="auto";break;default:d||h||isNaN(a)||(a+="%"),"0%"===a&&(d=!0),"0px"===a&&(a="0%"),m=rz(g,u?{"flex-grow":n,"flex-shrink":r,"flex-basis":d?a:"100%"}:{flex:`${n} ${r} ${d?a:"100%"}`})}return m.flex||m["flex-grow"]||(m=rz(g,u?{"flex-grow":n,"flex-shrink":r,"flex-basis":a}:{flex:`${n} ${r} ${a}`})),"0%"!==a&&"0px"!==a&&"0.000000001px"!==a&&"auto"!==a&&(m[l]=f||d&&n?a:null,m[s]=f||!c&&r?a:null),m[l]||m[s]?e.hasWrap&&(m[u?"flex-basis":"flex"]=m[s]?u?m[s]:`${n} ${r} ${m[s]}`:u?m[l]:`${n} ${r} ${m[l]}`):m=rz(g,u?{"flex-grow":n,"flex-shrink":r,"flex-basis":a}:{flex:`${n} ${r} ${a}`}),rz(m,{"box-sizing":"border-box"})}}return t.ngInjectableDef=dt({factory:function(){return new t(It(aF))},token:t,providedIn:"root"}),t})();const az=["fxFlex","fxFlex.xs","fxFlex.sm","fxFlex.md","fxFlex.lg","fxFlex.xl","fxFlex.lt-sm","fxFlex.lt-md","fxFlex.lt-lg","fxFlex.lt-xl","fxFlex.gt-xs","fxFlex.gt-sm","fxFlex.gt-md","fxFlex.gt-lg"];class oz extends hF{constructor(t,e,n,r,i){super(t,r,e,i),this.elRef=t,this.styleUtils=e,this.layoutConfig=n,this.styleBuilder=r,this.marshal=i,this.DIRECTIVE_KEY="flex",this.direction="",this.wrap=!1,this.flexGrow="1",this.flexShrink="1",this.init(),this.parentElement&&(this.marshal.trackValue(this.parentElement,"layout").pipe(ZD(this.destroySubject)).subscribe(this.onLayoutChange.bind(this)),this.marshal.trackValue(this.nativeElement,"layout-align").pipe(ZD(this.destroySubject)).subscribe(this.triggerReflow.bind(this)))}get shrink(){return this.flexShrink}set shrink(t){this.flexShrink=t||"1",this.triggerReflow()}get grow(){return this.flexGrow}set grow(t){this.flexGrow=t||"1",this.triggerReflow()}onLayoutChange(t){const e=t.value.split(" ");this.direction=e[0],this.wrap=void 0!==e[1]&&"wrap"===e[1],this.triggerUpdate()}updateWithValue(t){this.direction||(this.direction=this.getFlexFlowDirection(this.parentElement,!1!==this.layoutConfig.addFlexToParent));const e=this.direction,n=e.startsWith("row"),r=this.wrap;n&&r?this.styleCache=cz:n&&!r?this.styleCache=lz:!n&&r?this.styleCache=hz:n||r||(this.styleCache=uz);const i=AF(String(t).replace(";",""),this.flexGrow,this.flexShrink);this.addStyles(i.join(" "),{direction:e,hasWrap:r})}triggerReflow(){const t=this.activatedValue;if(void 0!==t){const e=AF(t+"",this.flexGrow,this.flexShrink);this.marshal.updateElement(this.nativeElement,this.DIRECTIVE_KEY,e.join(" "))}}}class sz extends oz{constructor(){super(...arguments),this.inputs=az}}const lz=new Map,uz=new Map,cz=new Map,hz=new Map;let pz=(()=>{class t extends IF{buildStyles(t,e){const n={},[r,i]=t.split(" ");switch(r){case"center":n["justify-content"]="center";break;case"space-around":n["justify-content"]="space-around";break;case"space-between":n["justify-content"]="space-between";break;case"space-evenly":n["justify-content"]="space-evenly";break;case"end":case"flex-end":n["justify-content"]="flex-end";break;case"start":case"flex-start":default:n["justify-content"]="flex-start"}switch(i){case"start":case"flex-start":n["align-items"]=n["align-content"]="flex-start";break;case"center":n["align-items"]=n["align-content"]="center";break;case"end":case"flex-end":n["align-items"]=n["align-content"]="flex-end";break;case"space-between":n["align-content"]="space-between",n["align-items"]="stretch";break;case"space-around":n["align-content"]="space-around",n["align-items"]="stretch";break;case"baseline":n["align-content"]="stretch",n["align-items"]="baseline";break;case"stretch":default:n["align-items"]=n["align-content"]="stretch"}return rz(n,{display:e.inline?"inline-flex":"flex","flex-direction":e.layout,"box-sizing":"border-box","max-width":"stretch"===i?BF(e.layout)?null:"100%":null,"max-height":"stretch"===i&&BF(e.layout)?"100%":null})}}return t.ngInjectableDef=dt({factory:function(){return new t},token:t,providedIn:"root"}),t})();const dz=["fxLayoutAlign","fxLayoutAlign.xs","fxLayoutAlign.sm","fxLayoutAlign.md","fxLayoutAlign.lg","fxLayoutAlign.xl","fxLayoutAlign.lt-sm","fxLayoutAlign.lt-md","fxLayoutAlign.lt-lg","fxLayoutAlign.lt-xl","fxLayoutAlign.gt-xs","fxLayoutAlign.gt-sm","fxLayoutAlign.gt-md","fxLayoutAlign.gt-lg"];class fz extends hF{constructor(t,e,n,r){super(t,n,e,r),this.elRef=t,this.styleUtils=e,this.styleBuilder=n,this.marshal=r,this.DIRECTIVE_KEY="layout-align",this.layout="row",this.inline=!1,this.init(),this.marshal.trackValue(this.nativeElement,"layout").pipe(ZD(this.destroySubject)).subscribe(this.onLayoutChange.bind(this))}updateWithValue(t){const e=this.layout||"row",n=this.inline;"row"===e&&n?this.styleCache=wz:"row"!==e||n?"row-reverse"===e&&n?this.styleCache=Cz:"row-reverse"!==e||n?"column"===e&&n?this.styleCache=xz:"column"!==e||n?"column-reverse"===e&&n?this.styleCache=_z:"column-reverse"!==e||n||(this.styleCache=bz):this.styleCache=yz:this.styleCache=vz:this.styleCache=gz,this.addStyles(t,{layout:e,inline:n})}onLayoutChange(t){const e=t.value.split(" ");this.layout=e[0],this.inline=t.value.includes("inline"),zF.find(t=>t===this.layout)||(this.layout="row"),this.triggerUpdate()}}class mz extends fz{constructor(){super(...arguments),this.inputs=dz}}const gz=new Map,yz=new Map,vz=new Map,bz=new Map,wz=new Map,xz=new Map,Cz=new Map,_z=new Map;class kz{}class Sz{constructor(){this.onFileDropped=new di,this.background="#FFFFFF",this.opacity="1"}onDragOver(t){t.preventDefault(),t.stopPropagation(),this.background="#CBE9F6",this.opacity="0.6"}onDragLeave(t){t.preventDefault(),t.stopPropagation(),this.background="#FFFFFF",this.opacity="1"}ondrop(t){t.preventDefault(),t.stopPropagation(),this.background="#FFFFFF",this.opacity="1";const e=t.dataTransfer.files;e.length>0&&this.onFileDropped.emit(e)}}class Oz extends _A{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}class Ez extends SA{}const Mz=new Ez(Oz);let Nz=(()=>{class t{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return OM(this.value);case"E":return t=this.error,new x(e=>e.error(t));case"C":return kM()}var t;throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();class Pz extends m{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(Pz.dispatch,this.delay,new Tz(t,this.destination)))}_next(t){this.scheduleMessage(Nz.createNext(t))}_error(t){this.scheduleMessage(Nz.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(Nz.createComplete()),this.unsubscribe()}}class Tz{constructor(t,e){this.notification=t,this.destination=e}}class Iz extends E{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift(),super.next(t)}nextTimeWindow(t){this._events.push(new Az(this._getNow(),t)),this._trimBufferThenGetEvents(),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let a;if(this.closed)throw new k;if(this.isStopped||this.hasError?a=p.EMPTY:(this.observers.push(t),a=new S(this,t)),r&&t.add(t=new Pz(t,r)),e)for(let o=0;o<i&&!t.closed;o++)t.next(n[o]);else for(let o=0;o<i&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),a}_getNow(){return(this.scheduler||Mz).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let a=0;for(;a<i&&!(t-r[a].time<n);)a++;return i>e&&(a=Math.max(a,i-e)),a>0&&r.splice(0,a),r}}class Az{constructor(t,e){this.time=t,this.value=e}}const Rz={"ball-8bits":16,"ball-atom":4,"ball-beat":3,"ball-circus":5,"ball-climbing-dot":4,"ball-clip-rotate":1,"ball-clip-rotate-multiple":2,"ball-clip-rotate-pulse":2,"ball-elastic-dots":5,"ball-fall":3,"ball-fussion":4,"ball-grid-beat":9,"ball-grid-pulse":9,"ball-newton-cradle":4,"ball-pulse":3,"ball-pulse-rise":5,"ball-pulse-sync":3,"ball-rotate":1,"ball-running-dots":5,"ball-scale":1,"ball-scale-multiple":3,"ball-scale-pulse":2,"ball-scale-ripple":1,"ball-scale-ripple-multiple":3,"ball-spin":8,"ball-spin-clockwise":8,"ball-spin-clockwise-fade":8,"ball-spin-clockwise-fade-rotating":8,"ball-spin-fade":8,"ball-spin-fade-rotating":8,"ball-spin-rotate":2,"ball-square-clockwise-spin":8,"ball-square-spin":8,"ball-triangle-path":3,"ball-zig-zag":2,"ball-zig-zag-deflect":2,cog:1,"cube-transition":2,fire:3,"line-scale":5,"line-scale-party":5,"line-scale-pulse-out":5,"line-scale-pulse-out-rapid":5,"line-spin-clockwise-fade":8,"line-spin-clockwise-fade-rotating":8,"line-spin-fade":8,"line-spin-fade-rotating":8,pacman:6,"square-jelly-box":2,"square-loader":1,"square-spin":1,timer:1,"triangle-skew-spin":1};class Dz{constructor(t){Object.assign(this,t)}}let Fz=(()=>{let t=class{constructor(){this.spinnerObservable=new Iz(1)}getSpinner(t){return this.spinnerObservable.asObservable().pipe(DM(e=>e&&e.name===t))}show(t="primary",e){return new Promise((n,r)=>{e&&Object.keys(e).length?(e.name=t,this.spinnerObservable.next(new Dz(Object.assign(Object.assign({},e),{show:!0}))),n(!0)):(this.spinnerObservable.next(new Dz({name:t,show:!0})),n(!0))})}hide(t="primary",e=0){return new Promise((n,r)=>{setTimeout(()=>{this.spinnerObservable.next(new Dz({name:t,show:!1})),n(!0)},e)})}};return t.\u0275prov=dt({factory:function(){return new t},token:t,providedIn:"root"}),t})(),zz=class{constructor(t,e){this.spinnerService=t,this.changeDetector=e,this.spinner=new Dz,this.ngUnsubscribe=new E,this.setDefaultOptions=()=>{this.spinner=new Dz({name:this.name,bdColor:this.bdColor,size:this.size,color:this.color,type:this.type,fullScreen:this.fullScreen,divArray:this.divArray,divCount:this.divCount,show:this.show,zIndex:this.zIndex,template:this.template})},this.bdColor="rgba(51,51,51,0.8)",this.zIndex=99999,this.color="#fff",this.type="ball-scale-multiple",this.size="large",this.fullScreen=!0,this.name="primary",this.template=null,this.divArray=[],this.divCount=0,this.show=!1}ngOnInit(){this.setDefaultOptions(),this.spinnerService.getSpinner(this.name).pipe(ZD(this.ngUnsubscribe)).subscribe(t=>{this.setDefaultOptions(),Object.assign(this.spinner,t),t.show&&this.onInputChange(),this.changeDetector.markForCheck()})}ngOnChanges(t){for(const e in t)if(e){const n=t[e];if(n.isFirstChange())return;void 0!==n.currentValue&&n.currentValue!==n.previousValue&&""!==n.currentValue&&(this.spinner[e]=n.currentValue)}}getClass(t,e){this.spinner.divCount=Rz[t],this.spinner.divArray=Array(this.spinner.divCount).fill(0).map((t,e)=>e);let n="";switch(e.toLowerCase()){case"small":n="la-sm";break;case"medium":n="la-2x";break;case"large":n="la-3x"}return"la-"+t+" "+n}onInputChange(){this.spinner.class=this.getClass(this.spinner.type,this.spinner.size)}ngOnDestroy(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}},Lz=class{};var Bz=Wn({encapsulation:0,styles:['.la-ball-8bits[_ngcontent-%COMP%], .la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-8bits[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:12px;height:12px}.la-ball-8bits.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:4px;height:4px;border-radius:0;opacity:0;-webkit-transform:translate(100%,100%);transform:translate(100%,100%);-webkit-animation:1s infinite ball-8bits;animation:1s infinite ball-8bits}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:-.9375s;animation-delay:-.9375s;top:-100%;left:0}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.875s;animation-delay:-.875s;top:-100%;left:33.3333333333%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.8125s;animation-delay:-.8125s;top:-66.6666666667%;left:66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.75s;animation-delay:-.75s;top:-33.3333333333%;left:100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.6875s;animation-delay:-.6875s;top:0;left:100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-delay:-.625s;animation-delay:-.625s;top:33.3333333333%;left:100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-delay:-.5625s;animation-delay:-.5625s;top:66.6666666667%;left:66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-delay:-.5s;animation-delay:-.5s;top:100%;left:33.3333333333%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-delay:-.4375s;animation-delay:-.4375s;top:100%;left:0}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(10){-webkit-animation-delay:-.375s;animation-delay:-.375s;top:100%;left:-33.3333333333%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(11){-webkit-animation-delay:-.3125s;animation-delay:-.3125s;top:66.6666666667%;left:-66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(12){-webkit-animation-delay:-.25s;animation-delay:-.25s;top:33.3333333333%;left:-100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(13){-webkit-animation-delay:-.1875s;animation-delay:-.1875s;top:0;left:-100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(14){-webkit-animation-delay:-.125s;animation-delay:-.125s;top:-33.3333333333%;left:-100%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(15){-webkit-animation-delay:-.0625s;animation-delay:-.0625s;top:-66.6666666667%;left:-66.6666666667%}.la-ball-8bits[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(16){-webkit-animation-delay:0s;animation-delay:0s;top:-100%;left:-33.3333333333%}.la-ball-8bits.la-sm[_ngcontent-%COMP%]{width:6px;height:6px}.la-ball-8bits.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:2px}.la-ball-8bits.la-2x[_ngcontent-%COMP%]{width:24px;height:24px}.la-ball-8bits.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px}.la-ball-8bits.la-3x[_ngcontent-%COMP%]{width:36px;height:36px}.la-ball-8bits.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:12px}@-webkit-keyframes ball-8bits{0%,50%{opacity:1}51%{opacity:0}}@keyframes ball-8bits{0%,50%{opacity:1}51%{opacity:0}}.la-ball-atom[_ngcontent-%COMP%], .la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-atom[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-atom.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){position:absolute;top:50%;left:50%;z-index:1;width:60%;height:60%;background:#aaa;border-radius:100%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-animation:4.5s linear infinite ball-atom-shrink;animation:4.5s linear infinite ball-atom-shrink}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)){position:absolute;left:0;z-index:0;width:100%;height:100%;background:0 0;-webkit-animation:1.5s steps(2,end) infinite ball-atom-zindex;animation:1.5s steps(2,end) infinite ball-atom-zindex}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):before{position:absolute;top:0;left:0;width:10px;height:10px;margin-top:-5px;margin-left:-5px;content:"";background:currentColor;border-radius:50%;opacity:.75;-webkit-animation:1.5s infinite ball-atom-position,1.5s infinite ball-atom-size;animation:1.5s infinite ball-atom-position,1.5s infinite ball-atom-size}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:.75s;animation-delay:.75s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2):before{-webkit-animation-delay:0s,-1.125s;animation-delay:0s,-1.125s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-transform:rotate(120deg);transform:rotate(120deg);-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3):before{-webkit-animation-delay:-1s,-.75s;animation-delay:-1s,-.75s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-transform:rotate(240deg);transform:rotate(240deg);-webkit-animation-delay:.25s;animation-delay:.25s}.la-ball-atom[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4):before{-webkit-animation-delay:-.5s,-125ms;animation-delay:-.5s,-125ms}.la-ball-atom.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-atom.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):before{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-atom.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-atom.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):before{width:20px;height:20px;margin-top:-10px;margin-left:-10px}.la-ball-atom.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-atom.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):before{width:30px;height:30px;margin-top:-15px;margin-left:-15px}@-webkit-keyframes ball-atom-position{50%{top:100%;left:100%}}@keyframes ball-atom-position{50%{top:100%;left:100%}}@-webkit-keyframes ball-atom-size{50%{-webkit-transform:scale(.5,.5);transform:scale(.5,.5)}}@keyframes ball-atom-size{50%{-webkit-transform:scale(.5,.5);transform:scale(.5,.5)}}@-webkit-keyframes ball-atom-zindex{50%{z-index:10}}@keyframes ball-atom-zindex{50%{z-index:10}}@-webkit-keyframes ball-atom-shrink{50%{-webkit-transform:translate(-50%,-50%) scale(.8,.8);transform:translate(-50%,-50%) scale(.8,.8)}}@keyframes ball-atom-shrink{50%{-webkit-transform:translate(-50%,-50%) scale(.8,.8);transform:translate(-50%,-50%) scale(.8,.8)}}.la-ball-beat[_ngcontent-%COMP%], .la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-beat[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:54px;height:18px}.la-ball-beat.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;margin:4px;border-radius:100%;-webkit-animation:.7s linear -.15s infinite ball-beat;animation:.7s linear -.15s infinite ball-beat}.la-ball-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2n-1){-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-beat.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-beat.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-beat.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-beat.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-beat.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-beat.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes ball-beat{50%{opacity:.2;-webkit-transform:scale(.75);transform:scale(.75)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-beat{50%{opacity:.2;-webkit-transform:scale(.75);transform:scale(.75)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}.la-ball-circus[_ngcontent-%COMP%], .la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-circus[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:16px;height:16px}.la-ball-circus.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:0;left:-100%;display:block;width:100%;height:100%;border-radius:100%;opacity:.5;-webkit-animation:2.5s cubic-bezier(.25,0,.75,1) infinite ball-circus-position,2.5s cubic-bezier(.25,0,.75,1) infinite ball-circus-size;animation:2.5s cubic-bezier(.25,0,.75,1) infinite ball-circus-position,2.5s cubic-bezier(.25,0,.75,1) infinite ball-circus-size}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:0s,-.5s;animation-delay:0s,-.5s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.5s,-1s;animation-delay:-.5s,-1s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-1s,-1.5s;animation-delay:-1s,-1.5s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-1.5s,-2s;animation-delay:-1.5s,-2s}.la-ball-circus[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-2s,-2.5s;animation-delay:-2s,-2.5s}.la-ball-circus.la-sm[_ngcontent-%COMP%], .la-ball-circus.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px}.la-ball-circus.la-2x[_ngcontent-%COMP%], .la-ball-circus.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:32px;height:32px}.la-ball-circus.la-3x[_ngcontent-%COMP%], .la-ball-circus.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:48px;height:48px}@-webkit-keyframes ball-circus-position{50%{left:100%}}@keyframes ball-circus-position{50%{left:100%}}@-webkit-keyframes ball-circus-size{50%{-webkit-transform:scale(.3,.3);transform:scale(.3,.3)}}@keyframes ball-circus-size{50%{-webkit-transform:scale(.3,.3);transform:scale(.3,.3)}}.la-ball-climbing-dot[_ngcontent-%COMP%], .la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-climbing-dot[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:42px;height:32px}.la-ball-climbing-dot.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){position:absolute;bottom:32%;left:18%;width:14px;height:14px;border-radius:100%;-webkit-transform-origin:center bottom;transform-origin:center bottom;-webkit-animation:.6s ease-in-out infinite ball-climbing-dot-jump;animation:.6s ease-in-out infinite ball-climbing-dot-jump}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)){position:absolute;top:0;right:0;width:14px;height:2px;border-radius:0;-webkit-transform:translate(60%,0);transform:translate(60%,0);-webkit-animation:1.8s linear infinite ball-climbing-dot-steps;animation:1.8s linear infinite ball-climbing-dot-steps}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):nth-child(2){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):nth-child(3){-webkit-animation-delay:-.6s;animation-delay:-.6s}.la-ball-climbing-dot[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)):nth-child(4){-webkit-animation-delay:-1.2s;animation-delay:-1.2s}.la-ball-climbing-dot.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-ball-climbing-dot.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){width:6px;height:6px}.la-ball-climbing-dot.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)){width:6px;height:1px}.la-ball-climbing-dot.la-2x[_ngcontent-%COMP%]{width:84px;height:64px}.la-ball-climbing-dot.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){width:28px;height:28px}.la-ball-climbing-dot.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)){width:28px;height:4px}.la-ball-climbing-dot.la-3x[_ngcontent-%COMP%]{width:126px;height:96px}.la-ball-climbing-dot.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){width:42px;height:42px}.la-ball-climbing-dot.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(:nth-child(1)){width:42px;height:6px}@-webkit-keyframes ball-climbing-dot-jump{0%,100%{-webkit-transform:scale(1,.7);transform:scale(1,.7)}20%,80%,90%{-webkit-transform:scale(.7,1.2);transform:scale(.7,1.2)}40%,46%{-webkit-transform:scale(1,1);transform:scale(1,1)}50%{bottom:125%}}@keyframes ball-climbing-dot-jump{0%,100%{-webkit-transform:scale(1,.7);transform:scale(1,.7)}20%,80%,90%{-webkit-transform:scale(.7,1.2);transform:scale(.7,1.2)}40%,46%{-webkit-transform:scale(1,1);transform:scale(1,1)}50%{bottom:125%}}@-webkit-keyframes ball-climbing-dot-steps{0%{top:0;right:0;opacity:0}50%{opacity:1}100%{top:100%;right:100%;opacity:0}}@keyframes ball-climbing-dot-steps{0%{top:0;right:0;opacity:0}50%{opacity:1}100%{top:100%;right:100%;opacity:0}}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%], .la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-clip-rotate-multiple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px solid currentColor;position:absolute;top:50%;left:50%;background:0 0;border-radius:100%;-webkit-animation:1s ease-in-out infinite ball-clip-rotate-multiple-rotate;animation:1s ease-in-out infinite ball-clip-rotate-multiple-rotate}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{position:absolute;width:32px;height:32px;border-right-color:transparent;border-left-color:transparent}.la-ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:16px;height:16px;border-top-color:transparent;border-bottom-color:transparent;-webkit-animation-duration:.5s;animation-duration:.5s;-webkit-animation-direction:reverse;animation-direction:reverse}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:1px}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:16px;height:16px}.la-ball-clip-rotate-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:8px;height:8px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:4px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:64px;height:64px}.la-ball-clip-rotate-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:32px;height:32px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:6px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:96px;height:96px}.la-ball-clip-rotate-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:48px;height:48px}@-webkit-keyframes ball-clip-rotate-multiple-rotate{0%{-webkit-transform:translate(-50%,-50%) rotate(0);transform:translate(-50%,-50%) rotate(0)}50%{-webkit-transform:translate(-50%,-50%) rotate(180deg);transform:translate(-50%,-50%) rotate(180deg)}100%{-webkit-transform:translate(-50%,-50%) rotate(360deg);transform:translate(-50%,-50%) rotate(360deg)}}@keyframes ball-clip-rotate-multiple-rotate{0%{-webkit-transform:translate(-50%,-50%) rotate(0);transform:translate(-50%,-50%) rotate(0)}50%{-webkit-transform:translate(-50%,-50%) rotate(180deg);transform:translate(-50%,-50%) rotate(180deg)}100%{-webkit-transform:translate(-50%,-50%) rotate(360deg);transform:translate(-50%,-50%) rotate(360deg)}}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%], .la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-clip-rotate-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;border-radius:100%}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{position:absolute;width:32px;height:32px;background:0 0;border-style:solid;border-width:2px;border-right-color:transparent;border-left-color:transparent;-webkit-animation:1s cubic-bezier(.09,.57,.49,.9) infinite ball-clip-rotate-pulse-rotate;animation:1s cubic-bezier(.09,.57,.49,.9) infinite ball-clip-rotate-pulse-rotate}.la-ball-clip-rotate-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:16px;height:16px;-webkit-animation:1s cubic-bezier(.09,.57,.49,.9) infinite ball-clip-rotate-pulse-scale;animation:1s cubic-bezier(.09,.57,.49,.9) infinite ball-clip-rotate-pulse-scale}.la-ball-clip-rotate-pulse.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-clip-rotate-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:16px;height:16px;border-width:1px}.la-ball-clip-rotate-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:8px;height:8px}.la-ball-clip-rotate-pulse.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-clip-rotate-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:64px;height:64px;border-width:4px}.la-ball-clip-rotate-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:32px;height:32px}.la-ball-clip-rotate-pulse.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-clip-rotate-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:96px;height:96px;border-width:6px}.la-ball-clip-rotate-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{width:48px;height:48px}@-webkit-keyframes ball-clip-rotate-pulse-rotate{0%{-webkit-transform:translate(-50%,-50%) rotate(0);transform:translate(-50%,-50%) rotate(0)}50%{-webkit-transform:translate(-50%,-50%) rotate(180deg);transform:translate(-50%,-50%) rotate(180deg)}100%{-webkit-transform:translate(-50%,-50%) rotate(360deg);transform:translate(-50%,-50%) rotate(360deg)}}@keyframes ball-clip-rotate-pulse-rotate{0%{-webkit-transform:translate(-50%,-50%) rotate(0);transform:translate(-50%,-50%) rotate(0)}50%{-webkit-transform:translate(-50%,-50%) rotate(180deg);transform:translate(-50%,-50%) rotate(180deg)}100%{-webkit-transform:translate(-50%,-50%) rotate(360deg);transform:translate(-50%,-50%) rotate(360deg)}}@-webkit-keyframes ball-clip-rotate-pulse-scale{0%,100%{opacity:1;-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}30%{opacity:.3;-webkit-transform:translate(-50%,-50%) scale(.15);transform:translate(-50%,-50%) scale(.15)}}@keyframes ball-clip-rotate-pulse-scale{0%,100%{opacity:1;-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}30%{opacity:.3;-webkit-transform:translate(-50%,-50%) scale(.15);transform:translate(-50%,-50%) scale(.15)}}.la-ball-clip-rotate[_ngcontent-%COMP%], .la-ball-clip-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-clip-rotate[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-clip-rotate.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-clip-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px solid currentColor;width:32px;height:32px;background:0 0;border-bottom-color:transparent;border-radius:100%;-webkit-animation:.75s linear infinite ball-clip-rotate;animation:.75s linear infinite ball-clip-rotate}.la-ball-clip-rotate.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-clip-rotate.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-ball-clip-rotate.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-clip-rotate.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-ball-clip-rotate.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-clip-rotate.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}@-webkit-keyframes ball-clip-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ball-clip-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.la-ball-elastic-dots[_ngcontent-%COMP%], .la-ball-elastic-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-elastic-dots[_ngcontent-%COMP%]{display:block;color:#fff;width:120px;height:10px;font-size:0;text-align:center}.la-ball-elastic-dots.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-elastic-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{float:none;background-color:currentColor;border:0 solid currentColor;display:inline-block;width:10px;height:10px;white-space:nowrap;border-radius:100%;-webkit-animation:1s infinite ball-elastic-dots-anim;animation:1s infinite ball-elastic-dots-anim}.la-ball-elastic-dots.la-sm[_ngcontent-%COMP%]{width:60px;height:4px}.la-ball-elastic-dots.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-elastic-dots.la-2x[_ngcontent-%COMP%]{width:240px;height:20px}.la-ball-elastic-dots.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-elastic-dots.la-3x[_ngcontent-%COMP%]{width:360px;height:30px}.la-ball-elastic-dots.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes ball-elastic-dots-anim{0%,100%{margin:0;-webkit-transform:scale(1);transform:scale(1)}50%{margin:0 5%;-webkit-transform:scale(.65);transform:scale(.65)}}@keyframes ball-elastic-dots-anim{0%,100%{margin:0;-webkit-transform:scale(1);transform:scale(1)}50%{margin:0 5%;-webkit-transform:scale(.65);transform:scale(.65)}}.la-ball-fall[_ngcontent-%COMP%], .la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-fall[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:54px;height:18px}.la-ball-fall.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;margin:4px;border-radius:100%;opacity:0;-webkit-animation:1s ease-in-out infinite ball-fall;animation:1s ease-in-out infinite ball-fall}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:-.2s;animation-delay:-.2s}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.1s;animation-delay:-.1s}.la-ball-fall[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-fall.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-fall.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-fall.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-fall.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-fall.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-fall.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes ball-fall{0%{opacity:0;-webkit-transform:translateY(-145%);transform:translateY(-145%)}10%,90%{opacity:.5}20%,80%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}100%{opacity:0;-webkit-transform:translateY(145%);transform:translateY(145%)}}@keyframes ball-fall{0%{opacity:0;-webkit-transform:translateY(-145%);transform:translateY(-145%)}10%,90%{opacity:.5}20%,80%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}100%{opacity:0;-webkit-transform:translateY(145%);transform:translateY(145%)}}.la-ball-fussion[_ngcontent-%COMP%], .la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-fussion[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:8px;height:8px}.la-ball-fussion.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;width:12px;height:12px;border-radius:100%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-animation:1s infinite ball-fussion-ball1;animation:1s infinite ball-fussion-ball1}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:0;left:50%;z-index:1}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:50%;left:100%;z-index:2;-webkit-animation-name:ball-fussion-ball2;animation-name:ball-fussion-ball2}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:100%;left:50%;z-index:1;-webkit-animation-name:ball-fussion-ball3;animation-name:ball-fussion-ball3}.la-ball-fussion[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:50%;left:0;z-index:2;-webkit-animation-name:ball-fussion-ball4;animation-name:ball-fussion-ball4}.la-ball-fussion.la-sm[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-fussion.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px}.la-ball-fussion.la-2x[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-fussion.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-ball-fussion.la-3x[_ngcontent-%COMP%]{width:24px;height:24px}.la-ball-fussion.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px}@-webkit-keyframes ball-fussion-ball1{0%{opacity:.35}50%{top:-100%;left:200%;opacity:1}100%{top:50%;left:100%;z-index:2;opacity:.35}}@keyframes ball-fussion-ball1{0%{opacity:.35}50%{top:-100%;left:200%;opacity:1}100%{top:50%;left:100%;z-index:2;opacity:.35}}@-webkit-keyframes ball-fussion-ball2{0%{opacity:.35}50%{top:200%;left:200%;opacity:1}100%{top:100%;left:50%;z-index:1;opacity:.35}}@keyframes ball-fussion-ball2{0%{opacity:.35}50%{top:200%;left:200%;opacity:1}100%{top:100%;left:50%;z-index:1;opacity:.35}}@-webkit-keyframes ball-fussion-ball3{0%{opacity:.35}50%{top:200%;left:-100%;opacity:1}100%{top:50%;left:0;z-index:2;opacity:.35}}@keyframes ball-fussion-ball3{0%{opacity:.35}50%{top:200%;left:-100%;opacity:1}100%{top:50%;left:0;z-index:2;opacity:.35}}@-webkit-keyframes ball-fussion-ball4{0%{opacity:.35}50%{top:-100%;left:-100%;opacity:1}100%{top:0;left:50%;z-index:1;opacity:.35}}@keyframes ball-fussion-ball4{0%{opacity:.35}50%{top:-100%;left:-100%;opacity:1}100%{top:0;left:50%;z-index:1;opacity:.35}}.la-ball-grid-beat[_ngcontent-%COMP%], .la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-grid-beat[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:36px;height:36px}.la-ball-grid-beat.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:8px;height:8px;margin:2px;border-radius:100%;-webkit-animation-name:ball-grid-beat;animation-name:ball-grid-beat;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-duration:.65s;animation-duration:.65s;-webkit-animation-delay:.03s;animation-delay:.03s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:1.02s;animation-duration:1.02s;-webkit-animation-delay:.09s;animation-delay:.09s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:1.06s;animation-duration:1.06s;-webkit-animation-delay:-.69s;animation-delay:-.69s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-delay:-.41s;animation-delay:-.41s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:1.6s;animation-duration:1.6s;-webkit-animation-delay:.04s;animation-delay:.04s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-duration:.84s;animation-duration:.84s;-webkit-animation-delay:.07s;animation-delay:.07s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-duration:.68s;animation-duration:.68s;-webkit-animation-delay:-.66s;animation-delay:-.66s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-duration:.93s;animation-duration:.93s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-beat[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-duration:1.24s;animation-duration:1.24s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-beat.la-sm[_ngcontent-%COMP%]{width:18px;height:18px}.la-ball-grid-beat.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-grid-beat.la-2x[_ngcontent-%COMP%]{width:72px;height:72px}.la-ball-grid-beat.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin:4px}.la-ball-grid-beat.la-3x[_ngcontent-%COMP%]{width:108px;height:108px}.la-ball-grid-beat.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin:6px}@-webkit-keyframes ball-grid-beat{0%,100%{opacity:1}50%{opacity:.35}}@keyframes ball-grid-beat{0%,100%{opacity:1}50%{opacity:.35}}.la-ball-grid-pulse[_ngcontent-%COMP%], .la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-grid-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:36px;height:36px}.la-ball-grid-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:8px;height:8px;margin:2px;border-radius:100%;-webkit-animation-name:ball-grid-pulse;animation-name:ball-grid-pulse;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-duration:.65s;animation-duration:.65s;-webkit-animation-delay:.03s;animation-delay:.03s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:1.02s;animation-duration:1.02s;-webkit-animation-delay:.09s;animation-delay:.09s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:1.06s;animation-duration:1.06s;-webkit-animation-delay:-.69s;animation-delay:-.69s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-delay:-.41s;animation-delay:-.41s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:1.6s;animation-duration:1.6s;-webkit-animation-delay:.04s;animation-delay:.04s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-duration:.84s;animation-duration:.84s;-webkit-animation-delay:.07s;animation-delay:.07s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-duration:.68s;animation-duration:.68s;-webkit-animation-delay:-.66s;animation-delay:-.66s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-duration:.93s;animation-duration:.93s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-duration:1.24s;animation-duration:1.24s;-webkit-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-pulse.la-sm[_ngcontent-%COMP%]{width:18px;height:18px}.la-ball-grid-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-grid-pulse.la-2x[_ngcontent-%COMP%]{width:72px;height:72px}.la-ball-grid-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin:4px}.la-ball-grid-pulse.la-3x[_ngcontent-%COMP%]{width:108px;height:108px}.la-ball-grid-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin:6px}@-webkit-keyframes ball-grid-pulse{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.35;-webkit-transform:scale(.45);transform:scale(.45)}}@keyframes ball-grid-pulse{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.35;-webkit-transform:scale(.45);transform:scale(.45)}}.la-ball-newton-cradle[_ngcontent-%COMP%], .la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-newton-cradle[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:40px;height:10px}.la-ball-newton-cradle.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;border-radius:100%}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-transform:translateX(0);transform:translateX(0);-webkit-animation:1s ease-out infinite ball-newton-cradle-left;animation:1s ease-out infinite ball-newton-cradle-left}.la-ball-newton-cradle[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-transform:translateX(0);transform:translateX(0);-webkit-animation:1s ease-out infinite ball-newton-cradle-right;animation:1s ease-out infinite ball-newton-cradle-right}.la-ball-newton-cradle.la-sm[_ngcontent-%COMP%]{width:20px;height:4px}.la-ball-newton-cradle.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-newton-cradle.la-2x[_ngcontent-%COMP%]{width:80px;height:20px}.la-ball-newton-cradle.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-newton-cradle.la-3x[_ngcontent-%COMP%]{width:120px;height:30px}.la-ball-newton-cradle.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes ball-newton-cradle-left{25%{-webkit-transform:translateX(-100%);transform:translateX(-100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes ball-newton-cradle-left{25%{-webkit-transform:translateX(-100%);transform:translateX(-100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}50%{-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes ball-newton-cradle-right{100%,50%{-webkit-transform:translateX(0);transform:translateX(0)}75%{-webkit-transform:translateX(100%);transform:translateX(100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes ball-newton-cradle-right{100%,50%{-webkit-transform:translateX(0);transform:translateX(0)}75%{-webkit-transform:translateX(100%);transform:translateX(100%);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.la-ball-pulse-rise[_ngcontent-%COMP%], .la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-pulse-rise[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:70px;height:14px}.la-ball-pulse-rise.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;margin:2px;border-radius:100%;-webkit-animation:1s cubic-bezier(.15,.36,.9,.6) infinite ball-pulse-rise-even;animation:1s cubic-bezier(.15,.36,.9,.6) infinite ball-pulse-rise-even}.la-ball-pulse-rise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2n-1){-webkit-animation-name:ball-pulse-rise-odd;animation-name:ball-pulse-rise-odd}.la-ball-pulse-rise.la-sm[_ngcontent-%COMP%]{width:34px;height:6px}.la-ball-pulse-rise.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-pulse-rise.la-2x[_ngcontent-%COMP%]{width:140px;height:28px}.la-ball-pulse-rise.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:4px}.la-ball-pulse-rise.la-3x[_ngcontent-%COMP%]{width:210px;height:42px}.la-ball-pulse-rise.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:6px}@-webkit-keyframes ball-pulse-rise-even{0%{opacity:1;-webkit-transform:scale(1.1);transform:scale(1.1)}25%{-webkit-transform:translateY(-200%);transform:translateY(-200%)}50%{opacity:.35;-webkit-transform:scale(.3);transform:scale(.3)}75%{-webkit-transform:translateY(200%);transform:translateY(200%)}100%{opacity:1;-webkit-transform:translateY(0);-webkit-transform:scale(1);transform:translateY(0);transform:scale(1)}}@keyframes ball-pulse-rise-even{0%{opacity:1;-webkit-transform:scale(1.1);transform:scale(1.1)}25%{-webkit-transform:translateY(-200%);transform:translateY(-200%)}50%{opacity:.35;-webkit-transform:scale(.3);transform:scale(.3)}75%{-webkit-transform:translateY(200%);transform:translateY(200%)}100%{opacity:1;-webkit-transform:translateY(0);-webkit-transform:scale(1);transform:translateY(0);transform:scale(1)}}@-webkit-keyframes ball-pulse-rise-odd{0%{opacity:.35;-webkit-transform:scale(.4);transform:scale(.4)}25%{-webkit-transform:translateY(200%);transform:translateY(200%)}50%{opacity:1;-webkit-transform:scale(1.1);transform:scale(1.1)}75%{-webkit-transform:translateY(-200%);transform:translateY(-200%)}100%{opacity:.35;-webkit-transform:translateY(0);-webkit-transform:scale(.75);transform:translateY(0);transform:scale(.75)}}@keyframes ball-pulse-rise-odd{0%{opacity:.35;-webkit-transform:scale(.4);transform:scale(.4)}25%{-webkit-transform:translateY(200%);transform:translateY(200%)}50%{opacity:1;-webkit-transform:scale(1.1);transform:scale(1.1)}75%{-webkit-transform:translateY(-200%);transform:translateY(-200%)}100%{opacity:.35;-webkit-transform:translateY(0);-webkit-transform:scale(.75);transform:translateY(0);transform:scale(.75)}}.la-ball-pulse-sync[_ngcontent-%COMP%], .la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-pulse-sync[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:54px;height:18px}.la-ball-pulse-sync.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;margin:4px;border-radius:100%;-webkit-animation:.6s ease-in-out infinite ball-pulse-sync;animation:.6s ease-in-out infinite ball-pulse-sync}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:-.14s;animation-delay:-.14s}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.07s;animation-delay:-.07s}.la-ball-pulse-sync[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-pulse-sync.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-pulse-sync.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-pulse-sync.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-pulse-sync.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-pulse-sync.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-pulse-sync.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes ball-pulse-sync{33%{-webkit-transform:translateY(100%);transform:translateY(100%)}66%{-webkit-transform:translateY(-100%);transform:translateY(-100%)}100%{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes ball-pulse-sync{33%{-webkit-transform:translateY(100%);transform:translateY(100%)}66%{-webkit-transform:translateY(-100%);transform:translateY(-100%)}100%{-webkit-transform:translateY(0);transform:translateY(0)}}.la-ball-pulse[_ngcontent-%COMP%], .la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:54px;height:18px}.la-ball-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;margin:4px;border-radius:100%;-webkit-animation:1s infinite ball-pulse;animation:1s infinite ball-pulse}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:-.2s;animation-delay:-.2s}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.1s;animation-delay:-.1s}.la-ball-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-pulse.la-sm[_ngcontent-%COMP%]{width:26px;height:8px}.la-ball-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:2px}.la-ball-pulse.la-2x[_ngcontent-%COMP%]{width:108px;height:36px}.la-ball-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin:8px}.la-ball-pulse.la-3x[_ngcontent-%COMP%]{width:162px;height:54px}.la-ball-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin:12px}@-webkit-keyframes ball-pulse{0%,100%,60%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}30%{opacity:.1;-webkit-transform:scale(.01);transform:scale(.01)}}@keyframes ball-pulse{0%,100%,60%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}30%{opacity:.1;-webkit-transform:scale(.01);transform:scale(.01)}}.la-ball-rotate[_ngcontent-%COMP%], .la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-rotate[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:10px;height:10px}.la-ball-rotate.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:10px;height:10px;border-radius:100%;-webkit-animation:1s cubic-bezier(.7,-.13,.22,.86) infinite ball-rotate-animation;animation:1s cubic-bezier(.7,-.13,.22,.86) infinite ball-rotate-animation}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{position:absolute;width:inherit;height:inherit;margin:inherit;content:"";background:currentColor;border-radius:inherit;opacity:.8}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:0;left:-150%}.la-ball-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{top:0;left:150%}.la-ball-rotate.la-sm[_ngcontent-%COMP%], .la-ball-rotate.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-rotate.la-2x[_ngcontent-%COMP%], .la-ball-rotate.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-rotate.la-3x[_ngcontent-%COMP%], .la-ball-rotate.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes ball-rotate-animation{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ball-rotate-animation{0%{-webkit-transform:rotate(0);transform:rotate(0)}50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.la-ball-running-dots[_ngcontent-%COMP%], .la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-running-dots[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:10px;height:10px}.la-ball-running-dots.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;width:10px;height:10px;margin-left:-25px;border-radius:100%;-webkit-animation:2s linear infinite ball-running-dots-animate;animation:2s linear infinite ball-running-dots-animate}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-.4s;animation-delay:-.4s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.8s;animation-delay:-.8s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-1.2s;animation-delay:-1.2s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-1.6s;animation-delay:-1.6s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-delay:-2.4s;animation-delay:-2.4s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-delay:-2.8s;animation-delay:-2.8s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-delay:-3.2s;animation-delay:-3.2s}.la-ball-running-dots[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(10){-webkit-animation-delay:-3.6s;animation-delay:-3.6s}.la-ball-running-dots.la-sm[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-running-dots.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-left:-12px}.la-ball-running-dots.la-2x[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-running-dots.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:-50px}.la-ball-running-dots.la-3x[_ngcontent-%COMP%]{width:30px;height:30px}.la-ball-running-dots.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin-left:-75px}@-webkit-keyframes ball-running-dots-animate{0%,100%{width:100%;height:100%;-webkit-transform:translateY(0) translateX(500%);transform:translateY(0) translateX(500%)}80%{-webkit-transform:translateY(0) translateX(0);transform:translateY(0) translateX(0)}85%{width:100%;height:100%;-webkit-transform:translateY(-125%) translateX(0);transform:translateY(-125%) translateX(0)}90%{width:200%;height:75%}95%{width:100%;height:100%;-webkit-transform:translateY(-100%) translateX(500%);transform:translateY(-100%) translateX(500%)}}@keyframes ball-running-dots-animate{0%,100%{width:100%;height:100%;-webkit-transform:translateY(0) translateX(500%);transform:translateY(0) translateX(500%)}80%{-webkit-transform:translateY(0) translateX(0);transform:translateY(0) translateX(0)}85%{width:100%;height:100%;-webkit-transform:translateY(-125%) translateX(0);transform:translateY(-125%) translateX(0)}90%{width:200%;height:75%}95%{width:100%;height:100%;-webkit-transform:translateY(-100%) translateX(500%);transform:translateY(-100%) translateX(500%)}}.la-ball-scale-multiple[_ngcontent-%COMP%], .la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-multiple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-scale-multiple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:0;left:0;width:32px;height:32px;border-radius:100%;opacity:0;-webkit-animation:1s linear infinite ball-scale-multiple;animation:1s linear infinite ball-scale-multiple}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.la-ball-scale-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}.la-ball-scale-multiple.la-sm[_ngcontent-%COMP%], .la-ball-scale-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-multiple.la-2x[_ngcontent-%COMP%], .la-ball-scale-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-multiple.la-3x[_ngcontent-%COMP%], .la-ball-scale-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes ball-scale-multiple{0%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}5%{opacity:.75}100%{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-scale-multiple{0%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}5%{opacity:.75}100%{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}.la-ball-scale-pulse[_ngcontent-%COMP%], .la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-scale-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:0;left:0;width:32px;height:32px;border-radius:100%;opacity:.5;-webkit-animation:2s ease-in-out infinite ball-scale-pulse;animation:2s ease-in-out infinite ball-scale-pulse}.la-ball-scale-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation-delay:-1s;animation-delay:-1s}.la-ball-scale-pulse.la-sm[_ngcontent-%COMP%], .la-ball-scale-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-pulse.la-2x[_ngcontent-%COMP%], .la-ball-scale-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-pulse.la-3x[_ngcontent-%COMP%], .la-ball-scale-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes ball-scale-pulse{0%,100%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-scale-pulse{0%,100%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1);transform:scale(1)}}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%], .la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-scale-ripple-multiple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px solid currentColor;position:absolute;top:0;left:0;width:32px;height:32px;background:0 0;border-radius:100%;opacity:0;-webkit-animation:1.25s cubic-bezier(.21,.53,.56,.8) infinite ball-scale-ripple-multiple;animation:1.25s cubic-bezier(.21,.53,.56,.8) infinite ball-scale-ripple-multiple}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:.25s;animation-delay:.25s}.la-ball-scale-ripple-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:.5s;animation-delay:.5s}.la-ball-scale-ripple-multiple.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-ripple-multiple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-ball-scale-ripple-multiple.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-ripple-multiple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-ball-scale-ripple-multiple.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-scale-ripple-multiple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}@-webkit-keyframes ball-scale-ripple-multiple{0%{opacity:1;-webkit-transform:scale(.1);transform:scale(.1)}70%{opacity:.5;-webkit-transform:scale(1);transform:scale(1)}95%{opacity:0}}@keyframes ball-scale-ripple-multiple{0%{opacity:1;-webkit-transform:scale(.1);transform:scale(.1)}70%{opacity:.5;-webkit-transform:scale(1);transform:scale(1)}95%{opacity:0}}.la-ball-scale-ripple[_ngcontent-%COMP%], .la-ball-scale-ripple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale-ripple[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-scale-ripple.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale-ripple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px solid currentColor;width:32px;height:32px;background:0 0;border-radius:100%;opacity:0;-webkit-animation:1s cubic-bezier(.21,.53,.56,.8) infinite ball-scale-ripple;animation:1s cubic-bezier(.21,.53,.56,.8) infinite ball-scale-ripple}.la-ball-scale-ripple.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale-ripple.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-ball-scale-ripple.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale-ripple.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-ball-scale-ripple.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-scale-ripple.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}@-webkit-keyframes ball-scale-ripple{0%{opacity:1;-webkit-transform:scale(.1);transform:scale(.1)}70%{opacity:.65;-webkit-transform:scale(1);transform:scale(1)}100%{opacity:0}}@keyframes ball-scale-ripple{0%{opacity:1;-webkit-transform:scale(.1);transform:scale(.1)}70%{opacity:.65;-webkit-transform:scale(1);transform:scale(1)}100%{opacity:0}}.la-ball-scale[_ngcontent-%COMP%], .la-ball-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-scale[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-scale.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:32px;height:32px;border-radius:100%;opacity:0;-webkit-animation:1s ease-in-out infinite ball-scale;animation:1s ease-in-out infinite ball-scale}.la-ball-scale.la-sm[_ngcontent-%COMP%], .la-ball-scale.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-scale.la-2x[_ngcontent-%COMP%], .la-ball-scale.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-scale.la-3x[_ngcontent-%COMP%], .la-ball-scale.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes ball-scale{0%{opacity:1;-webkit-transform:scale(0);transform:scale(0)}100%{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-scale{0%{opacity:1;-webkit-transform:scale(0);transform:scale(0)}100%{opacity:0;-webkit-transform:scale(1);transform:scale(1)}}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%], .la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px;-webkit-animation:6s linear infinite ball-spin-clockwise-fade-rotating-rotate;animation:6s linear infinite ball-spin-clockwise-fade-rotating-rotate}.la-ball-spin-clockwise-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:1s linear infinite ball-spin-clockwise-fade-rotating;animation:1s linear infinite ball-spin-clockwise-fade-rotating}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:5%;left:50%;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes ball-spin-clockwise-fade-rotating-rotate{100%{-webkit-transform:rotate(-360deg);transform:rotate(-360deg)}}@keyframes ball-spin-clockwise-fade-rotating-rotate{100%{-webkit-transform:rotate(-360deg);transform:rotate(-360deg)}}@-webkit-keyframes ball-spin-clockwise-fade-rotating{50%{opacity:.25;-webkit-transform:scale(.5);transform:scale(.5)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-spin-clockwise-fade-rotating{50%{opacity:.25;-webkit-transform:scale(.5);transform:scale(.5)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%], .la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-spin-clockwise-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:1s linear infinite ball-spin-clockwise-fade;animation:1s linear infinite ball-spin-clockwise-fade}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:5%;left:50%;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-spin-clockwise-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-clockwise-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-clockwise-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-clockwise-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-clockwise-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-clockwise-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes ball-spin-clockwise-fade{50%{opacity:.25;-webkit-transform:scale(.5);transform:scale(.5)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-spin-clockwise-fade{50%{opacity:.25;-webkit-transform:scale(.5);transform:scale(.5)}100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}.la-ball-spin-clockwise[_ngcontent-%COMP%], .la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-clockwise[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-spin-clockwise.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:1s ease-in-out infinite ball-spin-clockwise;animation:1s ease-in-out infinite ball-spin-clockwise}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:5%;left:50%;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-spin-clockwise[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-spin-clockwise.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-clockwise.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-clockwise.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-clockwise.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-clockwise.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-clockwise.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes ball-spin-clockwise{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}20%{opacity:1}80%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}@keyframes ball-spin-clockwise{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}20%{opacity:1}80%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}.la-ball-spin-fade-rotating[_ngcontent-%COMP%], .la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px;-webkit-animation:6s linear infinite ball-spin-fade-rotate;animation:6s linear infinite ball-spin-fade-rotate}.la-ball-spin-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:1s linear infinite ball-spin-fade;animation:1s linear infinite ball-spin-fade}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:5%;left:50%;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-spin-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes ball-spin-fade-rotate{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ball-spin-fade-rotate{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.la-ball-spin-fade[_ngcontent-%COMP%], .la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-spin-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:1s linear infinite ball-spin-fade;animation:1s linear infinite ball-spin-fade}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:5%;left:50%;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-spin-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes ball-spin-fade{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.25;-webkit-transform:scale(.5);transform:scale(.5)}}@keyframes ball-spin-fade{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.25;-webkit-transform:scale(.5);transform:scale(.5)}}.la-ball-spin-rotate[_ngcontent-%COMP%], .la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin-rotate[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px;-webkit-animation:2s linear infinite ball-spin-rotate;animation:2s linear infinite ball-spin-rotate}.la-ball-spin-rotate.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:0;width:60%;height:60%;border-radius:100%;-webkit-animation:2s ease-in-out infinite ball-spin-bounce;animation:2s ease-in-out infinite ball-spin-bounce}.la-ball-spin-rotate[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{top:auto;bottom:0;-webkit-animation-delay:-1s;animation-delay:-1s}.la-ball-spin-rotate.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin-rotate.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin-rotate.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes ball-spin-rotate{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ball-spin-rotate{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes ball-spin-bounce{0%,100%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-spin-bounce{0%,100%{-webkit-transform:scale(0);transform:scale(0)}50%{-webkit-transform:scale(1);transform:scale(1)}}.la-ball-spin[_ngcontent-%COMP%], .la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:8px;height:8px;margin-top:-4px;margin-left:-4px;border-radius:100%;-webkit-animation:1s ease-in-out infinite ball-spin;animation:1s ease-in-out infinite ball-spin}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:5%;left:50%;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:18.1801948466%;left:81.8198051534%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:95%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:81.8198051534%;left:81.8198051534%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:94.9999999966%;left:50.0000000005%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:81.8198046966%;left:18.1801949248%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999750815%;left:5.0000051215%;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:18.179464974%;left:18.1803700518%;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-spin.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-spin.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin-top:-8px;margin-left:-8px}.la-ball-spin.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}@-webkit-keyframes ball-spin{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}20%{opacity:1}80%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}@keyframes ball-spin{0%,100%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}20%{opacity:1}80%{opacity:0;-webkit-transform:scale(0);transform:scale(0)}}.la-ball-square-clockwise-spin[_ngcontent-%COMP%], .la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-square-clockwise-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:26px;height:26px}.la-ball-square-clockwise-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:12px;height:12px;margin-top:-6px;margin-left:-6px;border-radius:100%;-webkit-animation:1s ease-in-out infinite ball-square-clockwise-spin;animation:1s ease-in-out infinite ball-square-clockwise-spin}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:0;left:0;-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0;left:50%;-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:0;left:100%;-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:50%;left:100%;-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:100%;left:100%;-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:100%;left:50%;-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:100%;left:0;-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-ball-square-clockwise-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:50%;left:0;-webkit-animation-delay:0s;animation-delay:0s}.la-ball-square-clockwise-spin.la-sm[_ngcontent-%COMP%]{width:12px;height:12px}.la-ball-square-clockwise-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;margin-top:-3px;margin-left:-3px}.la-ball-square-clockwise-spin.la-2x[_ngcontent-%COMP%]{width:52px;height:52px}.la-ball-square-clockwise-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}.la-ball-square-clockwise-spin.la-3x[_ngcontent-%COMP%]{width:78px;height:78px}.la-ball-square-clockwise-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px;margin-top:-18px;margin-left:-18px}@-webkit-keyframes ball-square-clockwise-spin{0%,100%,40%{-webkit-transform:scale(.4);transform:scale(.4)}70%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-square-clockwise-spin{0%,100%,40%{-webkit-transform:scale(.4);transform:scale(.4)}70%{-webkit-transform:scale(1);transform:scale(1)}}.la-ball-square-spin[_ngcontent-%COMP%], .la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-square-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:26px;height:26px}.la-ball-square-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:12px;height:12px;margin-top:-6px;margin-left:-6px;border-radius:100%;-webkit-animation:1s ease-in-out infinite ball-square-spin;animation:1s ease-in-out infinite ball-square-spin}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:0;left:0;-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:0;left:50%;-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:0;left:100%;-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:50%;left:100%;-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:100%;left:100%;-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:100%;left:50%;-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:100%;left:0;-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-ball-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:50%;left:0;-webkit-animation-delay:-2s;animation-delay:-2s}.la-ball-square-spin.la-sm[_ngcontent-%COMP%]{width:12px;height:12px}.la-ball-square-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;margin-top:-3px;margin-left:-3px}.la-ball-square-spin.la-2x[_ngcontent-%COMP%]{width:52px;height:52px}.la-ball-square-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin-top:-12px;margin-left:-12px}.la-ball-square-spin.la-3x[_ngcontent-%COMP%]{width:78px;height:78px}.la-ball-square-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px;margin-top:-18px;margin-left:-18px}@-webkit-keyframes ball-square-spin{0%,100%,40%{-webkit-transform:scale(.4);transform:scale(.4)}70%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes ball-square-spin{0%,100%,40%{-webkit-transform:scale(.4);transform:scale(.4)}70%{-webkit-transform:scale(1);transform:scale(1)}}.la-ball-triangle-path[_ngcontent-%COMP%], .la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-ball-triangle-path[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-ball-triangle-path.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:0;left:0;width:10px;height:10px;border-radius:100%}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation:2s ease-in-out infinite ball-triangle-path-ball-one;animation:2s ease-in-out infinite ball-triangle-path-ball-one}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation:2s ease-in-out infinite ball-triangle-path-ball-two;animation:2s ease-in-out infinite ball-triangle-path-ball-two}.la-ball-triangle-path[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation:2s ease-in-out infinite ball-triangle-path-ball-tree;animation:2s ease-in-out infinite ball-triangle-path-ball-tree}.la-ball-triangle-path.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-triangle-path.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px}.la-ball-triangle-path.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-triangle-path.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px}.la-ball-triangle-path.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-triangle-path.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px}@-webkit-keyframes ball-triangle-path-ball-one{0%{-webkit-transform:translate(0,220%);transform:translate(0,220%)}17%,50%,83%{opacity:.25}33%{opacity:1;-webkit-transform:translate(110%,0);transform:translate(110%,0)}66%{opacity:1;-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}100%{opacity:1;-webkit-transform:translate(0,220%);transform:translate(0,220%)}}@keyframes ball-triangle-path-ball-one{0%{-webkit-transform:translate(0,220%);transform:translate(0,220%)}17%,50%,83%{opacity:.25}33%{opacity:1;-webkit-transform:translate(110%,0);transform:translate(110%,0)}66%{opacity:1;-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}100%{opacity:1;-webkit-transform:translate(0,220%);transform:translate(0,220%)}}@-webkit-keyframes ball-triangle-path-ball-two{0%{-webkit-transform:translate(110%,0);transform:translate(110%,0)}17%,50%,83%{opacity:.25}33%{opacity:1;-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}66%{opacity:1;-webkit-transform:translate(0,220%);transform:translate(0,220%)}100%{opacity:1;-webkit-transform:translate(110%,0);transform:translate(110%,0)}}@keyframes ball-triangle-path-ball-two{0%{-webkit-transform:translate(110%,0);transform:translate(110%,0)}17%,50%,83%{opacity:.25}33%{opacity:1;-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}66%{opacity:1;-webkit-transform:translate(0,220%);transform:translate(0,220%)}100%{opacity:1;-webkit-transform:translate(110%,0);transform:translate(110%,0)}}@-webkit-keyframes ball-triangle-path-ball-tree{0%{-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}17%,50%,83%{opacity:.25}33%{opacity:1;-webkit-transform:translate(0,220%);transform:translate(0,220%)}66%{opacity:1;-webkit-transform:translate(110%,0);transform:translate(110%,0)}100%{opacity:1;-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}}@keyframes ball-triangle-path-ball-tree{0%{-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}17%,50%,83%{opacity:.25}33%{opacity:1;-webkit-transform:translate(0,220%);transform:translate(0,220%)}66%{opacity:1;-webkit-transform:translate(110%,0);transform:translate(110%,0)}100%{opacity:1;-webkit-transform:translate(220%,220%);transform:translate(220%,220%)}}.la-ball-zig-zag-deflect[_ngcontent-%COMP%], .la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box}.la-ball-zig-zag-deflect[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;position:relative;width:32px;height:32px}.la-ball-zig-zag-deflect.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:10px;height:10px;margin-top:-5px;margin-left:-5px;border-radius:100%}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation:1.5s linear infinite ball-zig-deflect;animation:1.5s linear infinite ball-zig-deflect}.la-ball-zig-zag-deflect[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation:1.5s linear infinite ball-zag-deflect;animation:1.5s linear infinite ball-zag-deflect}.la-ball-zig-zag-deflect.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-zig-zag-deflect.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-zig-zag-deflect.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-zig-zag-deflect.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin-top:-10px;margin-left:-10px}.la-ball-zig-zag-deflect.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-zig-zag-deflect.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin-top:-15px;margin-left:-15px}@-webkit-keyframes ball-zig-deflect{17%,84%{-webkit-transform:translate(-80%,-160%);transform:translate(-80%,-160%)}34%,67%{-webkit-transform:translate(80%,-160%);transform:translate(80%,-160%)}100%,50%{-webkit-transform:translate(0,0);transform:translate(0,0)}}@keyframes ball-zig-deflect{17%,84%{-webkit-transform:translate(-80%,-160%);transform:translate(-80%,-160%)}34%,67%{-webkit-transform:translate(80%,-160%);transform:translate(80%,-160%)}100%,50%{-webkit-transform:translate(0,0);transform:translate(0,0)}}@-webkit-keyframes ball-zag-deflect{17%,84%{-webkit-transform:translate(80%,160%);transform:translate(80%,160%)}34%,67%{-webkit-transform:translate(-80%,160%);transform:translate(-80%,160%)}100%,50%{-webkit-transform:translate(0,0);transform:translate(0,0)}}@keyframes ball-zag-deflect{17%,84%{-webkit-transform:translate(80%,160%);transform:translate(80%,160%)}34%,67%{-webkit-transform:translate(-80%,160%);transform:translate(-80%,160%)}100%,50%{-webkit-transform:translate(0,0);transform:translate(0,0)}}.la-ball-zig-zag[_ngcontent-%COMP%], .la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box}.la-ball-zig-zag[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;position:relative;width:32px;height:32px}.la-ball-zig-zag.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:50%;left:50%;width:10px;height:10px;margin-top:-5px;margin-left:-5px;border-radius:100%}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{-webkit-animation:.7s linear infinite ball-zig-effect;animation:.7s linear infinite ball-zig-effect}.la-ball-zig-zag[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation:.7s linear infinite ball-zag-effect;animation:.7s linear infinite ball-zag-effect}.la-ball-zig-zag.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-ball-zig-zag.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin-top:-2px;margin-left:-2px}.la-ball-zig-zag.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-ball-zig-zag.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:20px;height:20px;margin-top:-10px;margin-left:-10px}.la-ball-zig-zag.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-ball-zig-zag.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:30px;height:30px;margin-top:-15px;margin-left:-15px}@-webkit-keyframes ball-zig-effect{0%,100%{-webkit-transform:translate(0,0);transform:translate(0,0)}33%{-webkit-transform:translate(-75%,-150%);transform:translate(-75%,-150%)}66%{-webkit-transform:translate(75%,-150%);transform:translate(75%,-150%)}}@keyframes ball-zig-effect{0%,100%{-webkit-transform:translate(0,0);transform:translate(0,0)}33%{-webkit-transform:translate(-75%,-150%);transform:translate(-75%,-150%)}66%{-webkit-transform:translate(75%,-150%);transform:translate(75%,-150%)}}@-webkit-keyframes ball-zag-effect{0%,100%{-webkit-transform:translate(0,0);transform:translate(0,0)}33%{-webkit-transform:translate(75%,150%);transform:translate(75%,150%)}66%{-webkit-transform:translate(-75%,150%);transform:translate(-75%,150%)}}@keyframes ball-zag-effect{0%,100%{-webkit-transform:translate(0,0);transform:translate(0,0)}33%{-webkit-transform:translate(75%,150%);transform:translate(75%,150%)}66%{-webkit-transform:translate(-75%,150%);transform:translate(-75%,150%)}}.la-cog[_ngcontent-%COMP%], .la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-cog[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:31px;height:31px}.la-cog.la-dark[_ngcontent-%COMP%]{color:#333}.la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px dashed currentColor;width:100%;height:100%;background-color:transparent;border-radius:100%;-webkit-animation:4s linear infinite cog-rotate;animation:4s linear infinite cog-rotate}.la-cog[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;width:100%;height:100%;content:"";border:2px solid currentColor;border-radius:100%}.la-cog.la-sm[_ngcontent-%COMP%]{width:15px;height:15px}.la-cog.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-cog.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{border-width:1px}.la-cog.la-2x[_ngcontent-%COMP%]{width:61px;height:61px}.la-cog.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-cog.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{border-width:4px}.la-cog.la-3x[_ngcontent-%COMP%]{width:91px;height:91px}.la-cog.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .la-cog.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{border-width:6px}@-webkit-keyframes cog-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes cog-rotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.la-cube-transition[_ngcontent-%COMP%], .la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-cube-transition[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-cube-transition.la-dark[_ngcontent-%COMP%]{color:#333}.la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;top:0;left:0;width:14px;height:14px;margin-top:-7px;margin-left:-7px;border-radius:0;-webkit-animation:1.6s ease-in-out infinite cube-transition;animation:1.6s ease-in-out infinite cube-transition}.la-cube-transition[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{-webkit-animation-delay:-.8s;animation-delay:-.8s}.la-cube-transition.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-cube-transition.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px;margin-top:-3px;margin-left:-3px}.la-cube-transition.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-cube-transition.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:28px;height:28px;margin-top:-14px;margin-left:-14px}.la-cube-transition.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-cube-transition.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:42px;height:42px;margin-top:-21px;margin-left:-21px}@-webkit-keyframes cube-transition{25%{top:0;left:100%;-webkit-transform:scale(.5) rotate(-90deg);transform:scale(.5) rotate(-90deg)}50%{top:100%;left:100%;-webkit-transform:scale(1) rotate(-180deg);transform:scale(1) rotate(-180deg)}75%{top:100%;left:0;-webkit-transform:scale(.5) rotate(-270deg);transform:scale(.5) rotate(-270deg)}100%{top:0;left:0;-webkit-transform:scale(1) rotate(-360deg);transform:scale(1) rotate(-360deg)}}@keyframes cube-transition{25%{top:0;left:100%;-webkit-transform:scale(.5) rotate(-90deg);transform:scale(.5) rotate(-90deg)}50%{top:100%;left:100%;-webkit-transform:scale(1) rotate(-180deg);transform:scale(1) rotate(-180deg)}75%{top:100%;left:0;-webkit-transform:scale(.5) rotate(-270deg);transform:scale(.5) rotate(-270deg)}100%{top:0;left:0;-webkit-transform:scale(1) rotate(-360deg);transform:scale(1) rotate(-360deg)}}.la-fire[_ngcontent-%COMP%], .la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-fire[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-fire.la-dark[_ngcontent-%COMP%]{color:#333}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;bottom:0;left:50%;width:12px;height:12px;border-radius:2px;-webkit-transform:translateY(0) translateX(-50%) rotate(45deg) scale(0);transform:translateY(0) translateX(-50%) rotate(45deg) scale(0);-webkit-animation:1.5s linear infinite fire-diamonds;animation:1.5s linear infinite fire-diamonds}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:-.85s;animation-delay:-.85s}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-1.85s;animation-delay:-1.85s}.la-fire[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-2.85s;animation-delay:-2.85s}.la-fire.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-fire.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:6px}.la-fire.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-fire.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px}.la-fire.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-fire.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:36px;height:36px}@-webkit-keyframes fire-diamonds{0%{-webkit-transform:translateY(75%) translateX(-50%) rotate(45deg) scale(0);transform:translateY(75%) translateX(-50%) rotate(45deg) scale(0)}50%{-webkit-transform:translateY(-87.5%) translateX(-50%) rotate(45deg) scale(1);transform:translateY(-87.5%) translateX(-50%) rotate(45deg) scale(1)}100%{-webkit-transform:translateY(-212.5%) translateX(-50%) rotate(45deg) scale(0);transform:translateY(-212.5%) translateX(-50%) rotate(45deg) scale(0)}}@keyframes fire-diamonds{0%{-webkit-transform:translateY(75%) translateX(-50%) rotate(45deg) scale(0);transform:translateY(75%) translateX(-50%) rotate(45deg) scale(0)}50%{-webkit-transform:translateY(-87.5%) translateX(-50%) rotate(45deg) scale(1);transform:translateY(-87.5%) translateX(-50%) rotate(45deg) scale(1)}100%{-webkit-transform:translateY(-212.5%) translateX(-50%) rotate(45deg) scale(0);transform:translateY(-212.5%) translateX(-50%) rotate(45deg) scale(0)}}.la-line-scale-party[_ngcontent-%COMP%], .la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale-party[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:40px;height:32px}.la-line-scale-party.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation-name:line-scale-party;animation-name:line-scale-party;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-duration:.43s;animation-duration:.43s;-webkit-animation-delay:-.23s;animation-delay:-.23s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:.62s;animation-duration:.62s;-webkit-animation-delay:-.32s;animation-delay:-.32s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:.43s;animation-duration:.43s;-webkit-animation-delay:-.44s;animation-delay:-.44s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:.8s;animation-duration:.8s;-webkit-animation-delay:-.31s;animation-delay:-.31s}.la-line-scale-party[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:.74s;animation-duration:.74s;-webkit-animation-delay:-.24s;animation-delay:-.24s}.la-line-scale-party.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale-party.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale-party.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale-party.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale-party.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale-party.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes line-scale-party{0%,100%{-webkit-transform:scaleY(1);transform:scaleY(1)}50%{-webkit-transform:scaleY(.3);transform:scaleY(.3)}}@keyframes line-scale-party{0%,100%{-webkit-transform:scaleY(1);transform:scaleY(1)}50%{-webkit-transform:scaleY(.3);transform:scaleY(.3)}}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%], .la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:40px;height:32px}.la-line-scale-pulse-out-rapid.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation:.9s cubic-bezier(.11,.49,.38,.78) infinite line-scale-pulse-out-rapid;animation:.9s cubic-bezier(.11,.49,.38,.78) infinite line-scale-pulse-out-rapid}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.9s;animation-delay:-.9s}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2), .la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.65s;animation-delay:-.65s}.la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-line-scale-pulse-out-rapid[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.4s;animation-delay:-.4s}.la-line-scale-pulse-out-rapid.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale-pulse-out-rapid.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale-pulse-out-rapid.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale-pulse-out-rapid.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale-pulse-out-rapid.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale-pulse-out-rapid.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes line-scale-pulse-out-rapid{0%,90%{-webkit-transform:scaley(1);transform:scaley(1)}80%{-webkit-transform:scaley(.3);transform:scaley(.3)}}@keyframes line-scale-pulse-out-rapid{0%,90%{-webkit-transform:scaley(1);transform:scaley(1)}80%{-webkit-transform:scaley(.3);transform:scaley(.3)}}.la-line-scale-pulse-out[_ngcontent-%COMP%], .la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale-pulse-out[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:40px;height:32px}.la-line-scale-pulse-out.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation:.9s cubic-bezier(.85,.25,.37,.85) infinite line-scale-pulse-out;animation:.9s cubic-bezier(.85,.25,.37,.85) infinite line-scale-pulse-out}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-.9s;animation-delay:-.9s}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2), .la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.7s;animation-delay:-.7s}.la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-line-scale-pulse-out[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-line-scale-pulse-out.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale-pulse-out.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale-pulse-out.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale-pulse-out.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale-pulse-out.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale-pulse-out.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes line-scale-pulse-out{0%,100%{-webkit-transform:scaley(1);transform:scaley(1)}50%{-webkit-transform:scaley(.3);transform:scaley(.3)}}@keyframes line-scale-pulse-out{0%,100%{-webkit-transform:scaley(1);transform:scaley(1)}50%{-webkit-transform:scaley(.3);transform:scaley(.3)}}.la-line-scale[_ngcontent-%COMP%], .la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-scale[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:40px;height:32px}.la-line-scale.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:4px;height:32px;margin:0 2px;border-radius:0;-webkit-animation:1.2s infinite line-scale;animation:1.2s infinite line-scale}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-delay:-1.2s;animation-delay:-1.2s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-delay:-1.1s;animation-delay:-1.1s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-1s;animation-delay:-1s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-.9s;animation-delay:-.9s}.la-line-scale[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-.8s;animation-delay:-.8s}.la-line-scale.la-sm[_ngcontent-%COMP%]{width:20px;height:16px}.la-line-scale.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:2px;height:16px;margin:0 1px}.la-line-scale.la-2x[_ngcontent-%COMP%]{width:80px;height:64px}.la-line-scale.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:64px;margin:0 4px}.la-line-scale.la-3x[_ngcontent-%COMP%]{width:120px;height:96px}.la-line-scale.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:12px;height:96px;margin:0 6px}@-webkit-keyframes line-scale{0%,100%,40%{-webkit-transform:scaleY(.4);transform:scaleY(.4)}20%{-webkit-transform:scaleY(1);transform:scaleY(1)}}@keyframes line-scale{0%,100%,40%{-webkit-transform:scaleY(.4);transform:scaleY(.4)}20%{-webkit-transform:scaleY(1);transform:scaleY(1)}}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%], .la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px;-webkit-animation:6s linear infinite line-spin-clockwise-fade-rotating-rotate;animation:6s linear infinite line-spin-clockwise-fade-rotating-rotate}.la-line-spin-clockwise-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:1s ease-in-out infinite line-spin-clockwise-fade-rotating;animation:1s ease-in-out infinite line-spin-clockwise-fade-rotating}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:15%;left:50%;-webkit-transform:rotate(0);transform:rotate(0);-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;-webkit-transform:rotate(135deg);transform:rotate(135deg);-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;-webkit-transform:rotate(180deg);transform:rotate(180deg);-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;-webkit-transform:rotate(225deg);transform:rotate(225deg);-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;-webkit-transform:rotate(270deg);transform:rotate(270deg);-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-line-spin-clockwise-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;-webkit-transform:rotate(315deg);transform:rotate(315deg);-webkit-animation-delay:0s;animation-delay:0s}.la-line-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-clockwise-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-clockwise-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-clockwise-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes line-spin-clockwise-fade-rotating-rotate{100%{-webkit-transform:rotate(-360deg);transform:rotate(-360deg)}}@keyframes line-spin-clockwise-fade-rotating-rotate{100%{-webkit-transform:rotate(-360deg);transform:rotate(-360deg)}}@-webkit-keyframes line-spin-clockwise-fade-rotating{50%{opacity:.2}100%{opacity:1}}@keyframes line-spin-clockwise-fade-rotating{50%{opacity:.2}100%{opacity:1}}.la-line-spin-clockwise-fade[_ngcontent-%COMP%], .la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-clockwise-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-line-spin-clockwise-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:1s ease-in-out infinite line-spin-clockwise-fade;animation:1s ease-in-out infinite line-spin-clockwise-fade}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:15%;left:50%;-webkit-transform:rotate(0);transform:rotate(0);-webkit-animation-delay:-.875s;animation-delay:-.875s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation-delay:-.75s;animation-delay:-.75s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-animation-delay:-.625s;animation-delay:-.625s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;-webkit-transform:rotate(135deg);transform:rotate(135deg);-webkit-animation-delay:-.5s;animation-delay:-.5s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;-webkit-transform:rotate(180deg);transform:rotate(180deg);-webkit-animation-delay:-.375s;animation-delay:-.375s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;-webkit-transform:rotate(225deg);transform:rotate(225deg);-webkit-animation-delay:-.25s;animation-delay:-.25s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;-webkit-transform:rotate(270deg);transform:rotate(270deg);-webkit-animation-delay:-.125s;animation-delay:-.125s}.la-line-spin-clockwise-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;-webkit-transform:rotate(315deg);transform:rotate(315deg);-webkit-animation-delay:0s;animation-delay:0s}.la-line-spin-clockwise-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-clockwise-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-clockwise-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-clockwise-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-clockwise-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-clockwise-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes line-spin-clockwise-fade{50%{opacity:.2}100%{opacity:1}}@keyframes line-spin-clockwise-fade{50%{opacity:.2}100%{opacity:1}}.la-line-spin-fade-rotating[_ngcontent-%COMP%], .la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-fade-rotating[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px;-webkit-animation:6s linear infinite ball-spin-fade-rotating-rotate;animation:6s linear infinite ball-spin-fade-rotating-rotate}.la-line-spin-fade-rotating.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:1s ease-in-out infinite line-spin-fade-rotating;animation:1s ease-in-out infinite line-spin-fade-rotating}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:15%;left:50%;-webkit-transform:rotate(0);transform:rotate(0);-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;-webkit-transform:rotate(135deg);transform:rotate(135deg);-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;-webkit-transform:rotate(180deg);transform:rotate(180deg);-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;-webkit-transform:rotate(225deg);transform:rotate(225deg);-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;-webkit-transform:rotate(270deg);transform:rotate(270deg);-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-line-spin-fade-rotating[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;-webkit-transform:rotate(315deg);transform:rotate(315deg);-webkit-animation-delay:-2s;animation-delay:-2s}.la-line-spin-fade-rotating.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-fade-rotating.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-fade-rotating.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-fade-rotating.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-fade-rotating.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-fade-rotating.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes ball-spin-fade-rotating-rotate{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ball-spin-fade-rotating-rotate{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes line-spin-fade-rotating{50%{opacity:.2}100%{opacity:1}}@keyframes line-spin-fade-rotating{50%{opacity:.2}100%{opacity:1}}.la-line-spin-fade[_ngcontent-%COMP%], .la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-line-spin-fade[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-line-spin-fade.la-dark[_ngcontent-%COMP%]{color:#333}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;position:absolute;width:2px;height:10px;margin:-5px 2px 2px -1px;border-radius:0;-webkit-animation:1s ease-in-out infinite line-spin-fade;animation:1s ease-in-out infinite line-spin-fade}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:15%;left:50%;-webkit-transform:rotate(0);transform:rotate(0);-webkit-animation-delay:-1.125s;animation-delay:-1.125s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){top:25.2512626585%;left:74.7487373415%;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation-delay:-1.25s;animation-delay:-1.25s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){top:50%;left:85%;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-animation-delay:-1.375s;animation-delay:-1.375s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){top:74.7487373415%;left:74.7487373415%;-webkit-transform:rotate(135deg);transform:rotate(135deg);-webkit-animation-delay:-1.5s;animation-delay:-1.5s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){top:84.9999999974%;left:50.0000000004%;-webkit-transform:rotate(180deg);transform:rotate(180deg);-webkit-animation-delay:-1.625s;animation-delay:-1.625s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){top:74.7487369862%;left:25.2512627193%;-webkit-transform:rotate(225deg);transform:rotate(225deg);-webkit-animation-delay:-1.75s;animation-delay:-1.75s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){top:49.9999806189%;left:15.0000039834%;-webkit-transform:rotate(270deg);transform:rotate(270deg);-webkit-animation-delay:-1.875s;animation-delay:-1.875s}.la-line-spin-fade[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){top:25.2506949798%;left:25.2513989292%;-webkit-transform:rotate(315deg);transform:rotate(315deg);-webkit-animation-delay:-2s;animation-delay:-2s}.la-line-spin-fade.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-line-spin-fade.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:1px;height:4px;margin-top:-2px;margin-left:0}.la-line-spin-fade.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-line-spin-fade.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:20px;margin-top:-10px;margin-left:-2px}.la-line-spin-fade.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-line-spin-fade.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:6px;height:30px;margin-top:-15px;margin-left:-3px}@-webkit-keyframes line-spin-fade{50%{opacity:.2}100%{opacity:1}}@keyframes line-spin-fade{50%{opacity:.2}100%{opacity:1}}.la-pacman[_ngcontent-%COMP%], .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-pacman[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-pacman.la-dark[_ngcontent-%COMP%]{color:#333}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){width:0;height:0;background:0 0;border-style:solid;border-width:16px;border-right-color:transparent;border-radius:100%;-webkit-animation:.5s infinite pacman-rotate-half-up;animation:.5s infinite pacman-rotate-half-up}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){margin-top:-32px;-webkit-animation-name:pacman-rotate-half-down;animation-name:pacman-rotate-half-down}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){position:absolute;top:50%;left:200%;width:8px;height:8px;border-radius:100%;opacity:0;-webkit-animation:2s linear infinite pacman-balls;animation:2s linear infinite pacman-balls}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-delay:-1.44s;animation-delay:-1.44s}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-delay:-1.94s;animation-delay:-1.94s}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-delay:-2.44s;animation-delay:-2.44s}.la-pacman[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-delay:-2.94s;animation-delay:-2.94s}.la-pacman.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){border-width:8px}.la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){margin-top:-16px}.la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){width:4px;height:4px}.la-pacman.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){border-width:32px}.la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){margin-top:-64px}.la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){width:16px;height:16px}.la-pacman.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){border-width:48px}.la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){margin-top:-96px}.la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5), .la-pacman.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){width:24px;height:24px}@-webkit-keyframes pacman-rotate-half-up{0%,100%{-webkit-transform:rotate(270deg);transform:rotate(270deg)}50%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes pacman-rotate-half-up{0%,100%{-webkit-transform:rotate(270deg);transform:rotate(270deg)}50%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes pacman-rotate-half-down{0%,100%{-webkit-transform:rotate(90deg);transform:rotate(90deg)}50%{-webkit-transform:rotate(0);transform:rotate(0)}}@keyframes pacman-rotate-half-down{0%,100%{-webkit-transform:rotate(90deg);transform:rotate(90deg)}50%{-webkit-transform:rotate(0);transform:rotate(0)}}@-webkit-keyframes pacman-balls{0%{left:200%;opacity:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}5%{opacity:.5}66%{opacity:1}67%{opacity:0}100%{left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}}@keyframes pacman-balls{0%{left:200%;opacity:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}5%{opacity:.5}66%{opacity:1}67%{opacity:0}100%{left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}}.la-square-jelly-box[_ngcontent-%COMP%], .la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-square-jelly-box[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-square-jelly-box.la-dark[_ngcontent-%COMP%]{color:#333}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1), .la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){position:absolute;left:0;width:100%}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){top:-25%;z-index:1;height:100%;border-radius:10%;-webkit-animation:.6s linear -.1s infinite square-jelly-box-animate;animation:.6s linear -.1s infinite square-jelly-box-animate}.la-square-jelly-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){bottom:-9%;height:10%;background:#000;border-radius:50%;opacity:.2;-webkit-animation:.6s linear -.1s infinite square-jelly-box-shadow;animation:.6s linear -.1s infinite square-jelly-box-shadow}.la-square-jelly-box.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-square-jelly-box.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-square-jelly-box.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes square-jelly-box-animate{17%{border-bottom-right-radius:10%}25%{-webkit-transform:translateY(25%) rotate(22.5deg);transform:translateY(25%) rotate(22.5deg)}50%{border-bottom-right-radius:100%;-webkit-transform:translateY(50%) scale(1,.9) rotate(45deg);transform:translateY(50%) scale(1,.9) rotate(45deg)}75%{-webkit-transform:translateY(25%) rotate(67.5deg);transform:translateY(25%) rotate(67.5deg)}100%{-webkit-transform:translateY(0) rotate(90deg);transform:translateY(0) rotate(90deg)}}@keyframes square-jelly-box-animate{17%{border-bottom-right-radius:10%}25%{-webkit-transform:translateY(25%) rotate(22.5deg);transform:translateY(25%) rotate(22.5deg)}50%{border-bottom-right-radius:100%;-webkit-transform:translateY(50%) scale(1,.9) rotate(45deg);transform:translateY(50%) scale(1,.9) rotate(45deg)}75%{-webkit-transform:translateY(25%) rotate(67.5deg);transform:translateY(25%) rotate(67.5deg)}100%{-webkit-transform:translateY(0) rotate(90deg);transform:translateY(0) rotate(90deg)}}@-webkit-keyframes square-jelly-box-shadow{50%{-webkit-transform:scale(1.25,1);transform:scale(1.25,1)}}@keyframes square-jelly-box-shadow{50%{-webkit-transform:scale(1.25,1);transform:scale(1.25,1)}}.la-square-loader[_ngcontent-%COMP%], .la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-square-loader[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-square-loader.la-dark[_ngcontent-%COMP%]{color:#333}.la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px solid currentColor;width:100%;height:100%;background:0 0;border-radius:0;-webkit-animation:2s infinite square-loader;animation:2s infinite square-loader}.la-square-loader[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{display:inline-block;width:100%;vertical-align:top;content:"";background-color:currentColor;-webkit-animation:2s ease-in infinite square-loader-inner;animation:2s ease-in infinite square-loader-inner}.la-square-loader.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-square-loader.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:1px}.la-square-loader.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-square-loader.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:4px}.la-square-loader.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-square-loader.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:6px}@-webkit-keyframes square-loader{0%{-webkit-transform:rotate(0);transform:rotate(0)}25%,50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}100%,75%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes square-loader{0%{-webkit-transform:rotate(0);transform:rotate(0)}25%,50%{-webkit-transform:rotate(180deg);transform:rotate(180deg)}100%,75%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes square-loader-inner{0%,100%,25%{height:0}50%,75%{height:100%}}@keyframes square-loader-inner{0%,100%,25%{height:0}50%,75%{height:100%}}.la-square-spin[_ngcontent-%COMP%], .la-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-square-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-square-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-square-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor;width:100%;height:100%;border-radius:0;-webkit-animation:3s cubic-bezier(.09,.57,.49,.9) infinite square-spin;animation:3s cubic-bezier(.09,.57,.49,.9) infinite square-spin}.la-square-spin.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-square-spin.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-square-spin.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}@-webkit-keyframes square-spin{0%{-webkit-transform:perspective(100px) rotateX(0) rotateY(0);transform:perspective(100px) rotateX(0) rotateY(0)}25%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(0);transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(180deg);transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{-webkit-transform:perspective(100px) rotateX(0) rotateY(180deg);transform:perspective(100px) rotateX(0) rotateY(180deg)}100%{-webkit-transform:perspective(100px) rotateX(0) rotateY(360deg);transform:perspective(100px) rotateX(0) rotateY(360deg)}}@keyframes square-spin{0%{-webkit-transform:perspective(100px) rotateX(0) rotateY(0);transform:perspective(100px) rotateX(0) rotateY(0)}25%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(0);transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(180deg);transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{-webkit-transform:perspective(100px) rotateX(0) rotateY(180deg);transform:perspective(100px) rotateX(0) rotateY(180deg)}100%{-webkit-transform:perspective(100px) rotateX(0) rotateY(360deg);transform:perspective(100px) rotateX(0) rotateY(360deg)}}.la-timer[_ngcontent-%COMP%], .la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-timer[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:32px}.la-timer.la-dark[_ngcontent-%COMP%]{color:#333}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:2px solid currentColor;width:32px;height:32px;background:0 0;border-radius:100%}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{position:absolute;top:14px;left:14px;display:block;width:2px;margin-top:-1px;margin-left:-1px;content:"";background:currentColor;border-radius:2px;-webkit-transform-origin:1px 1px 0;transform-origin:1px 1px 0;-webkit-animation:1.25s linear -625ms infinite timer-loader;animation:1.25s linear -625ms infinite timer-loader}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:12px}.la-timer[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:8px;-webkit-animation-duration:15s;animation-duration:15s;-webkit-animation-delay:-7.5s;animation-delay:-7.5s}.la-timer.la-sm[_ngcontent-%COMP%]{width:16px;height:16px}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;border-width:1px}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:7px;left:7px;width:1px;margin-top:-.5px;margin-left:-.5px;border-radius:1px;-webkit-transform-origin:.5px .5px 0;transform-origin:.5px .5px 0}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:6px}.la-timer.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:4px}.la-timer.la-2x[_ngcontent-%COMP%]{width:64px;height:64px}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:64px;height:64px;border-width:4px}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:28px;left:28px;width:4px;margin-top:-2px;margin-left:-2px;border-radius:4px;-webkit-transform-origin:2px 2px 0;transform-origin:2px 2px 0}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:24px}.la-timer.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:16px}.la-timer.la-3x[_ngcontent-%COMP%]{width:96px;height:96px}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:96px;height:96px;border-width:6px}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after, .la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{top:42px;left:42px;width:6px;margin-top:-3px;margin-left:-3px;border-radius:6px;-webkit-transform-origin:3px 3px 0;transform-origin:3px 3px 0}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:before{height:36px}.la-timer.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:after{height:24px}@-webkit-keyframes timer-loader{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes timer-loader{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.la-triangle-skew-spin[_ngcontent-%COMP%], .la-triangle-skew-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;box-sizing:border-box}.la-triangle-skew-spin[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff;width:32px;height:16px}.la-triangle-skew-spin.la-dark[_ngcontent-%COMP%]{color:#333}.la-triangle-skew-spin[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;border:0 solid currentColor;width:0;height:0;background:0 0;border:solid;border-width:0 16px 16px;border-right-color:transparent;border-left-color:transparent;-webkit-animation:3s cubic-bezier(.09,.57,.49,.9) infinite triangle-skew-spin;animation:3s cubic-bezier(.09,.57,.49,.9) infinite triangle-skew-spin}.la-triangle-skew-spin.la-sm[_ngcontent-%COMP%]{width:16px;height:8px}.la-triangle-skew-spin.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:0 8px 8px}.la-triangle-skew-spin.la-2x[_ngcontent-%COMP%]{width:64px;height:32px}.la-triangle-skew-spin.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:0 32px 32px}.la-triangle-skew-spin.la-3x[_ngcontent-%COMP%]{width:96px;height:48px}.la-triangle-skew-spin.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border-width:0 48px 48px}@-webkit-keyframes triangle-skew-spin{0%{-webkit-transform:perspective(100px) rotateX(0) rotateY(0);transform:perspective(100px) rotateX(0) rotateY(0)}25%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(0);transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(180deg);transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{-webkit-transform:perspective(100px) rotateX(0) rotateY(180deg);transform:perspective(100px) rotateX(0) rotateY(180deg)}100%{-webkit-transform:perspective(100px) rotateX(0) rotateY(360deg);transform:perspective(100px) rotateX(0) rotateY(360deg)}}@keyframes triangle-skew-spin{0%{-webkit-transform:perspective(100px) rotateX(0) rotateY(0);transform:perspective(100px) rotateX(0) rotateY(0)}25%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(0);transform:perspective(100px) rotateX(180deg) rotateY(0)}50%{-webkit-transform:perspective(100px) rotateX(180deg) rotateY(180deg);transform:perspective(100px) rotateX(180deg) rotateY(180deg)}75%{-webkit-transform:perspective(100px) rotateX(0) rotateY(180deg);transform:perspective(100px) rotateX(0) rotateY(180deg)}100%{-webkit-transform:perspective(100px) rotateX(0) rotateY(360deg);transform:perspective(100px) rotateX(0) rotateY(360deg)}}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%}.overlay[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:not(.loading-text){top:50%;left:50%;margin:0;position:absolute;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.loading-text[_ngcontent-%COMP%]{position:absolute;top:60%;left:50%;-webkit-transform:translate(-50%,-60%);transform:translate(-50%,-60%)}'],data:{animation:[{type:7,name:"fadeIn",definitions:[{type:0,name:"in",styles:{type:6,styles:{opacity:1},offset:null},options:void 0},{type:1,expr:":enter",animation:[{type:6,styles:{opacity:0},offset:null},{type:4,styles:null,timings:300}],options:null},{type:1,expr:":leave",animation:{type:4,styles:{type:6,styles:{opacity:0},offset:null},timings:200},options:null}],options:{}}]}});function Vz(t){return Va(0,[(t()(),Oa(0,0,null,null,0,"div",[],null,null,null,null,null))],null,null)}function Uz(t){return Va(0,[(t()(),Oa(0,0,null,null,2,"div",[],[[8,"className",0],[4,"color",null]],null,null,null,null)),(t()(),Sa(16777216,null,null,1,null,Vz)),Xr(2,278528,null,0,pM,[On,kn,bn],{ngForOf:[0,"ngForOf"]},null)],(function(t,e){t(e,2,0,e.component.spinner.divArray)}),(function(t,e){var n=e.component;t(e,0,0,n.spinner.class,n.spinner.color)}))}function Wz(t){return Va(0,[(t()(),Oa(0,0,null,null,0,"div",[],[[8,"innerHTML",1]],null,null,null,null))],null,(function(t,e){t(e,0,0,e.component.template)}))}function jz(t){return Va(0,[(t()(),Oa(0,0,null,null,6,"div",[["class","overlay"]],[[24,"@fadeIn",0],[4,"background-color",null],[4,"z-index",null],[4,"position",null]],null,null,null,null)),(t()(),Sa(16777216,null,null,1,null,Uz)),Xr(2,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null),(t()(),Sa(16777216,null,null,1,null,Wz)),Xr(4,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null),(t()(),Oa(5,0,null,null,1,"div",[["class","loading-text"]],[[4,"z-index",null]],null,null,null,null)),Da(null,0)],(function(t,e){var n=e.component;t(e,2,0,!n.template),t(e,4,0,n.template)}),(function(t,e){var n=e.component;t(e,0,0,"in",n.spinner.bdColor,n.spinner.zIndex,n.spinner.fullScreen?"fixed":"absolute"),t(e,5,0,n.spinner.zIndex)}))}function qz(t){return Va(2,[(t()(),Sa(16777216,null,null,1,null,jz)),Xr(1,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null)],(function(t,e){t(e,1,0,e.component.spinner.show)}),null)}var Hz=Wn({encapsulation:0,styles:[[".page-header[_ngcontent-%COMP%]{margin:30px 10px;text-align:center}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:500}.container[_ngcontent-%COMP%]{margin:20px}.container[_ngcontent-%COMP%]   .file-upload-area[_ngcontent-%COMP%]{margin-bottom:50px}.container[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]:not([class*=mat-elevation-z]){box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.6)}.container[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{font-size:18px}.container[_ngcontent-%COMP%]   .mat-card[_ngcontent-%COMP%]   .mat-card-content[_ngcontent-%COMP%]{padding:20px 0 0}.container[_ngcontent-%COMP%]   .uploadfilecontainer[_ngcontent-%COMP%]{border:2px dashed #1c8adb;border-radius:10px;display:flex;align-items:center;justify-content:center;margin:0 auto;height:250px;width:80%}.container[_ngcontent-%COMP%]   .uploadfilecontainer[_ngcontent-%COMP%]   .drag-drop-content[_ngcontent-%COMP%]{margin:auto;text-align:center}.container[_ngcontent-%COMP%]   .uploadfilecontainer[_ngcontent-%COMP%]   .drag-drop-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px}.container[_ngcontent-%COMP%]   .uploadfilecontainer[_ngcontent-%COMP%]   .drag-drop-content[_ngcontent-%COMP%]   .file-upload-text[_ngcontent-%COMP%]{font-size:20px}.container[_ngcontent-%COMP%]   .uploadfilecontainer[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#cbe9f6!important;opacity:.8}.container[_ngcontent-%COMP%]   .uploaded-image-area[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{border:1px solid #ddd;display:block;margin:0 auto 10px;padding:10px;width:calc(100% - 20px)}.container[_ngcontent-%COMP%]   .result-area[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:inline-block;font-weight:700;width:150px}.container[_ngcontent-%COMP%]   .result-image-area[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{border:1px solid #ddd;display:block;margin:0 auto 10px;padding:10px;width:calc(100% - 20px)}ngx-spinner[_ngcontent-%COMP%]{color:#fff}@media only screen and (max-width:600px){.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:26px}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px}.container[_ngcontent-%COMP%]   .uploadfilecontainer[_ngcontent-%COMP%]{width:auto}}"]],data:{}});function Gz(t){return Va(0,[(t()(),Oa(0,0,null,null,0,"img",[["class","preview-image"]],[[8,"src",4]],null,null,null,null))],null,(function(t,e){t(e,0,0,e.component.imgURL)}))}function $z(t){return Va(0,[(t()(),Oa(0,0,null,null,18,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,QD,YD)),Xr(1,49152,null,0,fA,[[2,KD]],null,null),(t()(),Oa(2,0,null,0,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),Xr(3,16384,null,0,dA,[],null,null),(t()(),za(-1,null,["Result"])),(t()(),Oa(5,0,null,0,13,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Xr(6,16384,null,0,pA,[],null,null),(t()(),Oa(7,0,null,null,3,"p",[],null,null,null,null,null)),(t()(),Oa(8,0,null,null,1,"span",[["class","label"]],null,null,null,null,null)),(t()(),za(-1,null,["COVID-19: "])),(t()(),za(10,null,[" ","%"])),(t()(),Oa(11,0,null,null,3,"p",[],null,null,null,null,null)),(t()(),Oa(12,0,null,null,1,"span",[["class","label"]],null,null,null,null,null)),(t()(),za(-1,null,["Pneumonia: "])),(t()(),za(14,null,[" ","%"])),(t()(),Oa(15,0,null,null,3,"p",[],null,null,null,null,null)),(t()(),Oa(16,0,null,null,1,"span",[["class","label"]],null,null,null,null,null)),(t()(),za(-1,null,["Normal: "])),(t()(),za(18,null,[" ","%"]))],null,(function(t,e){var n=e.component;t(e,0,0,"NoopAnimations"===Fr(e,1)._animationMode),t(e,10,0,n.result[2]),t(e,14,0,n.result[1]),t(e,18,0,n.result[0])}))}function Kz(t){return Va(0,[(t()(),Oa(0,0,null,null,0,"img",[["class","preview-image"]],[[8,"src",4]],null,null,null,null))],null,(function(t,e){t(e,0,0,e.component.resultImgURL)}))}function Xz(t){return Va(0,[(t()(),Oa(0,0,null,null,8,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,QD,YD)),Xr(1,49152,null,0,fA,[[2,KD]],null,null),(t()(),Oa(2,0,null,0,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),Xr(3,16384,null,0,dA,[],null,null),(t()(),za(-1,null,["Result image"])),(t()(),Oa(5,0,null,0,3,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Xr(6,16384,null,0,pA,[],null,null),(t()(),Sa(16777216,null,null,1,null,Kz)),Xr(8,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null)],(function(t,e){t(e,8,0,e.component.resultImgURL)}),(function(t,e){t(e,0,0,"NoopAnimations"===Fr(e,1)._animationMode)}))}function Yz(t){return Va(0,[(t()(),Oa(0,0,null,null,22,"div",[["fxLayout","row wrap"],["fxLayoutAlign","space-around stretch"],["fxLayoutGap","10px grid"]],null,null,null,null,null)),Xr(1,671744,null,0,qF,[Je,TF,[2,UF],DF],{fxLayout:[0,"fxLayout"]},null),Xr(2,1720320,null,0,YF,[Je,Wi,yA,TF,[2,$F],DF],{fxLayoutGap:[0,"fxLayoutGap"]},null),Xr(3,671744,null,0,mz,[Je,TF,[2,pz],DF],{fxLayoutAlign:[0,"fxLayoutAlign"]},null),(t()(),Oa(4,0,null,null,10,"div",[["class","uploaded-image-area"],["fxFlex","32"],["fxFlex.xs","100"]],null,null,null,null,null)),Xr(5,671744,null,0,sz,[Je,TF,aF,iz,DF],{fxFlex:[0,"fxFlex"],"fxFlex.xs":[1,"fxFlex.xs"]},null),(t()(),Oa(6,0,null,null,8,"mat-card",[["class","mat-card"]],[[2,"_mat-animation-noopable",null]],null,null,QD,YD)),Xr(7,49152,null,0,fA,[[2,KD]],null,null),(t()(),Oa(8,0,null,0,2,"mat-card-title",[["class","mat-card-title"]],null,null,null,null,null)),Xr(9,16384,null,0,dA,[],null,null),(t()(),za(-1,null,["Test image"])),(t()(),Oa(11,0,null,0,3,"mat-card-content",[["class","mat-card-content"]],null,null,null,null,null)),Xr(12,16384,null,0,pA,[],null,null),(t()(),Sa(16777216,null,null,1,null,Gz)),Xr(14,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null),(t()(),Oa(15,0,null,null,3,"div",[["class","result-area"],["fxFlex","32"],["fxFlex.xs","100"]],null,null,null,null,null)),Xr(16,671744,null,0,sz,[Je,TF,aF,iz,DF],{fxFlex:[0,"fxFlex"],"fxFlex.xs":[1,"fxFlex.xs"]},null),(t()(),Sa(16777216,null,null,1,null,$z)),Xr(18,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null),(t()(),Oa(19,0,null,null,3,"div",[["class","result-image-area"],["fxFlex","32"],["fxFlex.xs","100"]],null,null,null,null,null)),Xr(20,671744,null,0,sz,[Je,TF,aF,iz,DF],{fxFlex:[0,"fxFlex"],"fxFlex.xs":[1,"fxFlex.xs"]},null),(t()(),Sa(16777216,null,null,1,null,Xz)),Xr(22,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null)],(function(t,e){var n=e.component;t(e,1,0,"row wrap"),t(e,2,0,"10px grid"),t(e,3,0,"space-around stretch"),t(e,5,0,"32","100"),t(e,14,0,n.imgURL),t(e,16,0,"32","100"),t(e,18,0,n.result),t(e,20,0,"32","100"),t(e,22,0,n.result)}),(function(t,e){t(e,6,0,"NoopAnimations"===Fr(e,7)._animationMode)}))}function Qz(t){return Va(0,[(t()(),Oa(0,0,null,null,4,"div",[["class","page-header"]],null,null,null,null,null)),(t()(),Oa(1,0,null,null,1,"h1",[],null,null,null,null,null)),(t()(),za(-1,null,["Detect COVID-19 in seconds!"])),(t()(),Oa(3,0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),za(-1,null,["Upload your X-Ray image to detect COVID-19"])),(t()(),Oa(5,0,null,null,10,"div",[["class","container"]],null,null,null,null,null)),(t()(),Oa(6,0,null,null,7,"div",[["class","file-upload-area"]],null,null,null,null,null)),(t()(),Oa(7,0,null,null,6,"div",[["appDragDrop",""],["class","uploadfilecontainer"]],[[4,"background-color",null],[4,"opacity",null]],[[null,"click"],[null,"onFileDropped"],[null,"dragover"],[null,"dragleave"],[null,"drop"]],(function(t,e,n){var r=!0,i=t.component;return"dragover"===e&&(r=!1!==Fr(t,8).onDragOver(n)&&r),"dragleave"===e&&(r=!1!==Fr(t,8).onDragLeave(n)&&r),"drop"===e&&(r=!1!==Fr(t,8).ondrop(n)&&r),"click"===e&&(r=!1!==Fr(t,9).click()&&r),"onFileDropped"===e&&(r=!1!==i.uploadFile(n)&&r),r}),null,null)),Xr(8,16384,null,0,Sz,[],null,{onFileDropped:"onFileDropped"}),(t()(),Oa(9,0,[["fileInput",1]],null,0,"input",[["hidden",""],["type","file"]],[[8,"accept",0]],[[null,"change"]],(function(t,e,n){var r=!0;return"change"===e&&(r=!1!==t.component.uploadFile(n.target.files)&&r),r}),null,null)),(t()(),Oa(10,0,null,null,3,"div",[["class","drag-drop-content"]],null,null,null,null,null)),(t()(),Oa(11,0,null,null,0,"img",[["src","assets/cloud.png"]],null,null,null,null,null)),(t()(),Oa(12,0,null,null,1,"p",[["class","file-upload-text"]],null,null,null,null,null)),(t()(),za(-1,null,["Upload X-Ray image here"])),(t()(),Sa(16777216,null,null,1,null,Yz)),Xr(15,16384,null,0,fM,[On,kn],{ngIf:[0,"ngIf"]},null),(t()(),Oa(16,0,null,null,2,"ngx-spinner",[["size","medium"],["type","ball-clip-rotate-pulse"]],null,null,null,qz,Bz)),Xr(17,770048,null,0,zz,[Fz,Ce],{size:[0,"size"],type:[1,"type"]},null),(t()(),za(18,0,["",""]))],(function(t,e){t(e,15,0,e.component.uploadedFile),t(e,17,0,"medium","ball-clip-rotate-pulse")}),(function(t,e){var n=e.component;t(e,7,0,Fr(e,8).background,Fr(e,8).opacity),t(e,9,0,n.fileTypes.join(",")),t(e,18,0,n.loadingText)}))}function Zz(t){return Va(0,[(t()(),Oa(0,0,null,null,1,"app-root",[],null,null,null,Qz,Hz)),Xr(1,114688,null,0,ZE,[Fz],null,null)],(function(t,e){t(e,1,0)}),null)}var Jz=Sr("app-root",ZE,Zz,{},{},[]);class tL{}class eL{}class nL{}class rL{}class iL{constructor(t,e){wM(e)&&!t&&console.warn("Warning: Flex Layout loaded on the server without FlexLayoutServerModule")}static withConfig(t,e=[]){return{ngModule:iL,providers:t.serverLoaded?[{provide:aF,useValue:Object.assign({},iF,t)},{provide:sF,useValue:e,multi:!0},{provide:oF,useValue:!0}]:[{provide:aF,useValue:Object.assign({},iF,t)},{provide:sF,useValue:e,multi:!0}]}}}var aL=Go(Ko,[ZE],(function(t){return function(t){const e={},n=[];let r=!1;for(let i=0;i<t.length;i++){const a=t[i];a.token===ke&&!0===a.value&&(r=!0),1073741824&a.flags&&n.push(a.token),a.index=i,e[Un(a.token)]=a}return{factory:null,providersByKey:e,providers:t,modules:n,isRoot:r}}([vr(512,Xe,Ye,[[8,[hA,Jz]],[3,Xe],Ft]),vr(5120,Si,Ca,[[3,Si]]),vr(4608,uM,cM,[Si,[2,lM]]),vr(5120,ui,_a,[Wi]),vr(5120,vi,bi,[]),vr(5120,bn,wa,[]),vr(5120,wn,xa,[]),vr(4608,cP,hP,[vM]),vr(6144,ye,null,[cP]),vr(4608,rP,aP,[]),vr(5120,IN,(function(t,e,n,r,i,a,o,s){return[new eP(t,e,n),new uP(r),new oP(i,a,o,s)]}),[vM,Wi,Ci,vM,vM,rP,ki,[2,iP]]),vr(4608,AN,AN,[IN,Wi]),vr(135680,FN,FN,[vM]),vr(4608,UN,UN,[AN,FN,vi]),vr(5120,rR,HD,[]),vr(5120,GR,GD,[]),vr(4608,bD,qD,[vM,rR,GR]),vr(5120,nn,$D,[UN,bD,Wi]),vr(6144,DN,null,[FN]),vr(4608,Xi,Xi,[Wi]),vr(5120,ET,rA,[zI]),vr(4608,qI,qI,[]),vr(6144,WI,null,[qI]),vr(135680,HI,HI,[zI,la,Ti,Oe,WI]),vr(4608,jI,jI,[]),vr(5120,GI,ZI,[zI,xM,$I]),vr(5120,sA,oA,[iA]),vr(5120,_i,(function(t,e,n){return[t,(r=e,i=n,()=>{if(bM(i)){const t=Array.from(r.querySelectorAll("[class*=flex-layout-]")),e=/\bflex-layout-.+?\b/g;t.forEach(t=>{t.classList.contains("flex-layout-ssr")&&t.parentNode?t.parentNode.removeChild(t):t.className.replace(e,"")})}})];var r,i}),[sA,vM,Ci]),vr(4608,TA,zD,[nn,vM]),vr(4608,Fz,Fz,[]),vr(1073742336,yM,yM,[]),vr(1024,Ht,bP,[]),vr(1024,ea,(function(){return[YI()]}),[]),vr(512,iA,iA,[Oe]),vr(1024,gi,(function(t,e){return[(n=t,NN("probe",TN),NN("coreTokens",Object.assign({},PN,(n||[]).reduce((t,e)=>(t[e.name]=e.token,t),{}))),()=>TN),aA(e)];var n}),[[2,ea],iA]),vr(512,yi,yi,[[2,gi]]),vr(131584,oa,oa,[Wi,ki,Oe,Ht,Xe,yi]),vr(1073742336,ka,ka,[oa]),vr(1073742336,wP,wP,[[3,wP]]),vr(1024,KI,tA,[[3,zI]]),vr(512,aT,oT,[]),vr(512,BI,BI,[]),vr(256,$I,{},[]),vr(1024,eM,JI,[JE,[2,nM],$I]),vr(512,rM,rM,[eM,JE]),vr(512,Ti,Ti,[]),vr(512,la,ha,[Ti,[2,ua]]),vr(1024,PI,(function(){return[[]]}),[]),vr(1024,zI,nA,[oa,aT,BI,rM,Oe,la,Ti,PI,$I,[2,II],[2,MI]]),vr(1073742336,QI,QI,[[2,KI],[2,zI]]),vr(1073742336,tL,tL,[]),vr(1073742336,XD,XD,[]),vr(1073742336,vA,vA,[]),vr(1073742336,MA,MA,[[2,EA],[2,iP]]),vr(1073742336,xA,xA,[]),vr(1073742336,PA,PA,[]),vr(1073742336,eL,eL,[]),vr(1073742336,mA,mA,[]),vr(1073742336,eF,eF,[]),vr(1073742336,kz,kz,[]),vr(1073742336,nL,nL,[]),vr(1073742336,rL,rL,[]),vr(1073742336,iL,iL,[[2,oF],Ci]),vr(1073742336,Lz,Lz,[]),vr(1073742336,Ko,Ko,[]),vr(256,ke,!0,[]),vr(256,KD,"BrowserAnimations",[])])}));(function(){if($t)throw new Error("Cannot enable prod mode after platform setup.");Gt=!1})(),vP().bootstrapModuleFactory(aL).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0]]]);